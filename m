Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S317404AbSGDNCS>; Thu, 4 Jul 2002 09:02:18 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S317406AbSGDNCR>; Thu, 4 Jul 2002 09:02:17 -0400
Received: from swszl.szkp.uni-miskolc.hu ([193.6.2.24]:14735 "EHLO
	swszl.szkp.uni-miskolc.hu") by vger.kernel.org with ESMTP
	id <S317404AbSGDNCQ>; Thu, 4 Jul 2002 09:02:16 -0400
Date: Thu, 4 Jul 2002 15:04:49 +0200
From: Vitez Gabor <gabor@swszl.szkp.uni-miskolc.hu>
To: Ingo Molnar <mingo@elte.hu>
Cc: linux-kernel@vger.kernel.org
Subject: Re: [announce] [patch] batch/idle priority scheduling, SCHED_BATCH
Message-ID: <20020704130449.GA1051@swszl.szkp.uni-miskolc.hu>
References: <Pine.LNX.4.44.0207010122580.11969-300000@e2>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <Pine.LNX.4.44.0207010122580.11969-300000@e2>
User-Agent: Mutt/1.3.28i
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

On Mon, Jul 01, 2002 at 02:26:42AM +0200, Ingo Molnar wrote:
> the load generated by multiple SCHED_BATCH processes does not show up in
> the load average - this is the straightforward solution to not confuse
> load-average-sensitive applications such as sendmail.

I think this will confuse atd too, which is an obvious candidate 
for the batch scheduler; it may end up starting all jobs which 
sit in it's "batch" queue.

I think a load-average calculation scheme like this would be better:

oldload: is the load average calculated the old way
batchload: is the load average calculated only from the batch scheduler
numcpus: number of cpus...

newload(){
if (oldload > numcpus) return oldload;
if ((oldload+batchload) > numcpus) return numcpus;
return (oldload+batchload)
}

So the batch processes would show the CPUs maxed out, but would not show 
up as overload in the load average. (and you could run 
"atd -l <numcpus - 0.3>")

	regards:
		Gabor Vitez
