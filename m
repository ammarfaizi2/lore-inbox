Return-Path: <linux-kernel-owner+willy=40w.ods.org-S1750739AbWDTMGJ@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1750739AbWDTMGJ (ORCPT <rfc822;willy@w.ods.org>);
	Thu, 20 Apr 2006 08:06:09 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1750759AbWDTMGJ
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Thu, 20 Apr 2006 08:06:09 -0400
Received: from out1.smtp.messagingengine.com ([66.111.4.25]:60864 "EHLO
	out1.smtp.messagingengine.com") by vger.kernel.org with ESMTP
	id S1750739AbWDTMGI (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Thu, 20 Apr 2006 08:06:08 -0400
X-Sasl-enc: yrnUxL/wt7VBXnrybLRn6jv773NoH/iGkh5xQ8rKyvyC 1145534730
Message-ID: <4447796F.1070307@imap.cc>
Date: Thu, 20 Apr 2006 14:07:11 +0200
From: Tilman Schmidt <tilman@imap.cc>
Organization: me - organized??
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.0; de-AT; rv:1.7.12) Gecko/20050915
X-Accept-Language: de,en,fr
MIME-Version: 1.0
To: Andrew Morton <akpm@osdl.org>
CC: kkeil@suse.de, i4ldeveloper@listserv.isdn4linux.de,
       linux-kernel@vger.kernel.org, hjlipp@web.de, Greg KH <gregkh@suse.de>,
       linux-usb-devel@lists.sourceforge.net
Subject: Re: [2.6 Patch] isdn4linux: Siemens Gigaset base driver: fix disconnect
 handling
References: <200604191838.k3JIc1eX022982@lx1.pxnet.com> <20060420001106.23d08ca7.akpm@osdl.org>
In-Reply-To: <20060420001106.23d08ca7.akpm@osdl.org>
X-Enigmail-Version: 0.93.0.0
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="------------enigE159B9B324A2E74B3DFA388F"
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

This is an OpenPGP/MIME signed message (RFC 2440 and 3156)
--------------enigE159B9B324A2E74B3DFA388F
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

On 20.04.2006 09:11, Andrew Morton wrote:
> Tilman Schmidt <tilman@imap.cc> wrote:
> 
>>This patch fixes a possible Oops in the Siemens Gigaset base driver when
>> the device is unplugged while an ISDN connection is still active, and
>> makes sure that the isdn4linux link level (LL) is properly informed if a
>> connection is broken by the USB cable being unplugged.
>> It also improves some kernel messages generated by the driver.
> 
> It seems to do quite a lot more than that.
> [...] I'd ask you to confirm that this was actually the patch which
> was supposed to go with that changelog.

It is. However the changelog was not quite complete. There were a couple
of smaller changes which I neglected to mention. Sorry for that. I'll
try to be more careful when composing future changelogs.

The missing changes are:

Avoid unsafe checks of URB status fields outside the URB completion
handlers, keep track of in-use URBs myself instead.
If an isochronous transfer URB completes with status==0, also check the
status of the frame descriptors.
Verify length of interrupt messages received from the device.
Align the length limit on transmitted AT commands with the device
documentation.
In case of AT response receive overrun, keep newly arrived instead of
old unread data.
Remove redundant check of device ID in the USB probe function.
Correct and improve some comments and formatting.

>> --- linux-2.6.17-rc2-work/drivers/isdn/gigaset.orig/bas-gigaset.c	2006-04-19 15:15:49.000000000 +0200
>> +++ local/drivers/isdn/gigaset/bas-gigaset.c	2006-04-19 01:19:41.000000000 +0200
> 
> eek, please don't do that - it confuses my scripts.
> 
> --- linux-2.6.17-rc2-work/drivers/isdn/gigaset/bas-gigaset.c
> +++ linux-2.6.17-rc2-work/drivers/isdn/gigaset/bas-gigaset.c
> 
> is preferred.  There are nice tools around which help with this.

I'll be happy to comply with whatever your scripts need, but I don't
quite understand yet what it is that's causing you problems:
The presence of file timestamps?
The timestamp of the second file being earlier than the first one?
The ".orig" suffix in the first path?
The second path starting with "local" instead of "linux-..."?
All of this can be easily corrected; just tell me what's required.

Thanks
Tilman

-- 
Tilman Schmidt                          E-Mail: tilman@imap.cc
Bonn, Germany
It is well known that a vital ingredient of success is not knowing that
what you're attempting can't be done. [Terry Pratchett, "Equal Rites"]

--------------enigE159B9B324A2E74B3DFA388F
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3rc1 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFER3l2MdB4Whm86/kRAlkyAJ9cnjahTJjf0beSSB/Fn8ylV3TwfACfWNzQ
1U2a6fFSQiDYn0LOmOPS45U=
=8Bpo
-----END PGP SIGNATURE-----

--------------enigE159B9B324A2E74B3DFA388F--
