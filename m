Return-Path: <linux-kernel-owner+willy=40w.ods.org-S261181AbVFUEov@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261181AbVFUEov (ORCPT <rfc822;willy@w.ods.org>);
	Tue, 21 Jun 2005 00:44:51 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261627AbVFTW6q
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Mon, 20 Jun 2005 18:58:46 -0400
Received: from smtp.osdl.org ([65.172.181.4]:64926 "EHLO smtp.osdl.org")
	by vger.kernel.org with ESMTP id S261290AbVFTWd6 (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Mon, 20 Jun 2005 18:33:58 -0400
Date: Mon, 20 Jun 2005 15:34:45 -0700
From: Andrew Morton <akpm@osdl.org>
To: "J.A. Magallon" <jamagallon@able.es>
Cc: linux-kernel@vger.kernel.org, netdev@vger.kernel.org
Subject: iptables bug (was: Re: 2.6.12-mm1)
Message-Id: <20050620153445.5daaed4e.akpm@osdl.org>
In-Reply-To: <1119305756l.1344l.0l@werewolf.able.es>
References: <20050619233029.45dd66b8.akpm@osdl.org>
	<1119305756l.1344l.0l@werewolf.able.es>
X-Mailer: Sylpheed version 1.0.0 (GTK+ 1.2.10; i386-vine-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

"J.A. Magallon" <jamagallon@able.es> wrote:
>
> 
> On 06.20, Andrew Morton wrote:
> > 
> > ftp://ftp.kernel.org/pub/linux/kernel/people/akpm/patches/2.6/2.6.12/2.6.12-mm1/
> > 
> > 
> > - Someone broke /proc/device-tree on ppc64.  It's being looked into.
> > 
> > - Nothing particularly special here - various fixes and updates.
> > 
> 
> Are there any known problems with iptables ?

Let's cc the appropriate list and find out ;)

> I see strange things.
> When I use bittorrent (azureus or bittorrent-gui), at the same time as
> iptables (for nat and internet access for my ibook), when I stop a download
> or exit from one of this apps my external network goes down. 
> I have tried the same without iptables loaded and it works fine.
> 
> If someone has any idea about this, I could give more details.
> 
> Kernel: every -mm since time ago.
> External net: 1Mb cable through 3c59x, dhcp
> Internal net: e1000
> Iptables setup:
> # Generated by iptables-save v1.2.9 on Thu Mar  3 23:41:02 2005
> *nat
> :PREROUTING ACCEPT [2:156]
> :POSTROUTING ACCEPT [0:0]
> :OUTPUT ACCEPT [0:0]
> [0:0] -A POSTROUTING -o eth0 -j MASQUERADE 
> COMMIT
> # Completed on Thu Mar  3 23:41:02 2005
> # Generated by iptables-save v1.2.9 on Thu Mar  3 23:41:02 2005
> *filter
> :INPUT ACCEPT [6:468]
> :FORWARD DROP [0:0]
> :OUTPUT ACCEPT [0:0]
> [0:0] -A FORWARD -i eth0 -o eth1 -m state --state RELATED,ESTABLISHED -j ACCEPT 
> [0:0] -A FORWARD -i eth1 -o eth0 -j ACCEPT 
> [0:0] -A FORWARD -i eth0 -o eth2 -m state --state RELATED,ESTABLISHED -j ACCEPT 
> [0:0] -A FORWARD -i eth2 -o eth0 -j ACCEPT 
> [0:0] -A FORWARD -i eth0 -o eth3 -m state --state RELATED,ESTABLISHED -j ACCEPT 
> [0:0] -A FORWARD -i eth3 -o eth0 -j ACCEPT 
> COMMIT
> # Completed on Thu Mar  3 23:41:02 2005
> 
> eth's:
> alias eth0 3c59x
> alias eth1 e1000
> alias eth2 ne2k-pci
> alias eth3 eth1394
> 
> eth2 and eth3 are currently down, not even the module is loaded.
> 
> Any idea ?
> 
> --
> J.A. Magallon <jamagallon()able!es>     \               Software is like sex:
> werewolf!able!es                         \         It's better when it's free
> Mandriva Linux release 2006.0 (Cooker) for i586
> Linux 2.6.12-jam1 (gcc 4.0.1 (4.0.1-0.2mdk for Mandriva Linux release 2006.0))
> 
