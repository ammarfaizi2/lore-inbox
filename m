Return-Path: <linux-kernel-owner+willy=40w.ods.org-S1750723AbWDDP4i@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1750723AbWDDP4i (ORCPT <rfc822;willy@w.ods.org>);
	Tue, 4 Apr 2006 11:56:38 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1750724AbWDDP4i
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Tue, 4 Apr 2006 11:56:38 -0400
Received: from ns2.suse.de ([195.135.220.15]:419 "EHLO mx2.suse.de")
	by vger.kernel.org with ESMTP id S1750723AbWDDP4i (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Tue, 4 Apr 2006 11:56:38 -0400
Date: Tue, 04 Apr 2006 17:56:36 +0200
Message-ID: <s5hlkul72rv.wl%tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Jan Niehusmann <jan@gondor.com>
Cc: Ken Moffat <zarniwhoop@ntlworld.com>, linux-kernel@vger.kernel.org,
       alsa-devel@alsa-project.org
Subject: Re: [Alsa-devel] Slab corruptions & Re: 2.6.17-rc1: Oops in sound applications
In-Reply-To: <20060404133814.GA11741@knautsch.gondor.com>
References: <Pine.LNX.4.63.0604032155220.17605@deepthought.mydomain>
	<20060404133814.GA11741@knautsch.gondor.com>
User-Agent: Wanderlust/2.12.0 (Your Wildest Dreams) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.7 (=?ISO-8859-4?Q?Sanj=F2?=) APEL/10.6 MULE XEmacs/21.5 (beta25)
 (eggplant) (+CVS-20060326) (i386-suse-linux)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

At Tue, 4 Apr 2006 15:38:14 +0200,
Jan Niehusmann wrote:
> 
> On Mon, Apr 03, 2006 at 10:01:08PM +0100, Ken Moffat wrote:
> > 1. One line summary:
> > 
> >  On x86, sound applications oops when I refresh the browser.
> 
> I also see Oopses which seem to be sound related, although I did
> not notice a correllation with the browser. The oopses below are from
> 2.6.17-rc1 with additional ipw2200 patches (first one), and from a clean
> 2.6.17 (second one). The -dirty suffix in the version numbers comes from
> compiling with make-kpkg, not from actual changes to the source.

Could you try the patch below by OGAWA Hirofumi
<hirofumi@mail.parknet.co.jp>?


Takashi

===

 sound/core/oss/pcm_oss.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff -puN sound/core/oss/pcm_oss.c~pcm_oss-fixes sound/core/oss/pcm_oss.c
--- linux-2.6/sound/core/oss/pcm_oss.c~pcm_oss-fixes	2006-04-04 19:53:41.000000000 +0900
+++ linux-2.6-hirofumi/sound/core/oss/pcm_oss.c	2006-04-04 19:54:18.000000000 +0900
@@ -1760,7 +1760,7 @@ static int snd_pcm_oss_open_file(struct 
 		snd_pcm_oss_init_substream(substream, &setup[idx], minor);
 	}
 	
-	if (! pcm_oss_file->streams[0] && pcm_oss_file->streams[1]) {
+	if (!pcm_oss_file->streams[0] && !pcm_oss_file->streams[1]) {
 		snd_pcm_oss_release_file(pcm_oss_file);
 		return -EINVAL;
 	}

