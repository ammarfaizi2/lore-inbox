Return-Path: <linux-kernel-owner+willy=40w.ods.org-S1756498AbWKVS5j@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1756498AbWKVS5j (ORCPT <rfc822;willy@w.ods.org>);
	Wed, 22 Nov 2006 13:57:39 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1756508AbWKVS5j
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Wed, 22 Nov 2006 13:57:39 -0500
Received: from bay0-omc1-s15.bay0.hotmail.com ([65.54.246.87]:26190 "EHLO
	bay0-omc1-s15.bay0.hotmail.com") by vger.kernel.org with ESMTP
	id S1756498AbWKVS5i (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Wed, 22 Nov 2006 13:57:38 -0500
Message-ID: <BAY20-F16EB95A16D5DB8549DE6A1D8E30@phx.gbl>
X-Originating-IP: [80.178.108.101]
X-Originating-Email: [yan_952@hotmail.com]
From: "Burman Yan" <yan_952@hotmail.com>
To: linux-kernel@vger.kernel.org
Cc: trivial@kernel.org
Subject: [PATCH 2.6.19-rc6] serial: replace kmalloc+memset with kzalloc
Date: Wed, 22 Nov 2006 20:57:33 +0200
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="----=_NextPart_000_3a44_42ad_4cce"
X-OriginalArrivalTime: 22 Nov 2006 18:57:35.0302 (UTC) FILETIME=[127E8E60:01C70E68]
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

This is a multi-part message in MIME format.

------=_NextPart_000_3a44_42ad_4cce
Content-Type: text/plain; format=flowed

Hi.

This patch replaces kmalloc+memset with kzalloc in serial driver sources.

Regards
Yan Burman

_________________________________________________________________
FREE pop-up blocking with the new MSN Toolbar - get it now! 
http://toolbar.msn.click-url.com/go/onm00200415ave/direct/01/

------=_NextPart_000_3a44_42ad_4cce
Content-Type: application/octet-stream; name="kzalloc_serial.patch"
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename="kzalloc_serial.patch"

UmVwbGFjZSBrbWFsbG9jK21lbXNldCB3aXRoIGt6YWxsb2MgCgpTaWduZWQt
b2ZmLWJ5OiBZYW4gQnVybWFuIDx5YW5fOTUyQGhvdG1haWwuY29tPgoKZGlm
ZiAtcnVicCBsaW51eC0yLjYuMTktcmM1X29yaWcvZHJpdmVycy9zZXJpYWwv
ODI1MF9hY29ybi5jIGxpbnV4LTIuNi4xOS1yYzVfa3phbGxvYy9kcml2ZXJz
L3NlcmlhbC84MjUwX2Fjb3JuLmMKLS0tIGxpbnV4LTIuNi4xOS1yYzVfb3Jp
Zy9kcml2ZXJzL3NlcmlhbC84MjUwX2Fjb3JuLmMJMjAwNi0xMS0wOSAxMjox
NjoyMS4wMDAwMDAwMDAgKzAyMDAKKysrIGxpbnV4LTIuNi4xOS1yYzVfa3ph
bGxvYy9kcml2ZXJzL3NlcmlhbC84MjUwX2Fjb3JuLmMJMjAwNi0xMS0xMSAy
Mjo0NDowNC4wMDAwMDAwMDAgKzAyMDAKQEAgLTQ3LDExICs0NywxMCBAQCBz
ZXJpYWxfY2FyZF9wcm9iZShzdHJ1Y3QgZXhwYW5zaW9uX2NhcmQgCiAJdW5z
aWduZWQgbG9uZyBidXNfYWRkcjsKIAl1bnNpZ25lZCBpbnQgaTsKIAotCWlu
Zm8gPSBrbWFsbG9jKHNpemVvZihzdHJ1Y3Qgc2VyaWFsX2NhcmRfaW5mbyks
IEdGUF9LRVJORUwpOworCWluZm8gPSBremFsbG9jKHNpemVvZihzdHJ1Y3Qg
c2VyaWFsX2NhcmRfaW5mbyksIEdGUF9LRVJORUwpOwogCWlmICghaW5mbykK
IAkJcmV0dXJuIC1FTk9NRU07CiAKLQltZW1zZXQoaW5mbywgMCwgc2l6ZW9m
KHN0cnVjdCBzZXJpYWxfY2FyZF9pbmZvKSk7CiAJaW5mby0+bnVtX3BvcnRz
ID0gdHlwZS0+bnVtX3BvcnRzOwogCiAJYnVzX2FkZHIgPSBlY2FyZF9yZXNv
dXJjZV9zdGFydChlYywgdHlwZS0+dHlwZSk7CmRpZmYgLXJ1YnAgbGludXgt
Mi42LjE5LXJjNV9vcmlnL2RyaXZlcnMvc2VyaWFsLzgyNTBfcGNpLmMgbGlu
dXgtMi42LjE5LXJjNV9remFsbG9jL2RyaXZlcnMvc2VyaWFsLzgyNTBfcGNp
LmMKLS0tIGxpbnV4LTIuNi4xOS1yYzVfb3JpZy9kcml2ZXJzL3NlcmlhbC84
MjUwX3BjaS5jCTIwMDYtMTEtMDkgMTI6MTY6MjEuMDAwMDAwMDAwICswMjAw
CisrKyBsaW51eC0yLjYuMTktcmM1X2t6YWxsb2MvZHJpdmVycy9zZXJpYWwv
ODI1MF9wY2kuYwkyMDA2LTExLTExIDIyOjQ0OjE4LjAwMDAwMDAwMCArMDIw
MApAQCAtMTYxNCw3ICsxNjE0LDcgQEAgcGNpc2VyaWFsX2luaXRfcG9ydHMo
c3RydWN0IHBjaV9kZXYgKmRldgogCQkJbnJfcG9ydHMgPSByYzsKIAl9CiAK
LQlwcml2ID0ga21hbGxvYyhzaXplb2Yoc3RydWN0IHNlcmlhbF9wcml2YXRl
KSArCisJcHJpdiA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBzZXJpYWxfcHJp
dmF0ZSkgKwogCQkgICAgICAgc2l6ZW9mKHVuc2lnbmVkIGludCkgKiBucl9w
b3J0cywKIAkJICAgICAgIEdGUF9LRVJORUwpOwogCWlmICghcHJpdikgewpA
QCAtMTYyMiw5ICsxNjIyLDYgQEAgcGNpc2VyaWFsX2luaXRfcG9ydHMoc3Ry
dWN0IHBjaV9kZXYgKmRldgogCQlnb3RvIGVycl9kZWluaXQ7CiAJfQogCi0J
bWVtc2V0KHByaXYsIDAsIHNpemVvZihzdHJ1Y3Qgc2VyaWFsX3ByaXZhdGUp
ICsKLQkJCXNpemVvZih1bnNpZ25lZCBpbnQpICogbnJfcG9ydHMpOwotCiAJ
cHJpdi0+ZGV2ID0gZGV2OwogCXByaXYtPnF1aXJrID0gcXVpcms7CiAKZGlm
ZiAtcnVicCBsaW51eC0yLjYuMTktcmM1X29yaWcvZHJpdmVycy9zZXJpYWwv
aWNvbS5jIGxpbnV4LTIuNi4xOS1yYzVfa3phbGxvYy9kcml2ZXJzL3Nlcmlh
bC9pY29tLmMKLS0tIGxpbnV4LTIuNi4xOS1yYzVfb3JpZy9kcml2ZXJzL3Nl
cmlhbC9pY29tLmMJMjAwNi0xMS0wOSAxMjoxNjoyMS4wMDAwMDAwMDAgKzAy
MDAKKysrIGxpbnV4LTIuNi4xOS1yYzVfa3phbGxvYy9kcml2ZXJzL3Nlcmlh
bC9pY29tLmMJMjAwNi0xMS0xMSAyMjo0NDowNC4wMDAwMDAwMDAgKzAyMDAK
QEAgLTE0MTcsMTQgKzE0MTcsMTIgQEAgc3RhdGljIGludCBfX2RldmluaXQg
aWNvbV9hbGxvY19hZGFwdGVyKAogCXN0cnVjdCBsaXN0X2hlYWQgKnRtcDsK
IAogCWljb21fYWRhcHRlciA9IChzdHJ1Y3QgaWNvbV9hZGFwdGVyICopCi0J
ICAgIGttYWxsb2Moc2l6ZW9mKHN0cnVjdCBpY29tX2FkYXB0ZXIpLCBHRlBf
S0VSTkVMKTsKKwkgICAga3phbGxvYyhzaXplb2Yoc3RydWN0IGljb21fYWRh
cHRlciksIEdGUF9LRVJORUwpOwogCiAJaWYgKCFpY29tX2FkYXB0ZXIpIHsK
IAkJcmV0dXJuIC1FTk9NRU07CiAJfQogCi0JbWVtc2V0KGljb21fYWRhcHRl
ciwgMCwgc2l6ZW9mKHN0cnVjdCBpY29tX2FkYXB0ZXIpKTsKLQogCWxpc3Rf
Zm9yX2VhY2godG1wLCAmaWNvbV9hZGFwdGVyX2hlYWQpIHsKIAkJY3VyX2Fk
YXB0ZXJfZW50cnkgPQogCQkgICAgbGlzdF9lbnRyeSh0bXAsIHN0cnVjdCBp
Y29tX2FkYXB0ZXIsCmRpZmYgLXJ1YnAgbGludXgtMi42LjE5LXJjNV9vcmln
L2RyaXZlcnMvc2VyaWFsL2lvYzNfc2VyaWFsLmMgbGludXgtMi42LjE5LXJj
NV9remFsbG9jL2RyaXZlcnMvc2VyaWFsL2lvYzNfc2VyaWFsLmMKLS0tIGxp
bnV4LTIuNi4xOS1yYzVfb3JpZy9kcml2ZXJzL3NlcmlhbC9pb2MzX3Nlcmlh
bC5jCTIwMDYtMTEtMDkgMTI6MTY6MjEuMDAwMDAwMDAwICswMjAwCisrKyBs
aW51eC0yLjYuMTktcmM1X2t6YWxsb2MvZHJpdmVycy9zZXJpYWwvaW9jM19z
ZXJpYWwuYwkyMDA2LTExLTExIDIyOjQ0OjA0LjAwMDAwMDAwMCArMDIwMApA
QCAtMjAxOSwxMyArMjAxOSwxMiBAQCBpb2MzdWFydF9wcm9iZShzdHJ1Y3Qg
aW9jM19zdWJtb2R1bGUgKmlzCiAKIAlEUFJJTlRfQ09ORklHKCgiJXMgKDB4
JXAsIDB4JXApXG4iLCBfX0ZVTkNUSU9OX18sIGlzLCBpZGQpKTsKIAotCWNh
cmRfcHRyID0ga21hbGxvYyhzaXplb2Yoc3RydWN0IGlvYzNfY2FyZCksIEdG
UF9LRVJORUwpOworCWNhcmRfcHRyID0ga3phbGxvYyhzaXplb2Yoc3RydWN0
IGlvYzNfY2FyZCksIEdGUF9LRVJORUwpOwogCWlmICghY2FyZF9wdHIpIHsK
IAkJcHJpbnRrKEtFUk5fV0FSTklORyAiaW9jM19hdHRhY2hfb25lIgogCQkg
ICAgICAgIjogdW5hYmxlIHRvIGdldCBtZW1vcnkgZm9yIHRoZSBJT0MzXG4i
KTsKIAkJcmV0dXJuIC1FTk9NRU07CiAJfQotCW1lbXNldChjYXJkX3B0ciwg
MCwgc2l6ZW9mKHN0cnVjdCBpb2MzX2NhcmQpKTsKIAlpZGQtPmRhdGFbaXMt
PmlkXSA9IGNhcmRfcHRyOwogCVN1Ym1vZHVsZV9zbG90ID0gaXMtPmlkOwog
CkBAIC0yMDQwLDEzICsyMDM5LDEyIEBAIGlvYzN1YXJ0X3Byb2JlKHN0cnVj
dCBpb2MzX3N1Ym1vZHVsZSAqaXMKIAogCS8qIENyZWF0ZSBwb3J0IHN0cnVj
dHVyZXMgZm9yIGVhY2ggcG9ydCAqLwogCWZvciAocGh5c19wb3J0ID0gMDsg
cGh5c19wb3J0IDwgUE9SVFNfUEVSX0NBUkQ7IHBoeXNfcG9ydCsrKSB7Ci0J
CXBvcnQgPSBrbWFsbG9jKHNpemVvZihzdHJ1Y3QgaW9jM19wb3J0KSwgR0ZQ
X0tFUk5FTCk7CisJCXBvcnQgPSBremFsbG9jKHNpemVvZihzdHJ1Y3QgaW9j
M19wb3J0KSwgR0ZQX0tFUk5FTCk7CiAJCWlmICghcG9ydCkgewogCQkJcHJp
bnRrKEtFUk5fV0FSTklORwogCQkJICAgICAgICJJT0MzIHNlcmlhbCBtZW1v
cnkgbm90IGF2YWlsYWJsZSBmb3IgcG9ydFxuIik7CiAJCQlnb3RvIG91dDQ7
CiAJCX0KLQkJbWVtc2V0KHBvcnQsIDAsIHNpemVvZihzdHJ1Y3QgaW9jM19w
b3J0KSk7CiAJCXNwaW5fbG9ja19pbml0KCZwb3J0LT5pcF9sb2NrKTsKIAog
CQkvKiB3ZSBuZWVkIHRvIHJlbWVtYmVyIHRoZSBwcmV2aW91cyBvbmVzLCB0
byBwb2ludCBiYWNrIHRvCmRpZmYgLXJ1YnAgbGludXgtMi42LjE5LXJjNV9v
cmlnL2RyaXZlcnMvc2VyaWFsL2lvYzRfc2VyaWFsLmMgbGludXgtMi42LjE5
LXJjNV9remFsbG9jL2RyaXZlcnMvc2VyaWFsL2lvYzRfc2VyaWFsLmMKLS0t
IGxpbnV4LTIuNi4xOS1yYzVfb3JpZy9kcml2ZXJzL3NlcmlhbC9pb2M0X3Nl
cmlhbC5jCTIwMDYtMTEtMDkgMTI6MTY6MjEuMDAwMDAwMDAwICswMjAwCisr
KyBsaW51eC0yLjYuMTktcmM1X2t6YWxsb2MvZHJpdmVycy9zZXJpYWwvaW9j
NF9zZXJpYWwuYwkyMDA2LTExLTExIDIyOjQ0OjA0LjAwMDAwMDAwMCArMDIw
MApAQCAtMTA3NiwxMyArMTA3NiwxMiBAQCBzdGF0aWMgaW50IGlubGluZSBp
b2M0X2F0dGFjaF9sb2NhbChzdHJ1CiAJLyogQ3JlYXRlIHBvcnQgc3RydWN0
dXJlcyBmb3IgZWFjaCBwb3J0ICovCiAJZm9yIChwb3J0X251bWJlciA9IDA7
IHBvcnRfbnVtYmVyIDwgSU9DNF9OVU1fU0VSSUFMX1BPUlRTOwogCQkJCQkJ
CXBvcnRfbnVtYmVyKyspIHsKLQkJcG9ydCA9IGttYWxsb2Moc2l6ZW9mKHN0
cnVjdCBpb2M0X3BvcnQpLCBHRlBfS0VSTkVMKTsKKwkJcG9ydCA9IGt6YWxs
b2Moc2l6ZW9mKHN0cnVjdCBpb2M0X3BvcnQpLCBHRlBfS0VSTkVMKTsKIAkJ
aWYgKCFwb3J0KSB7CiAJCQlwcmludGsoS0VSTl9XQVJOSU5HCiAJCQkJIklP
QzQgc2VyaWFsIG1lbW9yeSBub3QgYXZhaWxhYmxlIGZvciBwb3J0XG4iKTsK
IAkJCXJldHVybiAtRU5PTUVNOwogCQl9Ci0JCW1lbXNldChwb3J0LCAwLCBz
aXplb2Yoc3RydWN0IGlvYzRfcG9ydCkpOwogCQlzcGluX2xvY2tfaW5pdCgm
cG9ydC0+aXBfbG9jayk7CiAKIAkJLyogd2UgbmVlZCB0byByZW1lbWJlciB0
aGUgcHJldmlvdXMgb25lcywgdG8gcG9pbnQgYmFjayB0bwpAQCAtMjgxMSw3
ICsyODEwLDcgQEAgaW9jNF9zZXJpYWxfYXR0YWNoX29uZShzdHJ1Y3QgaW9j
NF9kcml2ZQogCQkJCSh2b2lkICopc2VyaWFsKSk7CiAKIAkvKiBHZXQgbWVt
b3J5IGZvciB0aGUgbmV3IGNhcmQgKi8KLQljb250cm9sID0ga21hbGxvYyhz
aXplb2Yoc3RydWN0IGlvYzRfY29udHJvbCksIEdGUF9LRVJORUwpOworCWNv
bnRyb2wgPSBremFsbG9jKHNpemVvZihzdHJ1Y3QgaW9jNF9jb250cm9sKSwg
R0ZQX0tFUk5FTCk7CiAKIAlpZiAoIWNvbnRyb2wpIHsKIAkJcHJpbnRrKEtF
Uk5fV0FSTklORyAiaW9jNF9hdHRhY2hfb25lIgpAQCAtMjgxOSwxMSArMjgx
OCwxMCBAQCBpb2M0X3NlcmlhbF9hdHRhY2hfb25lKHN0cnVjdCBpb2M0X2Ry
aXZlCiAJCXJldCA9IC1FTk9NRU07CiAJCWdvdG8gb3V0MjsKIAl9Ci0JbWVt
c2V0KGNvbnRyb2wsIDAsIHNpemVvZihzdHJ1Y3QgaW9jNF9jb250cm9sKSk7
CiAJaWRkLT5pZGRfc2VyaWFsX2RhdGEgPSBjb250cm9sOwogCiAJLyogQWxs
b2NhdGUgdGhlIHNvZnQgc3RydWN0dXJlICovCi0Jc29mdCA9IGttYWxsb2Mo
c2l6ZW9mKHN0cnVjdCBpb2M0X3NvZnQpLCBHRlBfS0VSTkVMKTsKKwlzb2Z0
ID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IGlvYzRfc29mdCksIEdGUF9LRVJO
RUwpOwogCWlmICghc29mdCkgewogCQlwcmludGsoS0VSTl9XQVJOSU5HCiAJ
CSAgICAgICAiaW9jNCAoJXApOiB1bmFibGUgdG8gZ2V0IG1lbW9yeSBmb3Ig
dGhlIHNvZnQgc3RydWN0XG4iLApAQCAtMjgzMSw3ICsyODI5LDYgQEAgaW9j
NF9zZXJpYWxfYXR0YWNoX29uZShzdHJ1Y3QgaW9jNF9kcml2ZQogCQlyZXQg
PSAtRU5PTUVNOwogCQlnb3RvIG91dDM7CiAJfQotCW1lbXNldChzb2Z0LCAw
LCBzaXplb2Yoc3RydWN0IGlvYzRfc29mdCkpOwogCiAJc3Bpbl9sb2NrX2lu
aXQoJnNvZnQtPmlzX2lyX2xvY2spOwogCXNvZnQtPmlzX2lvYzRfbWlzY19h
ZGRyID0gaWRkLT5pZGRfbWlzY19yZWdzOwpkaWZmIC1ydWJwIGxpbnV4LTIu
Ni4xOS1yYzVfb3JpZy9kcml2ZXJzL3NlcmlhbC9pcDIyemlsb2cuYyBsaW51
eC0yLjYuMTktcmM1X2t6YWxsb2MvZHJpdmVycy9zZXJpYWwvaXAyMnppbG9n
LmMKLS0tIGxpbnV4LTIuNi4xOS1yYzVfb3JpZy9kcml2ZXJzL3NlcmlhbC9p
cDIyemlsb2cuYwkyMDA2LTExLTA5IDEyOjE2OjIxLjAwMDAwMDAwMCArMDIw
MAorKysgbGludXgtMi42LjE5LXJjNV9remFsbG9jL2RyaXZlcnMvc2VyaWFs
L2lwMjJ6aWxvZy5jCTIwMDYtMTEtMTEgMjI6NDQ6MDQuMDAwMDAwMDAwICsw
MjAwCkBAIC05MjIsMTMgKzkyMiw3IEBAIHN0YXRpYyBpbnQgemlsb2dfaXJx
ID0gLTE7CiAKIHN0YXRpYyB2b2lkICogX19pbml0IGFsbG9jX29uZV90YWJs
ZSh1bnNpZ25lZCBsb25nIHNpemUpCiB7Ci0Jdm9pZCAqcmV0OwotCi0JcmV0
ID0ga21hbGxvYyhzaXplLCBHRlBfS0VSTkVMKTsKLQlpZiAocmV0ICE9IE5V
TEwpCi0JCW1lbXNldChyZXQsIDAsIHNpemUpOwotCi0JcmV0dXJuIHJldDsK
KwlyZXR1cm4ga3phbGxvYyhzaXplLCBHRlBfS0VSTkVMKTsKIH0KIAogc3Rh
dGljIHZvaWQgX19pbml0IGlwMjJ6aWxvZ19hbGxvY190YWJsZXModm9pZCkK
ZGlmZiAtcnVicCBsaW51eC0yLjYuMTktcmM1X29yaWcvZHJpdmVycy9zZXJp
YWwvanNtL2pzbV9kcml2ZXIuYyBsaW51eC0yLjYuMTktcmM1X2t6YWxsb2Mv
ZHJpdmVycy9zZXJpYWwvanNtL2pzbV9kcml2ZXIuYwotLS0gbGludXgtMi42
LjE5LXJjNV9vcmlnL2RyaXZlcnMvc2VyaWFsL2pzbS9qc21fZHJpdmVyLmMJ
MjAwNi0xMS0wOSAxMjoxNjoyMS4wMDAwMDAwMDAgKzAyMDAKKysrIGxpbnV4
LTIuNi4xOS1yYzVfa3phbGxvYy9kcml2ZXJzL3NlcmlhbC9qc20vanNtX2Ry
aXZlci5jCTIwMDYtMTEtMTEgMjI6NDQ6MDQuMDAwMDAwMDAwICswMjAwCkBA
IC03MSwxNCArNzEsMTMgQEAgc3RhdGljIGludCBqc21fcHJvYmVfb25lKHN0
cnVjdCBwY2lfZGV2IAogCQlnb3RvIG91dF9kaXNhYmxlX2RldmljZTsKIAl9
CiAKLQlicmQgPSBrbWFsbG9jKHNpemVvZihzdHJ1Y3QganNtX2JvYXJkKSwg
R0ZQX0tFUk5FTCk7CisJYnJkID0ga3phbGxvYyhzaXplb2Yoc3RydWN0IGpz
bV9ib2FyZCksIEdGUF9LRVJORUwpOwogCWlmICghYnJkKSB7CiAJCWRldl9l
cnIoJnBkZXYtPmRldiwKIAkJCSJtZW1vcnkgYWxsb2NhdGlvbiBmb3IgYm9h
cmQgc3RydWN0dXJlIGZhaWxlZFxuIik7CiAJCXJjID0gLUVOT01FTTsKIAkJ
Z290byBvdXRfcmVsZWFzZV9yZWdpb25zOwogCX0KLQltZW1zZXQoYnJkLCAw
LCBzaXplb2Yoc3RydWN0IGpzbV9ib2FyZCkpOwogCiAJLyogc3RvcmUgdGhl
IGluZm8gZm9yIHRoZSBib2FyZCB3ZSd2ZSBmb3VuZCAqLwogCWJyZC0+Ym9h
cmRudW0gPSBhZGFwdGVyX2NvdW50Kys7CkBAIC0xNTIsNyArMTUxLDcgQEAg
c3RhdGljIGludCBqc21fcHJvYmVfb25lKHN0cnVjdCBwY2lfZGV2IAogCSAq
IE9rYXkgdG8gbWFsbG9jIHdpdGggR0ZQX0tFUk5FTCwgd2UgYXJlIG5vdCBh
dCBpbnRlcnJ1cHQKIAkgKiBjb250ZXh0LCBhbmQgdGhlcmUgYXJlIG5vIGxv
Y2tzIGhlbGQuCiAJICovCi0JYnJkLT5mbGlwYnVmID0ga21hbGxvYyhNWUZM
SVBMRU4sIEdGUF9LRVJORUwpOworCWJyZC0+ZmxpcGJ1ZiA9IGt6YWxsb2Mo
TVlGTElQTEVOLCBHRlBfS0VSTkVMKTsKIAlpZiAoIWJyZC0+ZmxpcGJ1Zikg
ewogCQkvKiBYWFg6IGxlYWtpbmcgYWxsIHJlc291cmNlcyBmcm9tIGpzbV90
dHlfaW5pdCBhbmQKIAkJIAlqc21fdWFydF9wb3J0X2luaXQgaGVyZSEgKi8K
QEAgLTE2MCw3ICsxNTksNiBAQCBzdGF0aWMgaW50IGpzbV9wcm9iZV9vbmUo
c3RydWN0IHBjaV9kZXYgCiAJCXJldHZhbCA9IC1FTk9NRU07CiAJCWdvdG8g
b3V0X2ZyZWVfaXJxOwogCX0KLQltZW1zZXQoYnJkLT5mbGlwYnVmLCAwLCBN
WUZMSVBMRU4pOwogCiAJcGNpX3NldF9kcnZkYXRhKHBkZXYsIGJyZCk7CiAK
ZGlmZiAtcnVicCBsaW51eC0yLjYuMTktcmM1X29yaWcvZHJpdmVycy9zZXJp
YWwvanNtL2pzbV90dHkuYyBsaW51eC0yLjYuMTktcmM1X2t6YWxsb2MvZHJp
dmVycy9zZXJpYWwvanNtL2pzbV90dHkuYwotLS0gbGludXgtMi42LjE5LXJj
NV9vcmlnL2RyaXZlcnMvc2VyaWFsL2pzbS9qc21fdHR5LmMJMjAwNi0xMS0w
OSAxMjoxNjoyMS4wMDAwMDAwMDAgKzAyMDAKKysrIGxpbnV4LTIuNi4xOS1y
YzVfa3phbGxvYy9kcml2ZXJzL3NlcmlhbC9qc20vanNtX3R0eS5jCTIwMDYt
MTEtMTEgMjI6NDQ6MDQuMDAwMDAwMDAwICswMjAwCkBAIC0xOTQsMzEgKzE5
NCwyOCBAQCBzdGF0aWMgaW50IGpzbV90dHlfb3BlbihzdHJ1Y3QgdWFydF9w
b3J0CiAJLyogRHJvcCBsb2NrcywgYXMgbWFsbG9jIHdpdGggR0ZQX0tFUk5F
TCBjYW4gc2xlZXAgKi8KIAogCWlmICghY2hhbm5lbC0+Y2hfcnF1ZXVlKSB7
Ci0JCWNoYW5uZWwtPmNoX3JxdWV1ZSA9ICh1OCAqKSBrbWFsbG9jKFJRVUVV
RVNJWkUsIEdGUF9LRVJORUwpOworCQljaGFubmVsLT5jaF9ycXVldWUgPSBr
emFsbG9jKFJRVUVVRVNJWkUsIEdGUF9LRVJORUwpOwogCQlpZiAoIWNoYW5u
ZWwtPmNoX3JxdWV1ZSkgewogCQkJanNtX3ByaW50ayhJTklULCBFUlIsICZj
aGFubmVsLT5jaF9iZC0+cGNpX2RldiwKIAkJCQkidW5hYmxlIHRvIGFsbG9j
YXRlIHJlYWQgcXVldWUgYnVmIik7CiAJCQlyZXR1cm4gLUVOT01FTTsKIAkJ
fQotCQltZW1zZXQoY2hhbm5lbC0+Y2hfcnF1ZXVlLCAwLCBSUVVFVUVTSVpF
KTsKIAl9CiAJaWYgKCFjaGFubmVsLT5jaF9lcXVldWUpIHsKLQkJY2hhbm5l
bC0+Y2hfZXF1ZXVlID0gKHU4ICopIGttYWxsb2MoRVFVRVVFU0laRSwgR0ZQ
X0tFUk5FTCk7CisJCWNoYW5uZWwtPmNoX2VxdWV1ZSA9IGt6YWxsb2MoRVFV
RVVFU0laRSwgR0ZQX0tFUk5FTCk7CiAJCWlmICghY2hhbm5lbC0+Y2hfZXF1
ZXVlKSB7CiAJCQlqc21fcHJpbnRrKElOSVQsIEVSUiwgJmNoYW5uZWwtPmNo
X2JkLT5wY2lfZGV2LAogCQkJCSJ1bmFibGUgdG8gYWxsb2NhdGUgZXJyb3Ig
cXVldWUgYnVmIik7CiAJCQlyZXR1cm4gLUVOT01FTTsKIAkJfQotCQltZW1z
ZXQoY2hhbm5lbC0+Y2hfZXF1ZXVlLCAwLCBFUVVFVUVTSVpFKTsKIAl9CiAJ
aWYgKCFjaGFubmVsLT5jaF93cXVldWUpIHsKLQkJY2hhbm5lbC0+Y2hfd3F1
ZXVlID0gKHU4ICopIGttYWxsb2MoV1FVRVVFU0laRSwgR0ZQX0tFUk5FTCk7
CisJCWNoYW5uZWwtPmNoX3dxdWV1ZSA9IGt6YWxsb2MoV1FVRVVFU0laRSwg
R0ZQX0tFUk5FTCk7CiAJCWlmICghY2hhbm5lbC0+Y2hfd3F1ZXVlKSB7CiAJ
CQlqc21fcHJpbnRrKElOSVQsIEVSUiwgJmNoYW5uZWwtPmNoX2JkLT5wY2lf
ZGV2LAogCQkJCSJ1bmFibGUgdG8gYWxsb2NhdGUgd3JpdGUgcXVldWUgYnVm
Iik7CiAJCQlyZXR1cm4gLUVOT01FTTsKIAkJfQotCQltZW1zZXQoY2hhbm5l
bC0+Y2hfd3F1ZXVlLCAwLCBXUVVFVUVTSVpFKTsKIAl9CiAKIAljaGFubmVs
LT5jaF9mbGFncyAmPSB+KENIX09QRU5JTkcpOwpAQCAtMzkyLDEzICszODks
MTIgQEAgaW50IGpzbV90dHlfaW5pdChzdHJ1Y3QganNtX2JvYXJkICpicmQp
CiAJCQkgKiBPa2F5IHRvIG1hbGxvYyB3aXRoIEdGUF9LRVJORUwsIHdlIGFy
ZSBub3QgYXQKIAkJCSAqIGludGVycnVwdCBjb250ZXh0LCBhbmQgdGhlcmUg
YXJlIG5vIGxvY2tzIGhlbGQuCiAJCQkgKi8KLQkJCWJyZC0+Y2hhbm5lbHNb
aV0gPSBrbWFsbG9jKHNpemVvZihzdHJ1Y3QganNtX2NoYW5uZWwpLCBHRlBf
S0VSTkVMKTsKKwkJCWJyZC0+Y2hhbm5lbHNbaV0gPSBremFsbG9jKHNpemVv
ZihzdHJ1Y3QganNtX2NoYW5uZWwpLCBHRlBfS0VSTkVMKTsKIAkJCWlmICgh
YnJkLT5jaGFubmVsc1tpXSkgewogCQkJCWpzbV9wcmludGsoQ09SRSwgRVJS
LCAmYnJkLT5wY2lfZGV2LAogCQkJCQkiJXM6JWQgVW5hYmxlIHRvIGFsbG9j
YXRlIG1lbW9yeSBmb3IgY2hhbm5lbCBzdHJ1Y3RcbiIsCiAJCQkJCQkJIF9f
RklMRV9fLCBfX0xJTkVfXyk7CiAJCQl9Ci0JCQltZW1zZXQoYnJkLT5jaGFu
bmVsc1tpXSwgMCwgc2l6ZW9mKHN0cnVjdCBqc21fY2hhbm5lbCkpOwogCQl9
CiAJfQogCmRpZmYgLXJ1YnAgbGludXgtMi42LjE5LXJjNV9vcmlnL2RyaXZl
cnMvc2VyaWFsL3NlcmlhbF9jb3JlLmMgbGludXgtMi42LjE5LXJjNV9remFs
bG9jL2RyaXZlcnMvc2VyaWFsL3NlcmlhbF9jb3JlLmMKLS0tIGxpbnV4LTIu
Ni4xOS1yYzVfb3JpZy9kcml2ZXJzL3NlcmlhbC9zZXJpYWxfY29yZS5jCTIw
MDYtMTEtMDkgMTI6MTY6MjEuMDAwMDAwMDAwICswMjAwCisrKyBsaW51eC0y
LjYuMTktcmM1X2t6YWxsb2MvZHJpdmVycy9zZXJpYWwvc2VyaWFsX2NvcmUu
YwkyMDA2LTExLTExIDIyOjQ0OjA0LjAwMDAwMDAwMCArMDIwMApAQCAtMTUy
Myw5ICsxNTIzLDggQEAgc3RhdGljIHN0cnVjdCB1YXJ0X3N0YXRlICp1YXJ0
X2dldChzdHJ1YwogCX0KIAogCWlmICghc3RhdGUtPmluZm8pIHsKLQkJc3Rh
dGUtPmluZm8gPSBrbWFsbG9jKHNpemVvZihzdHJ1Y3QgdWFydF9pbmZvKSwg
R0ZQX0tFUk5FTCk7CisJCXN0YXRlLT5pbmZvID0ga3phbGxvYyhzaXplb2Yo
c3RydWN0IHVhcnRfaW5mbyksIEdGUF9LRVJORUwpOwogCQlpZiAoc3RhdGUt
PmluZm8pIHsKLQkJCW1lbXNldChzdGF0ZS0+aW5mbywgMCwgc2l6ZW9mKHN0
cnVjdCB1YXJ0X2luZm8pKTsKIAkJCWluaXRfd2FpdHF1ZXVlX2hlYWQoJnN0
YXRlLT5pbmZvLT5vcGVuX3dhaXQpOwogCQkJaW5pdF93YWl0cXVldWVfaGVh
ZCgmc3RhdGUtPmluZm8tPmRlbHRhX21zcl93YWl0KTsKIApAQCAtMjE2Nywx
MyArMjE2NiwxMSBAQCBpbnQgdWFydF9yZWdpc3Rlcl9kcml2ZXIoc3RydWN0
IHVhcnRfZHJpCiAJICogTWF5YmUgd2Ugc2hvdWxkIGJlIHVzaW5nIGEgc2xh
YiBjYWNoZSBmb3IgdGhpcywgZXNwZWNpYWxseSBpZgogCSAqIHdlIGhhdmUg
YSBsYXJnZSBudW1iZXIgb2YgcG9ydHMgdG8gaGFuZGxlLgogCSAqLwotCWRy
di0+c3RhdGUgPSBrbWFsbG9jKHNpemVvZihzdHJ1Y3QgdWFydF9zdGF0ZSkg
KiBkcnYtPm5yLCBHRlBfS0VSTkVMKTsKKwlkcnYtPnN0YXRlID0ga3phbGxv
YyhzaXplb2Yoc3RydWN0IHVhcnRfc3RhdGUpICogZHJ2LT5uciwgR0ZQX0tF
Uk5FTCk7CiAJcmV0dmFsID0gLUVOT01FTTsKIAlpZiAoIWRydi0+c3RhdGUp
CiAJCWdvdG8gb3V0OwogCi0JbWVtc2V0KGRydi0+c3RhdGUsIDAsIHNpemVv
ZihzdHJ1Y3QgdWFydF9zdGF0ZSkgKiBkcnYtPm5yKTsKLQogCW5vcm1hbCAg
PSBhbGxvY190dHlfZHJpdmVyKGRydi0+bnIpOwogCWlmICghbm9ybWFsKQog
CQlnb3RvIG91dDsKZGlmZiAtcnVicCBsaW51eC0yLjYuMTktcmM1X29yaWcv
ZHJpdmVycy9zZXJpYWwvc2VyaWFsX2NzLmMgbGludXgtMi42LjE5LXJjNV9r
emFsbG9jL2RyaXZlcnMvc2VyaWFsL3NlcmlhbF9jcy5jCi0tLSBsaW51eC0y
LjYuMTktcmM1X29yaWcvZHJpdmVycy9zZXJpYWwvc2VyaWFsX2NzLmMJMjAw
Ni0xMS0wOSAxMjoxNjoyMS4wMDAwMDAwMDAgKzAyMDAKKysrIGxpbnV4LTIu
Ni4xOS1yYzVfa3phbGxvYy9kcml2ZXJzL3NlcmlhbC9zZXJpYWxfY3MuYwky
MDA2LTExLTExIDIyOjQ0OjA0LjAwMDAwMDAwMCArMDIwMApAQCAtMzM0LDEw
ICszMzQsOSBAQCBzdGF0aWMgaW50IHNlcmlhbF9wcm9iZShzdHJ1Y3QgcGNt
Y2lhX2RlCiAJREVCVUcoMCwgInNlcmlhbF9hdHRhY2goKVxuIik7CiAKIAkv
KiBDcmVhdGUgbmV3IHNlcmlhbCBkZXZpY2UgKi8KLQlpbmZvID0ga21hbGxv
YyhzaXplb2YgKCppbmZvKSwgR0ZQX0tFUk5FTCk7CisJaW5mbyA9IGt6YWxs
b2Moc2l6ZW9mICgqaW5mbyksIEdGUF9LRVJORUwpOwogCWlmICghaW5mbykK
IAkJcmV0dXJuIC1FTk9NRU07Ci0JbWVtc2V0KGluZm8sIDAsIHNpemVvZiAo
KmluZm8pKTsKIAlpbmZvLT5wX2RldiA9IGxpbms7CiAJbGluay0+cHJpdiA9
IGluZm87CiAK


------=_NextPart_000_3a44_42ad_4cce--
