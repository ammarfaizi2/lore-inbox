Return-Path: <linux-kernel-owner+willy=40w.ods.org-S1750813AbWIFNaA@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1750813AbWIFNaA (ORCPT <rfc822;willy@w.ods.org>);
	Wed, 6 Sep 2006 09:30:00 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1750822AbWIFN37
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Wed, 6 Sep 2006 09:29:59 -0400
Received: from cantor2.suse.de ([195.135.220.15]:48350 "EHLO mx2.suse.de")
	by vger.kernel.org with ESMTP id S1750813AbWIFN36 (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Wed, 6 Sep 2006 09:29:58 -0400
Date: Wed, 06 Sep 2006 15:29:54 +0200
Message-ID: <s5h4pvlnmwd.wl%tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: "Filip Sneppe" <filip.sneppe@gmail.com>
Cc: linux-kernel@vger.kernel.org
Subject: Re: 2.6.18-rc6 (audio-related ?) oops during boot
In-Reply-To: <9151ac2a0609051710m7f5d30e3gdcfced3676d43869@mail.gmail.com>
References: <9151ac2a0609050313h22d3c34fy2fc46124ba6876cc@mail.gmail.com>
	<s5hwt8iijt0.wl%tiwai@suse.de>
	<9151ac2a0609051710m7f5d30e3gdcfced3676d43869@mail.gmail.com>
User-Agent: Wanderlust/2.12.0 (Your Wildest Dreams) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.7 (=?ISO-8859-4?Q?Sanj=F2?=) APEL/10.6 MULE XEmacs/21.5 (beta25)
 (eggplant) (+CVS-20060326) (i386-suse-linux)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

At Wed, 6 Sep 2006 02:10:10 +0200,
Filip Sneppe wrote:
> 
> Hi,
> 
> On 9/5/06, Takashi Iwai <tiwai@suse.de> wrote:
> > At Tue, 5 Sep 2006 12:13:24 +0200,
> > Filip Sneppe wrote:
> > >
> > > Hi,
> > >
> > > I tried out 2.6.18-rc6 today and got this during the boot on my
> > > Debian testing machine:
> > >
> > > pnp: Device 00:04 disabled.
> > > cs: IO port probe 0x100-0x4ff: clean.
> > > cs: IO port probe 0x800-0x8ff: clean.
> > > cs: IO port probe 0xc00-0xcff: clean.
> > > cs: IO port probe 0xa00-0xaff: clean.
> > > Adding 730948k swap on /dev/hda2.  Priority:-1 extents:1 across:730948k
> > > EXT3 FS on hda5, internal journal
> > > kobject_add failed for audio with -EEXIST, don't try to register
> > > things with the same name in the same directory.
> > >  [<b01aa41c>] kobject_add+0x13c/0x163
> > >  [<b0205b01>] class_device_add+0x9f/0x3c1
> > >  [<b01aa19c>] kobject_get+0x12/0x17
> > >  [<b01aa49d>] kobject_init+0x32/0x43
> > >  [<b0205eaf>] class_device_create+0x76/0x98
> > >  [<f091c195>] sound_insert_unit+0xea/0x113 [soundcore]
> > >  [<f091c387>] register_sound_special_device+0x125/0x12d [soundcore]
> > >  [<b01ace3c>] vsnprintf+0x413/0x452
> > >  [<f0944d65>] snd_register_oss_device+0x111/0x16c [snd]
> > >  [<f0ae74e4>] register_oss_dsp+0x31/0x53 [snd_pcm_oss]
> > >  [<b0112318>] __activate_task+0x1c/0x28
> > >  [<b01a9fa6>] idr_get_new+0xf/0x30
> > >  [<b0177791>] proc_register+0x31/0xd6
> > >  [<b0177b93>] create_proc_entry+0x86/0x98
> > >  [<f094278e>] snd_create_proc_entry+0xb/0x1a [snd]
> > >  [<f094281e>] snd_info_register+0x81/0x86 [snd]
> > >  [<f0ae912c>] snd_pcm_oss_register_minor+0x31/0x122 [snd_pcm_oss]
> > >  [<b0161667>] alloc_inode+0xf5/0x182
> > >  [<b0161e21>] new_inode+0x16/0x6f
> > >  [<b0160440>] d_instantiate+0x3a/0x70
> > >  [<b017fb6e>] sysfs_new_dirent+0x1a/0x62
> > >  [<b017fc64>] sysfs_make_dirent+0x19/0x6e
> > >  [<b017f610>] sysfs_add_file+0x48/0x63
> > >  [<b0139e0b>] free_hot_cold_page+0x8d/0xd8
> > >  [<f0963fa8>] snd_pcm_notify+0x7a/0x9a [snd_pcm]
> > >  [<f0889061>] alsa_pcm_oss_init+0x61/0x6e [snd_pcm_oss]
> > >  [<b012b225>] sys_init_module+0x13aa/0x1506
> > >  [<b0102a09>] sysenter_past_esp+0x56/0x79
> > > device-mapper: ioctl: 4.7.0-ioctl (2006-06-24) initialised: dm-devel@redhat.com
> > > kjournald starting.  Commit interval 5 seconds
> > > EXT3 FS on hda1, internal journal
> > > EXT3-fs: mounted filesystem with ordered data mode.
> > > kjournald starting.  Commit interval 5 seconds
> > > EXT3 FS on hda8, internal journal
> > > EXT3-fs: mounted filesystem with ordered data mode.
> > > kjournald starting.  Commit interval 5 seconds
> > > EXT3 FS on hda6, internal journal
> >
> > Did you load any other OSS modules in prior?
> >
> >
> 
> This happened during the boot, so I don't know exactly what was already loaded.
> The only modules that I know for sure are loaded at boot, are:
> 
> ide-cd
> ide-disk
> ide-generic
> psmouse
> sound
> snd-mixer-oss
> snd-pcm-oss

Hm it looks OK.  So, you loaded snd-mixer-oss and snd-pcm-oss before
any other ALSA drivers, right?  Then it's weird.
The only caller of snd_pcm_oss_register_minor() is
snd_pcm_dev_reigster(), and it's never called unless you initialize a
sound card.

Could you check what entries exist in /sys/class/sound?

Also, what is the reason to load snd-mixer-oss and snd-pcm-oss at this
point at all?


Takashi
