Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S262159AbSJJTt0>; Thu, 10 Oct 2002 15:49:26 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S262182AbSJJTs7>; Thu, 10 Oct 2002 15:48:59 -0400
Received: from pasmtp.tele.dk ([193.162.159.95]:28945 "EHLO pasmtp.tele.dk")
	by vger.kernel.org with ESMTP id <S262159AbSJJTss>;
	Thu, 10 Oct 2002 15:48:48 -0400
Date: Thu, 10 Oct 2002 21:53:59 +0200
From: Sam Ravnborg <sam@ravnborg.org>
To: linux-kernel@vger.kernel.org
Subject: kbuild: Distributed clean, misc.
Message-ID: <20021010215359.E577@mars.ravnborg.org>
Mail-Followup-To: linux-kernel@vger.kernel.org
References: <20021010213440.A508@mars.ravnborg.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5.1i
In-Reply-To: <20021010213440.A508@mars.ravnborg.org>; from sam@ravnborg.org on Thu, Oct 10, 2002 at 09:34:40PM +0200
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

# This is a BitKeeper generated patch for the following project:
# Project Name: Linux kernel tree
# This patch format is intended for GNU patch command version 2.5 or higher.
# This patch includes the following deltas:
#	           ChangeSet	1.748.1.4 -> 1.748.1.5
#	            Makefile	1.322   -> 1.323  
#	  sound/oss/Makefile	1.16    -> 1.17   
#	       init/Makefile	1.10    -> 1.11   
#
# The following is the BitKeeper ChangeSet Log
# --------------------------------------------
# 02/10/10	sam@mars.ravnborg.org	1.748.1.5
# kbuild: Distributed clean, misc.
# o Move sound/oss file list to sound/oss/Makefile
# o Remove files non-existing in the tree (khttp,net/802/submenu)
# o scripts/* are handled by scripts makefile
# o Do not delete .config*, be more explicit
# o Add MC* - files generated by Menuconfig in toplevel dir
# --------------------------------------------
#
diff -Nru a/Makefile b/Makefile
--- a/Makefile	Thu Oct 10 21:22:36 2002
+++ b/Makefile	Thu Oct 10 21:22:36 2002
@@ -670,27 +670,12 @@
 # make distclean Remove editor backup files, patch leftover files and the like
 
 # Files removed with 'make clean'
-CLEAN_FILES += \
-	include/linux/compile.h \
-	vmlinux System.map \
-	drivers/char/drm/*-mod.c \
-	sound/oss/bin2hex sound/oss/hex2hex \
-	net/802/cl2llc.c net/802/transit/pdutr.h net/802/transit/timertr.h \
-	net/802/pseudo/pseudocode.h \
-	net/khttpd/make_times_h net/khttpd/times.h \
-	submenu*
+CLEAN_FILES += vmlinux System.map MC*
 
 # Files removed with 'make mrproper'
 MRPROPER_FILES += \
 	include/linux/autoconf.h include/linux/version.h \
-	sound/oss/*_boot.h sound/oss/.*.boot \
-	sound/oss/msndinit.c \
-	sound/oss/msndperm.c \
-	sound/oss/pndsperm.c \
-	sound/oss/pndspini.c \
-	.version .config* config.in config.old \
-	scripts/tkparse scripts/kconfig.tk scripts/kconfig.tmp \
-	scripts/lxdialog/*.o scripts/lxdialog/lxdialog \
+	.version .config .config.old config.in config.old \
 	.menuconfig.log \
 	include/asm \
 	.hdepend include/linux/modversions.h \
diff -Nru a/init/Makefile b/init/Makefile
--- a/init/Makefile	Thu Oct 10 21:22:36 2002
+++ b/init/Makefile	Thu Oct 10 21:22:36 2002
@@ -4,17 +4,21 @@
 
 obj-y    := main.o version.o do_mounts.o
 
+# files to be removed upon make clean
+clean-files := ../include/linux/compile.h
+
 include $(TOPDIR)/Rules.make
 
 # dependencies on generated files need to be listed explicitly
 
-$(obj)/version.o: $(objtree)/include/linux/compile.h
+$(obj)/version.o: $(obj)/../include/linux/compile.h
 
 # compile.h changes depending on hostname, generation number, etc,
 # so we regenerate it always.
 # mkcompile_h will make sure to only update the
 # actual file if its content has changed.
 
-$(objtree)/include/linux/compile.h: FORCE
-	@echo -n '  Generating $@'
+$(obj)/../include/linux/compile.h: FORCE
+	@echo -n '  Generating $(echo_target)'
 	@$(srctree)/scripts/mkcompile_h $@ "$(ARCH)" "$(CONFIG_SMP)" "$(CC) $(CFLAGS)"
+
diff -Nru a/sound/oss/Makefile b/sound/oss/Makefile
--- a/sound/oss/Makefile	Thu Oct 10 21:22:36 2002
+++ b/sound/oss/Makefile	Thu Oct 10 21:22:36 2002
@@ -96,6 +96,10 @@
 
 host-progs	:= bin2hex hex2hex
 
+# Files generated that shall be removed upon make clean
+clean-files := maui_boot.h msndperm.c msndinit.c pndsperm.c pndspini.c \
+               pss_boot.h trix_boot.h
+
 include $(TOPDIR)/Rules.make
 
 # Firmware files that need translation
