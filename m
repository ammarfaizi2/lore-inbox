Return-Path: <linux-kernel-owner+willy=40w.ods.org-S932363AbWCGVaz@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S932363AbWCGVaz (ORCPT <rfc822;willy@w.ods.org>);
	Tue, 7 Mar 2006 16:30:55 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S932364AbWCGVay
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Tue, 7 Mar 2006 16:30:54 -0500
Received: from x35.xmailserver.org ([69.30.125.51]:1231 "EHLO
	x35.xmailserver.org") by vger.kernel.org with ESMTP id S932363AbWCGVay
	(ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Tue, 7 Mar 2006 16:30:54 -0500
X-AuthUser: davidel@xmailserver.org
Date: Tue, 7 Mar 2006 13:30:49 -0800 (PST)
From: Davide Libenzi <davidel@xmailserver.org>
X-X-Sender: davide@localhost.localdomain
To: Linux Kernel Mailing List <linux-kernel@vger.kernel.org>
cc: Ulrich Drepper <drepper@redhat.com>, Linus Torvalds <torvalds@osdl.org>,
       Andrew Morton <akpm@osdl.org>, David Miller <davem@davemloft.net>
Subject: [patch] POLLRDHUP/EPOLLRDHUP handling for half-closed devices
 notifications ...
Message-ID: <Pine.LNX.4.63.0603071247440.15576@localhost.localdomain>
X-GPG-FINGRPRINT: CFAE 5BEE FD36 F65E E640  56FE 0974 BF23 270F 474E
X-GPG-PUBLIC_KEY: http://www.xmailserver.org/davidel.asc
MIME-Version: 1.0
Content-Type: MULTIPART/MIXED; BOUNDARY="8323328-1791953030-1141764767=:15576"
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.

--8323328-1791953030-1141764767=:15576
Content-Type: TEXT/PLAIN; CHARSET=US-ASCII; FORMAT=flowed


The attached patch against 2.6.16-rc5 implements the half-closed devices 
notifiation, by adding a new POLLRDHUP (and its alias EPOLLRDHUP) bit to 
the existing poll/select sets. Since the existing POLLHUP handling, that 
does not report correctly half-closed devices, was feared to be changed, 
this implementation leaves the current POLLHUP reporting unchanged and 
simply add a new bit that is set in the few places where it makes sense.
The same thing was discussed and conceptually agreed quite some time ago:

http://lkml.org/lkml/2003/7/12/116

Since this new event bit is added to the existing Linux poll infrastruture, 
even the existing poll/select system calls will be able to use it. As far 
as the existing POLLHUP handling, the patch leaves it as is.
The pollrdhup-2.6.16.rc5-0.10.diff defines the POLLRDHUP for all the 
existing archs and sets the bit in the six relevant files.
The other attached diff is the simple change required to sys/epoll.h to 
add the EPOLLRDHUP definition.



Signed-off-by: Davide Libenzi <davidel@xmailserver.org>



- Davide


fs/eventpoll.c               |    4 ++--
include/asm-alpha/poll.h     |    2 ++
include/asm-arm/poll.h       |    1 +
include/asm-arm26/poll.h     |    1 +
include/asm-cris/poll.h      |    1 +
include/asm-frv/poll.h       |    1 +
include/asm-h8300/poll.h     |    1 +
include/asm-i386/poll.h      |    1 +
include/asm-ia64/poll.h      |    1 +
include/asm-m32r/poll.h      |    1 +
include/asm-m68k/poll.h      |    1 +
include/asm-mips/poll.h      |    1 +
include/asm-parisc/poll.h    |    1 +
include/asm-powerpc/poll.h   |    1 +
include/asm-s390/poll.h      |    1 +
include/asm-sh/poll.h        |    1 +
include/asm-sh64/poll.h      |    1 +
include/asm-sparc/poll.h     |    1 +
include/asm-sparc64/poll.h   |    1 +
include/asm-v850/poll.h      |    1 +
include/asm-x86_64/poll.h    |    1 +
include/asm-xtensa/poll.h    |    1 +
net/bluetooth/af_bluetooth.c |    3 +++
net/core/datagram.c          |    2 ++
net/dccp/proto.c             |    2 +-
net/ipv4/tcp.c               |    2 +-
net/sctp/socket.c            |    2 ++
net/unix/af_unix.c           |    2 ++
28 files changed, 35 insertions(+), 4 deletions(-)

--8323328-1791953030-1141764767=:15576
Content-Type: TEXT/PLAIN; CHARSET=US-ASCII; NAME=pollrdhup-2.6.16.rc5-0.10.diff
Content-Transfer-Encoding: BASE64
Content-Description: 
Content-Disposition: ATTACHMENT; FILENAME=pollrdhup-2.6.16.rc5-0.10.diff

ZGlmZiAtTnJ1IGxpbnV4LTIuNi4xNS9mcy9ldmVudHBvbGwuYyBsaW51eC0y
LjYuMTUubW9kL2ZzL2V2ZW50cG9sbC5jDQotLS0gbGludXgtMi42LjE1L2Zz
L2V2ZW50cG9sbC5jCTIwMDYtMDEtMDIgMTk6MjE6MTAuMDAwMDAwMDAwIC0w
ODAwDQorKysgbGludXgtMi42LjE1Lm1vZC9mcy9ldmVudHBvbGwuYwkyMDA2
LTAzLTA3IDEyOjI1OjA4LjAwMDAwMDAwMCAtMDgwMA0KQEAgLTYwNyw3ICs2
MDcsNyBAQA0KIAlzd2l0Y2ggKG9wKSB7DQogCWNhc2UgRVBPTExfQ1RMX0FE
RDoNCiAJCWlmICghZXBpKSB7DQotCQkJZXBkcy5ldmVudHMgfD0gUE9MTEVS
UiB8IFBPTExIVVA7DQorCQkJZXBkcy5ldmVudHMgfD0gUE9MTEVSUiB8IFBP
TExIVVAgfCBQT0xMUkRIVVA7DQogDQogCQkJZXJyb3IgPSBlcF9pbnNlcnQo
ZXAsICZlcGRzLCB0ZmlsZSwgZmQpOw0KIAkJfSBlbHNlDQpAQCAtNjIxLDcg
KzYyMSw3IEBADQogCQlicmVhazsNCiAJY2FzZSBFUE9MTF9DVExfTU9EOg0K
IAkJaWYgKGVwaSkgew0KLQkJCWVwZHMuZXZlbnRzIHw9IFBPTExFUlIgfCBQ
T0xMSFVQOw0KKwkJCWVwZHMuZXZlbnRzIHw9IFBPTExFUlIgfCBQT0xMSFVQ
IHwgUE9MTFJESFVQOw0KIAkJCWVycm9yID0gZXBfbW9kaWZ5KGVwLCBlcGks
ICZlcGRzKTsNCiAJCX0gZWxzZQ0KIAkJCWVycm9yID0gLUVOT0VOVDsNCmRp
ZmYgLU5ydSBsaW51eC0yLjYuMTUvaW5jbHVkZS9hc20tYWxwaGEvcG9sbC5o
IGxpbnV4LTIuNi4xNS5tb2QvaW5jbHVkZS9hc20tYWxwaGEvcG9sbC5oDQot
LS0gbGludXgtMi42LjE1L2luY2x1ZGUvYXNtLWFscGhhL3BvbGwuaAkyMDA2
LTAxLTAyIDE5OjIxOjEwLjAwMDAwMDAwMCAtMDgwMA0KKysrIGxpbnV4LTIu
Ni4xNS5tb2QvaW5jbHVkZS9hc20tYWxwaGEvcG9sbC5oCTIwMDYtMDMtMDcg
MTI6MjU6MDguMDAwMDAwMDAwIC0wODAwDQpAQCAtMTMsNiArMTMsOCBAQA0K
ICNkZWZpbmUgUE9MTFdSQkFORAkoMSA8PCA5KQ0KICNkZWZpbmUgUE9MTE1T
RwkJKDEgPDwgMTApDQogI2RlZmluZSBQT0xMUkVNT1ZFCSgxIDw8IDExKQ0K
KyNkZWZpbmUgUE9MTFJESFVQICAgICAgICgxIDw8IDEyKQ0KKw0KIA0KIHN0
cnVjdCBwb2xsZmQgew0KIAlpbnQgZmQ7DQpkaWZmIC1OcnUgbGludXgtMi42
LjE1L2luY2x1ZGUvYXNtLWFybS9wb2xsLmggbGludXgtMi42LjE1Lm1vZC9p
bmNsdWRlL2FzbS1hcm0vcG9sbC5oDQotLS0gbGludXgtMi42LjE1L2luY2x1
ZGUvYXNtLWFybS9wb2xsLmgJMjAwNi0wMS0wMiAxOToyMToxMC4wMDAwMDAw
MDAgLTA4MDANCisrKyBsaW51eC0yLjYuMTUubW9kL2luY2x1ZGUvYXNtLWFy
bS9wb2xsLmgJMjAwNi0wMy0wNyAxMjoyNTowOC4wMDAwMDAwMDAgLTA4MDAN
CkBAIC0xNiw2ICsxNiw3IEBADQogI2RlZmluZSBQT0xMV1JCQU5ECTB4MDIw
MA0KICNkZWZpbmUgUE9MTE1TRwkJMHgwNDAwDQogI2RlZmluZSBQT0xMUkVN
T1ZFCTB4MTAwMA0KKyNkZWZpbmUgUE9MTFJESFVQICAgICAgIDB4MjAwMA0K
IA0KIHN0cnVjdCBwb2xsZmQgew0KIAlpbnQgZmQ7DQpkaWZmIC1OcnUgbGlu
dXgtMi42LjE1L2luY2x1ZGUvYXNtLWFybTI2L3BvbGwuaCBsaW51eC0yLjYu
MTUubW9kL2luY2x1ZGUvYXNtLWFybTI2L3BvbGwuaA0KLS0tIGxpbnV4LTIu
Ni4xNS9pbmNsdWRlL2FzbS1hcm0yNi9wb2xsLmgJMjAwNi0wMS0wMiAxOToy
MToxMC4wMDAwMDAwMDAgLTA4MDANCisrKyBsaW51eC0yLjYuMTUubW9kL2lu
Y2x1ZGUvYXNtLWFybTI2L3BvbGwuaAkyMDA2LTAzLTA3IDEyOjI1OjA4LjAw
MDAwMDAwMCAtMDgwMA0KQEAgLTE1LDYgKzE1LDcgQEANCiAjZGVmaW5lIFBP
TExXUk5PUk0JMHgwMTAwDQogI2RlZmluZSBQT0xMV1JCQU5ECTB4MDIwMA0K
ICNkZWZpbmUgUE9MTE1TRwkJMHgwNDAwDQorI2RlZmluZSBQT0xMUkRIVVAg
ICAgICAgMHgyMDAwDQogDQogc3RydWN0IHBvbGxmZCB7DQogCWludCBmZDsN
CmRpZmYgLU5ydSBsaW51eC0yLjYuMTUvaW5jbHVkZS9hc20tY3Jpcy9wb2xs
LmggbGludXgtMi42LjE1Lm1vZC9pbmNsdWRlL2FzbS1jcmlzL3BvbGwuaA0K
LS0tIGxpbnV4LTIuNi4xNS9pbmNsdWRlL2FzbS1jcmlzL3BvbGwuaAkyMDA2
LTAxLTAyIDE5OjIxOjEwLjAwMDAwMDAwMCAtMDgwMA0KKysrIGxpbnV4LTIu
Ni4xNS5tb2QvaW5jbHVkZS9hc20tY3Jpcy9wb2xsLmgJMjAwNi0wMy0wNyAx
MjoyNTowOC4wMDAwMDAwMDAgLTA4MDANCkBAIC0xNSw2ICsxNSw3IEBADQog
I2RlZmluZSBQT0xMV1JCQU5ECTUxMg0KICNkZWZpbmUgUE9MTE1TRwkJMTAy
NA0KICNkZWZpbmUgUE9MTFJFTU9WRQk0MDk2DQorI2RlZmluZSBQT0xMUkRI
VVAgICAgICAgODE5Mg0KIA0KIHN0cnVjdCBwb2xsZmQgew0KIAlpbnQgZmQ7
DQpkaWZmIC1OcnUgbGludXgtMi42LjE1L2luY2x1ZGUvYXNtLWZydi9wb2xs
LmggbGludXgtMi42LjE1Lm1vZC9pbmNsdWRlL2FzbS1mcnYvcG9sbC5oDQot
LS0gbGludXgtMi42LjE1L2luY2x1ZGUvYXNtLWZydi9wb2xsLmgJMjAwNi0w
MS0wMiAxOToyMToxMC4wMDAwMDAwMDAgLTA4MDANCisrKyBsaW51eC0yLjYu
MTUubW9kL2luY2x1ZGUvYXNtLWZydi9wb2xsLmgJMjAwNi0wMy0wNyAxMjoy
NTowOC4wMDAwMDAwMDAgLTA4MDANCkBAIC0xMiw2ICsxMiw3IEBADQogI2Rl
ZmluZSBQT0xMUkRCQU5ECTEyOA0KICNkZWZpbmUgUE9MTFdSQkFORAkyNTYN
CiAjZGVmaW5lIFBPTExNU0cJCTB4MDQwMA0KKyNkZWZpbmUgUE9MTFJESFVQ
ICAgICAgIDB4MjAwMA0KIA0KIHN0cnVjdCBwb2xsZmQgew0KIAlpbnQgZmQ7
DQpkaWZmIC1OcnUgbGludXgtMi42LjE1L2luY2x1ZGUvYXNtLWg4MzAwL3Bv
bGwuaCBsaW51eC0yLjYuMTUubW9kL2luY2x1ZGUvYXNtLWg4MzAwL3BvbGwu
aA0KLS0tIGxpbnV4LTIuNi4xNS9pbmNsdWRlL2FzbS1oODMwMC9wb2xsLmgJ
MjAwNi0wMS0wMiAxOToyMToxMC4wMDAwMDAwMDAgLTA4MDANCisrKyBsaW51
eC0yLjYuMTUubW9kL2luY2x1ZGUvYXNtLWg4MzAwL3BvbGwuaAkyMDA2LTAz
LTA3IDEyOjI1OjA4LjAwMDAwMDAwMCAtMDgwMA0KQEAgLTEyLDYgKzEyLDcg
QEANCiAjZGVmaW5lIFBPTExSREJBTkQJMTI4DQogI2RlZmluZSBQT0xMV1JC
QU5ECTI1Ng0KICNkZWZpbmUgUE9MTE1TRwkJMHgwNDAwDQorI2RlZmluZSBQ
T0xMUkRIVVAgICAgICAgMHgyMDAwDQogDQogc3RydWN0IHBvbGxmZCB7DQog
CWludCBmZDsNCmRpZmYgLU5ydSBsaW51eC0yLjYuMTUvaW5jbHVkZS9hc20t
aTM4Ni9wb2xsLmggbGludXgtMi42LjE1Lm1vZC9pbmNsdWRlL2FzbS1pMzg2
L3BvbGwuaA0KLS0tIGxpbnV4LTIuNi4xNS9pbmNsdWRlL2FzbS1pMzg2L3Bv
bGwuaAkyMDA2LTAxLTAyIDE5OjIxOjEwLjAwMDAwMDAwMCAtMDgwMA0KKysr
IGxpbnV4LTIuNi4xNS5tb2QvaW5jbHVkZS9hc20taTM4Ni9wb2xsLmgJMjAw
Ni0wMy0wNyAxMjoyNTowOC4wMDAwMDAwMDAgLTA4MDANCkBAIC0xNiw2ICsx
Niw3IEBADQogI2RlZmluZSBQT0xMV1JCQU5ECTB4MDIwMA0KICNkZWZpbmUg
UE9MTE1TRwkJMHgwNDAwDQogI2RlZmluZSBQT0xMUkVNT1ZFCTB4MTAwMA0K
KyNkZWZpbmUgUE9MTFJESFVQICAgICAgIDB4MjAwMA0KIA0KIHN0cnVjdCBw
b2xsZmQgew0KIAlpbnQgZmQ7DQpkaWZmIC1OcnUgbGludXgtMi42LjE1L2lu
Y2x1ZGUvYXNtLWlhNjQvcG9sbC5oIGxpbnV4LTIuNi4xNS5tb2QvaW5jbHVk
ZS9hc20taWE2NC9wb2xsLmgNCi0tLSBsaW51eC0yLjYuMTUvaW5jbHVkZS9h
c20taWE2NC9wb2xsLmgJMjAwNi0wMS0wMiAxOToyMToxMC4wMDAwMDAwMDAg
LTA4MDANCisrKyBsaW51eC0yLjYuMTUubW9kL2luY2x1ZGUvYXNtLWlhNjQv
cG9sbC5oCTIwMDYtMDMtMDcgMTI6MjU6MDguMDAwMDAwMDAwIC0wODAwDQpA
QCAtMjEsNiArMjEsNyBAQA0KICNkZWZpbmUgUE9MTFdSQkFORAkweDAyMDAN
CiAjZGVmaW5lIFBPTExNU0cJCTB4MDQwMA0KICNkZWZpbmUgUE9MTFJFTU9W
RQkweDEwMDANCisjZGVmaW5lIFBPTExSREhVUCAgICAgICAweDIwMDANCiAN
CiBzdHJ1Y3QgcG9sbGZkIHsNCiAJaW50IGZkOw0KZGlmZiAtTnJ1IGxpbnV4
LTIuNi4xNS9pbmNsdWRlL2FzbS1tMzJyL3BvbGwuaCBsaW51eC0yLjYuMTUu
bW9kL2luY2x1ZGUvYXNtLW0zMnIvcG9sbC5oDQotLS0gbGludXgtMi42LjE1
L2luY2x1ZGUvYXNtLW0zMnIvcG9sbC5oCTIwMDYtMDEtMDIgMTk6MjE6MTAu
MDAwMDAwMDAwIC0wODAwDQorKysgbGludXgtMi42LjE1Lm1vZC9pbmNsdWRl
L2FzbS1tMzJyL3BvbGwuaAkyMDA2LTAzLTA3IDEyOjI1OjA4LjAwMDAwMDAw
MCAtMDgwMA0KQEAgLTIxLDYgKzIxLDcgQEANCiAjZGVmaW5lIFBPTExXUkJB
TkQJMHgwMjAwDQogI2RlZmluZSBQT0xMTVNHCQkweDA0MDANCiAjZGVmaW5l
IFBPTExSRU1PVkUJMHgxMDAwDQorI2RlZmluZSBQT0xMUkRIVVAgICAgICAg
MHgyMDAwDQogDQogc3RydWN0IHBvbGxmZCB7DQogCWludCBmZDsNCmRpZmYg
LU5ydSBsaW51eC0yLjYuMTUvaW5jbHVkZS9hc20tbTY4ay9wb2xsLmggbGlu
dXgtMi42LjE1Lm1vZC9pbmNsdWRlL2FzbS1tNjhrL3BvbGwuaA0KLS0tIGxp
bnV4LTIuNi4xNS9pbmNsdWRlL2FzbS1tNjhrL3BvbGwuaAkyMDA2LTAxLTAy
IDE5OjIxOjEwLjAwMDAwMDAwMCAtMDgwMA0KKysrIGxpbnV4LTIuNi4xNS5t
b2QvaW5jbHVkZS9hc20tbTY4ay9wb2xsLmgJMjAwNi0wMy0wNyAxMjoyNTow
OC4wMDAwMDAwMDAgLTA4MDANCkBAIC0xMyw2ICsxMyw3IEBADQogI2RlZmlu
ZSBQT0xMV1JCQU5ECTI1Ng0KICNkZWZpbmUgUE9MTE1TRwkJMHgwNDAwDQog
I2RlZmluZSBQT0xMUkVNT1ZFCTB4MTAwMA0KKyNkZWZpbmUgUE9MTFJESFVQ
ICAgICAgIDB4MjAwMA0KIA0KIHN0cnVjdCBwb2xsZmQgew0KIAlpbnQgZmQ7
DQpkaWZmIC1OcnUgbGludXgtMi42LjE1L2luY2x1ZGUvYXNtLW1pcHMvcG9s
bC5oIGxpbnV4LTIuNi4xNS5tb2QvaW5jbHVkZS9hc20tbWlwcy9wb2xsLmgN
Ci0tLSBsaW51eC0yLjYuMTUvaW5jbHVkZS9hc20tbWlwcy9wb2xsLmgJMjAw
Ni0wMS0wMiAxOToyMToxMC4wMDAwMDAwMDAgLTA4MDANCisrKyBsaW51eC0y
LjYuMTUubW9kL2luY2x1ZGUvYXNtLW1pcHMvcG9sbC5oCTIwMDYtMDMtMDcg
MTI6MjU6MDguMDAwMDAwMDAwIC0wODAwDQpAQCAtMTcsNiArMTcsNyBAQA0K
IC8qIFRoZXNlIHNlZW0gdG8gYmUgbW9yZSBvciBsZXNzIG5vbnN0YW5kYXJk
IC4uLiAgKi8NCiAjZGVmaW5lIFBPTExNU0cJCTB4MDQwMA0KICNkZWZpbmUg
UE9MTFJFTU9WRQkweDEwMDANCisjZGVmaW5lIFBPTExSREhVUCAgICAgICAw
eDIwMDANCiANCiBzdHJ1Y3QgcG9sbGZkIHsNCiAJaW50IGZkOw0KZGlmZiAt
TnJ1IGxpbnV4LTIuNi4xNS9pbmNsdWRlL2FzbS1wYXJpc2MvcG9sbC5oIGxp
bnV4LTIuNi4xNS5tb2QvaW5jbHVkZS9hc20tcGFyaXNjL3BvbGwuaA0KLS0t
IGxpbnV4LTIuNi4xNS9pbmNsdWRlL2FzbS1wYXJpc2MvcG9sbC5oCTIwMDYt
MDEtMDIgMTk6MjE6MTAuMDAwMDAwMDAwIC0wODAwDQorKysgbGludXgtMi42
LjE1Lm1vZC9pbmNsdWRlL2FzbS1wYXJpc2MvcG9sbC5oCTIwMDYtMDMtMDcg
MTI6MjU6MDguMDAwMDAwMDAwIC0wODAwDQpAQCAtMTYsNiArMTYsNyBAQA0K
ICNkZWZpbmUgUE9MTFdSQkFORAkweDAyMDANCiAjZGVmaW5lIFBPTExNU0cJ
CTB4MDQwMA0KICNkZWZpbmUgUE9MTFJFTU9WRQkweDEwMDANCisjZGVmaW5l
IFBPTExSREhVUCAgICAgICAweDIwMDANCiANCiBzdHJ1Y3QgcG9sbGZkIHsN
CiAJaW50IGZkOw0KZGlmZiAtTnJ1IGxpbnV4LTIuNi4xNS9pbmNsdWRlL2Fz
bS1wb3dlcnBjL3BvbGwuaCBsaW51eC0yLjYuMTUubW9kL2luY2x1ZGUvYXNt
LXBvd2VycGMvcG9sbC5oDQotLS0gbGludXgtMi42LjE1L2luY2x1ZGUvYXNt
LXBvd2VycGMvcG9sbC5oCTIwMDYtMDEtMDIgMTk6MjE6MTAuMDAwMDAwMDAw
IC0wODAwDQorKysgbGludXgtMi42LjE1Lm1vZC9pbmNsdWRlL2FzbS1wb3dl
cnBjL3BvbGwuaAkyMDA2LTAzLTA3IDEyOjI1OjA4LjAwMDAwMDAwMCAtMDgw
MA0KQEAgLTEzLDYgKzEzLDcgQEANCiAjZGVmaW5lIFBPTExXUkJBTkQJMHgw
MjAwDQogI2RlZmluZSBQT0xMTVNHCQkweDA0MDANCiAjZGVmaW5lIFBPTExS
RU1PVkUJMHgxMDAwDQorI2RlZmluZSBQT0xMUkRIVVAgICAgICAgMHgyMDAw
DQogDQogc3RydWN0IHBvbGxmZCB7DQogCWludCBmZDsNCmRpZmYgLU5ydSBs
aW51eC0yLjYuMTUvaW5jbHVkZS9hc20tczM5MC9wb2xsLmggbGludXgtMi42
LjE1Lm1vZC9pbmNsdWRlL2FzbS1zMzkwL3BvbGwuaA0KLS0tIGxpbnV4LTIu
Ni4xNS9pbmNsdWRlL2FzbS1zMzkwL3BvbGwuaAkyMDA2LTAxLTAyIDE5OjIx
OjEwLjAwMDAwMDAwMCAtMDgwMA0KKysrIGxpbnV4LTIuNi4xNS5tb2QvaW5j
bHVkZS9hc20tczM5MC9wb2xsLmgJMjAwNi0wMy0wNyAxMjoyNTowOC4wMDAw
MDAwMDAgLTA4MDANCkBAIC0yNCw2ICsyNCw3IEBADQogI2RlZmluZSBQT0xM
V1JCQU5ECTB4MDIwMA0KICNkZWZpbmUgUE9MTE1TRwkJMHgwNDAwDQogI2Rl
ZmluZSBQT0xMUkVNT1ZFCTB4MTAwMA0KKyNkZWZpbmUgUE9MTFJESFVQICAg
ICAgIDB4MjAwMA0KIA0KIHN0cnVjdCBwb2xsZmQgew0KIAlpbnQgZmQ7DQpk
aWZmIC1OcnUgbGludXgtMi42LjE1L2luY2x1ZGUvYXNtLXNoL3BvbGwuaCBs
aW51eC0yLjYuMTUubW9kL2luY2x1ZGUvYXNtLXNoL3BvbGwuaA0KLS0tIGxp
bnV4LTIuNi4xNS9pbmNsdWRlL2FzbS1zaC9wb2xsLmgJMjAwNi0wMS0wMiAx
OToyMToxMC4wMDAwMDAwMDAgLTA4MDANCisrKyBsaW51eC0yLjYuMTUubW9k
L2luY2x1ZGUvYXNtLXNoL3BvbGwuaAkyMDA2LTAzLTA3IDEyOjI1OjA4LjAw
MDAwMDAwMCAtMDgwMA0KQEAgLTE2LDYgKzE2LDcgQEANCiAjZGVmaW5lIFBP
TExXUkJBTkQJMHgwMjAwDQogI2RlZmluZSBQT0xMTVNHCQkweDA0MDANCiAj
ZGVmaW5lIFBPTExSRU1PVkUJMHgxMDAwDQorI2RlZmluZSBQT0xMUkRIVVAg
ICAgICAgMHgyMDAwDQogDQogc3RydWN0IHBvbGxmZCB7DQogCWludCBmZDsN
CmRpZmYgLU5ydSBsaW51eC0yLjYuMTUvaW5jbHVkZS9hc20tc2g2NC9wb2xs
LmggbGludXgtMi42LjE1Lm1vZC9pbmNsdWRlL2FzbS1zaDY0L3BvbGwuaA0K
LS0tIGxpbnV4LTIuNi4xNS9pbmNsdWRlL2FzbS1zaDY0L3BvbGwuaAkyMDA2
LTAxLTAyIDE5OjIxOjEwLjAwMDAwMDAwMCAtMDgwMA0KKysrIGxpbnV4LTIu
Ni4xNS5tb2QvaW5jbHVkZS9hc20tc2g2NC9wb2xsLmgJMjAwNi0wMy0wNyAx
MjoyNTowOC4wMDAwMDAwMDAgLTA4MDANCkBAIC0yNiw2ICsyNiw3IEBADQog
I2RlZmluZSBQT0xMV1JOT1JNCTB4MDEwMA0KICNkZWZpbmUgUE9MTFdSQkFO
RAkweDAyMDANCiAjZGVmaW5lIFBPTExNU0cJCTB4MDQwMA0KKyNkZWZpbmUg
UE9MTFJESFVQICAgICAgIDB4MjAwMA0KIA0KIHN0cnVjdCBwb2xsZmQgew0K
IAlpbnQgZmQ7DQpkaWZmIC1OcnUgbGludXgtMi42LjE1L2luY2x1ZGUvYXNt
LXNwYXJjL3BvbGwuaCBsaW51eC0yLjYuMTUubW9kL2luY2x1ZGUvYXNtLXNw
YXJjL3BvbGwuaA0KLS0tIGxpbnV4LTIuNi4xNS9pbmNsdWRlL2FzbS1zcGFy
Yy9wb2xsLmgJMjAwNi0wMS0wMiAxOToyMToxMC4wMDAwMDAwMDAgLTA4MDAN
CisrKyBsaW51eC0yLjYuMTUubW9kL2luY2x1ZGUvYXNtLXNwYXJjL3BvbGwu
aAkyMDA2LTAzLTA3IDEyOjI1OjA4LjAwMDAwMDAwMCAtMDgwMA0KQEAgLTEz
LDYgKzEzLDcgQEANCiAjZGVmaW5lIFBPTExXUkJBTkQJMjU2DQogI2RlZmlu
ZSBQT0xMTVNHCQk1MTINCiAjZGVmaW5lIFBPTExSRU1PVkUJMTAyNA0KKyNk
ZWZpbmUgUE9MTFJESFVQICAgICAgIDIwNDgNCiANCiBzdHJ1Y3QgcG9sbGZk
IHsNCiAJaW50IGZkOw0KZGlmZiAtTnJ1IGxpbnV4LTIuNi4xNS9pbmNsdWRl
L2FzbS1zcGFyYzY0L3BvbGwuaCBsaW51eC0yLjYuMTUubW9kL2luY2x1ZGUv
YXNtLXNwYXJjNjQvcG9sbC5oDQotLS0gbGludXgtMi42LjE1L2luY2x1ZGUv
YXNtLXNwYXJjNjQvcG9sbC5oCTIwMDYtMDEtMDIgMTk6MjE6MTAuMDAwMDAw
MDAwIC0wODAwDQorKysgbGludXgtMi42LjE1Lm1vZC9pbmNsdWRlL2FzbS1z
cGFyYzY0L3BvbGwuaAkyMDA2LTAzLTA3IDEyOjI1OjA4LjAwMDAwMDAwMCAt
MDgwMA0KQEAgLTEzLDYgKzEzLDcgQEANCiAjZGVmaW5lIFBPTExXUkJBTkQJ
MjU2DQogI2RlZmluZSBQT0xMTVNHCQk1MTINCiAjZGVmaW5lIFBPTExSRU1P
VkUJMTAyNA0KKyNkZWZpbmUgUE9MTFJESFVQICAgICAgIDIwNDgNCiANCiBz
dHJ1Y3QgcG9sbGZkIHsNCiAJaW50IGZkOw0KZGlmZiAtTnJ1IGxpbnV4LTIu
Ni4xNS9pbmNsdWRlL2FzbS12ODUwL3BvbGwuaCBsaW51eC0yLjYuMTUubW9k
L2luY2x1ZGUvYXNtLXY4NTAvcG9sbC5oDQotLS0gbGludXgtMi42LjE1L2lu
Y2x1ZGUvYXNtLXY4NTAvcG9sbC5oCTIwMDYtMDEtMDIgMTk6MjE6MTAuMDAw
MDAwMDAwIC0wODAwDQorKysgbGludXgtMi42LjE1Lm1vZC9pbmNsdWRlL2Fz
bS12ODUwL3BvbGwuaAkyMDA2LTAzLTA3IDEyOjI1OjA4LjAwMDAwMDAwMCAt
MDgwMA0KQEAgLTEzLDYgKzEzLDcgQEANCiAjZGVmaW5lIFBPTExXUkJBTkQJ
MHgwMTAwDQogI2RlZmluZSBQT0xMTVNHCQkweDA0MDANCiAjZGVmaW5lIFBP
TExSRU1PVkUJMHgxMDAwDQorI2RlZmluZSBQT0xMUkRIVVAgICAgICAgMHgy
MDAwDQogDQogc3RydWN0IHBvbGxmZCB7DQogCWludCBmZDsNCmRpZmYgLU5y
dSBsaW51eC0yLjYuMTUvaW5jbHVkZS9hc20teDg2XzY0L3BvbGwuaCBsaW51
eC0yLjYuMTUubW9kL2luY2x1ZGUvYXNtLXg4Nl82NC9wb2xsLmgNCi0tLSBs
aW51eC0yLjYuMTUvaW5jbHVkZS9hc20teDg2XzY0L3BvbGwuaAkyMDA2LTAx
LTAyIDE5OjIxOjEwLjAwMDAwMDAwMCAtMDgwMA0KKysrIGxpbnV4LTIuNi4x
NS5tb2QvaW5jbHVkZS9hc20teDg2XzY0L3BvbGwuaAkyMDA2LTAzLTA3IDEy
OjI1OjA4LjAwMDAwMDAwMCAtMDgwMA0KQEAgLTE2LDYgKzE2LDcgQEANCiAj
ZGVmaW5lIFBPTExXUkJBTkQJMHgwMjAwDQogI2RlZmluZSBQT0xMTVNHCQkw
eDA0MDANCiAjZGVmaW5lIFBPTExSRU1PVkUJMHgxMDAwDQorI2RlZmluZSBQ
T0xMUkRIVVAgICAgICAgMHgyMDAwDQogDQogc3RydWN0IHBvbGxmZCB7DQog
CWludCBmZDsNCmRpZmYgLU5ydSBsaW51eC0yLjYuMTUvaW5jbHVkZS9hc20t
eHRlbnNhL3BvbGwuaCBsaW51eC0yLjYuMTUubW9kL2luY2x1ZGUvYXNtLXh0
ZW5zYS9wb2xsLmgNCi0tLSBsaW51eC0yLjYuMTUvaW5jbHVkZS9hc20teHRl
bnNhL3BvbGwuaAkyMDA2LTAxLTAyIDE5OjIxOjEwLjAwMDAwMDAwMCAtMDgw
MA0KKysrIGxpbnV4LTIuNi4xNS5tb2QvaW5jbHVkZS9hc20teHRlbnNhL3Bv
bGwuaAkyMDA2LTAzLTA3IDEyOjI1OjA4LjAwMDAwMDAwMCAtMDgwMA0KQEAg
LTI3LDYgKzI3LDcgQEANCiANCiAjZGVmaW5lIFBPTExNU0cJCTB4MDQwMA0K
ICNkZWZpbmUgUE9MTFJFTU9WRQkweDA4MDANCisjZGVmaW5lIFBPTExSREhV
UCAgICAgICAweDIwMDANCiANCiBzdHJ1Y3QgcG9sbGZkIHsNCiAJaW50IGZk
Ow0KZGlmZiAtTnJ1IGxpbnV4LTIuNi4xNS9uZXQvYmx1ZXRvb3RoL2FmX2Js
dWV0b290aC5jIGxpbnV4LTIuNi4xNS5tb2QvbmV0L2JsdWV0b290aC9hZl9i
bHVldG9vdGguYw0KLS0tIGxpbnV4LTIuNi4xNS9uZXQvYmx1ZXRvb3RoL2Fm
X2JsdWV0b290aC5jCTIwMDYtMDMtMDcgMTI6MjQ6MjYuMDAwMDAwMDAwIC0w
ODAwDQorKysgbGludXgtMi42LjE1Lm1vZC9uZXQvYmx1ZXRvb3RoL2FmX2Js
dWV0b290aC5jCTIwMDYtMDMtMDcgMTI6MjU6MDguMDAwMDAwMDAwIC0wODAw
DQpAQCAtMjM4LDYgKzIzOCw5IEBADQogCWlmIChzay0+c2tfZXJyIHx8ICFz
a2JfcXVldWVfZW1wdHkoJnNrLT5za19lcnJvcl9xdWV1ZSkpDQogCQltYXNr
IHw9IFBPTExFUlI7DQogDQorCWlmIChzay0+c2tfc2h1dGRvd24gJiBSQ1Zf
U0hVVERPV04pDQorCQltYXNrIHw9IFBPTExSREhVUDsNCisJDQogCWlmIChz
ay0+c2tfc2h1dGRvd24gPT0gU0hVVERPV05fTUFTSykNCiAJCW1hc2sgfD0g
UE9MTEhVUDsNCiANCmRpZmYgLU5ydSBsaW51eC0yLjYuMTUvbmV0L2NvcmUv
ZGF0YWdyYW0uYyBsaW51eC0yLjYuMTUubW9kL25ldC9jb3JlL2RhdGFncmFt
LmMNCi0tLSBsaW51eC0yLjYuMTUvbmV0L2NvcmUvZGF0YWdyYW0uYwkyMDA2
LTAzLTA3IDEyOjI0OjI2LjAwMDAwMDAwMCAtMDgwMA0KKysrIGxpbnV4LTIu
Ni4xNS5tb2QvbmV0L2NvcmUvZGF0YWdyYW0uYwkyMDA2LTAzLTA3IDEyOjI1
OjA4LjAwMDAwMDAwMCAtMDgwMA0KQEAgLTUwMCw2ICs1MDAsOCBAQA0KIAkv
KiBleGNlcHRpb25hbCBldmVudHM/ICovDQogCWlmIChzay0+c2tfZXJyIHx8
ICFza2JfcXVldWVfZW1wdHkoJnNrLT5za19lcnJvcl9xdWV1ZSkpDQogCQlt
YXNrIHw9IFBPTExFUlI7DQorCWlmIChzay0+c2tfc2h1dGRvd24gJiBSQ1Zf
U0hVVERPV04pDQorCQltYXNrIHw9IFBPTExSREhVUDsNCiAJaWYgKHNrLT5z
a19zaHV0ZG93biA9PSBTSFVURE9XTl9NQVNLKQ0KIAkJbWFzayB8PSBQT0xM
SFVQOw0KIA0KZGlmZiAtTnJ1IGxpbnV4LTIuNi4xNS9uZXQvZGNjcC9wcm90
by5jIGxpbnV4LTIuNi4xNS5tb2QvbmV0L2RjY3AvcHJvdG8uYw0KLS0tIGxp
bnV4LTIuNi4xNS9uZXQvZGNjcC9wcm90by5jCTIwMDYtMDMtMDcgMTI6MjQ6
MjYuMDAwMDAwMDAwIC0wODAwDQorKysgbGludXgtMi42LjE1Lm1vZC9uZXQv
ZGNjcC9wcm90by5jCTIwMDYtMDMtMDcgMTI6MjU6MDguMDAwMDAwMDAwIC0w
ODAwDQpAQCAtMTgzLDcgKzE4Myw3IEBADQogCWlmIChzay0+c2tfc2h1dGRv
d24gPT0gU0hVVERPV05fTUFTSyB8fCBzay0+c2tfc3RhdGUgPT0gRENDUF9D
TE9TRUQpDQogCQltYXNrIHw9IFBPTExIVVA7DQogCWlmIChzay0+c2tfc2h1
dGRvd24gJiBSQ1ZfU0hVVERPV04pDQotCQltYXNrIHw9IFBPTExJTiB8IFBP
TExSRE5PUk07DQorCQltYXNrIHw9IFBPTExJTiB8IFBPTExSRE5PUk0gfCBQ
T0xMUkRIVVA7DQogDQogCS8qIENvbm5lY3RlZD8gKi8NCiAJaWYgKCgxIDw8
IHNrLT5za19zdGF0ZSkgJiB+KERDQ1BGX1JFUVVFU1RJTkcgfCBEQ0NQRl9S
RVNQT05EKSkgew0KZGlmZiAtTnJ1IGxpbnV4LTIuNi4xNS9uZXQvaXB2NC90
Y3AuYyBsaW51eC0yLjYuMTUubW9kL25ldC9pcHY0L3RjcC5jDQotLS0gbGlu
dXgtMi42LjE1L25ldC9pcHY0L3RjcC5jCTIwMDYtMDMtMDcgMTI6MjQ6MjYu
MDAwMDAwMDAwIC0wODAwDQorKysgbGludXgtMi42LjE1Lm1vZC9uZXQvaXB2
NC90Y3AuYwkyMDA2LTAzLTA3IDEyOjI1OjA4LjAwMDAwMDAwMCAtMDgwMA0K
QEAgLTM2NSw3ICszNjUsNyBAQA0KIAlpZiAoc2stPnNrX3NodXRkb3duID09
IFNIVVRET1dOX01BU0sgfHwgc2stPnNrX3N0YXRlID09IFRDUF9DTE9TRSkN
CiAJCW1hc2sgfD0gUE9MTEhVUDsNCiAJaWYgKHNrLT5za19zaHV0ZG93biAm
IFJDVl9TSFVURE9XTikNCi0JCW1hc2sgfD0gUE9MTElOIHwgUE9MTFJETk9S
TTsNCisJCW1hc2sgfD0gUE9MTElOIHwgUE9MTFJETk9STSB8IFBPTExSREhV
UDsNCiANCiAJLyogQ29ubmVjdGVkPyAqLw0KIAlpZiAoKDEgPDwgc2stPnNr
X3N0YXRlKSAmIH4oVENQRl9TWU5fU0VOVCB8IFRDUEZfU1lOX1JFQ1YpKSB7
DQpkaWZmIC1OcnUgbGludXgtMi42LjE1L25ldC9zY3RwL3NvY2tldC5jIGxp
bnV4LTIuNi4xNS5tb2QvbmV0L3NjdHAvc29ja2V0LmMNCi0tLSBsaW51eC0y
LjYuMTUvbmV0L3NjdHAvc29ja2V0LmMJMjAwNi0wMy0wNyAxMjoyNDoyNi4w
MDAwMDAwMDAgLTA4MDANCisrKyBsaW51eC0yLjYuMTUubW9kL25ldC9zY3Rw
L3NvY2tldC5jCTIwMDYtMDMtMDcgMTI6MjU6MDguMDAwMDAwMDAwIC0wODAw
DQpAQCAtNDg5NCw2ICs0ODk0LDggQEANCiAJLyogSXMgdGhlcmUgYW55IGV4
Y2VwdGlvbmFsIGV2ZW50cz8gICovDQogCWlmIChzay0+c2tfZXJyIHx8ICFz
a2JfcXVldWVfZW1wdHkoJnNrLT5za19lcnJvcl9xdWV1ZSkpDQogCQltYXNr
IHw9IFBPTExFUlI7DQorCWlmIChzay0+c2tfc2h1dGRvd24gJiBSQ1ZfU0hV
VERPV04pDQorCQltYXNrIHw9IFBPTExSREhVUDsNCiAJaWYgKHNrLT5za19z
aHV0ZG93biA9PSBTSFVURE9XTl9NQVNLKQ0KIAkJbWFzayB8PSBQT0xMSFVQ
Ow0KIA0KZGlmZiAtTnJ1IGxpbnV4LTIuNi4xNS9uZXQvdW5peC9hZl91bml4
LmMgbGludXgtMi42LjE1Lm1vZC9uZXQvdW5peC9hZl91bml4LmMNCi0tLSBs
aW51eC0yLjYuMTUvbmV0L3VuaXgvYWZfdW5peC5jCTIwMDYtMDMtMDcgMTI6
MjQ6MjYuMDAwMDAwMDAwIC0wODAwDQorKysgbGludXgtMi42LjE1Lm1vZC9u
ZXQvdW5peC9hZl91bml4LmMJMjAwNi0wMy0wNyAxMjoyNTowOC4wMDAwMDAw
MDAgLTA4MDANCkBAIC0xODc4LDYgKzE4NzgsOCBAQA0KIAkJbWFzayB8PSBQ
T0xMRVJSOw0KIAlpZiAoc2stPnNrX3NodXRkb3duID09IFNIVVRET1dOX01B
U0spDQogCQltYXNrIHw9IFBPTExIVVA7DQorCWlmIChzay0+c2tfc2h1dGRv
d24gJiBSQ1ZfU0hVVERPV04pDQorCQltYXNrIHw9IFBPTExSREhVUDsNCiAN
CiAJLyogcmVhZGFibGU/ICovDQogCWlmICghc2tiX3F1ZXVlX2VtcHR5KCZz
ay0+c2tfcmVjZWl2ZV9xdWV1ZSkgfHwNCg==

--8323328-1791953030-1141764767=:15576
Content-Type: TEXT/PLAIN; CHARSET=US-ASCII; NAME=epoll.h.diff
Content-Transfer-Encoding: BASE64
Content-Description: 
Content-Disposition: ATTACHMENT; FILENAME=epoll.h.diff

LS0tIGVwb2xsLmgub3JpZwkyMDA2LTAzLTA3IDEyOjMwOjU3LjAwMDAwMDAw
MCAtMDgwMA0KKysrIGVwb2xsLmgJMjAwNi0wMy0wNyAxMzoyNTowMy4wMDAw
MDAwMDAgLTA4MDANCkBAIC00NSw2ICs0NSw4IEBADQogI2RlZmluZSBFUE9M
TEVSUiBFUE9MTEVSUg0KICAgICBFUE9MTEhVUCA9IDB4MDEwLA0KICNkZWZp
bmUgRVBPTExIVVAgRVBPTExIVVANCisgICAgRVBPTExSREhVUCA9IDB4MjAw
MCwNCisjZGVmaW5lIEVQT0xMUkRIVVAgRVBPTExSREhVUA0KICAgICBFUE9M
TE9ORVNIT1QgPSAoMSA8PCAzMCksDQogI2RlZmluZSBFUE9MTE9ORVNIT1Qg
RVBPTExPTkVTSE9UDQogICAgIEVQT0xMRVQgPSAoMSA8PCAzMSkNCg==

--8323328-1791953030-1141764767=:15576--
