Return-Path: <linux-kernel-owner+willy=40w.ods.org-S262191AbUJZI1s@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S262191AbUJZI1s (ORCPT <rfc822;willy@w.ods.org>);
	Tue, 26 Oct 2004 04:27:48 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S262189AbUJZI1s
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Tue, 26 Oct 2004 04:27:48 -0400
Received: from apollo.nbase.co.il ([194.90.137.2]:28683 "EHLO
	apollo.nbase.co.il") by vger.kernel.org with ESMTP id S262186AbUJZI1j
	(ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Tue, 26 Oct 2004 04:27:39 -0400
Message-ID: <417E0AF5.8020000@mrv.com>
Date: Tue, 26 Oct 2004 10:29:41 +0200
From: emann@mrv.com (Eran Mann)
User-Agent: Mozilla Thunderbird 0.8 (X11/20040913)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: "K.R. Foley" <kr@cybsft.com>
CC: Florian Schmidt <mista.tapas@gmx.net>, Ingo Molnar <mingo@elte.hu>,
       linux-kernel@vger.kernel.org, Lee Revell <rlrevell@joe-job.com>,
       Rui Nuno Capela <rncbc@rncbc.org>, Mark_H_Johnson@Raytheon.com,
       Bill Huey <bhuey@lnxw.com>, Adam Heath <doogie@debian.org>,
       Thomas Gleixner <tglx@linutronix.de>,
       Michal Schmidt <xschmi00@stud.feec.vutbr.cz>,
       Fernando Pablo Lopez-Lezcano <nando@ccrma.Stanford.EDU>,
       Alexander Batyrshin <abatyrshin@ru.mvista.com>
Subject: Re: [patch] Real-Time Preemption, -RT-2.6.9-mm1-V0
References: <20041022133551.GA6954@elte.hu>	<20041022155048.GA16240@elte.hu>	<20041022175633.GA1864@elte.hu>	<20041025104023.GA1960@elte.hu>	<417CDE90.6040201@cybsft.com>	<20041025111046.GA3630@elte.hu>	<20041025121210.GA6555@elte.hu>	<20041025152458.3e62120a@mango.fruits.de>	<20041025132605.GA9516@elte.hu>	<20041025160330.394e9071@mango.fruits.de>	<20041025141008.GA13512@elte.hu> <20041025170612.6284923a@mango.fruits.de> <417D2D8F.8080904@cybsft.com>
In-Reply-To: <417D2D8F.8080904@cybsft.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

K.R. Foley wrote:
> Florian Schmidt wrote:
> 
>> doesn't seem so. V0.2 doesn't fix this for me. This time i got a BUG 
>> storm
>> again in syslog (it kinda seems related to starting playback in xmms plus
>> loading pages in mozilla. will boot again to verify):
>>
> 
> Well I have now gotten a couple of these now too (with V0.2). They all 
> seem to be generated by firefox or thunderbird and the traces are all 
> identical except for the offending process.
> 
> 
> Oct 25 11:22:11 swdev14 kernel:
> Oct 25 11:22:20 swdev14 kernel: thunderbird-bin/3946: BUG in futex_wait 
> at kernel/futex.c:542
> Oct 25 11:22:20 swdev14 kernel:  [<c0136389>] futex_wait+0x192/0x19c (12)
> Oct 25 11:22:20 swdev14 kernel:  [<c0135646>] 
> sub_preempt_count+0x75/0xd8 (72)
> Oct 25 11:22:20 swdev14 kernel:  [<c02aa9f2>] _spin_unlock+0x1a/0x34 (4)
> Oct 25 11:22:20 swdev14 kernel:  [<c02aa9f2>] _spin_unlock+0x1a/0x34 (84)
> Oct 25 11:22:20 swdev14 kernel:  [<c01120ac>] mcount+0x14/0x18 (4)
> Oct 25 11:22:20 swdev14 kernel:  [<c02aa9f2>] _spin_unlock+0x1a/0x34 (20)
> Oct 25 11:22:20 swdev14 kernel:  [<c0118e15>] 
> default_wake_function+0x0/0x1c (60)
> Oct 25 11:22:20 swdev14 kernel:  [<c0118e15>] 
> default_wake_function+0x0/0x1c (32)
> Oct 25 11:22:20 swdev14 kernel:  [<c0136777>] sys_futex+0xf0/0xfc (12)
> Oct 25 11:22:20 swdev14 kernel:  [<c01120ac>] mcount+0x14/0x18 (8)
> Oct 25 11:22:20 swdev14 kernel:  [<c0136637>] do_futex+0x47/0x97 (20)
> Oct 25 11:22:20 swdev14 kernel:  [<c0136777>] sys_futex+0xf0/0xfc (40)
> Oct 25 11:22:20 swdev14 kernel:  [<c010623d>] 
> sysenter_past_esp+0x52/0x71 (68)
> Oct 25 11:22:20 swdev14 kernel: preempt count: 00000001
> Oct 25 11:22:20 swdev14 kernel: . 1-level deep critical section nesting:
> Oct 25 11:22:20 swdev14 kernel: .. entry 1: print_traces+0x1d/0x59 
> [<c0135a28>] / (dump_stack+0x23/0x27 [<c01070db>])
> Oct 25 11:22:20 swdev14 kernel:
I see a lot of similar traces too on V0.2 (also either from firefox or 
thunderbird):
Oct 26 10:20:57 eran kernel: thunderbird-bin/4285: BUG in futex_wait at 
kernel/futex.c:542
Oct 26 10:20:57 eran kernel:  [<c01338d9>] futex_wait+0x1b9/0x1c0 (8)
Oct 26 10:20:57 eran kernel:  [<c0132b84>] 
check_preempt_timing+0x64/0x190 (80)
Oct 26 10:20:57 eran kernel:  [<c0132b84>] 
check_preempt_timing+0x64/0x190 (4)
Oct 26 10:20:57 eran kernel:  [<c01191f7>] recalc_task_prio+0xa7/0x1a0 (12)
Oct 26 10:20:57 eran kernel:  [<c0119785>] finish_task_switch+0x35/0xb0 (8)
Oct 26 10:20:57 eran kernel:  [<c011941a>] try_to_wake_up+0x8a/0xc0 (8)
Oct 26 10:20:57 eran kernel:  [<c01191f7>] recalc_task_prio+0xa7/0x1a0 (12)
Oct 26 10:20:57 eran kernel:  [<c01191f7>] recalc_task_prio+0xa7/0x1a0 (12)
Oct 26 10:20:57 eran kernel:  [<c01191f7>] recalc_task_prio+0xa7/0x1a0 (8)
Oct 26 10:20:57 eran kernel:  [<c0119785>] finish_task_switch+0x35/0xb0 (12)
Oct 26 10:20:57 eran kernel:  [<c01191f7>] recalc_task_prio+0xa7/0x1a0 (20)
Oct 26 10:20:57 eran kernel:  [<c0119785>] finish_task_switch+0x35/0xb0 (12)
Oct 26 10:20:57 eran kernel:  [<c0119e20>] 
default_wake_function+0x0/0x10 (64)
Oct 26 10:20:57 eran kernel:  [<c0119e20>] 
default_wake_function+0x0/0x10 (32)
Oct 26 10:20:57 eran kernel:  [<c0108609>] do_IRQ+0x39/0x60 (20)
Oct 26 10:20:57 eran kernel:  [<c0133b55>] do_futex+0x35/0x90 (20)
Oct 26 10:20:57 eran kernel:  [<c022cf3c>] copy_from_user+0x5c/0x90 (8)
Oct 26 10:20:57 eran kernel:  [<c0133c9a>] sys_futex+0xea/0x100 (16)
Oct 26 10:20:57 eran kernel:  [<c01060f9>] sysenter_past_esp+0x52/0x71 (56)
Oct 26 10:20:57 eran kernel: preempt count: 00000001
Oct 26 10:20:57 eran kernel: . 1-level deep critical section nesting:
Oct 26 10:20:57 eran kernel: .. entry 1: print_traces+0xd/0x40 
[<c0132f8d>] / (0x0 [<00000000>])

I also get these errors from 'tail -f /var/log/messages':
tail: cannot read realtime clock: Unknown error 516
(it seems to happen at the same time as the above traces, though less 
often).

-- 
Eran Mann
MRV International
Tel: 972-4-9936297
Fax: 972-4-9890430
www.mrv.com
