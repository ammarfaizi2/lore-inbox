Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261627AbUCPNmb (ORCPT <rfc822;willy@w.ods.org>);
	Tue, 16 Mar 2004 08:42:31 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261634AbUCPNma
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Tue, 16 Mar 2004 08:42:30 -0500
Received: from ns.suse.de ([195.135.220.2]:6885 "EHLO Cantor.suse.de")
	by vger.kernel.org with ESMTP id S261627AbUCPNm2 (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Tue, 16 Mar 2004 08:42:28 -0500
Date: Tue, 16 Mar 2004 14:42:26 +0100
Message-ID: <s5hk71kgb7h.wl@alsa2.suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Meelis Roos <mroos@linux.ee>
Cc: linux-kernel@vger.kernel.org
Subject: Re: Sound core broken on sparc64 (2.6.4+bk)
In-Reply-To: <Pine.GSO.4.44.0403161513470.29946-100000@math.ut.ee>
References: <s5hllm2gewj.wl@alsa2.suse.de>
	<Pine.GSO.4.44.0403161513470.29946-100000@math.ut.ee>
User-Agent: Wanderlust/2.10.1 (Watching The Wheels) SEMI/1.14.5 (Awara-Onsen) FLIM/1.14.5 (Demachiyanagi) APEL/10.6 MULE XEmacs/21.4 (patch 13) (Rational FORTRAN) (i386-suse-linux)
MIME-Version: 1.0 (generated by SEMI 1.14.5 - "Awara-Onsen")
Content-Type: multipart/mixed;
 boundary="Multipart_Tue_Mar_16_14:42:26_2004-1"
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

--Multipart_Tue_Mar_16_14:42:26_2004-1
Content-Type: text/plain; charset=US-ASCII

At Tue, 16 Mar 2004 15:28:00 +0200 (EET),
Meelis Roos wrote:
> 
> > the attached patch should fix.
> 
> Yes, thanks! This is also fixed in mainline by now.
> 
> Ths leads me to the next error:
> 
> sound/sparc/cs4231.c: In function `snd_cs4231_pcm':
> sound/sparc/cs4231.c:1573: error: `SNDRV_DMA_TYPE_PCI' undeclared (first use in this function)
> sound/sparc/cs4231.c:1573: error: (Each undeclared identifier is reported only once
> sound/sparc/cs4231.c:1573: error: for each function it appears in.)
> sound/sparc/cs4231.c:1575: error: parse error before numeric constant
> 
> SNDRV_DMA_TYPE_PCI used to be defined in <sound/memalloc.h> but is now
> gone.

grrr, it's a typo of SNDRV_DMA_TYPE_DEV.
thanks for the report.


Takashi

--Multipart_Tue_Mar_16_14:42:26_2004-1
Content-Type: text/plain; charset=US-ASCII

--- linux/sound/sparc/cs4231.c	6 Mar 2004 17:30:24 -0000	1.10
+++ linux/sound/sparc/cs4231.c	16 Mar 2004 13:40:15 -0000
@@ -1570,7 +1570,7 @@
 
 #ifdef EBUS_SUPPORT
 	if (chip->flags & CS4231_FLAG_EBUS) {
-		snd_pcm_lib_preallocate_pages_for_all(pcm, SNDRV_DMA_TYPE_PCI,
+		snd_pcm_lib_preallocate_pages_for_all(pcm, SNDRV_DMA_TYPE_DEV,
 						      snd_dma_pci_data(chip->dev_u.pdev)
 						      64*1024, 128*1024);
 	} else {

--Multipart_Tue_Mar_16_14:42:26_2004-1--
