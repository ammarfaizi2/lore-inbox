Return-Path: <linux-kernel-owner+willy=40w.ods.org-S262098AbUKPTOS@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S262098AbUKPTOS (ORCPT <rfc822;willy@w.ods.org>);
	Tue, 16 Nov 2004 14:14:18 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S262112AbUKPTOM
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Tue, 16 Nov 2004 14:14:12 -0500
Received: from mx1.redhat.com ([66.187.233.31]:20096 "EHLO mx1.redhat.com")
	by vger.kernel.org with ESMTP id S262107AbUKPTN6 (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Tue, 16 Nov 2004 14:13:58 -0500
From: David Howells <dhowells@redhat.com>
To: akpm@osdl.org, torvalds@osdl.org
cc: linux-kernel@vger.kernel.org
Subject: [PATCH] Remove obsolete hardirq stuff from frv includes
User-Agent: EMH/1.14.1 SEMI/1.14.5 (Awara-Onsen) FLIM/1.14.5 (Demachiyanagi) APEL/10.6 Emacs/21.3 (i386-redhat-linux-gnu) MULE/5.0 (SAKAKI)
MIME-Version: 1.0 (generated by SEMI 1.14.5 - "Awara-Onsen")
Content-Type: text/plain; charset=US-ASCII
Date: Tue, 16 Nov 2004 19:13:51 +0000
Message-ID: <3298.1100632431@redhat.com>
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org


The attached patch removes irq_enter() and friends from asm-frv/hardirq.h as
they are now mandatorily defined in linux/hardirq.h.

Signed-Off-By: David Howells <dhowells@redhat.com>
---
warthog>diffstat hardirq-2610rc2mm1.diff 
 hardirq.h |   13 -------------
 1 files changed, 13 deletions(-)

diff -uNrp /warthog/kernels/linux-2.6.10-rc2-mm1/include/asm-frv/hardirq.h linux-2.6.10-rc2-mm1-frv/include/asm-frv/hardirq.h
--- /warthog/kernels/linux-2.6.10-rc2-mm1/include/asm-frv/hardirq.h	2004-11-16 11:31:44.000000000 +0000
+++ linux-2.6.10-rc2-mm1-frv/include/asm-frv/hardirq.h	2004-11-16 11:35:51.421306453 +0000
@@ -22,19 +22,6 @@ typedef struct {
 
 #include <linux/irq_cpustat.h>	/* Standard mappings for irq_cpustat_t above */
 
-
-#define irq_enter()		(preempt_count() += HARDIRQ_OFFSET)
-#define nmi_enter()		(irq_enter())
-#define nmi_exit()		(preempt_count() -= HARDIRQ_OFFSET)
-
-#define irq_exit()							\
-do {									\
-	preempt_count() -= IRQ_EXIT_OFFSET;				\
-	if (!in_interrupt() && softirq_pending(smp_processor_id()))	\
-		do_softirq();						\
-	preempt_enable_no_resched();					\
-} while (0)
-
 #ifdef CONFIG_SMP
 #error SMP not available on FR-V
 #endif /* CONFIG_SMP */
