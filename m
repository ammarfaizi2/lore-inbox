Return-Path: <linux-kernel-owner+willy=40w.ods.org-S262689AbVBYM1Q@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S262689AbVBYM1Q (ORCPT <rfc822;willy@w.ods.org>);
	Fri, 25 Feb 2005 07:27:16 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S262686AbVBYM1P
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Fri, 25 Feb 2005 07:27:15 -0500
Received: from [195.23.16.24] ([195.23.16.24]:45263 "EHLO
	bipbip.comserver-pie.com") by vger.kernel.org with ESMTP
	id S262678AbVBYM05 (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Fri, 25 Feb 2005 07:26:57 -0500
Message-ID: <421F198E.1070503@grupopie.com>
Date: Fri, 25 Feb 2005 12:26:54 +0000
From: Paulo Marques <pmarques@grupopie.com>
Organization: Grupo PIE
User-Agent: Mozilla Thunderbird 0.7.1 (X11/20040626)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: Geert Uytterhoeven <geert@linux-m68k.org>
Cc: Linux Kernel Development <linux-kernel@vger.kernel.org>,
       Keith Owens <kaos@ocs.com.au>, Linux/m68k <linux-m68k@vger.kernel.org>
Subject: Re: Inconsistent kallsyms data (since 2.6.11-rc3 or so)
References: <Pine.LNX.4.62.0502251126090.28108@anakin>
In-Reply-To: <Pine.LNX.4.62.0502251126090.28108@anakin>
Content-Type: text/plain; charset=us-ascii; format=flowed
Content-Transfer-Encoding: 7bit
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Geert Uytterhoeven wrote:
> One of my m68k configs has been giving
> 
> | Inconsistent kallsyms data
> | Try setting CONFIG_KALLSYMS_EXTRA_PASS
> 
> since 2.6.11-rc3 or so. Setting CONFIG_KALLSYMS_EXTRA_PASS, or applying Keith
> Owen's patch to fix an issue for SH
> (http://seclists.org/lists/linux-kernel/2005/Jan/0017.html) doesn't help.

> The diffs between the human-readable tables (as generated by Keith's
> kallsyms_uncompress.pl) show lots of changes (see below).

There is something weird going on here.

For starters all the symbols that move are of type either '?'(unknown 
type) or 'b' (local bss).

 From the first to the second run a few more symbols pop up, and that 
moves symbols around. From a quick visual inspection I spotted these:

> +b log_start 	PTR	0x1b72c8
> +b con_start 	PTR	0x1b72cc
> +b log_end 	PTR	0x1b72d0

There might be a few more, but these would be enough to give problems.

Although marked as 'b' type, their addresses are between _sinittext and 
_einittext. These are actualy "local bss", static vars defined in printk.c.

So the question is: why don't they appear on the first link phase on m68k?

-- 
Paulo Marques - www.grupopie.com

All that is necessary for the triumph of evil is that good men do nothing.
Edmund Burke (1729 - 1797)
