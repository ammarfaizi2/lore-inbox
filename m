Return-Path: <linux-kernel-owner+willy=40w.ods.org-S933022AbWKLRZ3@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S933022AbWKLRZ3 (ORCPT <rfc822;willy@w.ods.org>);
	Sun, 12 Nov 2006 12:25:29 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S933023AbWKLRZ3
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Sun, 12 Nov 2006 12:25:29 -0500
Received: from bay0-omc1-s3.bay0.hotmail.com ([65.54.246.75]:15253 "EHLO
	bay0-omc1-s3.bay0.hotmail.com") by vger.kernel.org with ESMTP
	id S933022AbWKLRZ1 (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Sun, 12 Nov 2006 12:25:27 -0500
Message-ID: <BAY20-F13AD81001333138928FA8D8F50@phx.gbl>
X-Originating-IP: [80.178.43.168]
X-Originating-Email: [yan_952@hotmail.com]
From: "Burman Yan" <yan_952@hotmail.com>
To: trivial@kernel.org
Cc: linux-kernel@vger.kernel.org
Subject: [PATH] Replace kmalloc+memset with kzalloc 4/17
Date: Sun, 12 Nov 2006 19:25:24 +0200
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="----=_NextPart_000_4e53_6ed1_3d17"
X-OriginalArrivalTime: 12 Nov 2006 17:25:27.0370 (UTC) FILETIME=[8B7592A0:01C7067F]
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

This is a multi-part message in MIME format.

------=_NextPart_000_4e53_6ed1_3d17
Content-Type: text/plain; format=flowed

Part 4 of the kmalloc+memset to kzalloc patch

Yan Burman

_________________________________________________________________
Express yourself instantly with MSN Messenger! Download today it's FREE! 
http://messenger.msn.click-url.com/go/onm00200471ave/direct/01/

------=_NextPart_000_4e53_6ed1_3d17
Content-Type: application/octet-stream; name="kzalloc_driver_net_wlan.patch"
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename="kzalloc_driver_net_wlan.patch"

UmVwbGFjZSBrbWFsbG9jK21lbXNldCB3aXRoIGt6YWxsb2MgClBhdGNoIDQv
MTcKClNpZ25lZC1vZmYtYnk6IFlhbiBCdXJtYW4gPHlhbl85NTJAaG90bWFp
bC5jb20+CgpkaWZmIC1ydWJwIGxpbnV4LTIuNi4xOS1yYzVfb3JpZy9kcml2
ZXJzL25ldC93aXJlbGVzcy9ob3N0YXAvaG9zdGFwX2FwLmMgbGludXgtMi42
LjE5LXJjNV9remFsbG9jL2RyaXZlcnMvbmV0L3dpcmVsZXNzL2hvc3RhcC9o
b3N0YXBfYXAuYwotLS0gbGludXgtMi42LjE5LXJjNV9vcmlnL2RyaXZlcnMv
bmV0L3dpcmVsZXNzL2hvc3RhcC9ob3N0YXBfYXAuYwkyMDA2LTExLTA5IDEy
OjE2OjIxLjAwMDAwMDAwMCArMDIwMAorKysgbGludXgtMi42LjE5LXJjNV9r
emFsbG9jL2RyaXZlcnMvbmV0L3dpcmVsZXNzL2hvc3RhcC9ob3N0YXBfYXAu
YwkyMDA2LTExLTExIDIyOjQ0OjA0LjAwMDAwMDAwMCArMDIwMApAQCAtMTEw
MCwxNCArMTEwMCwxMyBAQCBzdGF0aWMgc3RydWN0IHN0YV9pbmZvICogYXBf
YWRkX3N0YShzdHJ1CiAJc3RydWN0IHN0YV9pbmZvICpzdGE7CiAKIAlzdGEg
PSAoc3RydWN0IHN0YV9pbmZvICopCi0JCWttYWxsb2Moc2l6ZW9mKHN0cnVj
dCBzdGFfaW5mbyksIEdGUF9BVE9NSUMpOworCQlremFsbG9jKHNpemVvZihz
dHJ1Y3Qgc3RhX2luZm8pLCBHRlBfQVRPTUlDKTsKIAlpZiAoc3RhID09IE5V
TEwpIHsKIAkJUERFQlVHKERFQlVHX0FQLCAiQVA6IGttYWxsb2MgZmFpbGVk
XG4iKTsKIAkJcmV0dXJuIE5VTEw7CiAJfQogCiAJLyogaW5pdGlhbGl6ZSBT
VEEgaW5mbyBkYXRhICovCi0JbWVtc2V0KHN0YSwgMCwgc2l6ZW9mKHN0cnVj
dCBzdGFfaW5mbykpOwogCXN0YS0+bG9jYWwgPSBhcC0+bG9jYWw7CiAJc2ti
X3F1ZXVlX2hlYWRfaW5pdCgmc3RhLT50eF9idWYpOwogCW1lbWNweShzdGEt
PmFkZHIsIGFkZHIsIEVUSF9BTEVOKTsKZGlmZiAtcnVicCBsaW51eC0yLjYu
MTktcmM1X29yaWcvZHJpdmVycy9uZXQvd2lyZWxlc3MvaG9zdGFwL2hvc3Rh
cF9jcy5jIGxpbnV4LTIuNi4xOS1yYzVfa3phbGxvYy9kcml2ZXJzL25ldC93
aXJlbGVzcy9ob3N0YXAvaG9zdGFwX2NzLmMKLS0tIGxpbnV4LTIuNi4xOS1y
YzVfb3JpZy9kcml2ZXJzL25ldC93aXJlbGVzcy9ob3N0YXAvaG9zdGFwX2Nz
LmMJMjAwNi0xMS0wOSAxMjoxNjoyMS4wMDAwMDAwMDAgKzAyMDAKKysrIGxp
bnV4LTIuNi4xOS1yYzVfa3phbGxvYy9kcml2ZXJzL25ldC93aXJlbGVzcy9o
b3N0YXAvaG9zdGFwX2NzLmMJMjAwNi0xMS0xMSAyMjo0NDowNC4wMDAwMDAw
MDAgKzAyMDAKQEAgLTU2NiwxMiArNTY2LDExIEBAIHN0YXRpYyBpbnQgcHJp
c20yX2NvbmZpZyhzdHJ1Y3QgcGNtY2lhX2QKIAlQREVCVUcoREVCVUdfRkxP
VywgInByaXNtMl9jb25maWcoKVxuIik7CiAKIAlwYXJzZSA9IGttYWxsb2Mo
c2l6ZW9mKGNpc3BhcnNlX3QpLCBHRlBfS0VSTkVMKTsKLQlod19wcml2ID0g
a21hbGxvYyhzaXplb2YoKmh3X3ByaXYpLCBHRlBfS0VSTkVMKTsKKwlod19w
cml2ID0ga3phbGxvYyhzaXplb2YoKmh3X3ByaXYpLCBHRlBfS0VSTkVMKTsK
IAlpZiAocGFyc2UgPT0gTlVMTCB8fCBod19wcml2ID09IE5VTEwpIHsKIAkJ
cmV0ID0gLUVOT01FTTsKIAkJZ290byBmYWlsZWQ7CiAJfQotCW1lbXNldCho
d19wcml2LCAwLCBzaXplb2YoKmh3X3ByaXYpKTsKIAogCXR1cGxlLkRlc2ly
ZWRUdXBsZSA9IENJU1RQTF9DT05GSUc7CiAJdHVwbGUuQXR0cmlidXRlcyA9
IDA7CmRpZmYgLXJ1YnAgbGludXgtMi42LjE5LXJjNV9vcmlnL2RyaXZlcnMv
bmV0L3dpcmVsZXNzL2hvc3RhcC9ob3N0YXBfZG93bmxvYWQuYyBsaW51eC0y
LjYuMTktcmM1X2t6YWxsb2MvZHJpdmVycy9uZXQvd2lyZWxlc3MvaG9zdGFw
L2hvc3RhcF9kb3dubG9hZC5jCi0tLSBsaW51eC0yLjYuMTktcmM1X29yaWcv
ZHJpdmVycy9uZXQvd2lyZWxlc3MvaG9zdGFwL2hvc3RhcF9kb3dubG9hZC5j
CTIwMDYtMTEtMDkgMTI6MTY6MjEuMDAwMDAwMDAwICswMjAwCisrKyBsaW51
eC0yLjYuMTktcmM1X2t6YWxsb2MvZHJpdmVycy9uZXQvd2lyZWxlc3MvaG9z
dGFwL2hvc3RhcF9kb3dubG9hZC5jCTIwMDYtMTEtMTEgMjI6NDQ6MDQuMDAw
MDAwMDAwICswMjAwCkBAIC02ODUsMTQgKzY4NSwxMiBAQCBzdGF0aWMgaW50
IHByaXNtMl9kb3dubG9hZChsb2NhbF9pbmZvX3QgCiAJCWdvdG8gb3V0Owog
CX0KIAotCWRsID0ga21hbGxvYyhzaXplb2YoKmRsKSArIHBhcmFtLT5udW1f
YXJlYXMgKgorCWRsID0ga3phbGxvYyhzaXplb2YoKmRsKSArIHBhcmFtLT5u
dW1fYXJlYXMgKgogCQkgICAgIHNpemVvZihzdHJ1Y3QgcHJpc20yX2Rvd25s
b2FkX2RhdGFfYXJlYSksIEdGUF9LRVJORUwpOwogCWlmIChkbCA9PSBOVUxM
KSB7CiAJCXJldCA9IC1FTk9NRU07CiAJCWdvdG8gb3V0OwogCX0KLQltZW1z
ZXQoZGwsIDAsIHNpemVvZigqZGwpICsgcGFyYW0tPm51bV9hcmVhcyAqCi0J
ICAgICAgIHNpemVvZihzdHJ1Y3QgcHJpc20yX2Rvd25sb2FkX2RhdGFfYXJl
YSkpOwogCWRsLT5kbF9jbWQgPSBwYXJhbS0+ZGxfY21kOwogCWRsLT5zdGFy
dF9hZGRyID0gcGFyYW0tPnN0YXJ0X2FkZHI7CiAJZGwtPm51bV9hcmVhcyA9
IHBhcmFtLT5udW1fYXJlYXM7CmRpZmYgLXJ1YnAgbGludXgtMi42LjE5LXJj
NV9vcmlnL2RyaXZlcnMvbmV0L3dpcmVsZXNzL2hvc3RhcC9ob3N0YXBfaHcu
YyBsaW51eC0yLjYuMTktcmM1X2t6YWxsb2MvZHJpdmVycy9uZXQvd2lyZWxl
c3MvaG9zdGFwL2hvc3RhcF9ody5jCi0tLSBsaW51eC0yLjYuMTktcmM1X29y
aWcvZHJpdmVycy9uZXQvd2lyZWxlc3MvaG9zdGFwL2hvc3RhcF9ody5jCTIw
MDYtMTEtMDkgMTI6MTY6MjEuMDAwMDAwMDAwICswMjAwCisrKyBsaW51eC0y
LjYuMTktcmM1X2t6YWxsb2MvZHJpdmVycy9uZXQvd2lyZWxlc3MvaG9zdGFw
L2hvc3RhcF9ody5jCTIwMDYtMTEtMTEgMjI6NDQ6MDQuMDAwMDAwMDAwICsw
MjAwCkBAIC0zNDgsMTMgKzM0OCwxMiBAQCBzdGF0aWMgaW50IGhmYTM4NHhf
Y21kKHN0cnVjdCBuZXRfZGV2aWNlCiAJCXJldHVybiAtRUlOVFI7CiAKIAll
bnRyeSA9IChzdHJ1Y3QgaG9zdGFwX2NtZF9xdWV1ZSAqKQotCQlrbWFsbG9j
KHNpemVvZigqZW50cnkpLCBHRlBfQVRPTUlDKTsKKwkJa3phbGxvYyhzaXpl
b2YoKmVudHJ5KSwgR0ZQX0FUT01JQyk7CiAJaWYgKGVudHJ5ID09IE5VTEwp
IHsKIAkJcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBoZmEzODR4X2NtZCAtIGtt
YWxsb2MgZmFpbGVkXG4iLAogCQkgICAgICAgZGV2LT5uYW1lKTsKIAkJcmV0
dXJuIC1FTk9NRU07CiAJfQotCW1lbXNldChlbnRyeSwgMCwgc2l6ZW9mKCpl
bnRyeSkpOwogCWF0b21pY19zZXQoJmVudHJ5LT51c2VjbnQsIDEpOwogCWVu
dHJ5LT50eXBlID0gQ01EX1NMRUVQOwogCWVudHJ5LT5jbWQgPSBjbWQ7CkBA
IC01MTgsMTMgKzUxNywxMiBAQCBzdGF0aWMgaW50IGhmYTM4NHhfY21kX2Nh
bGxiYWNrKHN0cnVjdCBuCiAJfQogCiAJZW50cnkgPSAoc3RydWN0IGhvc3Rh
cF9jbWRfcXVldWUgKikKLQkJa21hbGxvYyhzaXplb2YoKmVudHJ5KSwgR0ZQ
X0FUT01JQyk7CisJCWt6YWxsb2Moc2l6ZW9mKCplbnRyeSksIEdGUF9BVE9N
SUMpOwogCWlmIChlbnRyeSA9PSBOVUxMKSB7CiAJCXByaW50ayhLRVJOX0RF
QlVHICIlczogaGZhMzg0eF9jbWRfY2FsbGJhY2sgLSBrbWFsbG9jICIKIAkJ
ICAgICAgICJmYWlsZWRcbiIsIGRldi0+bmFtZSk7CiAJCXJldHVybiAtRU5P
TUVNOwogCX0KLQltZW1zZXQoZW50cnksIDAsIHNpemVvZigqZW50cnkpKTsK
IAlhdG9taWNfc2V0KCZlbnRyeS0+dXNlY250LCAxKTsKIAllbnRyeS0+dHlw
ZSA9IENNRF9DQUxMQkFDSzsKIAllbnRyeS0+Y21kID0gY21kOwpAQCAtMzAx
NiwxMyArMzAxNCwxMiBAQCBzdGF0aWMgaW50IHByaXNtMl9zZXRfdGltKHN0
cnVjdCBuZXRfZGV2CiAJbG9jYWwgPSBpZmFjZS0+bG9jYWw7CiAKIAluZXdf
ZW50cnkgPSAoc3RydWN0IHNldF90aW1fZGF0YSAqKQotCQlrbWFsbG9jKHNp
emVvZigqbmV3X2VudHJ5KSwgR0ZQX0FUT01JQyk7CisJCWt6YWxsb2Moc2l6
ZW9mKCpuZXdfZW50cnkpLCBHRlBfQVRPTUlDKTsKIAlpZiAobmV3X2VudHJ5
ID09IE5VTEwpIHsKIAkJcHJpbnRrKEtFUk5fREVCVUcgIiVzOiBwcmlzbTJf
c2V0X3RpbToga21hbGxvYyBmYWlsZWRcbiIsCiAJCSAgICAgICBsb2NhbC0+
ZGV2LT5uYW1lKTsKIAkJcmV0dXJuIC1FTk9NRU07CiAJfQotCW1lbXNldChu
ZXdfZW50cnksIDAsIHNpemVvZigqbmV3X2VudHJ5KSk7CiAJbmV3X2VudHJ5
LT5haWQgPSBhaWQ7CiAJbmV3X2VudHJ5LT5zZXQgPSBzZXQ7CiAKZGlmZiAt
cnVicCBsaW51eC0yLjYuMTktcmM1X29yaWcvZHJpdmVycy9uZXQvd2lyZWxl
c3MvaG9zdGFwL2hvc3RhcF9pbmZvLmMgbGludXgtMi42LjE5LXJjNV9remFs
bG9jL2RyaXZlcnMvbmV0L3dpcmVsZXNzL2hvc3RhcC9ob3N0YXBfaW5mby5j
Ci0tLSBsaW51eC0yLjYuMTktcmM1X29yaWcvZHJpdmVycy9uZXQvd2lyZWxl
c3MvaG9zdGFwL2hvc3RhcF9pbmZvLmMJMjAwNi0xMS0wOSAxMjoxNjoyMS4w
MDAwMDAwMDAgKzAyMDAKKysrIGxpbnV4LTIuNi4xOS1yYzVfa3phbGxvYy9k
cml2ZXJzL25ldC93aXJlbGVzcy9ob3N0YXAvaG9zdGFwX2luZm8uYwkyMDA2
LTExLTExIDIyOjQ0OjA0LjAwMDAwMDAwMCArMDIwMApAQCAtMzI3LDExICsz
MjcsMTAgQEAgc3RhdGljIHZvaWQgcHJpc20yX2luZm9faG9zdHNjYW5yZXN1
bHRzKAogCXB0ciA9ICh1OCAqKSBwb3M7CiAKIAluZXdfY291bnQgPSBsZWZ0
IC8gcmVzdWx0X3NpemU7Ci0JcmVzdWx0cyA9IGttYWxsb2MobmV3X2NvdW50
ICogc2l6ZW9mKHN0cnVjdCBoZmEzODR4X2hvc3RzY2FuX3Jlc3VsdCksCisJ
cmVzdWx0cyA9IGt6YWxsb2MobmV3X2NvdW50ICogc2l6ZW9mKHN0cnVjdCBo
ZmEzODR4X2hvc3RzY2FuX3Jlc3VsdCksCiAJCQkgIEdGUF9BVE9NSUMpOwog
CWlmIChyZXN1bHRzID09IE5VTEwpCiAJCXJldHVybjsKLQltZW1zZXQocmVz
dWx0cywgMCwgbmV3X2NvdW50ICogc2l6ZW9mKHN0cnVjdCBoZmEzODR4X2hv
c3RzY2FuX3Jlc3VsdCkpOwogCiAJZm9yIChpID0gMDsgaSA8IG5ld19jb3Vu
dDsgaSsrKSB7CiAJCW1lbWNweSgmcmVzdWx0c1tpXSwgcHRyLCBjb3B5X2xl
bik7CmRpZmYgLXJ1YnAgbGludXgtMi42LjE5LXJjNV9vcmlnL2RyaXZlcnMv
bmV0L3dpcmVsZXNzL2hvc3RhcC9ob3N0YXBfaW9jdGwuYyBsaW51eC0yLjYu
MTktcmM1X2t6YWxsb2MvZHJpdmVycy9uZXQvd2lyZWxlc3MvaG9zdGFwL2hv
c3RhcF9pb2N0bC5jCi0tLSBsaW51eC0yLjYuMTktcmM1X29yaWcvZHJpdmVy
cy9uZXQvd2lyZWxlc3MvaG9zdGFwL2hvc3RhcF9pb2N0bC5jCTIwMDYtMTEt
MDkgMTI6MTY6MjEuMDAwMDAwMDAwICswMjAwCisrKyBsaW51eC0yLjYuMTkt
cmM1X2t6YWxsb2MvZHJpdmVycy9uZXQvd2lyZWxlc3MvaG9zdGFwL2hvc3Rh
cF9pb2N0bC5jCTIwMDYtMTEtMTEgMjI6NDQ6MDQuMDAwMDAwMDAwICswMjAw
CkBAIC0xODIsMTEgKzE4MiwxMCBAQCBzdGF0aWMgaW50IHByaXNtMl9pb2N0
bF9zaXdlbmNvZGUoc3RydWN0CiAKIAkJLyogdGFrZSBXRVAgaW50byB1c2Ug
Ki8KIAkJbmV3X2NyeXB0ID0gKHN0cnVjdCBpZWVlODAyMTFfY3J5cHRfZGF0
YSAqKQotCQkJa21hbGxvYyhzaXplb2Yoc3RydWN0IGllZWU4MDIxMV9jcnlw
dF9kYXRhKSwKKwkJCWt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBpZWVlODAyMTFf
Y3J5cHRfZGF0YSksCiAJCQkJR0ZQX0tFUk5FTCk7CiAJCWlmIChuZXdfY3J5
cHQgPT0gTlVMTCkKIAkJCXJldHVybiAtRU5PTUVNOwotCQltZW1zZXQobmV3
X2NyeXB0LCAwLCBzaXplb2Yoc3RydWN0IGllZWU4MDIxMV9jcnlwdF9kYXRh
KSk7CiAJCW5ld19jcnlwdC0+b3BzID0gaWVlZTgwMjExX2dldF9jcnlwdG9f
b3BzKCJXRVAiKTsKIAkJaWYgKCFuZXdfY3J5cHQtPm9wcykgewogCQkJcmVx
dWVzdF9tb2R1bGUoImllZWU4MDIxMV9jcnlwdF93ZXAiKTsKQEAgLTMzMjEs
MTMgKzMzMjAsMTIgQEAgc3RhdGljIGludCBwcmlzbTJfaW9jdGxfc2l3ZW5j
b2RlZXh0KHN0cgogCQlwcmlzbTJfY3J5cHRfZGVsYXllZF9kZWluaXQobG9j
YWwsIGNyeXB0KTsKIAogCQluZXdfY3J5cHQgPSAoc3RydWN0IGllZWU4MDIx
MV9jcnlwdF9kYXRhICopCi0JCQlrbWFsbG9jKHNpemVvZihzdHJ1Y3QgaWVl
ZTgwMjExX2NyeXB0X2RhdGEpLAorCQkJa3phbGxvYyhzaXplb2Yoc3RydWN0
IGllZWU4MDIxMV9jcnlwdF9kYXRhKSwKIAkJCQlHRlBfS0VSTkVMKTsKIAkJ
aWYgKG5ld19jcnlwdCA9PSBOVUxMKSB7CiAJCQlyZXQgPSAtRU5PTUVNOwog
CQkJZ290byBkb25lOwogCQl9Ci0JCW1lbXNldChuZXdfY3J5cHQsIDAsIHNp
emVvZihzdHJ1Y3QgaWVlZTgwMjExX2NyeXB0X2RhdGEpKTsKIAkJbmV3X2Ny
eXB0LT5vcHMgPSBvcHM7CiAJCW5ld19jcnlwdC0+cHJpdiA9IG5ld19jcnlw
dC0+b3BzLT5pbml0KGkpOwogCQlpZiAobmV3X2NyeXB0LT5wcml2ID09IE5V
TEwpIHsKQEAgLTM1MzksMTMgKzM1MzcsMTIgQEAgc3RhdGljIGludCBwcmlz
bTJfaW9jdGxfc2V0X2VuY3J5cHRpb24obAogCQlwcmlzbTJfY3J5cHRfZGVs
YXllZF9kZWluaXQobG9jYWwsIGNyeXB0KTsKIAogCQluZXdfY3J5cHQgPSAo
c3RydWN0IGllZWU4MDIxMV9jcnlwdF9kYXRhICopCi0JCQlrbWFsbG9jKHNp
emVvZihzdHJ1Y3QgaWVlZTgwMjExX2NyeXB0X2RhdGEpLAorCQkJa3phbGxv
YyhzaXplb2Yoc3RydWN0IGllZWU4MDIxMV9jcnlwdF9kYXRhKSwKIAkJCQlH
RlBfS0VSTkVMKTsKIAkJaWYgKG5ld19jcnlwdCA9PSBOVUxMKSB7CiAJCQly
ZXQgPSAtRU5PTUVNOwogCQkJZ290byBkb25lOwogCQl9Ci0JCW1lbXNldChu
ZXdfY3J5cHQsIDAsIHNpemVvZihzdHJ1Y3QgaWVlZTgwMjExX2NyeXB0X2Rh
dGEpKTsKIAkJbmV3X2NyeXB0LT5vcHMgPSBvcHM7CiAJCW5ld19jcnlwdC0+
cHJpdiA9IG5ld19jcnlwdC0+b3BzLT5pbml0KHBhcmFtLT51LmNyeXB0Lmlk
eCk7CiAJCWlmIChuZXdfY3J5cHQtPnByaXYgPT0gTlVMTCkgewpkaWZmIC1y
dWJwIGxpbnV4LTIuNi4xOS1yYzVfb3JpZy9kcml2ZXJzL25ldC93aXJlbGVz
cy9ob3N0YXAvaG9zdGFwX3BjaS5jIGxpbnV4LTIuNi4xOS1yYzVfa3phbGxv
Yy9kcml2ZXJzL25ldC93aXJlbGVzcy9ob3N0YXAvaG9zdGFwX3BjaS5jCi0t
LSBsaW51eC0yLjYuMTktcmM1X29yaWcvZHJpdmVycy9uZXQvd2lyZWxlc3Mv
aG9zdGFwL2hvc3RhcF9wY2kuYwkyMDA2LTExLTA5IDEyOjE2OjIxLjAwMDAw
MDAwMCArMDIwMAorKysgbGludXgtMi42LjE5LXJjNV9remFsbG9jL2RyaXZl
cnMvbmV0L3dpcmVsZXNzL2hvc3RhcC9ob3N0YXBfcGNpLmMJMjAwNi0xMS0x
MSAyMjo0NDowNC4wMDAwMDAwMDAgKzAyMDAKQEAgLTMwMCwxMCArMzAwLDkg
QEAgc3RhdGljIGludCBwcmlzbTJfcGNpX3Byb2JlKHN0cnVjdCBwY2lfZAog
CXN0cnVjdCBob3N0YXBfaW50ZXJmYWNlICppZmFjZTsKIAlzdHJ1Y3QgaG9z
dGFwX3BjaV9wcml2ICpod19wcml2OwogCi0JaHdfcHJpdiA9IGttYWxsb2Mo
c2l6ZW9mKCpod19wcml2KSwgR0ZQX0tFUk5FTCk7CisJaHdfcHJpdiA9IGt6
YWxsb2Moc2l6ZW9mKCpod19wcml2KSwgR0ZQX0tFUk5FTCk7CiAJaWYgKGh3
X3ByaXYgPT0gTlVMTCkKIAkJcmV0dXJuIC1FTk9NRU07Ci0JbWVtc2V0KGh3
X3ByaXYsIDAsIHNpemVvZigqaHdfcHJpdikpOwogCiAJaWYgKHBjaV9lbmFi
bGVfZGV2aWNlKHBkZXYpKQogCQlnb3RvIGVycl9vdXRfZnJlZTsKZGlmZiAt
cnVicCBsaW51eC0yLjYuMTktcmM1X29yaWcvZHJpdmVycy9uZXQvd2lyZWxl
c3MvaG9zdGFwL2hvc3RhcF9wbHguYyBsaW51eC0yLjYuMTktcmM1X2t6YWxs
b2MvZHJpdmVycy9uZXQvd2lyZWxlc3MvaG9zdGFwL2hvc3RhcF9wbHguYwot
LS0gbGludXgtMi42LjE5LXJjNV9vcmlnL2RyaXZlcnMvbmV0L3dpcmVsZXNz
L2hvc3RhcC9ob3N0YXBfcGx4LmMJMjAwNi0xMS0wOSAxMjoxNjoyMS4wMDAw
MDAwMDAgKzAyMDAKKysrIGxpbnV4LTIuNi4xOS1yYzVfa3phbGxvYy9kcml2
ZXJzL25ldC93aXJlbGVzcy9ob3N0YXAvaG9zdGFwX3BseC5jCTIwMDYtMTEt
MTEgMjI6NDQ6MDQuMDAwMDAwMDAwICswMjAwCkBAIC00NDcsMTAgKzQ0Nyw5
IEBAIHN0YXRpYyBpbnQgcHJpc20yX3BseF9wcm9iZShzdHJ1Y3QgcGNpX2QK
IAlpbnQgdG1kNzE2MDsKIAlzdHJ1Y3QgaG9zdGFwX3BseF9wcml2ICpod19w
cml2OwogCi0JaHdfcHJpdiA9IGttYWxsb2Moc2l6ZW9mKCpod19wcml2KSwg
R0ZQX0tFUk5FTCk7CisJaHdfcHJpdiA9IGt6YWxsb2Moc2l6ZW9mKCpod19w
cml2KSwgR0ZQX0tFUk5FTCk7CiAJaWYgKGh3X3ByaXYgPT0gTlVMTCkKIAkJ
cmV0dXJuIC1FTk9NRU07Ci0JbWVtc2V0KGh3X3ByaXYsIDAsIHNpemVvZigq
aHdfcHJpdikpOwogCiAJaWYgKHBjaV9lbmFibGVfZGV2aWNlKHBkZXYpKQog
CQlnb3RvIGVycl9vdXRfZnJlZTsKZGlmZiAtcnVicCBsaW51eC0yLjYuMTkt
cmM1X29yaWcvZHJpdmVycy9uZXQvd2lyZWxlc3MvaXB3MjIwMC5jIGxpbnV4
LTIuNi4xOS1yYzVfa3phbGxvYy9kcml2ZXJzL25ldC93aXJlbGVzcy9pcHcy
MjAwLmMKLS0tIGxpbnV4LTIuNi4xOS1yYzVfb3JpZy9kcml2ZXJzL25ldC93
aXJlbGVzcy9pcHcyMjAwLmMJMjAwNi0xMS0wOSAxMjoxNjoyMS4wMDAwMDAw
MDAgKzAyMDAKKysrIGxpbnV4LTIuNi4xOS1yYzVfa3phbGxvYy9kcml2ZXJz
L25ldC93aXJlbGVzcy9pcHcyMjAwLmMJMjAwNi0xMS0xMSAyMjo0NDowNC4w
MDAwMDAwMDAgKzAyMDAKQEAgLTExMTI5LDE0ICsxMTEyOSwxMyBAQCBzdGF0
aWMgaW50IGlwd191cChzdHJ1Y3QgaXB3X3ByaXYgKnByaXYpCiAJCXJldHVy
biAtRUlPOwogCiAJaWYgKGNtZGxvZyAmJiAhcHJpdi0+Y21kbG9nKSB7Ci0J
CXByaXYtPmNtZGxvZyA9IGttYWxsb2Moc2l6ZW9mKCpwcml2LT5jbWRsb2cp
ICogY21kbG9nLAorCQlwcml2LT5jbWRsb2cgPSBremFsbG9jKHNpemVvZigq
cHJpdi0+Y21kbG9nKSAqIGNtZGxvZywKIAkJCQkgICAgICAgR0ZQX0tFUk5F
TCk7CiAJCWlmIChwcml2LT5jbWRsb2cgPT0gTlVMTCkgewogCQkJSVBXX0VS
Uk9SKCJFcnJvciBhbGxvY2F0aW5nICVkIGNvbW1hbmQgbG9nIGVudHJpZXMu
XG4iLAogCQkJCSAgY21kbG9nKTsKIAkJCXJldHVybiAtRU5PTUVNOwogCQl9
IGVsc2UgewotCQkJbWVtc2V0KHByaXYtPmNtZGxvZywgMCwgc2l6ZW9mKCpw
cml2LT5jbWRsb2cpICogY21kbG9nKTsKIAkJCXByaXYtPmNtZGxvZ19sZW4g
PSBjbWRsb2c7CiAJCX0KIAl9CmRpZmYgLXJ1YnAgbGludXgtMi42LjE5LXJj
NV9vcmlnL2RyaXZlcnMvbmV0L3dpcmVsZXNzL3ByaXNtNTQvaXNsX2lvY3Rs
LmMgbGludXgtMi42LjE5LXJjNV9remFsbG9jL2RyaXZlcnMvbmV0L3dpcmVs
ZXNzL3ByaXNtNTQvaXNsX2lvY3RsLmMKLS0tIGxpbnV4LTIuNi4xOS1yYzVf
b3JpZy9kcml2ZXJzL25ldC93aXJlbGVzcy9wcmlzbTU0L2lzbF9pb2N0bC5j
CTIwMDYtMTEtMDkgMTI6MTY6MjEuMDAwMDAwMDAwICswMjAwCisrKyBsaW51
eC0yLjYuMTktcmM1X2t6YWxsb2MvZHJpdmVycy9uZXQvd2lyZWxlc3MvcHJp
c201NC9pc2xfaW9jdGwuYwkyMDA2LTExLTExIDIyOjQ0OjA0LjAwMDAwMDAw
MCArMDIwMApAQCAtMjE0MSwxMSArMjE0MSw5IEBAIHByaXNtNTRfd3BhX2Jz
c19pZV9hZGQoaXNscGNpX3ByaXZhdGUgKnAKIAkJCQkJIHN0cnVjdCBpc2xw
Y2lfYnNzX3dwYV9pZSwgbGlzdCk7CiAJCQlsaXN0X2RlbCgmYnNzLT5saXN0
KTsKIAkJfSBlbHNlIHsKLQkJCWJzcyA9IGttYWxsb2Moc2l6ZW9mICgqYnNz
KSwgR0ZQX0FUT01JQyk7Ci0JCQlpZiAoYnNzICE9IE5VTEwpIHsKKwkJCWJz
cyA9IGt6YWxsb2Moc2l6ZW9mICgqYnNzKSwgR0ZQX0FUT01JQyk7CisJCQlp
ZiAoYnNzICE9IE5VTEwpCiAJCQkJcHJpdi0+bnVtX2Jzc193cGErKzsKLQkJ
CQltZW1zZXQoYnNzLCAwLCBzaXplb2YgKCpic3MpKTsKLQkJCX0KIAkJfQog
CQlpZiAoYnNzICE9IE5VTEwpIHsKIAkJCW1lbWNweShic3MtPmJzc2lkLCBi
c3NpZCwgRVRIX0FMRU4pOwpAQCAtMjY4NSwxMSArMjY4MywxMCBAQCBwcmlz
bTJfaW9jdGxfc2V0X2dlbmVyaWNfZWxlbWVudChzdHJ1Y3QgCiAgICAgICAg
ICAgICAgICByZXR1cm4gLUVJTlZBTDsKIAogICAgICAgIGFsZW4gPSBzaXpl
b2YoKmF0dGFjaCkgKyBsZW47Ci0gICAgICAgYXR0YWNoID0ga21hbGxvYyhh
bGVuLCBHRlBfS0VSTkVMKTsKKyAgICAgICBhdHRhY2ggPSBremFsbG9jKGFs
ZW4sIEdGUF9LRVJORUwpOwogICAgICAgIGlmIChhdHRhY2ggPT0gTlVMTCkK
ICAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwogCi0gICAgICAgbWVt
c2V0KGF0dGFjaCwgMCwgYWxlbik7CiAjZGVmaW5lIFdMQU5fRkNfVFlQRV9N
R01UIDAKICNkZWZpbmUgV0xBTl9GQ19TVFlQRV9BU1NPQ19SRVEgMAogI2Rl
ZmluZSBXTEFOX0ZDX1NUWVBFX1JFQVNTT0NfUkVRIDIKZGlmZiAtcnVicCBs
aW51eC0yLjYuMTktcmM1X29yaWcvZHJpdmVycy9uZXQvd2lyZWxlc3MvcHJp
c201NC9vaWRfbWd0LmMgbGludXgtMi42LjE5LXJjNV9remFsbG9jL2RyaXZl
cnMvbmV0L3dpcmVsZXNzL3ByaXNtNTQvb2lkX21ndC5jCi0tLSBsaW51eC0y
LjYuMTktcmM1X29yaWcvZHJpdmVycy9uZXQvd2lyZWxlc3MvcHJpc201NC9v
aWRfbWd0LmMJMjAwNi0xMS0wOSAxMjoxNjoyMS4wMDAwMDAwMDAgKzAyMDAK
KysrIGxpbnV4LTIuNi4xOS1yYzVfa3phbGxvYy9kcml2ZXJzL25ldC93aXJl
bGVzcy9wcmlzbTU0L29pZF9tZ3QuYwkyMDA2LTExLTExIDIyOjQ0OjA0LjAw
MDAwMDAwMCArMDIwMApAQCAtMjM1LDEyICsyMzUsMTAgQEAgbWd0X2luaXQo
aXNscGNpX3ByaXZhdGUgKnByaXYpCiB7CiAJaW50IGk7CiAKLQlwcml2LT5t
aWIgPSBrbWFsbG9jKE9JRF9OVU1fTEFTVCAqIHNpemVvZiAodm9pZCAqKSwg
R0ZQX0tFUk5FTCk7CisJcHJpdi0+bWliID0ga3phbGxvYyhPSURfTlVNX0xB
U1QgKiBzaXplb2YgKHZvaWQgKiksIEdGUF9LRVJORUwpOwogCWlmICghcHJp
di0+bWliKQogCQlyZXR1cm4gLUVOT01FTTsKIAotCW1lbXNldChwcml2LT5t
aWIsIDAsIE9JRF9OVU1fTEFTVCAqIHNpemVvZiAodm9pZCAqKSk7Ci0KIAkv
KiBBbGxvYyB0aGUgY2FjaGUgKi8KIAlmb3IgKGkgPSAwOyBpIDwgT0lEX05V
TV9MQVNUOyBpKyspIHsKIAkJaWYgKGlzbF9vaWRbaV0uZmxhZ3MgJiBPSURf
RkxBR19DQUNIRUQpIHsKZGlmZiAtcnVicCBsaW51eC0yLjYuMTktcmM1X29y
aWcvZHJpdmVycy9uZXQvd2lyZWxlc3MvemQxMjAxLmMgbGludXgtMi42LjE5
LXJjNV9remFsbG9jL2RyaXZlcnMvbmV0L3dpcmVsZXNzL3pkMTIwMS5jCi0t
LSBsaW51eC0yLjYuMTktcmM1X29yaWcvZHJpdmVycy9uZXQvd2lyZWxlc3Mv
emQxMjAxLmMJMjAwNi0xMS0wOSAxMjoxNjoyMS4wMDAwMDAwMDAgKzAyMDAK
KysrIGxpbnV4LTIuNi4xOS1yYzVfa3phbGxvYy9kcml2ZXJzL25ldC93aXJl
bGVzcy96ZDEyMDEuYwkyMDA2LTExLTExIDIyOjQ0OjE4LjAwMDAwMDAwMCAr
MDIwMApAQCAtNTI0LDcgKzUyNCw3IEBAIHN0YXRpYyBpbnQgemQxMjAxX3Nl
dGNvbmZpZyhzdHJ1Y3QgemQxMjAKIAl6ZC0+cnhkYXRhcyA9IDA7CiAJemQt
PnJ4bGVuID0gMDsKIAlmb3IgKHNlcT0wOyBsZW4gPiAwOyBzZXErKykgewot
CQlyZXF1ZXN0ID0ga21hbGxvYygxNiwgZ2ZwX21hc2spOworCQlyZXF1ZXN0
ID0ga3phbGxvYygxNiwgZ2ZwX21hc2spOwogCQlpZiAoIXJlcXVlc3QpCiAJ
CQlyZXR1cm4gLUVOT01FTTsKIAkJdXJiID0gdXNiX2FsbG9jX3VyYigwLCBn
ZnBfbWFzayk7CkBAIC01MzIsNyArNTMyLDYgQEAgc3RhdGljIGludCB6ZDEy
MDFfc2V0Y29uZmlnKHN0cnVjdCB6ZDEyMAogCQkJa2ZyZWUocmVxdWVzdCk7
CiAJCQlyZXR1cm4gLUVOT01FTTsKIAkJfQotCQltZW1zZXQocmVxdWVzdCwg
MCwgMTYpOwogCQlyZXFsZW4gPSBsZW4+MTIgPyAxMiA6IGxlbjsKIAkJcmVx
dWVzdFswXSA9IFpEMTIwMV9VU0JfUkVTUkVROwogCQlyZXF1ZXN0WzFdID0g
c2VxOwpkaWZmIC1ydWJwIGxpbnV4LTIuNi4xOS1yYzVfb3JpZy9uZXQvaWVl
ZTgwMjExL2llZWU4MDIxMV9tb2R1bGUuYyBsaW51eC0yLjYuMTktcmM1X2t6
YWxsb2MvbmV0L2llZWU4MDIxMS9pZWVlODAyMTFfbW9kdWxlLmMKLS0tIGxp
bnV4LTIuNi4xOS1yYzVfb3JpZy9uZXQvaWVlZTgwMjExL2llZWU4MDIxMV9t
b2R1bGUuYwkyMDA2LTExLTA5IDEyOjE2OjIxLjAwMDAwMDAwMCArMDIwMAor
KysgbGludXgtMi42LjE5LXJjNV9remFsbG9jL25ldC9pZWVlODAyMTEvaWVl
ZTgwMjExX21vZHVsZS5jCTIwMDYtMTEtMTEgMjI6NDQ6MTguMDAwMDAwMDAw
ICswMjAwCkBAIC02Nyw3ICs2Nyw3IEBAIHN0YXRpYyBpbnQgaWVlZTgwMjEx
X25ldHdvcmtzX2FsbG9jYXRlKHMKIAkJcmV0dXJuIDA7CiAKIAlpZWVlLT5u
ZXR3b3JrcyA9Ci0JICAgIGttYWxsb2MoTUFYX05FVFdPUktfQ09VTlQgKiBz
aXplb2Yoc3RydWN0IGllZWU4MDIxMV9uZXR3b3JrKSwKKwkgICAga3phbGxv
YyhNQVhfTkVUV09SS19DT1VOVCAqIHNpemVvZihzdHJ1Y3QgaWVlZTgwMjEx
X25ldHdvcmspLAogCQkgICAgR0ZQX0tFUk5FTCk7CiAJaWYgKCFpZWVlLT5u
ZXR3b3JrcykgewogCQlwcmludGsoS0VSTl9XQVJOSU5HICIlczogT3V0IG9m
IG1lbW9yeSBhbGxvY2F0aW5nIGJlYWNvbnNcbiIsCkBAIC03NSw5ICs3NSw2
IEBAIHN0YXRpYyBpbnQgaWVlZTgwMjExX25ldHdvcmtzX2FsbG9jYXRlKHMK
IAkJcmV0dXJuIC1FTk9NRU07CiAJfQogCi0JbWVtc2V0KGllZWUtPm5ldHdv
cmtzLCAwLAotCSAgICAgICBNQVhfTkVUV09SS19DT1VOVCAqIHNpemVvZihz
dHJ1Y3QgaWVlZTgwMjExX25ldHdvcmspKTsKLQogCXJldHVybiAwOwogfQog
Cg==


------=_NextPart_000_4e53_6ed1_3d17--
