Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S267185AbTBDJhI>; Tue, 4 Feb 2003 04:37:08 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S267191AbTBDJhI>; Tue, 4 Feb 2003 04:37:08 -0500
Received: from caramon.arm.linux.org.uk ([212.18.232.186]:49674 "EHLO
	caramon.arm.linux.org.uk") by vger.kernel.org with ESMTP
	id <S267185AbTBDJhG>; Tue, 4 Feb 2003 04:37:06 -0500
Date: Tue, 4 Feb 2003 09:46:34 +0000
From: Russell King <rmk@arm.linux.org.uk>
To: Adam Belay <ambx1@neo.rr.com>, Jaroslav Kysela <perex@perex.cz>,
       "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
       "greg@kroah.com" <greg@kroah.com>, Alan Cox <alan@lxorguk.ukuu.org.uk>
Subject: Re: PnP model
Message-ID: <20030204094634.A11346@flint.arm.linux.org.uk>
Mail-Followup-To: Adam Belay <ambx1@neo.rr.com>,
	Jaroslav Kysela <perex@perex.cz>,
	"linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
	"greg@kroah.com" <greg@kroah.com>,
	Alan Cox <alan@lxorguk.ukuu.org.uk>
References: <20030202203641.GA22089@neo.rr.com> <Pine.LNX.4.44.0302031437310.1116-100000@pnote.perex-int.cz> <20030203204325.GA7425@neo.rr.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5.1i
In-Reply-To: <20030203204325.GA7425@neo.rr.com>; from ambx1@neo.rr.com on Mon, Feb 03, 2003 at 08:43:25PM +0000
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

On Mon, Feb 03, 2003 at 08:43:25PM +0000, Adam Belay wrote:
> In many cases, Auto configuration can be better then manual configuration.
> 1.) The auto configuration engine in my patch is able to resolve almost any
> resource conflict and provides the greatest chance for all devices to have
> resources allocated.

There is a nice problem with ISA PNP serial ports generated by this
type of thing in 2.5.59.

On boot, we probe for the usual serial ports, and discover two at
0x3f8 and 0x2f8, and we request these resources.  Please note that
one port could be in use as a serial console from earlier in the
bootup.

Then, we move on to the PNP probes.  The PNP layer gives us two
serial ports, and we initialise them.  The PNP layer notices that
the resources for 0x3f8 and 0x2f8, and re-assigns the ports to
0x3e8 and 0x2e8.  The serial layer finds two extra ports at
0x3e8 and 0x2e8.

However, the ports at 0x3f8 and 0x2f8 are now gone, along with the
serial console, and the boot messages claim that we have four serial
ports at ttyS0, ttyS1, ttyS2, and ttyS3, when the machine in fact
only has two serial ports.  The serial layer likewise believes we
have four serial ports.

I look forward to your thoughts on getting around this problem.

-- 
Russell King (rmk@arm.linux.org.uk)                The developer of ARM Linux
             http://www.arm.linux.org.uk/personal/aboutme.html

