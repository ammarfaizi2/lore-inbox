Return-Path: <linux-kernel-owner+willy=40w.ods.org-S261232AbVDNQmi@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261232AbVDNQmi (ORCPT <rfc822;willy@w.ods.org>);
	Thu, 14 Apr 2005 12:42:38 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261542AbVDNQmi
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Thu, 14 Apr 2005 12:42:38 -0400
Received: from sigma957.CIS.McMaster.CA ([130.113.64.83]:57069 "EHLO
	sigma957.cis.mcmaster.ca") by vger.kernel.org with ESMTP
	id S261232AbVDNQlE (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Thu, 14 Apr 2005 12:41:04 -0400
Subject: [patch] inotify 0.22-2
From: John McCutchan <ttb@tentacle.dhs.org>
To: linux-kernel@vger.kernel.org, Andrew Morton <akpm@osdl.org>
Content-Type: multipart/mixed; boundary="=-rEd1m2fod+9RMM/DgPRp"
Date: Thu, 14 Apr 2005 12:42:17 -0400
Message-Id: <1113496937.17575.3.camel@vertex>
Mime-Version: 1.0
X-Mailer: Evolution 2.2.1.1 
X-PMX-Version-Mac: 4.7.1.128075, Antispam-Engine: 2.0.3.1, Antispam-Data: 2005.4.14.8
X-PerlMx-Spam: Gauge=IIIIIII, Probability=7%, Report='__CT 0, __CTYPE_HAS_BOUNDARY 0, __CTYPE_MULTIPART 0, __HAS_MSGID 0, __HAS_X_MAILER 0, __MIME_VERSION 0, __SANE_MSGID 0'
X-Spam-Flag: NO
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org


--=-rEd1m2fod+9RMM/DgPRp
Content-Type: text/plain
Content-Transfer-Encoding: 7bit

Attached is inotify 0.22-2 against 2.6.12-rc2-mm1.

This release fixes an OOPs introduced in inotify 0.22.

-- 
John McCutchan <ttb@tentacle.dhs.org>

--=-rEd1m2fod+9RMM/DgPRp
Content-Disposition: attachment; filename=inotify-0.22-rml-2.6.12-rc2-mm1-2.patch
Content-Transfer-Encoding: base64
Content-Type: text/x-patch; name=inotify-0.22-rml-2.6.12-rc2-mm1-2.patch; charset=UTF-8

aW5vdGlmeSENCg0KaW5vdGlmeSBpcyBpbnRlbmRlZCB0byBjb3JyZWN0IHRoZSBkZWZpY2llbmNp
ZXMgb2YgZG5vdGlmeSwgcGFydGljdWxhcmx5DQppdHMgaW5hYmlsaXR5IHRvIHNjYWxlIGFuZCBp
dHMgdGVycmlibGUgdXNlciBpbnRlcmZhY2U6DQoNCiAgICAgICAgKiBkbm90aWZ5IHJlcXVpcmVz
IHRoZSBvcGVuaW5nIG9mIG9uZSBmZCBwZXIgZWFjaCBkaXJlY3RvcnkNCiAgICAgICAgICB0aGF0
IHlvdSBpbnRlbmQgdG8gd2F0Y2guIFRoaXMgcXVpY2tseSByZXN1bHRzIGluIHRvbyBtYW55DQog
ICAgICAgICAgb3BlbiBmaWxlcyBhbmQgcGlucyByZW1vdmFibGUgbWVkaWEsIHByZXZlbnRpbmcg
dW5tb3VudC4NCiAgICAgICAgKiBkbm90aWZ5IGlzIGRpcmVjdG9yeS1iYXNlZC4gWW91IG9ubHkg
bGVhcm4gYWJvdXQgY2hhbmdlcyB0bw0KICAgICAgICAgIGRpcmVjdG9yaWVzLiBTdXJlLCBhIGNo
YW5nZSB0byBhIGZpbGUgaW4gYSBkaXJlY3RvcnkgYWZmZWN0cw0KICAgICAgICAgIHRoZSBkaXJl
Y3RvcnksIGJ1dCB5b3UgYXJlIHRoZW4gZm9yY2VkIHRvIGtlZXAgYSBjYWNoZSBvZg0KICAgICAg
ICAgIHN0YXQgc3RydWN0dXJlcy4NCiAgICAgICAgKiBkbm90aWZ5J3MgaW50ZXJmYWNlIHRvIHVz
ZXItc3BhY2UgaXMgYXdmdWwuICBTaWduYWxzPw0KDQppbm90aWZ5IHByb3ZpZGVzIGEgbW9yZSB1
c2FibGUsIHNpbXBsZSwgcG93ZXJmdWwgc29sdXRpb24gdG8gZmlsZSBjaGFuZ2UNCm5vdGlmaWNh
dGlvbjoNCg0KICAgICAgICAqIGlub3RpZnkncyBpbnRlcmZhY2UgaXMgYSBkZXZpY2Ugbm9kZSwg
bm90IFNJR0lPLiAgWW91IG9wZW4gYSANCiAgICAgICAgICBzaW5nbGUgZmQgdG8gdGhlIGRldmlj
ZSBub2RlLCB3aGljaCBpcyBzZWxlY3QoKS1hYmxlLg0KICAgICAgICAqIGlub3RpZnkgaGFzIGFu
IGV2ZW50IHRoYXQgc2F5cyAidGhlIGZpbGVzeXN0ZW0gdGhhdCB0aGUgaXRlbQ0KICAgICAgICAg
IHlvdSB3ZXJlIHdhdGNoaW5nIGlzIG9uIHdhcyB1bm1vdW50ZWQuIg0KICAgICAgICAqIGlub3Rp
ZnkgY2FuIHdhdGNoIGRpcmVjdG9yaWVzIG9yIGZpbGVzLg0KDQpJbm90aWZ5IGlzIGN1cnJlbnRs
eSB1c2VkIGJ5IEJlYWdsZSAoYSBkZXNrdG9wIHNlYXJjaCBpbmZyYXN0cnVjdHVyZSkNCmFuZCBH
YW1pbiAoYSBGQU0gcmVwbGFjZW1lbnQpLg0KDQpTaWduZWQtb2ZmLWJ5OiBSb2JlcnQgTG92ZSA8
cm1sQG5vdmVsbC5jb20+DQoNCiBEb2N1bWVudGF0aW9uL2ZpbGVzeXN0ZW1zL2lub3RpZnkudHh0
IHwgICA4MSArKw0KIGZzL0tjb25maWcgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDEz
IA0KIGZzL01ha2VmaWxlICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAxIA0KIGZzL2F0
dHIuYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDMzIC0NCiBmcy9jb21wYXQuYyAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAxMiANCiBmcy9maWxlX3RhYmxlLmMgICAgICAg
ICAgICAgICAgICAgICAgIHwgICAgMyANCiBmcy9pbm9kZS5jICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHwgICAgNiANCiBmcy9pbm90aWZ5LmMgICAgICAgICAgICAgICAgICAgICAgICAgIHwg
IDk2MSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrDQogZnMvbmFtZWkuYyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB8ICAgMzAgLQ0KIGZzL29wZW4uYyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgfCAgICA2IA0KIGZzL3JlYWRfd3JpdGUuYyAgICAgICAgICAgICAgICAg
ICAgICAgfCAgIDE1IA0KIGluY2x1ZGUvbGludXgvZnMuaCAgICAgICAgICAgICAgICAgICAgfCAg
ICA2IA0KIGluY2x1ZGUvbGludXgvZnNub3RpZnkuaCAgICAgICAgICAgICAgfCAgMjI4ICsrKysr
KysrDQogaW5jbHVkZS9saW51eC9pbm90aWZ5LmggICAgICAgICAgICAgICB8ICAxMTEgKysrDQog
aW5jbHVkZS9saW51eC9zY2hlZC5oICAgICAgICAgICAgICAgICB8ICAgIDQgDQoga2VybmVsL3Vz
ZXIuYyAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgIDQgDQogMTYgZmlsZXMgY2hhbmdlZCwg
MTQ1OCBpbnNlcnRpb25zKCspLCA1NiBkZWxldGlvbnMoLSkNCg0KZGlmZiAtdXJOIGxpbnV4LTIu
Ni4xMi1yYzItbW0xL0RvY3VtZW50YXRpb24vZmlsZXN5c3RlbXMvaW5vdGlmeS50eHQgbGludXgv
RG9jdW1lbnRhdGlvbi9maWxlc3lzdGVtcy9pbm90aWZ5LnR4dA0KLS0tIGxpbnV4LTIuNi4xMi1y
YzItbW0xL0RvY3VtZW50YXRpb24vZmlsZXN5c3RlbXMvaW5vdGlmeS50eHQJMTk2OS0xMi0zMSAx
OTowMDowMC4wMDAwMDAwMDAgLTA1MDANCisrKyBsaW51eC9Eb2N1bWVudGF0aW9uL2ZpbGVzeXN0
ZW1zL2lub3RpZnkudHh0CTIwMDUtMDQtMDUgMTI6NDE6NTEuMDAwMDAwMDAwIC0wNDAwDQpAQCAt
MCwwICsxLDgxIEBADQorCQkJCSAgICBpbm90aWZ5DQorCSAgICAgYSBwb3dlcmZ1bCB5ZXQgc2lt
cGxlIGZpbGUgY2hhbmdlIG5vdGlmaWNhdGlvbiBzeXN0ZW0NCisNCisNCisNCitEb2N1bWVudCBz
dGFydGVkIDE1IE1hciAyMDA1IGJ5IFJvYmVydCBMb3ZlIDxybWxAbm92ZWxsLmNvbT4NCisNCiso
aSkgVXNlciBJbnRlcmZhY2UNCisNCitJbm90aWZ5IGlzIGNvbnRyb2xsZWQgYnkgYSBkZXZpY2Ug
bm9kZSwgL2Rldi9pbm90aWZ5LiAgSWYgeW91IGRvIG5vdCB1c2UgdWRldiwNCit0aGlzIGRldmlj
ZSBtYXkgbmVlZCB0byBiZSBjcmVhdGVkIG1hbnVhbGx5LiAgRmlyc3Qgc3RlcCwgb3BlbiBpdA0K
Kw0KKwlpbnQgZGV2X2ZkID0gb3BlbiAoIi9kZXYvaW5vdGlmeSIsIE9fUkRPTkxZKTsNCisNCitD
aGFuZ2UgZXZlbnRzIGFyZSBtYW5hZ2VkIGJ5ICJ3YXRjaGVzIi4gIEEgd2F0Y2ggaXMgYW4gKG9i
amVjdCxtYXNrKSBwYWlyIHdoZXJlDQordGhlIG9iamVjdCBpcyBhIGZpbGUgb3IgZGlyZWN0b3J5
IGFuZCB0aGUgbWFzayBpcyBhIGJpdG1hc2sgb2Ygb25lIG9yIG1vcmUNCitpbm90aWZ5IGV2ZW50
cyB0aGF0IHRoZSBhcHBsaWNhdGlvbiB3aXNoZXMgdG8gcmVjZWl2ZS4gIFNlZSA8bGludXgvaW5v
dGlmeS5oPg0KK2ZvciB2YWxpZCBldmVudHMuICBBIHdhdGNoIGlzIHJlZmVyZW5jZWQgYnkgYSB3
YXRjaCBkZXNjcmlwdG9yLCBvciB3ZC4NCisNCitXYXRjaGVzIGFyZSBhZGRlZCB2aWEgYSBmaWxl
IGRlc2NyaXB0b3IuDQorDQorV2F0Y2hlcyBvbiBhIGRpcmVjdG9yeSB3aWxsIHJldHVybiBldmVu
dHMgb24gYW55IGZpbGVzIGluc2lkZSBvZiB0aGUgZGlyZWN0b3J5Lg0KKw0KK0FkZGluZyBhIHdh
dGNoIGlzIHNpbXBsZSwNCisNCisJLyogJ3dkJyByZXByZXNlbnRzIHRoZSB3YXRjaCBvbiBmZCB3
aXRoIG1hc2sgKi8NCisJc3RydWN0IGlub3RpZnlfcmVxdWVzdCByZXEgPSB7IGZkLCBtYXNrIH07
DQorCWludCB3ZCA9IGlvY3RsIChkZXZfZmQsIElOT1RJRllfV0FUQ0gsICZyZXEpOw0KKw0KK1lv
dSBjYW4gYWRkIGEgbGFyZ2UgbnVtYmVyIG9mIGZpbGVzIHZpYSBzb21ldGhpbmcgbGlrZQ0KKw0K
Kwlmb3IgZWFjaCBmaWxlIHRvIHdhdGNoIHsNCisJCXN0cnVjdCBpbm90aWZ5X3JlcXVlc3QgcmVx
Ow0KKwkJaW50IGZpbGVfZmQ7DQorDQorCQlmaWxlX2ZkID0gb3BlbiAoZmlsZSwgT19SRE9OTFkp
Ow0KKwkJaWYgKGZkIDwgMCkgew0KKwkJCXBlcnJvciAoIm9wZW4iKTsNCisJCQlicmVhazsNCisJ
CX0NCisNCisJCXJlcS5mZCA9IGZpbGVfZmQ7DQorCQlyZXEubWFzayA9IG1hc2s7DQorDQorCQl3
ZCA9IGlvY3RsIChkZXZfZmQsIElOT1RJRllfV0FUQ0gsICZyZXEpOw0KKw0KKwkJY2xvc2UgKGZk
KTsNCisJfQ0KKw0KK1lvdSBjYW4gdXBkYXRlIGFuIGV4aXN0aW5nIHdhdGNoIGluIHRoZSBzYW1l
IG1hbm5lciwgYnkgcGFzc2luZyBpbiBhIG5ldyBtYXNrLg0KKw0KK0FuIGV4aXN0aW5nIHdhdGNo
IGlzIHJlbW92ZWQgdmlhIHRoZSBJTk9USUZZX0lHTk9SRSBpb2N0bCwgZm9yIGV4YW1wbGUNCisN
CisJaW9jdGwgKGRldl9mZCwgSU5PVElGWV9JR05PUkUsIHdkKTsNCisNCitFdmVudHMgYXJlIHBy
b3ZpZGVkIGluIHRoZSBmb3JtIG9mIGFuIGlub3RpZnlfZXZlbnQgc3RydWN0dXJlIHRoYXQgaXMg
cmVhZCgyKQ0KK2Zyb20gL2Rldi9pbm90aWZ5LiAgVGhlIGZpbGVuYW1lIGlzIG9mIGR5bmFtaWMg
bGVuZ3RoIGFuZCBmb2xsb3dzIHRoZSBzdHJ1Y3QuDQorSXQgaXMgb2Ygc2l6ZSBsZW4uICBUaGUg
ZmlsZW5hbWUgaXMgcGFkZGVkIHdpdGggbnVsbCBieXRlcyB0byBlbnN1cmUgcHJvcGVyDQorYWxp
Z25tZW50LiAgVGhpcyBwYWRkaW5nIGlzIHJlZmxlY3RlZCBpbiBsZW4uDQorDQorWW91IGNhbiBz
bHVycCBtdWx0aXBsZSBldmVudHMgYnkgcGFzc2luZyBhIGxhcmdlIGJ1ZmZlciwgZm9yIGV4YW1w
bGUNCisNCisJc2l6ZV90IGxlbiA9IHJlYWQgKGZkLCBidWYsIEJVRl9MRU4pOw0KKw0KK1dpbGwg
cmV0dXJuIGFzIG1hbnkgZXZlbnRzIGFzIGFyZSBhdmFpbGFibGUgYW5kIGZpdCBpbiBCVUZfTEVO
Lg0KKw0KKy9kZXYvaW5vdGlmeSBpcyBhbHNvIHNlbGVjdCgpIGFuZCBwb2xsKCkgYWJsZS4NCisN
CitZb3UgY2FuIGZpbmQgdGhlIHNpemUgb2YgdGhlIGN1cnJlbnQgZXZlbnQgcXVldWUgdmlhIHRo
ZSBGSU9OUkVBRCBpb2N0bC4NCisNCitBbGwgd2F0Y2hlcyBhcmUgZGVzdHJveWVkIGFuZCBjbGVh
bmVkIHVwIG9uIGNsb3NlLg0KKw0KKw0KKyhpaSkgSW50ZXJuYWwgS2VybmVsIEltcGxlbWVudGF0
aW9uDQorDQorRWFjaCBvcGVuIGlub3RpZnkgZGV2aWNlIGlzIGFzc29jaWF0ZWQgd2l0aCBhbiBp
bm90aWZ5X2RldmljZSBzdHJ1Y3R1cmUuDQorDQorRWFjaCB3YXRjaCBpcyBhc3NvY2lhdGVkIHdp
dGggYW4gaW5vdGlmeV93YXRjaCBzdHJ1Y3R1cmUuICBXYXRjaGVzIGFyZSBjaGFpbmVkDQorb2Zm
IG9mIGVhY2ggYXNzb2NpYXRlZCBkZXZpY2UgYW5kIGVhY2ggYXNzb2NpYXRlZCBpbm9kZS4NCisN
CitTZWUgZnMvaW5vdGlmeS5jIGZvciB0aGUgbG9ja2luZyBhbmQgbGlmZXRpbWUgcnVsZXMuDQpk
aWZmIC11ck4gbGludXgtMi42LjEyLXJjMi1tbTEvZnMvYXR0ci5jIGxpbnV4L2ZzL2F0dHIuYw0K
LS0tIGxpbnV4LTIuNi4xMi1yYzItbW0xL2ZzL2F0dHIuYwkyMDA1LTA0LTA1IDEyOjQwOjAzLjAw
MDAwMDAwMCAtMDQwMA0KKysrIGxpbnV4L2ZzL2F0dHIuYwkyMDA1LTA0LTA1IDEyOjQxOjUxLjAw
MDAwMDAwMCAtMDQwMA0KQEAgLTEwLDcgKzEwLDcgQEANCiAjaW5jbHVkZSA8bGludXgvbW0uaD4N
CiAjaW5jbHVkZSA8bGludXgvc3RyaW5nLmg+DQogI2luY2x1ZGUgPGxpbnV4L3NtcF9sb2NrLmg+
DQotI2luY2x1ZGUgPGxpbnV4L2Rub3RpZnkuaD4NCisjaW5jbHVkZSA8bGludXgvZnNub3RpZnku
aD4NCiAjaW5jbHVkZSA8bGludXgvZmNudGwuaD4NCiAjaW5jbHVkZSA8bGludXgvcXVvdGFvcHMu
aD4NCiAjaW5jbHVkZSA8bGludXgvc2VjdXJpdHkuaD4NCkBAIC0xMDcsMzEgKzEwNyw4IEBADQog
b3V0Og0KIAlyZXR1cm4gZXJyb3I7DQogfQ0KLQ0KIEVYUE9SVF9TWU1CT0woaW5vZGVfc2V0YXR0
cik7DQogDQotaW50IHNldGF0dHJfbWFzayh1bnNpZ25lZCBpbnQgaWFfdmFsaWQpDQotew0KLQl1
bnNpZ25lZCBsb25nIGRuX21hc2sgPSAwOw0KLQ0KLQlpZiAoaWFfdmFsaWQgJiBBVFRSX1VJRCkN
Ci0JCWRuX21hc2sgfD0gRE5fQVRUUklCOw0KLQlpZiAoaWFfdmFsaWQgJiBBVFRSX0dJRCkNCi0J
CWRuX21hc2sgfD0gRE5fQVRUUklCOw0KLQlpZiAoaWFfdmFsaWQgJiBBVFRSX1NJWkUpDQotCQlk
bl9tYXNrIHw9IEROX01PRElGWTsNCi0JLyogYm90aCB0aW1lcyBpbXBsaWVzIGEgdXRpbWUocykg
Y2FsbCAqLw0KLQlpZiAoKGlhX3ZhbGlkICYgKEFUVFJfQVRJTUV8QVRUUl9NVElNRSkpID09IChB
VFRSX0FUSU1FfEFUVFJfTVRJTUUpKQ0KLQkJZG5fbWFzayB8PSBETl9BVFRSSUI7DQotCWVsc2Ug
aWYgKGlhX3ZhbGlkICYgQVRUUl9BVElNRSkNCi0JCWRuX21hc2sgfD0gRE5fQUNDRVNTOw0KLQll
bHNlIGlmIChpYV92YWxpZCAmIEFUVFJfTVRJTUUpDQotCQlkbl9tYXNrIHw9IEROX01PRElGWTsN
Ci0JaWYgKGlhX3ZhbGlkICYgQVRUUl9NT0RFKQ0KLQkJZG5fbWFzayB8PSBETl9BVFRSSUI7DQot
CXJldHVybiBkbl9tYXNrOw0KLX0NCi0NCiBpbnQgbm90aWZ5X2NoYW5nZShzdHJ1Y3QgZGVudHJ5
ICogZGVudHJ5LCBzdHJ1Y3QgaWF0dHIgKiBhdHRyKQ0KIHsNCiAJc3RydWN0IGlub2RlICppbm9k
ZSA9IGRlbnRyeS0+ZF9pbm9kZTsNCkBAIC0xOTcsMTEgKzE3NCw5IEBADQogCWlmIChpYV92YWxp
ZCAmIEFUVFJfU0laRSkNCiAJCXVwX3dyaXRlKCZkZW50cnktPmRfaW5vZGUtPmlfYWxsb2Nfc2Vt
KTsNCiANCi0JaWYgKCFlcnJvcikgew0KLQkJdW5zaWduZWQgbG9uZyBkbl9tYXNrID0gc2V0YXR0
cl9tYXNrKGlhX3ZhbGlkKTsNCi0JCWlmIChkbl9tYXNrKQ0KLQkJCWRub3RpZnlfcGFyZW50KGRl
bnRyeSwgZG5fbWFzayk7DQotCX0NCisJaWYgKCFlcnJvcikNCisJCWZzbm90aWZ5X2NoYW5nZShk
ZW50cnksIGlhX3ZhbGlkKTsNCisNCiAJcmV0dXJuIGVycm9yOw0KIH0NCiANCmRpZmYgLXVyTiBs
aW51eC0yLjYuMTItcmMyLW1tMS9mcy9jb21wYXQuYyBsaW51eC9mcy9jb21wYXQuYw0KLS0tIGxp
bnV4LTIuNi4xMi1yYzItbW0xL2ZzL2NvbXBhdC5jCTIwMDUtMDQtMDUgMTI6NDA6MDMuMDAwMDAw
MDAwIC0wNDAwDQorKysgbGludXgvZnMvY29tcGF0LmMJMjAwNS0wNC0wNSAxMjo0MTo1MS4wMDAw
MDAwMDAgLTA0MDANCkBAIC0zNiw3ICszNiw3IEBADQogI2luY2x1ZGUgPGxpbnV4L2N0eXBlLmg+
DQogI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPg0KICNpbmNsdWRlIDxsaW51eC9kaXJlbnQuaD4N
Ci0jaW5jbHVkZSA8bGludXgvZG5vdGlmeS5oPg0KKyNpbmNsdWRlIDxsaW51eC9mc25vdGlmeS5o
Pg0KICNpbmNsdWRlIDxsaW51eC9oaWdodWlkLmg+DQogI2luY2x1ZGUgPGxpbnV4L3N1bnJwYy9z
dmMuaD4NCiAjaW5jbHVkZSA8bGludXgvbmZzZC9uZnNkLmg+DQpAQCAtMTIzMyw5ICsxMjMzLDEz
IEBADQogb3V0Og0KIAlpZiAoaW92ICE9IGlvdnN0YWNrKQ0KIAkJa2ZyZWUoaW92KTsNCi0JaWYg
KChyZXQgKyAodHlwZSA9PSBSRUFEKSkgPiAwKQ0KLQkJZG5vdGlmeV9wYXJlbnQoZmlsZS0+Zl9k
ZW50cnksDQotCQkJCSh0eXBlID09IFJFQUQpID8gRE5fQUNDRVNTIDogRE5fTU9ESUZZKTsNCisJ
aWYgKChyZXQgKyAodHlwZSA9PSBSRUFEKSkgPiAwKSB7DQorCQlzdHJ1Y3QgZGVudHJ5ICpkZW50
cnkgPSBmaWxlLT5mX2RlbnRyeTsNCisJCWlmICh0eXBlID09IFJFQUQpDQorCQkJZnNub3RpZnlf
YWNjZXNzKGRlbnRyeSk7DQorCQllbHNlDQorCQkJZnNub3RpZnlfbW9kaWZ5KGRlbnRyeSk7DQor
CX0NCiAJcmV0dXJuIHJldDsNCiB9DQogDQpkaWZmIC11ck4gbGludXgtMi42LjEyLXJjMi1tbTEv
ZnMvZmlsZV90YWJsZS5jIGxpbnV4L2ZzL2ZpbGVfdGFibGUuYw0KLS0tIGxpbnV4LTIuNi4xMi1y
YzItbW0xL2ZzL2ZpbGVfdGFibGUuYwkyMDA1LTA0LTA1IDEyOjQwOjAzLjAwMDAwMDAwMCAtMDQw
MA0KKysrIGxpbnV4L2ZzL2ZpbGVfdGFibGUuYwkyMDA1LTA0LTA1IDEyOjQxOjUxLjAwMDAwMDAw
MCAtMDQwMA0KQEAgLTE2LDYgKzE2LDcgQEANCiAjaW5jbHVkZSA8bGludXgvZXZlbnRwb2xsLmg+
DQogI2luY2x1ZGUgPGxpbnV4L21vdW50Lmg+DQogI2luY2x1ZGUgPGxpbnV4L2NkZXYuaD4NCisj
aW5jbHVkZSA8bGludXgvZnNub3RpZnkuaD4NCiANCiAvKiBzeXNjdGwgdHVuYWJsZXMuLi4gKi8N
CiBzdHJ1Y3QgZmlsZXNfc3RhdF9zdHJ1Y3QgZmlsZXNfc3RhdCA9IHsNCkBAIC0xMjMsNiArMTI0
LDggQEANCiAJc3RydWN0IGlub2RlICppbm9kZSA9IGRlbnRyeS0+ZF9pbm9kZTsNCiANCiAJbWln
aHRfc2xlZXAoKTsNCisNCisJZnNub3RpZnlfY2xvc2UoZmlsZSk7DQogCS8qDQogCSAqIFRoZSBm
dW5jdGlvbiBldmVudHBvbGxfcmVsZWFzZSgpIHNob3VsZCBiZSB0aGUgZmlyc3QgY2FsbGVkDQog
CSAqIGluIHRoZSBmaWxlIGNsZWFudXAgY2hhaW4uDQpkaWZmIC11ck4gbGludXgtMi42LjEyLXJj
Mi1tbTEvZnMvaW5vZGUuYyBsaW51eC9mcy9pbm9kZS5jDQotLS0gbGludXgtMi42LjEyLXJjMi1t
bTEvZnMvaW5vZGUuYwkyMDA1LTA0LTA1IDEyOjQwOjAzLjAwMDAwMDAwMCAtMDQwMA0KKysrIGxp
bnV4L2ZzL2lub2RlLmMJMjAwNS0wNC0wNSAxMjo0MTo1MS4wMDAwMDAwMDAgLTA0MDANCkBAIC0y
MSw2ICsyMSw3IEBADQogI2luY2x1ZGUgPGxpbnV4L3BhZ2VtYXAuaD4NCiAjaW5jbHVkZSA8bGlu
dXgvY2Rldi5oPg0KICNpbmNsdWRlIDxsaW51eC9ib290bWVtLmg+DQorI2luY2x1ZGUgPGxpbnV4
L2lub3RpZnkuaD4NCiANCiAvKg0KICAqIFRoaXMgaXMgbmVlZGVkIGZvciB0aGUgZm9sbG93aW5n
IGZ1bmN0aW9uczoNCkBAIC0xMzEsNiArMTMyLDEwIEBADQogI2lmZGVmIENPTkZJR19RVU9UQQ0K
IAkJbWVtc2V0KCZpbm9kZS0+aV9kcXVvdCwgMCwgc2l6ZW9mKGlub2RlLT5pX2RxdW90KSk7DQog
I2VuZGlmDQorI2lmZGVmIENPTkZJR19JTk9USUZZDQorCQlJTklUX0xJU1RfSEVBRCgmaW5vZGUt
Pmlub3RpZnlfd2F0Y2hlcyk7DQorCQlzZW1hX2luaXQoJmlub2RlLT5pbm90aWZ5X3NlbSwgMSk7
DQorI2VuZGlmDQogCQlpbm9kZS0+aV9waXBlID0gTlVMTDsNCiAJCWlub2RlLT5pX2JkZXYgPSBO
VUxMOw0KIAkJaW5vZGUtPmlfY2RldiA9IE5VTEw7DQpAQCAtMzU3LDYgKzM2Miw3IEBADQogDQog
CWRvd24oJmlwcnVuZV9zZW0pOw0KIAlzcGluX2xvY2soJmlub2RlX2xvY2spOw0KKwlpbm90aWZ5
X3VubW91bnRfaW5vZGVzKCZzYi0+c19pbm9kZXMpOw0KIAlidXN5ID0gaW52YWxpZGF0ZV9saXN0
KCZzYi0+c19pbm9kZXMsICZ0aHJvd19hd2F5KTsNCiAJc3Bpbl91bmxvY2soJmlub2RlX2xvY2sp
Ow0KIA0KZGlmZiAtdXJOIGxpbnV4LTIuNi4xMi1yYzItbW0xL2ZzL2lub3RpZnkuYyBsaW51eC9m
cy9pbm90aWZ5LmMNCi0tLSBsaW51eC0yLjYuMTItcmMyLW1tMS9mcy9pbm90aWZ5LmMJMTk2OS0x
Mi0zMSAxOTowMDowMC4wMDAwMDAwMDAgLTA1MDANCisrKyBsaW51eC9mcy9pbm90aWZ5LmMJMjAw
NS0wNC0wNSAxMjo0MTo1MS4wMDAwMDAwMDAgLTA0MDANCkBAIC0wLDAgKzEsOTYxIEBADQorLyoN
CisgKiBmcy9pbm90aWZ5LmMgLSBpbm9kZS1iYXNlZCBmaWxlIGV2ZW50IG5vdGlmaWNhdGlvbnMN
CisgKg0KKyAqIEF1dGhvcnM6DQorICoJSm9obiBNY0N1dGNoYW4JPHR0YkB0ZW50YWNsZS5kaHMu
b3JnPg0KKyAqCVJvYmVydCBMb3ZlCTxybWxAbm92ZWxsLmNvbT4NCisgKg0KKyAqIENvcHlyaWdo
dCAoQykgMjAwNSBKb2huIE1jQ3V0Y2hhbg0KKyAqDQorICogVGhpcyBwcm9ncmFtIGlzIGZyZWUg
c29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkgaXQNCisgKiB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxp
c2hlZCBieSB0aGUNCisgKiBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9u
IDIsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55DQorICogbGF0ZXIgdmVyc2lvbi4NCisgKg0KKyAq
IFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUg
dXNlZnVsLCBidXQNCisgKiBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBp
bXBsaWVkIHdhcnJhbnR5IG9mDQorICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEg
UEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlUNCisgKiBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGZvciBtb3JlIGRldGFpbHMuDQorICovDQorDQorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5o
Pg0KKyNpbmNsdWRlIDxsaW51eC9rZXJuZWwuaD4NCisjaW5jbHVkZSA8bGludXgvc2NoZWQuaD4N
CisjaW5jbHVkZSA8bGludXgvc3BpbmxvY2suaD4NCisjaW5jbHVkZSA8bGludXgvaWRyLmg+DQor
I2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4NCisjaW5jbHVkZSA8bGludXgvZnMuaD4NCisjaW5jbHVk
ZSA8bGludXgvZmlsZS5oPg0KKyNpbmNsdWRlIDxsaW51eC9uYW1laS5oPg0KKyNpbmNsdWRlIDxs
aW51eC9wb2xsLmg+DQorI2luY2x1ZGUgPGxpbnV4L2RldmljZS5oPg0KKyNpbmNsdWRlIDxsaW51
eC9taXNjZGV2aWNlLmg+DQorI2luY2x1ZGUgPGxpbnV4L2luaXQuaD4NCisjaW5jbHVkZSA8bGlu
dXgvbGlzdC5oPg0KKyNpbmNsdWRlIDxsaW51eC93cml0ZWJhY2suaD4NCisjaW5jbHVkZSA8bGlu
dXgvaW5vdGlmeS5oPg0KKw0KKyNpbmNsdWRlIDxhc20vaW9jdGxzLmg+DQorDQorc3RhdGljIGF0
b21pY190IGlub3RpZnlfY29va2llOw0KKw0KK3N0YXRpYyBrbWVtX2NhY2hlX3QgKndhdGNoX2Nh
Y2hlcDsNCitzdGF0aWMga21lbV9jYWNoZV90ICpldmVudF9jYWNoZXA7DQorDQorc3RhdGljIGlu
dCBtYXhfdXNlcl9kZXZpY2VzOw0KK3N0YXRpYyBpbnQgbWF4X3VzZXJfd2F0Y2hlczsNCitzdGF0
aWMgdW5zaWduZWQgaW50IG1heF9xdWV1ZWRfZXZlbnRzOw0KKw0KKy8qDQorICogTG9jayBvcmRl
cmluZzoNCisgKg0KKyAqIGRlbnRyeS0+ZF9sb2NrICh1c2VkIHRvIGtlZXAgZF9tb3ZlKCkgYXdh
eSBmcm9tIGRlbnRyeS0+ZF9wYXJlbnQpDQorICogaXBydW5lX3NlbSAoc3luY2hyb25pemUgdmVy
c3VzIHNocmlua19pY2FjaGVfbWVtb3J5KCkpDQorICogCWlub2RlX2xvY2sgKHByb3RlY3RzIHRo
ZSBzdXBlcl9ibG9jay0+c19pbm9kZXMgbGlzdCkNCisgKiAJaW5vZGUtPmlub3RpZnlfc2VtIChw
cm90ZWN0cyBpbm9kZS0+aW5vdGlmeV93YXRjaGVzIGFuZCB3YXRjaGVzLT5pX2xpc3QpDQorICog
CQlpbm90aWZ5X2Rldi0+c2VtIChwcm90ZWN0cyBpbm90aWZ5X2RldmljZSBhbmQgd2F0Y2hlcy0+
ZF9saXN0KQ0KKyAqLw0KKw0KKy8qDQorICogTGlmZXRpbWVzIG9mIHRoZSB0aHJlZSBtYWluIGRh
dGEgc3RydWN0dXJlcy0taW5vdGlmeV9kZXZpY2UsIGlub2RlLCBhbmQNCisgKiBpbm90aWZ5X3dh
dGNoLS1hcmUgbWFuYWdlZCBieSByZWZlcmVuY2UgY291bnQuDQorICoNCisgKiBpbm90aWZ5X2Rl
dmljZTogTGlmZXRpbWUgaXMgZnJvbSBvcGVuIHVudGlsIHJlbGVhc2UuICBBZGRpdGlvbmFsIHJl
ZmVyZW5jZXMNCisgKiBjYW4gYnVtcCB0aGUgY291bnQgdmlhIGdldF9pbm90aWZ5X2RldigpIGFu
ZCBkcm9wIHRoZSBjb3VudCB2aWENCisgKiBwdXRfaW5vdGlmeV9kZXYoKS4NCisgKg0KKyAqIGlu
b3RpZnlfd2F0Y2g6IExpZmV0aW1lIGlzIGZyb20gY3JlYXRlX3dhdGNoKCkgdG8gZGVzdG9yeV93
YXRjaCgpLg0KKyAqIEFkZGl0aW9uYWwgcmVmZXJlbmNlcyBjYW4gYnVtcCB0aGUgY291bnQgdmlh
IGdldF9pbm90aWZ5X3dhdGNoKCkgYW5kIGRyb3ANCisgKiB0aGUgY291bnQgdmlhIHB1dF9pbm90
aWZ5X3dhdGNoKCkuDQorICoNCisgKiBpbm9kZTogUGlubmVkIHNvIGxvbmcgYXMgdGhlIGlub2Rl
IGlzIGFzc29jaWF0ZWQgd2l0aCBhIHdhdGNoLCBmcm9tDQorICogY3JlYXRlX3dhdGNoKCkgdG8g
cHV0X2lub3RpZnlfd2F0Y2goKS4NCisgKi8NCisNCisvKg0KKyAqIHN0cnVjdCBpbm90aWZ5X2Rl
dmljZSAtIHJlcHJlc2VudHMgYW4gb3BlbiBpbnN0YW5jZSBvZiBhbiBpbm90aWZ5IGRldmljZQ0K
KyAqDQorICogVGhpcyBzdHJ1Y3R1cmUgaXMgcHJvdGVjdGVkIGJ5IHRoZSBzZW1hcGhvcmUgJ3Nl
bScuDQorICovDQorc3RydWN0IGlub3RpZnlfZGV2aWNlIHsNCisJd2FpdF9xdWV1ZV9oZWFkX3Qg
CXdxOwkJLyogd2FpdCBxdWV1ZSBmb3IgaS9vICovDQorCXN0cnVjdCBpZHIJCWlkcjsJCS8qIGlk
ciBtYXBwaW5nIHdkIC0+IHdhdGNoICovDQorCXN0cnVjdCBzZW1hcGhvcmUJc2VtOwkJLyogcHJv
dGVjdHMgdGhpcyBiYWQgYm95ICovCQ0KKwlzdHJ1Y3QgbGlzdF9oZWFkIAlldmVudHM7CQkvKiBs
aXN0IG9mIHF1ZXVlZCBldmVudHMgKi8NCisJc3RydWN0IGxpc3RfaGVhZAl3YXRjaGVzOwkvKiBs
aXN0IG9mIHdhdGNoZXMgKi8NCisJYXRvbWljX3QJCWNvdW50OwkJLyogcmVmZXJlbmNlIGNvdW50
ICovDQorCXN0cnVjdCB1c2VyX3N0cnVjdAkqdXNlcjsJCS8qIHVzZXIgd2hvIG9wZW5lZCB0aGlz
IGRldiAqLw0KKwl1bnNpZ25lZCBpbnQJCXF1ZXVlX3NpemU7CS8qIHNpemUgb2YgdGhlIHF1ZXVl
IChieXRlcykgKi8NCisJdW5zaWduZWQgaW50CQlldmVudF9jb3VudDsJLyogbnVtYmVyIG9mIHBl
bmRpbmcgZXZlbnRzICovDQorCXVuc2lnbmVkIGludAkJbWF4X2V2ZW50czsJLyogbWF4aW11bSBu
dW1iZXIgb2YgZXZlbnRzICovDQorfTsNCisNCisvKg0KKyAqIHN0cnVjdCBpbm90aWZ5X2tlcm5l
bF9ldmVudCAtIEFuIGludG9maXkgZXZlbnQsIG9yaWdpbmF0aW5nIGZyb20gYSB3YXRjaCBhbmQN
CisgKiBxdWV1ZWQgZm9yIHVzZXItc3BhY2UuICBBIGxpc3Qgb2YgdGhlc2UgaXMgYXR0YWNoZWQg
dG8gZWFjaCBpbnN0YW5jZSBvZiB0aGUNCisgKiBkZXZpY2UuICBJbiByZWFkKCksIHRoaXMgbGlz
dCBpcyB3YWxrZWQgYW5kIGFsbCBldmVudHMgdGhhdCBjYW4gZml0IGluIHRoZQ0KKyAqIGJ1ZmZl
ciBhcmUgcmV0dXJuZWQuDQorICoNCisgKiBQcm90ZWN0ZWQgYnkgZGV2LT5zZW0gb2YgdGhlIGRl
dmljZSBpbiB3aGljaCB3ZSBhcmUgcXVldWVkLg0KKyAqLw0KK3N0cnVjdCBpbm90aWZ5X2tlcm5l
bF9ldmVudCB7DQorCXN0cnVjdCBpbm90aWZ5X2V2ZW50CWV2ZW50OwkvKiB0aGUgdXNlci1zcGFj
ZSBldmVudCAqLw0KKwlzdHJ1Y3QgbGlzdF9oZWFkICAgICAgICBsaXN0OwkvKiBlbnRyeSBpbiBp
bm90aWZ5X2RldmljZSdzIGxpc3QgKi8NCisJY2hhcgkJCSpuYW1lOwkvKiBmaWxlbmFtZSwgaWYg
YW55ICovDQorfTsNCisNCisvKg0KKyAqIHN0cnVjdCBpbm90aWZ5X3dhdGNoIC0gcmVwcmVzZW50
cyBhIHdhdGNoIHJlcXVlc3Qgb24gYSBzcGVjaWZpYyBpbm9kZQ0KKyAqDQorICogZF9saXN0IGlz
IHByb3RlY3RlZCBieSBkZXYtPnNlbSBvZiB0aGUgYXNzb2NpYXRlZCB3YXRjaC0+ZGV2Lg0KKyAq
IGlfbGlzdCBhbmQgbWFzayBhcmUgcHJvdGVjdGVkIGJ5IGlub2RlLT5pbm90aWZ5X3NlbSBvZiB0
aGUgYXNzb2NpYXRlZCBpbm9kZS4NCisgKiBkZXYsIGlub2RlLCBhbmQgd2QgYXJlIG5ldmVyIHdy
aXR0ZW4gdG8gb25jZSB0aGUgd2F0Y2ggaXMgY3JlYXRlZC4NCisgKi8NCitzdHJ1Y3QgaW5vdGlm
eV93YXRjaCB7DQorCXN0cnVjdCBsaXN0X2hlYWQJZF9saXN0OwkvKiBlbnRyeSBpbiBpbm90aWZ5
X2RldmljZSdzIGxpc3QgKi8NCisJc3RydWN0IGxpc3RfaGVhZAlpX2xpc3Q7CS8qIGVudHJ5IGlu
IGlub2RlJ3MgbGlzdCAqLw0KKwlhdG9taWNfdAkJY291bnQ7CS8qIHJlZmVyZW5jZSBjb3VudCAq
Lw0KKwlzdHJ1Y3QgaW5vdGlmeV9kZXZpY2UJKmRldjsJLyogYXNzb2NpYXRlZCBkZXZpY2UgKi8N
CisJc3RydWN0IGlub2RlCQkqaW5vZGU7CS8qIGFzc29jaWF0ZWQgaW5vZGUgKi8NCisJczMyIAkJ
CXdkOwkvKiB3YXRjaCBkZXNjcmlwdG9yICovDQorCXUzMgkJCW1hc2s7CS8qIGV2ZW50IG1hc2sg
Zm9yIHRoaXMgd2F0Y2ggKi8NCit9Ow0KKw0KK3N0YXRpYyBzc2l6ZV90IHNob3dfbWF4X3F1ZXVl
ZF9ldmVudHMoc3RydWN0IGNsYXNzX2RldmljZSAqY2xhc3MsIGNoYXIgKmJ1ZikNCit7DQorCXJl
dHVybiBzcHJpbnRmKGJ1ZiwgIiVkXG4iLCBtYXhfcXVldWVkX2V2ZW50cyk7DQorfQ0KKw0KK3N0
YXRpYyBzc2l6ZV90IHN0b3JlX21heF9xdWV1ZWRfZXZlbnRzKHN0cnVjdCBjbGFzc19kZXZpY2Ug
KmNsYXNzLA0KKwkJCQkgICAgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgY291bnQpDQorew0K
Kwl1bnNpZ25lZCBpbnQgbWF4Ow0KKw0KKwlpZiAoc3NjYW5mKGJ1ZiwgIiV1IiwgJm1heCkgPiAw
ICYmIG1heCA+IDApIHsNCisJCW1heF9xdWV1ZWRfZXZlbnRzID0gbWF4Ow0KKwkJcmV0dXJuIHN0
cmxlbihidWYpOw0KKwl9DQorCXJldHVybiAtRUlOVkFMOw0KK30NCisNCitzdGF0aWMgc3NpemVf
dCBzaG93X21heF91c2VyX2RldmljZXMoc3RydWN0IGNsYXNzX2RldmljZSAqY2xhc3MsIGNoYXIg
KmJ1ZikNCit7DQorCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVkXG4iLCBtYXhfdXNlcl9kZXZpY2Vz
KTsNCit9DQorDQorc3RhdGljIHNzaXplX3Qgc3RvcmVfbWF4X3VzZXJfZGV2aWNlcyhzdHJ1Y3Qg
Y2xhc3NfZGV2aWNlICpjbGFzcywNCisJCQkJICAgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3Qg
Y291bnQpDQorew0KKwlpbnQgbWF4Ow0KKw0KKwlpZiAoc3NjYW5mKGJ1ZiwgIiVkIiwgJm1heCkg
PiAwICYmIG1heCA+IDApIHsNCisJCW1heF91c2VyX2RldmljZXMgPSBtYXg7DQorCQlyZXR1cm4g
c3RybGVuKGJ1Zik7DQorCX0NCisJcmV0dXJuIC1FSU5WQUw7DQorfQ0KKw0KK3N0YXRpYyBzc2l6
ZV90IHNob3dfbWF4X3VzZXJfd2F0Y2hlcyhzdHJ1Y3QgY2xhc3NfZGV2aWNlICpjbGFzcywgY2hh
ciAqYnVmKQ0KK3sNCisJcmV0dXJuIHNwcmludGYoYnVmLCAiJWRcbiIsIG1heF91c2VyX3dhdGNo
ZXMpOw0KK30NCisNCitzdGF0aWMgc3NpemVfdCBzdG9yZV9tYXhfdXNlcl93YXRjaGVzKHN0cnVj
dCBjbGFzc19kZXZpY2UgKmNsYXNzLA0KKwkJCQkgICAgICBjb25zdCBjaGFyICpidWYsIHNpemVf
dCBjb3VudCkNCit7DQorCWludCBtYXg7DQorDQorCWlmIChzc2NhbmYoYnVmLCAiJWQiLCAmbWF4
KSA+IDAgJiYgbWF4ID4gMCkgew0KKwkJbWF4X3VzZXJfd2F0Y2hlcyA9IG1heDsNCisJCXJldHVy
biBzdHJsZW4oYnVmKTsNCisJfQ0KKwlyZXR1cm4gLUVJTlZBTDsNCit9DQorDQorc3RhdGljIENM
QVNTX0RFVklDRV9BVFRSKG1heF9xdWV1ZWRfZXZlbnRzLCBTX0lSVUdPIHwgU19JV1VTUiwNCisJ
CQkgc2hvd19tYXhfcXVldWVkX2V2ZW50cywgc3RvcmVfbWF4X3F1ZXVlZF9ldmVudHMpOw0KK3N0
YXRpYyBDTEFTU19ERVZJQ0VfQVRUUihtYXhfdXNlcl9kZXZpY2VzLCBTX0lSVUdPIHwgU19JV1VT
UiwNCisJCQkgc2hvd19tYXhfdXNlcl9kZXZpY2VzLCBzdG9yZV9tYXhfdXNlcl9kZXZpY2VzKTsN
CitzdGF0aWMgQ0xBU1NfREVWSUNFX0FUVFIobWF4X3VzZXJfd2F0Y2hlcywgU19JUlVHTyB8IFNf
SVdVU1IsDQorCQkJIHNob3dfbWF4X3VzZXJfd2F0Y2hlcywgc3RvcmVfbWF4X3VzZXJfd2F0Y2hl
cyk7DQorDQorc3RhdGljIGlubGluZSB2b2lkIGdldF9pbm90aWZ5X2RldihzdHJ1Y3QgaW5vdGlm
eV9kZXZpY2UgKmRldikNCit7DQorCWF0b21pY19pbmMoJmRldi0+Y291bnQpOw0KK30NCisNCitz
dGF0aWMgaW5saW5lIHZvaWQgcHV0X2lub3RpZnlfZGV2KHN0cnVjdCBpbm90aWZ5X2RldmljZSAq
ZGV2KQ0KK3sNCisJaWYgKGF0b21pY19kZWNfYW5kX3Rlc3QoJmRldi0+Y291bnQpKSB7DQorCQlh
dG9taWNfZGVjKCZkZXYtPnVzZXItPmlub3RpZnlfZGV2cyk7DQorCQlmcmVlX3VpZChkZXYtPnVz
ZXIpOw0KKwkJa2ZyZWUoZGV2KTsNCisJfQ0KK30NCisNCitzdGF0aWMgaW5saW5lIHZvaWQgZ2V0
X2lub3RpZnlfd2F0Y2goc3RydWN0IGlub3RpZnlfd2F0Y2ggKndhdGNoKQ0KK3sNCisJYXRvbWlj
X2luYygmd2F0Y2gtPmNvdW50KTsNCit9DQorDQorLyoNCisgKiBwdXRfaW5vdGlmeV93YXRjaCAt
IGRlY3JlbWVudHMgdGhlIHJlZiBjb3VudCBvbiBhIGdpdmVuIHdhdGNoLiAgY2xlYW5zIHVwDQor
ICogdGhlIHdhdGNoIGFuZCBpdHMgcmVmZXJlbmNlcyBpZiB0aGUgY291bnQgcmVhY2hlcyB6ZXJv
Lg0KKyAqLw0KK3N0YXRpYyBpbmxpbmUgdm9pZCBwdXRfaW5vdGlmeV93YXRjaChzdHJ1Y3QgaW5v
dGlmeV93YXRjaCAqd2F0Y2gpDQorew0KKwlpZiAoYXRvbWljX2RlY19hbmRfdGVzdCgmd2F0Y2gt
PmNvdW50KSkgew0KKwkJcHV0X2lub3RpZnlfZGV2KHdhdGNoLT5kZXYpOw0KKwkJaXB1dCh3YXRj
aC0+aW5vZGUpOw0KKwkJa21lbV9jYWNoZV9mcmVlKHdhdGNoX2NhY2hlcCwgd2F0Y2gpOw0KKwl9
DQorfQ0KKw0KKy8qDQorICoga2VybmVsX2V2ZW50IC0gY3JlYXRlIGEgbmV3IGtlcm5lbCBldmVu
dCB3aXRoIHRoZSBnaXZlbiBwYXJhbWV0ZXJzDQorICoNCisgKiBUaGlzIGZ1bmN0aW9uIGNhbiBz
bGVlcC4NCisgKi8NCitzdGF0aWMgc3RydWN0IGlub3RpZnlfa2VybmVsX2V2ZW50ICoga2VybmVs
X2V2ZW50KHMzMiB3ZCwgdTMyIG1hc2ssIHUzMiBjb29raWUsDQorCQkJCQkJICBjb25zdCBjaGFy
ICpuYW1lKQ0KK3sNCisJc3RydWN0IGlub3RpZnlfa2VybmVsX2V2ZW50ICprZXZlbnQ7DQorDQor
CWtldmVudCA9IGttZW1fY2FjaGVfYWxsb2MoZXZlbnRfY2FjaGVwLCBHRlBfS0VSTkVMKTsNCisJ
aWYgKHVubGlrZWx5KCFrZXZlbnQpKQ0KKwkJcmV0dXJuIE5VTEw7DQorDQorCS8qIHdlIGhhbmQg
dGhpcyBvdXQgdG8gdXNlci1zcGFjZSwgc28gemVybyBpdCBqdXN0IGluIGNhc2UgKi8NCisJbWVt
c2V0KCZrZXZlbnQtPmV2ZW50LCAwLCBzaXplb2Yoc3RydWN0IGlub3RpZnlfZXZlbnQpKTsNCisN
CisJa2V2ZW50LT5ldmVudC53ZCA9IHdkOw0KKwlrZXZlbnQtPmV2ZW50Lm1hc2sgPSBtYXNrOw0K
KwlrZXZlbnQtPmV2ZW50LmNvb2tpZSA9IGNvb2tpZTsNCisNCisJSU5JVF9MSVNUX0hFQUQoJmtl
dmVudC0+bGlzdCk7DQorDQorCWlmIChuYW1lKSB7DQorCQlzaXplX3QgbGVuLCByZW0sIGV2ZW50
X3NpemUgPSBzaXplb2Yoc3RydWN0IGlub3RpZnlfZXZlbnQpOw0KKw0KKwkJLyoNCisJCSAqIFdl
IG5lZWQgdG8gcGFkIHRoZSBmaWxlbmFtZSBzbyBhcyB0byBwcm9wZXJseSBhbGlnbiBhbg0KKwkJ
ICogYXJyYXkgb2YgaW5vdGlmeV9ldmVudCBzdHJ1Y3R1cmVzLiAgQmVjYXVzZSB0aGUgc3RydWN0
dXJlIGlzDQorCQkgKiBzbWFsbCBhbmQgdGhlIGNvbW1vbiBjYXNlIGlzIGEgc21hbGwgZmlsZW5h
bWUsIHdlIGp1c3Qgcm91bmQNCisJCSAqIHVwIHRvIHRoZSBuZXh0IG11bHRpcGxlIG9mIHRoZSBz
dHJ1Y3R1cmUncyBzaXplb2YuICBUaGlzIGlzDQorCQkgKiBzaW1wbGUgYW5kIHNhZmUgZm9yIGFs
bCBhcmNoaXRlY3R1cmVzLg0KKwkJICovDQorCQlsZW4gPSBzdHJsZW4obmFtZSkgKyAxOw0KKwkJ
cmVtID0gZXZlbnRfc2l6ZSAtIGxlbjsNCisJCWlmIChsZW4gPiBldmVudF9zaXplKSB7DQorCQkJ
cmVtID0gZXZlbnRfc2l6ZSAtIChsZW4gJSBldmVudF9zaXplKTsNCisJCQlpZiAobGVuICUgZXZl
bnRfc2l6ZSA9PSAwKQ0KKwkJCQlyZW0gPSAwOw0KKwkJfQ0KKwkJbGVuICs9IHJlbTsNCisNCisJ
CWtldmVudC0+bmFtZSA9IGttYWxsb2MobGVuLCBHRlBfS0VSTkVMKTsNCisJCWlmICh1bmxpa2Vs
eSgha2V2ZW50LT5uYW1lKSkgew0KKwkJCWttZW1fY2FjaGVfZnJlZShldmVudF9jYWNoZXAsIGtl
dmVudCk7DQorCQkJcmV0dXJuIE5VTEw7DQorCQl9DQorCQltZW1zZXQoa2V2ZW50LT5uYW1lLCAw
LCBsZW4pOw0KKwkJc3RybmNweShrZXZlbnQtPm5hbWUsIG5hbWUsIHN0cmxlbihuYW1lKSk7DQor
CQlrZXZlbnQtPmV2ZW50LmxlbiA9IGxlbjsNCisJfSBlbHNlIHsNCisJCWtldmVudC0+ZXZlbnQu
bGVuID0gMDsNCisJCWtldmVudC0+bmFtZSA9IE5VTEw7DQorCX0NCisNCisJcmV0dXJuIGtldmVu
dDsNCit9DQorDQorLyoNCisgKiBpbm90aWZ5X2Rldl9nZXRfZXZlbnQgLSByZXR1cm4gdGhlIG5l
eHQgZXZlbnQgaW4gdGhlIGdpdmVuIGRldidzIHF1ZXVlDQorICoNCisgKiBDYWxsZXIgbXVzdCBo
b2xkIGRldi0+c2VtLg0KKyAqLw0KK3N0YXRpYyBpbmxpbmUgc3RydWN0IGlub3RpZnlfa2VybmVs
X2V2ZW50ICoNCitpbm90aWZ5X2Rldl9nZXRfZXZlbnQoc3RydWN0IGlub3RpZnlfZGV2aWNlICpk
ZXYpDQorew0KKwlyZXR1cm4gbGlzdF9lbnRyeShkZXYtPmV2ZW50cy5uZXh0LCBzdHJ1Y3QgaW5v
dGlmeV9rZXJuZWxfZXZlbnQsIGxpc3QpOw0KK30NCisNCisvKg0KKyAqIGlub3RpZnlfZGV2X3F1
ZXVlX2V2ZW50IC0gYWRkIGEgbmV3IGV2ZW50IHRvIHRoZSBnaXZlbiBkZXZpY2UNCisgKg0KKyAq
IENhbGxlciBtdXN0IGhvbGQgZGV2LT5zZW0uICBDYW4gc2xlZXAgKGNhbGxzIGtlcm5lbF9ldmVu
dCgpKS4NCisgKi8NCitzdGF0aWMgdm9pZCBpbm90aWZ5X2Rldl9xdWV1ZV9ldmVudChzdHJ1Y3Qg
aW5vdGlmeV9kZXZpY2UgKmRldiwNCisJCQkJICAgIHN0cnVjdCBpbm90aWZ5X3dhdGNoICp3YXRj
aCwgdTMyIG1hc2ssDQorCQkJCSAgICB1MzIgY29va2llLCBjb25zdCBjaGFyICpuYW1lKQ0KK3sN
CisJc3RydWN0IGlub3RpZnlfa2VybmVsX2V2ZW50ICprZXZlbnQsICpsYXN0Ow0KKw0KKwkvKiBj
b2FsZXNjaW5nOiBkcm9wIHRoaXMgZXZlbnQgaWYgaXQgaXMgYSBkdXBlIG9mIHRoZSBwcmV2aW91
cyAqLw0KKwlsYXN0ID0gaW5vdGlmeV9kZXZfZ2V0X2V2ZW50KGRldik7DQorCWlmIChkZXYtPmV2
ZW50X2NvdW50ICYmIGxhc3QtPmV2ZW50Lm1hc2sgPT0gbWFzayAmJg0KKwkJCWxhc3QtPmV2ZW50
LmNvb2tpZSA9PSBjb29raWUgJiYNCisJCQlsYXN0LT5ldmVudC53ZCA9PSB3YXRjaC0+d2QpIHsN
CisJCWNvbnN0IGNoYXIgKmxhc3RuYW1lID0gbGFzdC0+bmFtZTsNCisNCisJCWlmICghbmFtZSAm
JiAhbGFzdG5hbWUpDQorCQkJcmV0dXJuOw0KKwkJaWYgKG5hbWUgJiYgbGFzdG5hbWUgJiYgIXN0
cmNtcChsYXN0bmFtZSwgbmFtZSkpDQorCQkJcmV0dXJuOw0KKwl9DQorDQorCS8qIHRoZSBxdWV1
ZSBvdmVyZmxvd2VkIGFuZCB3ZSBhbHJlYWR5IHNlbnQgdGhlIFFfT1ZFUkZMT1cgZXZlbnQgKi8N
CisJaWYgKHVubGlrZWx5KGRldi0+ZXZlbnRfY291bnQgPiBkZXYtPm1heF9ldmVudHMpKQ0KKwkJ
cmV0dXJuOw0KKw0KKwkvKiBpZiB0aGUgcXVldWUgb3ZlcmZsb3dzLCB3ZSBuZWVkIHRvIG5vdGlm
eSB1c2VyIHNwYWNlICovDQorCWlmICh1bmxpa2VseShkZXYtPmV2ZW50X2NvdW50ID09IGRldi0+
bWF4X2V2ZW50cykpDQorCQlrZXZlbnQgPSBrZXJuZWxfZXZlbnQoLTEsIElOX1FfT1ZFUkZMT1cs
IGNvb2tpZSwgTlVMTCk7DQorCWVsc2UNCisJCWtldmVudCA9IGtlcm5lbF9ldmVudCh3YXRjaC0+
d2QsIG1hc2ssIGNvb2tpZSwgbmFtZSk7DQorDQorCWlmICh1bmxpa2VseSgha2V2ZW50KSkNCisJ
CXJldHVybjsNCisNCisJLyogcXVldWUgdGhlIGV2ZW50IGFuZCB3YWtlIHVwIGFueW9uZSB3YWl0
aW5nICovDQorCWRldi0+ZXZlbnRfY291bnQrKzsNCisJZGV2LT5xdWV1ZV9zaXplICs9IHNpemVv
ZihzdHJ1Y3QgaW5vdGlmeV9ldmVudCkgKyBrZXZlbnQtPmV2ZW50LmxlbjsNCisJbGlzdF9hZGRf
dGFpbCgma2V2ZW50LT5saXN0LCAmZGV2LT5ldmVudHMpOw0KKwl3YWtlX3VwX2ludGVycnVwdGli
bGUoJmRldi0+d3EpOw0KK30NCisNCisvKg0KKyAqIHJlbW92ZV9rZXZlbnQgLSBjbGVhbnMgdXAg
YW5kIHVsdGltYXRlbHkgZnJlZXMgdGhlIGdpdmVuIGtldmVudA0KKyAqDQorICogQ2FsbGVyIG11
c3QgaG9sZCBkZXYtPnNlbS4NCisgKi8NCitzdGF0aWMgdm9pZCByZW1vdmVfa2V2ZW50KHN0cnVj
dCBpbm90aWZ5X2RldmljZSAqZGV2LA0KKwkJCSAgc3RydWN0IGlub3RpZnlfa2VybmVsX2V2ZW50
ICprZXZlbnQpDQorew0KKwlsaXN0X2RlbCgma2V2ZW50LT5saXN0KTsNCisNCisJZGV2LT5ldmVu
dF9jb3VudC0tOw0KKwlkZXYtPnF1ZXVlX3NpemUgLT0gc2l6ZW9mKHN0cnVjdCBpbm90aWZ5X2V2
ZW50KSArIGtldmVudC0+ZXZlbnQubGVuOw0KKw0KKwlrZnJlZShrZXZlbnQtPm5hbWUpOw0KKwlr
bWVtX2NhY2hlX2ZyZWUoZXZlbnRfY2FjaGVwLCBrZXZlbnQpOw0KK30NCisNCisvKg0KKyAqIGlu
b3RpZnlfZGV2X2V2ZW50X2RlcXVldWUgLSBkZXN0cm95IGFuIGV2ZW50IG9uIHRoZSBnaXZlbiBk
ZXZpY2UNCisgKg0KKyAqIENhbGxlciBtdXN0IGhvbGQgZGV2LT5zZW0uDQorICovDQorc3RhdGlj
IHZvaWQgaW5vdGlmeV9kZXZfZXZlbnRfZGVxdWV1ZShzdHJ1Y3QgaW5vdGlmeV9kZXZpY2UgKmRl
dikNCit7DQorCWlmICghbGlzdF9lbXB0eSgmZGV2LT5ldmVudHMpKSB7DQorCQlzdHJ1Y3QgaW5v
dGlmeV9rZXJuZWxfZXZlbnQgKmtldmVudDsNCisJCWtldmVudCA9IGlub3RpZnlfZGV2X2dldF9l
dmVudChkZXYpOw0KKwkJcmVtb3ZlX2tldmVudChkZXYsIGtldmVudCk7DQorCX0NCit9DQorDQor
LyoNCisgKiBpbm90aWZ5X2Rldl9nZXRfd2QgLSByZXR1cm5zIHRoZSBuZXh0IFdEIGZvciB1c2Ug
YnkgdGhlIGdpdmVuIGRldg0KKyAqDQorICogQ2FsbGVycyBtdXN0IGhvbGQgZGV2LT5zZW0uICBU
aGlzIGZ1bmN0aW9uIGNhbiBzbGVlcC4NCisgKi8NCitzdGF0aWMgaW50IGlub3RpZnlfZGV2X2dl
dF93ZChzdHJ1Y3QgaW5vdGlmeV9kZXZpY2UgKmRldiwNCisJCQkgICAgIHN0cnVjdCBpbm90aWZ5
X3dhdGNoICp3YXRjaCkNCit7DQorCWludCByZXQ7DQorDQorCWRvIHsNCisJCWlmICh1bmxpa2Vs
eSghaWRyX3ByZV9nZXQoJmRldi0+aWRyLCBHRlBfS0VSTkVMKSkpDQorCQkJcmV0dXJuIC1FTk9T
UEM7DQorCQlyZXQgPSBpZHJfZ2V0X25ldygmZGV2LT5pZHIsIHdhdGNoLCAmd2F0Y2gtPndkKTsN
CisJfSB3aGlsZSAocmV0ID09IC1FQUdBSU4pOw0KKw0KKwlyZXR1cm4gcmV0Ow0KK30NCisNCisv
Kg0KKyAqIGNyZWF0ZV93YXRjaCAtIGNyZWF0ZXMgYSB3YXRjaCBvbiB0aGUgZ2l2ZW4gZGV2aWNl
Lg0KKyAqDQorICogQ2FsbGVycyBtdXN0IGhvbGQgZGV2LT5zZW0uICBDYWxscyBpbm90aWZ5X2Rl
dl9nZXRfd2QoKSBzbyBtYXkgc2xlZXAuDQorICogQm90aCAnZGV2JyBhbmQgJ2lub2RlJyAoYnkg
d2F5IG9mIG5hbWVpZGF0YSkgbmVlZCB0byBiZSBwaW5uZWQuDQorICovDQorc3RhdGljIHN0cnVj
dCBpbm90aWZ5X3dhdGNoICpjcmVhdGVfd2F0Y2goc3RydWN0IGlub3RpZnlfZGV2aWNlICpkZXYs
DQorCQkJCQkgIHUzMiBtYXNrLCBzdHJ1Y3QgaW5vZGUgKmlub2RlKQ0KK3sNCisJc3RydWN0IGlu
b3RpZnlfd2F0Y2ggKndhdGNoOw0KKwlpbnQgcmV0Ow0KKw0KKwlpZiAoYXRvbWljX3JlYWQoJmRl
di0+dXNlci0+aW5vdGlmeV93YXRjaGVzKSA+PSBtYXhfdXNlcl93YXRjaGVzKQ0KKwkJcmV0dXJu
IEVSUl9QVFIoLUVOT1NQQyk7DQorDQorCXdhdGNoID0ga21lbV9jYWNoZV9hbGxvYyh3YXRjaF9j
YWNoZXAsIEdGUF9LRVJORUwpOw0KKwlpZiAodW5saWtlbHkoIXdhdGNoKSkNCisJCXJldHVybiBF
UlJfUFRSKC1FTk9NRU0pOw0KKw0KKwlyZXQgPSBpbm90aWZ5X2Rldl9nZXRfd2QoZGV2LCB3YXRj
aCk7DQorCWlmICh1bmxpa2VseShyZXQpKSB7DQorCQlrbWVtX2NhY2hlX2ZyZWUod2F0Y2hfY2Fj
aGVwLCB3YXRjaCk7DQorCQlyZXR1cm4gRVJSX1BUUihyZXQpOw0KKwl9DQorDQorCXdhdGNoLT5t
YXNrID0gbWFzazsNCisJYXRvbWljX3NldCgmd2F0Y2gtPmNvdW50LCAwKTsNCisJSU5JVF9MSVNU
X0hFQUQoJndhdGNoLT5kX2xpc3QpOw0KKwlJTklUX0xJU1RfSEVBRCgmd2F0Y2gtPmlfbGlzdCk7
DQorDQorCS8qIHNhdmUgYSByZWZlcmVuY2UgdG8gZGV2aWNlIGFuZCBidW1wIHRoZSBjb3VudCB0
byBtYWtlIGl0IG9mZmljaWFsICovDQorCWdldF9pbm90aWZ5X2RldihkZXYpOw0KKwl3YXRjaC0+
ZGV2ID0gZGV2Ow0KKw0KKwkvKg0KKwkgKiBTYXZlIGEgcmVmZXJlbmNlIHRvIHRoZSBpbm9kZSBh
bmQgYnVtcCB0aGUgcmVmIGNvdW50IHRvIG1ha2UgaXQNCisJICogb2ZmaWNpYWwuICBXZSBob2xk
IGEgcmVmZXJlbmNlIHRvIG5hbWVpZGF0YSwgd2hpY2ggbWFrZXMgdGhpcyBzYWZlLg0KKwkgKi8N
CisJd2F0Y2gtPmlub2RlID0gaWdyYWIoaW5vZGUpOw0KKw0KKwkvKiBidW1wIG91ciBvd24gY291
bnQsIGNvcnJlc3BvbmRpbmcgdG8gb3VyIGVudHJ5IGluIGRldi0+d2F0Y2hlcyAqLw0KKwlnZXRf
aW5vdGlmeV93YXRjaCh3YXRjaCk7DQorDQorCWF0b21pY19pbmMoJmRldi0+dXNlci0+aW5vdGlm
eV93YXRjaGVzKTsNCisNCisJcmV0dXJuIHdhdGNoOw0KK30NCisNCisvKg0KKyAqIGlub3RpZnlf
ZmluZF9kZXYgLSBmaW5kIHRoZSB3YXRjaCBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIGlub2Rl
IGFuZCBkZXYNCisgKg0KKyAqIENhbGxlcnMgbXVzdCBob2xkIGlub2RlLT5pbm90aWZ5X3NlbS4N
CisgKi8NCitzdGF0aWMgc3RydWN0IGlub3RpZnlfd2F0Y2ggKmlub2RlX2ZpbmRfZGV2KHN0cnVj
dCBpbm9kZSAqaW5vZGUsDQorCQkJCQkgICAgc3RydWN0IGlub3RpZnlfZGV2aWNlICpkZXYpDQor
ew0KKwlzdHJ1Y3QgaW5vdGlmeV93YXRjaCAqd2F0Y2g7DQorDQorCWxpc3RfZm9yX2VhY2hfZW50
cnkod2F0Y2gsICZpbm9kZS0+aW5vdGlmeV93YXRjaGVzLCBpX2xpc3QpIHsNCisJCWlmICh3YXRj
aC0+ZGV2ID09IGRldikNCisJCQlyZXR1cm4gd2F0Y2g7DQorCX0NCisNCisJcmV0dXJuIE5VTEw7
DQorfQ0KKw0KKy8qDQorICogaW5vdGlmeV9kZXZfaXNfd2F0Y2hpbmdfaW5vZGUgLSBpcyB0aGlz
IGRldmljZSB3YXRjaGluZyB0aGlzIGlub2RlPw0KKyAqDQorICogQ2FsbGVycyBtdXN0IGhvbGQg
ZGV2LT5zZW0uDQorICovDQorc3RhdGljIGlubGluZSBpbnQgaW5vdGlmeV9kZXZfaXNfd2F0Y2hp
bmdfaW5vZGUoc3RydWN0IGlub3RpZnlfZGV2aWNlICpkZXYsDQorCQkJCQkJc3RydWN0IGlub2Rl
ICppbm9kZSkNCit7DQorCXN0cnVjdCBpbm90aWZ5X3dhdGNoICp3YXRjaDsNCisNCisJbGlzdF9m
b3JfZWFjaF9lbnRyeSh3YXRjaCwgJmRldi0+d2F0Y2hlcywgZF9saXN0KSB7DQorCQlpZiAod2F0
Y2gtPmlub2RlID09IGlub2RlKQ0KKwkJCXJldHVybiAxOw0KKwl9DQorDQorCXJldHVybiAwOw0K
K30NCisNCisvKg0KKyAqIHJlbW92ZV93YXRjaF9ub19ldmVudCAtIHJlbW92ZV93YXRjaCgpIHdp
dGhvdXQgdGhlIElOX0lHTk9SRUQgZXZlbnQuDQorICovDQorc3RhdGljIHZvaWQgcmVtb3ZlX3dh
dGNoX25vX2V2ZW50KHN0cnVjdCBpbm90aWZ5X3dhdGNoICp3YXRjaCwNCisJCQkJICBzdHJ1Y3Qg
aW5vdGlmeV9kZXZpY2UgKmRldikNCit7DQorCWxpc3RfZGVsKCZ3YXRjaC0+aV9saXN0KTsNCisJ
bGlzdF9kZWwoJndhdGNoLT5kX2xpc3QpOw0KKw0KKwlhdG9taWNfZGVjKCZkZXYtPnVzZXItPmlu
b3RpZnlfd2F0Y2hlcyk7DQorCWlkcl9yZW1vdmUoJmRldi0+aWRyLCB3YXRjaC0+d2QpOw0KKwlw
dXRfaW5vdGlmeV93YXRjaCh3YXRjaCk7DQorfQ0KKw0KKy8qDQorICogcmVtb3ZlX3dhdGNoIC0g
UmVtb3ZlIGEgd2F0Y2ggZnJvbSBib3RoIHRoZSBkZXZpY2UgYW5kIHRoZSBpbm9kZS4gIFNlbmRz
DQorICogdGhlIElOX0lHTk9SRUQgZXZlbnQgdG8gdGhlIGdpdmVuIGRldmljZSBzaWduaWZ5aW5n
IHRoYXQgdGhlIGlub2RlIGlzIG5vDQorICogbG9uZ2VyIHdhdGNoZWQuDQorICoNCisgKiBDYWxs
ZXJzIG11c3QgaG9sZCBib3RoIGlub2RlLT5pbm90aWZ5X3NlbSBhbmQgZGV2LT5zZW0uICBXZSBk
cm9wIGENCisgKiByZWZlcmVuY2UgdG8gdGhlIGlub2RlIGJlZm9yZSByZXR1cm5pbmcuDQorICoN
CisgKiBUaGUgaW5vZGUgaXMgbm90IGlwdXQoKSBzbyBhcyB0byByZW1haW4gYXRvbWljLiAgSWYg
dGhlIGlub2RlIG5lZWRzIHRvIGJlDQorICogaXB1dCgpLCB0aGUgY2FsbCByZXR1cm5zIG9uZS4g
IE90aGVyd2lzZSwgaXQgcmV0dXJucyB6ZXJvLg0KKyAqLw0KK3N0YXRpYyB2b2lkIHJlbW92ZV93
YXRjaChzdHJ1Y3QgaW5vdGlmeV93YXRjaCAqd2F0Y2gsc3RydWN0IGlub3RpZnlfZGV2aWNlICpk
ZXYpDQorew0KKwlpbm90aWZ5X2Rldl9xdWV1ZV9ldmVudChkZXYsIHdhdGNoLCBJTl9JR05PUkVE
LCAwLCBOVUxMKTsNCisJcmVtb3ZlX3dhdGNoX25vX2V2ZW50KHdhdGNoLCBkZXYpOw0KK30NCisN
CisvKiBLZXJuZWwgQVBJICovDQorDQorLyoqDQorICogaW5vdGlmeV9pbm9kZV9xdWV1ZV9ldmVu
dCAtIHF1ZXVlIGFuIGV2ZW50IHRvIGFsbCB3YXRjaGVzIG9uIHRoaXMgaW5vZGUNCisgKiBAaW5v
ZGU6IGlub2RlIGV2ZW50IGlzIG9yaWdpbmF0aW5nIGZyb20NCisgKiBAbWFzazogZXZlbnQgbWFz
ayBkZXNjcmliaW5nIHRoaXMgZXZlbnQNCisgKiBAY29va2llOiBjb29raWUgZm9yIHN5bmNocm9u
aXphdGlvbiwgb3IgemVybw0KKyAqIEBuYW1lOiBmaWxlbmFtZSwgaWYgYW55DQorICovDQordm9p
ZCBpbm90aWZ5X2lub2RlX3F1ZXVlX2V2ZW50KHN0cnVjdCBpbm9kZSAqaW5vZGUsIHUzMiBtYXNr
LCB1MzIgY29va2llLA0KKwkJCSAgICAgICBjb25zdCBjaGFyICpuYW1lKQ0KK3sNCisJc3RydWN0
IGlub3RpZnlfd2F0Y2ggKndhdGNoOw0KKw0KKwlkb3duKCZpbm9kZS0+aW5vdGlmeV9zZW0pOw0K
KwlsaXN0X2Zvcl9lYWNoX2VudHJ5KHdhdGNoLCAmaW5vZGUtPmlub3RpZnlfd2F0Y2hlcywgaV9s
aXN0KSB7DQorCQlpZiAod2F0Y2gtPm1hc2sgJiBtYXNrKSB7DQorCQkJc3RydWN0IGlub3RpZnlf
ZGV2aWNlICpkZXYgPSB3YXRjaC0+ZGV2Ow0KKwkJCWRvd24oJmRldi0+c2VtKTsNCisJCQlpbm90
aWZ5X2Rldl9xdWV1ZV9ldmVudChkZXYsIHdhdGNoLCBtYXNrLCBjb29raWUsIG5hbWUpOw0KKwkJ
CXVwKCZkZXYtPnNlbSk7DQorCQl9DQorCX0NCisJdXAoJmlub2RlLT5pbm90aWZ5X3NlbSk7DQor
fQ0KK0VYUE9SVF9TWU1CT0xfR1BMKGlub3RpZnlfaW5vZGVfcXVldWVfZXZlbnQpOw0KKw0KKy8q
Kg0KKyAqIGlub3RpZnlfZGVudHJ5X3BhcmVudF9xdWV1ZV9ldmVudCAtIHF1ZXVlIGFuIGV2ZW50
IHRvIGEgZGVudHJ5J3MgcGFyZW50DQorICogQGRlbnRyeTogdGhlIGRlbnRyeSBpbiBxdWVzdGlv
biwgd2UgcXVldWUgYWdhaW5zdCB0aGlzIGRlbnRyeSdzIHBhcmVudA0KKyAqIEBtYXNrOiBldmVu
dCBtYXNrIGRlc2NyaWJpbmcgdGhpcyBldmVudA0KKyAqIEBjb29raWU6IGNvb2tpZSBmb3Igc3lu
Y2hyb25pemF0aW9uLCBvciB6ZXJvDQorICogQG5hbWU6IGZpbGVuYW1lLCBpZiBhbnkNCisgKi8N
Cit2b2lkIGlub3RpZnlfZGVudHJ5X3BhcmVudF9xdWV1ZV9ldmVudChzdHJ1Y3QgZGVudHJ5ICpk
ZW50cnksIHUzMiBtYXNrLA0KKwkJCQkgICAgICAgdTMyIGNvb2tpZSwgY29uc3QgY2hhciAqbmFt
ZSkNCit7DQorCXN0cnVjdCBkZW50cnkgKnBhcmVudDsNCisJc3RydWN0IGlub2RlICppbm9kZTsN
CisNCisJc3Bpbl9sb2NrKCZkZW50cnktPmRfbG9jayk7DQorCXBhcmVudCA9IGRlbnRyeS0+ZF9w
YXJlbnQ7DQorCWlub2RlID0gcGFyZW50LT5kX2lub2RlOw0KKw0KKwkvKiBXZSBpbnRlbnRpYWxs
eSBkbyB0aGUgbGlzdF9lbXB0eSgpIGxvY2tsZXNzLiAgVGhlIHJhY2UgaXMgZmluZS4gKi8NCisJ
aWYgKCFsaXN0X2VtcHR5KCZpbm9kZS0+aW5vdGlmeV93YXRjaGVzKSkgew0KKwkJZGdldChwYXJl
bnQpOw0KKwkJc3Bpbl91bmxvY2soJmRlbnRyeS0+ZF9sb2NrKTsNCisJCWlub3RpZnlfaW5vZGVf
cXVldWVfZXZlbnQoaW5vZGUsIG1hc2ssIGNvb2tpZSwgbmFtZSk7DQorCQlkcHV0KHBhcmVudCk7
DQorCX0gZWxzZQ0KKwkJc3Bpbl91bmxvY2soJmRlbnRyeS0+ZF9sb2NrKTsNCit9DQorRVhQT1JU
X1NZTUJPTF9HUEwoaW5vdGlmeV9kZW50cnlfcGFyZW50X3F1ZXVlX2V2ZW50KTsNCisNCisvKioN
CisgKiBpbm90aWZ5X2dldF9jb29raWUgLSByZXR1cm4gYSB1bmlxdWUgY29va2llIGZvciB1c2Ug
aW4gc3luY2hyb25pemluZyBldmVudHMuDQorICovDQordTMyIGlub3RpZnlfZ2V0X2Nvb2tpZSh2
b2lkKQ0KK3sNCisJcmV0dXJuIGF0b21pY19pbmNfcmV0dXJuKCZpbm90aWZ5X2Nvb2tpZSk7DQor
fQ0KK0VYUE9SVF9TWU1CT0xfR1BMKGlub3RpZnlfZ2V0X2Nvb2tpZSk7DQorDQorLyoqDQorICog
aW5vdGlmeV91bm1vdW50X2lub2RlcyAtIGFuIHNiIGlzIHVubW91bnRpbmcuICBoYW5kbGUgYW55
IHdhdGNoZWQgaW5vZGVzLg0KKyAqIEBsaXN0OiBsaXN0IG9mIGlub2RlcyBiZWluZyB1bm1vdW50
ZWQgKHNiLT5zX2lub2RlcykNCisgKg0KKyAqIENhbGxlZCB3aXRoIGlub2RlX2xvY2sgaGVsZCwg
cHJvdGVjdGluZyB0aGUgdW5tb3VudGluZyBzdXBlciBibG9jaydzIGxpc3QNCisgKiBvZiBpbm9k
ZXMsIGFuZCB3aXRoIGlwcnVuZV9zZW0gaGVsZCwga2VlcGluZyBzaHJpbmtfaWNhY2hlX21lbW9y
eSgpIGF0IGJheS4NCisgKiBXZSB0ZW1wb3JhcmlseSBkcm9wIGlub2RlX2xvY2ssIGhvd2V2ZXIs
IGFuZCBDQU4gYmxvY2suDQorICovDQordm9pZCBpbm90aWZ5X3VubW91bnRfaW5vZGVzKHN0cnVj
dCBsaXN0X2hlYWQgKmxpc3QpDQorew0KKwlzdHJ1Y3QgaW5vZGUgKmlub2RlLCAqbmV4dF9pOw0K
Kw0KKwlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoaW5vZGUsIG5leHRfaSwgbGlzdCwgaV9zYl9s
aXN0KSB7DQorCQlzdHJ1Y3QgaW5vdGlmeV93YXRjaCAqd2F0Y2gsICpuZXh0X3c7DQorCQlzdHJ1
Y3QgbGlzdF9oZWFkICp3YXRjaGVzOw0KKw0KKwkJLyoNCisJCSAqIFdlIGNhbiBzYWZlbHkgZHJv
cCBpbm9kZV9sb2NrIGhlcmUgYmVjYXVzZSB0aGUgcGVyLXNiIGxpc3QNCisJCSAqIG9mIGlub2Rl
cyBtdXN0IG5vdCBjaGFuZ2UgZHVyaW5nIHVubW91bnQgYW5kIGlwcnVuZV9zZW0NCisJCSAqIGtl
ZXBzIHNocmlua19pY2FjaGVfbWVtb3J5KCkgYXdheS4NCisJCSAqLw0KKwkJc3Bpbl91bmxvY2so
Jmlub2RlX2xvY2spOw0KKw0KKwkJLyogZm9yIGVhY2ggd2F0Y2gsIHNlbmQgSU5fVU5NT1VOVCBh
bmQgdGhlbiByZW1vdmUgaXQgKi8NCisJCWRvd24oJmlub2RlLT5pbm90aWZ5X3NlbSk7DQorCQl3
YXRjaGVzID0gJmlub2RlLT5pbm90aWZ5X3dhdGNoZXM7DQorCQlsaXN0X2Zvcl9lYWNoX2VudHJ5
X3NhZmUod2F0Y2gsIG5leHRfdywgd2F0Y2hlcywgaV9saXN0KSB7DQorCQkJc3RydWN0IGlub3Rp
ZnlfZGV2aWNlICpkZXYgPSB3YXRjaC0+ZGV2Ow0KKwkJCWRvd24oJmRldi0+c2VtKTsNCisJCQlp
bm90aWZ5X2Rldl9xdWV1ZV9ldmVudChkZXYsIHdhdGNoLCBJTl9VTk1PVU5ULDAsTlVMTCk7DQor
CQkJcmVtb3ZlX3dhdGNoKHdhdGNoLCBkZXYpOw0KKwkJCXVwKCZkZXYtPnNlbSk7DQorCQl9DQor
CQl1cCgmaW5vZGUtPmlub3RpZnlfc2VtKTsNCisNCisJCXNwaW5fbG9jaygmaW5vZGVfbG9jayk7
DQorCX0NCit9DQorRVhQT1JUX1NZTUJPTF9HUEwoaW5vdGlmeV91bm1vdW50X2lub2Rlcyk7DQor
DQorLyoqDQorICogaW5vdGlmeV9pbm9kZV9pc19kZWFkIC0gYW4gaW5vZGUgaGFzIGJlZW4gZGVs
ZXRlZCwgY2xlYW51cCBhbnkgd2F0Y2hlcw0KKyAqIEBpbm9kZTogaW5vZGUgdGhhdCBpcyBhYm91
dCB0byBiZSByZW1vdmVkDQorICovDQordm9pZCBpbm90aWZ5X2lub2RlX2lzX2RlYWQoc3RydWN0
IGlub2RlICppbm9kZSkNCit7DQorCXN0cnVjdCBpbm90aWZ5X3dhdGNoICp3YXRjaCwgKm5leHQ7
DQorDQorCWRvd24oJmlub2RlLT5pbm90aWZ5X3NlbSk7DQorCWxpc3RfZm9yX2VhY2hfZW50cnlf
c2FmZSh3YXRjaCwgbmV4dCwgJmlub2RlLT5pbm90aWZ5X3dhdGNoZXMsIGlfbGlzdCkgew0KKwkJ
c3RydWN0IGlub3RpZnlfZGV2aWNlICpkZXYgPSB3YXRjaC0+ZGV2Ow0KKwkJZG93bigmZGV2LT5z
ZW0pOw0KKwkJcmVtb3ZlX3dhdGNoKHdhdGNoLCBkZXYpOw0KKwkJdXAoJmRldi0+c2VtKTsNCisJ
fQ0KKwl1cCgmaW5vZGUtPmlub3RpZnlfc2VtKTsNCit9DQorRVhQT1JUX1NZTUJPTF9HUEwoaW5v
dGlmeV9pbm9kZV9pc19kZWFkKTsNCisNCisvKiBEZXZpY2UgSW50ZXJmYWNlICovDQorDQorc3Rh
dGljIHVuc2lnbmVkIGludCBpbm90aWZ5X3BvbGwoc3RydWN0IGZpbGUgKmZpbGUsIHBvbGxfdGFi
bGUgKndhaXQpDQorew0KKwlzdHJ1Y3QgaW5vdGlmeV9kZXZpY2UgKmRldiA9IGZpbGUtPnByaXZh
dGVfZGF0YTsNCisJaW50IHJldCA9IDA7DQorDQorCXBvbGxfd2FpdChmaWxlLCAmZGV2LT53cSwg
d2FpdCk7DQorCWRvd24oJmRldi0+c2VtKTsNCisJaWYgKCFsaXN0X2VtcHR5KCZkZXYtPmV2ZW50
cykpDQorCQlyZXQgPSBQT0xMSU4gfCBQT0xMUkROT1JNOw0KKwl1cCgmZGV2LT5zZW0pOw0KKw0K
KwlyZXR1cm4gcmV0Ow0KK30NCisNCitzdGF0aWMgc3NpemVfdCBpbm90aWZ5X3JlYWQoc3RydWN0
IGZpbGUgKmZpbGUsIGNoYXIgX191c2VyICpidWYsDQorCQkJICAgIHNpemVfdCBjb3VudCwgbG9m
Zl90ICpwb3MpDQorew0KKwlzaXplX3QgZXZlbnRfc2l6ZSA9IHNpemVvZiAoc3RydWN0IGlub3Rp
ZnlfZXZlbnQpOw0KKwlzdHJ1Y3QgaW5vdGlmeV9kZXZpY2UgKmRldjsNCisJY2hhciBfX3VzZXIg
KnN0YXJ0Ow0KKwlpbnQgcmV0Ow0KKwlERUZJTkVfV0FJVCh3YWl0KTsNCisNCisJc3RhcnQgPSBi
dWY7DQorCWRldiA9IGZpbGUtPnByaXZhdGVfZGF0YTsNCisNCisJd2hpbGUgKDEpIHsNCisJCWlu
dCBldmVudHM7DQorDQorCQlwcmVwYXJlX3RvX3dhaXQoJmRldi0+d3EsICZ3YWl0LCBUQVNLX0lO
VEVSUlVQVElCTEUpOw0KKw0KKwkJZG93bigmZGV2LT5zZW0pOw0KKwkJZXZlbnRzID0gIWxpc3Rf
ZW1wdHkoJmRldi0+ZXZlbnRzKTsNCisJCXVwKCZkZXYtPnNlbSk7DQorCQlpZiAoZXZlbnRzKSB7
DQorCQkJcmV0ID0gMDsNCisJCQlicmVhazsNCisJCX0NCisNCisJCWlmIChmaWxlLT5mX2ZsYWdz
ICYgT19OT05CTE9DSykgew0KKwkJCXJldCA9IC1FQUdBSU47DQorCQkJYnJlYWs7DQorCQl9DQor
DQorCQlpZiAoc2lnbmFsX3BlbmRpbmcoY3VycmVudCkpIHsNCisJCQlyZXQgPSAtRUlOVFI7DQor
CQkJYnJlYWs7DQorCQl9DQorDQorCQlzY2hlZHVsZSgpOw0KKwl9DQorDQorCWZpbmlzaF93YWl0
KCZkZXYtPndxLCAmd2FpdCk7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwlkb3du
KCZkZXYtPnNlbSk7DQorCXdoaWxlICgxKSB7DQorCQlzdHJ1Y3QgaW5vdGlmeV9rZXJuZWxfZXZl
bnQgKmtldmVudDsNCisNCisJCXJldCA9IGJ1ZiAtIHN0YXJ0Ow0KKwkJaWYgKGxpc3RfZW1wdHko
JmRldi0+ZXZlbnRzKSkNCisJCQlicmVhazsNCisNCisJCWtldmVudCA9IGlub3RpZnlfZGV2X2dl
dF9ldmVudChkZXYpOw0KKwkJaWYgKGV2ZW50X3NpemUgKyBrZXZlbnQtPmV2ZW50LmxlbiA+IGNv
dW50KQ0KKwkJCWJyZWFrOw0KKw0KKwkJaWYgKGNvcHlfdG9fdXNlcihidWYsICZrZXZlbnQtPmV2
ZW50LCBldmVudF9zaXplKSkgew0KKwkJCXJldCA9IC1FRkFVTFQ7DQorCQkJYnJlYWs7DQorCQl9
DQorCQlidWYgKz0gZXZlbnRfc2l6ZTsNCisJCWNvdW50IC09IGV2ZW50X3NpemU7DQorDQorCQlp
ZiAoa2V2ZW50LT5uYW1lKSB7DQorCQkJaWYgKGNvcHlfdG9fdXNlcihidWYsIGtldmVudC0+bmFt
ZSwga2V2ZW50LT5ldmVudC5sZW4pKXsNCisJCQkJcmV0ID0gLUVGQVVMVDsNCisJCQkJYnJlYWs7
DQorCQkJfQ0KKwkJCWJ1ZiArPSBrZXZlbnQtPmV2ZW50LmxlbjsNCisJCQljb3VudCAtPSBrZXZl
bnQtPmV2ZW50LmxlbjsNCisJCX0NCisNCisJCXJlbW92ZV9rZXZlbnQoZGV2LCBrZXZlbnQpOw0K
Kwl9DQorCXVwKCZkZXYtPnNlbSk7DQorDQorCXJldHVybiByZXQ7DQorfQ0KKw0KK3N0YXRpYyBp
bnQgaW5vdGlmeV9vcGVuKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQ0K
K3sNCisJc3RydWN0IGlub3RpZnlfZGV2aWNlICpkZXY7DQorCXN0cnVjdCB1c2VyX3N0cnVjdCAq
dXNlcjsNCisJaW50IHJldDsNCisNCisJdXNlciA9IGdldF91aWQoY3VycmVudC0+dXNlcik7DQor
DQorCWlmICh1bmxpa2VseShhdG9taWNfcmVhZCgmdXNlci0+aW5vdGlmeV9kZXZzKSA+PSBtYXhf
dXNlcl9kZXZpY2VzKSkgew0KKwkJcmV0ID0gLUVNRklMRTsNCisJCWdvdG8gb3V0X2VycjsNCisJ
fQ0KKw0KKwlkZXYgPSBrbWFsbG9jKHNpemVvZihzdHJ1Y3QgaW5vdGlmeV9kZXZpY2UpLCBHRlBf
S0VSTkVMKTsNCisJaWYgKHVubGlrZWx5KCFkZXYpKSB7DQorCQlyZXQgPSAtRU5PTUVNOw0KKwkJ
Z290byBvdXRfZXJyOw0KKwl9DQorDQorCWlkcl9pbml0KCZkZXYtPmlkcik7DQorCUlOSVRfTElT
VF9IRUFEKCZkZXYtPmV2ZW50cyk7DQorCUlOSVRfTElTVF9IRUFEKCZkZXYtPndhdGNoZXMpOw0K
Kwlpbml0X3dhaXRxdWV1ZV9oZWFkKCZkZXYtPndxKTsNCisJc2VtYV9pbml0KCZkZXYtPnNlbSwg
MSk7DQorDQorCWRldi0+ZXZlbnRfY291bnQgPSAwOw0KKwlkZXYtPnF1ZXVlX3NpemUgPSAwOw0K
KwlkZXYtPm1heF9ldmVudHMgPSBtYXhfcXVldWVkX2V2ZW50czsNCisJZGV2LT51c2VyID0gdXNl
cjsNCisJYXRvbWljX3NldCgmZGV2LT5jb3VudCwgMCk7DQorDQorCWdldF9pbm90aWZ5X2Rldihk
ZXYpOw0KKwlhdG9taWNfaW5jKCZjdXJyZW50LT51c2VyLT5pbm90aWZ5X2RldnMpOw0KKw0KKwlm
aWxlLT5wcml2YXRlX2RhdGEgPSBkZXY7DQorDQorCXJldHVybiAwOw0KK291dF9lcnI6DQorCWZy
ZWVfdWlkKHVzZXIpOw0KKwlyZXR1cm4gcmV0Ow0KK30NCisNCitzdGF0aWMgaW50IGlub3RpZnlf
cmVsZWFzZShzdHJ1Y3QgaW5vZGUgKmlnbm9yZWQsIHN0cnVjdCBmaWxlICpmaWxlKQ0KK3sNCisJ
c3RydWN0IGlub3RpZnlfZGV2aWNlICpkZXYgPSBmaWxlLT5wcml2YXRlX2RhdGE7DQorDQorCS8q
DQorCSAqIERlc3Ryb3kgYWxsIG9mIHRoZSB3YXRjaGVzIG9uIHRoaXMgZGV2aWNlLiAgVW5mb3J0
dW5hdGVseSwgbm90IHZlcnkNCisJICogcHJldHR5LiAgV2UgY2Fubm90IGRvIGEgc2ltcGxlIGl0
ZXJhdGlvbiBvdmVyIHRoZSBsaXN0LCBiZWNhdXNlIHdlDQorCSAqIGRvIG5vdCBrbm93IHRoZSBp
bm9kZSB1bnRpbCB3ZSBpdGVyYXRlIHRvIHRoZSB3YXRjaC4gIEJ1dCB3ZSBuZWVkIHRvDQorCSAq
IGhvbGQgaW5vZGUtPmlub3RpZnlfc2VtIGJlZm9yZSBkZXYtPnNlbS4gIFRoZSBmb2xsb3dpbmcg
d29ya3MuDQorCSAqLw0KKwl3aGlsZSAoMSkgew0KKwkJc3RydWN0IGlub3RpZnlfd2F0Y2ggKndh
dGNoOw0KKwkJc3RydWN0IGxpc3RfaGVhZCAqd2F0Y2hlczsNCisJCXN0cnVjdCBpbm9kZSAqaW5v
ZGU7DQorDQorCQlkb3duKCZkZXYtPnNlbSk7DQorCQl3YXRjaGVzID0gJmRldi0+d2F0Y2hlczsN
CisJCWlmIChsaXN0X2VtcHR5KHdhdGNoZXMpKSB7DQorCQkJdXAoJmRldi0+c2VtKTsNCisJCQli
cmVhazsNCisJCX0NCisJCXdhdGNoID0gbGlzdF9lbnRyeSh3YXRjaGVzLT5uZXh0LCBzdHJ1Y3Qg
aW5vdGlmeV93YXRjaCwgZF9saXN0KTsNCisJCWdldF9pbm90aWZ5X3dhdGNoKHdhdGNoKTsNCisJ
CXVwKCZkZXYtPnNlbSk7DQorDQorCQlpbm9kZSA9IHdhdGNoLT5pbm9kZTsNCisJCWRvd24oJmlu
b2RlLT5pbm90aWZ5X3NlbSk7DQorCQlkb3duKCZkZXYtPnNlbSk7DQorCQlyZW1vdmVfd2F0Y2hf
bm9fZXZlbnQod2F0Y2gsIGRldik7DQorCQl1cCgmZGV2LT5zZW0pOw0KKwkJdXAoJmlub2RlLT5p
bm90aWZ5X3NlbSk7DQorCQlwdXRfaW5vdGlmeV93YXRjaCh3YXRjaCk7DQorCX0NCisNCisJLyog
ZGVzdHJveSBhbGwgb2YgdGhlIGV2ZW50cyBvbiB0aGlzIGRldmljZSAqLw0KKwlkb3duKCZkZXYt
PnNlbSk7DQorCXdoaWxlICghbGlzdF9lbXB0eSgmZGV2LT5ldmVudHMpKQ0KKwkJaW5vdGlmeV9k
ZXZfZXZlbnRfZGVxdWV1ZShkZXYpOw0KKwl1cCgmZGV2LT5zZW0pOw0KKw0KKwkvKiBmcmVlIHRo
aXMgZGV2aWNlOiB0aGUgcHV0IG1hdGNoaW5nIHRoZSBnZXQgaW4gaW5vdGlmeV9vcGVuKCkgKi8N
CisJcHV0X2lub3RpZnlfZGV2KGRldik7DQorDQorCXJldHVybiAwOw0KK30NCisNCitzdGF0aWMg
aW50IGlub3RpZnlfYWRkX3dhdGNoKHN0cnVjdCBpbm90aWZ5X2RldmljZSAqZGV2LA0KKwkJCSAg
ICAgaW50IGZkLCB1MzIgbWFzaykNCit7DQorCXN0cnVjdCBpbm90aWZ5X3dhdGNoICp3YXRjaCwg
Km9sZDsNCisJc3RydWN0IGlub2RlICppbm9kZTsNCisJc3RydWN0IGZpbGUgKmZpbHA7DQorCWlu
dCByZXQ7DQorDQorCWZpbHAgPSBmZ2V0KGZkKTsNCisJaWYgKCFmaWxwKQ0KKwkJcmV0dXJuIC1F
QkFERjsNCisJaW5vZGUgPSBmaWxwLT5mX2RlbnRyeS0+ZF9pbm9kZTsNCisNCisJZG93bigmaW5v
ZGUtPmlub3RpZnlfc2VtKTsNCisJZG93bigmZGV2LT5zZW0pOw0KKw0KKwkvKg0KKwkgKiBIYW5k
bGUgdGhlIGNhc2Ugb2YgcmUtYWRkaW5nIGEgd2F0Y2ggb24gYW4gKGlub2RlLGRldikgcGFpciB0
aGF0IHdlDQorCSAqIGFyZSBhbHJlYWR5IHdhdGNoaW5nLiAgV2UganVzdCB1cGRhdGUgdGhlIG1h
c2sgYW5kIHJldHVybiBpdHMgd2QuDQorCSAqLw0KKwlvbGQgPSBpbm9kZV9maW5kX2Rldihpbm9k
ZSwgZGV2KTsNCisJaWYgKHVubGlrZWx5KG9sZCkpIHsNCisJCW9sZC0+bWFzayA9IG1hc2s7DQor
CQlyZXQgPSBvbGQtPndkOw0KKwkJZ290byBvdXQ7DQorCX0NCisNCisJd2F0Y2ggPSBjcmVhdGVf
d2F0Y2goZGV2LCBtYXNrLCBpbm9kZSk7DQorCWlmICh1bmxpa2VseShJU19FUlIod2F0Y2gpKSkg
ew0KKwkJcmV0ID0gUFRSX0VSUih3YXRjaCk7DQorCQlnb3RvIG91dDsNCisJfQ0KKw0KKwkvKiBB
ZGQgdGhlIHdhdGNoIHRvIHRoZSBkZXZpY2UncyBhbmQgdGhlIGlub2RlJ3MgbGlzdCAqLw0KKwls
aXN0X2FkZCgmd2F0Y2gtPmRfbGlzdCwgJmRldi0+d2F0Y2hlcyk7DQorCWxpc3RfYWRkKCZ3YXRj
aC0+aV9saXN0LCAmaW5vZGUtPmlub3RpZnlfd2F0Y2hlcyk7DQorCXJldCA9IHdhdGNoLT53ZDsN
CisNCitvdXQ6DQorCXVwKCZkZXYtPnNlbSk7DQorCXVwKCZpbm9kZS0+aW5vdGlmeV9zZW0pOw0K
KwlmcHV0KGZpbHApOw0KKw0KKwlyZXR1cm4gcmV0Ow0KK30NCisNCisvKg0KKyAqIGlub3RpZnlf
aWdub3JlIC0gaGFuZGxlIHRoZSBJTk9USUZZX0lHTk9SRSBpb2N0bCwgYXNraW5nIHRoYXQgYSBn
aXZlbiB3ZCBiZQ0KKyAqIHJlbW92ZWQgZnJvbSB0aGUgZGV2aWNlLg0KKyAqDQorICogQ2FuIHNs
ZWVwLg0KKyAqLw0KK3N0YXRpYyBpbnQgaW5vdGlmeV9pZ25vcmUoc3RydWN0IGlub3RpZnlfZGV2
aWNlICpkZXYsIHMzMiB3ZCkNCit7DQorCXN0cnVjdCBpbm90aWZ5X3dhdGNoICp3YXRjaDsNCisJ
c3RydWN0IGlub2RlICppbm9kZTsNCisNCisJZG93bigmZGV2LT5zZW0pOw0KKwl3YXRjaCA9IGlk
cl9maW5kKCZkZXYtPmlkciwgd2QpOw0KKwlpZiAodW5saWtlbHkoIXdhdGNoKSkgew0KKwkJdXAo
JmRldi0+c2VtKTsNCisJCXJldHVybiAtRUlOVkFMOw0KKwl9DQorCWdldF9pbm90aWZ5X3dhdGNo
KHdhdGNoKTsNCisJdXAoJmRldi0+c2VtKTsNCisNCisJaW5vZGUgPSB3YXRjaC0+aW5vZGU7DQor
CWRvd24oJmlub2RlLT5pbm90aWZ5X3NlbSk7DQorCWRvd24oJmRldi0+c2VtKTsNCisJcmVtb3Zl
X3dhdGNoKHdhdGNoLCBkZXYpOw0KKwl1cCgmZGV2LT5zZW0pOw0KKwl1cCgmaW5vZGUtPmlub3Rp
Znlfc2VtKTsNCisJcHV0X2lub3RpZnlfd2F0Y2god2F0Y2gpOw0KKw0KKwlyZXR1cm4gMDsNCit9
DQorDQorc3RhdGljIGxvbmcgaW5vdGlmeV9pb2N0bChzdHJ1Y3QgZmlsZSAqZmlsZSwgdW5zaWdu
ZWQgaW50IGNtZCwNCisJCQkgIHVuc2lnbmVkIGxvbmcgYXJnKQ0KK3sNCisJc3RydWN0IGlub3Rp
ZnlfZGV2aWNlICpkZXY7DQorCXN0cnVjdCBpbm90aWZ5X3dhdGNoX3JlcXVlc3QgcmVxdWVzdDsN
CisJdm9pZCBfX3VzZXIgKnA7DQorCWludCByZXQgPSAtRU5PVFRZOw0KKwlzMzIgd2Q7DQorDQor
CWRldiA9IGZpbGUtPnByaXZhdGVfZGF0YTsNCisJcCA9ICh2b2lkIF9fdXNlciAqKSBhcmc7DQor
DQorCXN3aXRjaCAoY21kKSB7DQorCWNhc2UgSU5PVElGWV9XQVRDSDoNCisJCWlmICh1bmxpa2Vs
eShjb3B5X2Zyb21fdXNlcigmcmVxdWVzdCwgcCwgc2l6ZW9mIChyZXF1ZXN0KSkpKSB7DQorCQkJ
cmV0ID0gLUVGQVVMVDsNCisJCQlicmVhazsNCisJCX0NCisJCXJldCA9IGlub3RpZnlfYWRkX3dh
dGNoKGRldiwgcmVxdWVzdC5mZCwgcmVxdWVzdC5tYXNrKTsNCisJCWJyZWFrOw0KKwljYXNlIElO
T1RJRllfSUdOT1JFOg0KKwkJaWYgKHVubGlrZWx5KGdldF91c2VyKHdkLCAoaW50IF9fdXNlciAq
KSBwKSkpIHsNCisJCQlyZXQgPSAtRUZBVUxUOw0KKwkJCWJyZWFrOw0KKwkJfQ0KKwkJcmV0ID0g
aW5vdGlmeV9pZ25vcmUoZGV2LCB3ZCk7DQorCQlicmVhazsNCisJY2FzZSBGSU9OUkVBRDoNCisJ
CXJldCA9IHB1dF91c2VyKGRldi0+cXVldWVfc2l6ZSwgKGludCBfX3VzZXIgKikgcCk7DQorCQli
cmVhazsNCisJfQ0KKw0KKwlyZXR1cm4gcmV0Ow0KK30NCisNCitzdGF0aWMgc3RydWN0IGZpbGVf
b3BlcmF0aW9ucyBpbm90aWZ5X2ZvcHMgPSB7DQorCS5vd25lcgkJPSBUSElTX01PRFVMRSwNCisJ
LnBvbGwJCT0gaW5vdGlmeV9wb2xsLA0KKwkucmVhZAkJPSBpbm90aWZ5X3JlYWQsDQorCS5vcGVu
CQk9IGlub3RpZnlfb3BlbiwNCisJLnJlbGVhc2UJPSBpbm90aWZ5X3JlbGVhc2UsDQorCS51bmxv
Y2tlZF9pb2N0bAk9IGlub3RpZnlfaW9jdGwsDQorCS5jb21wYXRfaW9jdGwJPSBpbm90aWZ5X2lv
Y3RsLA0KK307DQorDQorc3RhdGljIHN0cnVjdCBtaXNjZGV2aWNlIGlub3RpZnlfZGV2aWNlID0g
ew0KKwkubWlub3IgID0gTUlTQ19EWU5BTUlDX01JTk9SLA0KKwkubmFtZQk9ICJpbm90aWZ5IiwN
CisJLmZvcHMJPSAmaW5vdGlmeV9mb3BzLA0KK307DQorDQorLyoNCisgKiBpbm90aWZ5X2luaXQg
LSBPdXIgaW5pdGlhbGl6YXRpb24gZnVuY3Rpb24uICBOb3RlIHRoYXQgd2UgY2Fubm5vdCByZXR1
cm4NCisgKiBlcnJvciBiZWNhdXNlIHdlIGhhdmUgY29tcGlsZWQtaW4gVkZTIGhvb2tzLiAgU28g
YW4gKHVubGlrZWx5KSBmYWlsdXJlIGhlcmUNCisgKiBtdXN0IHJlc3VsdCBpbiBwYW5pYygpLg0K
KyAqLw0KK3N0YXRpYyBpbnQgX19pbml0IGlub3RpZnlfaW5pdCh2b2lkKQ0KK3sNCisJc3RydWN0
IGNsYXNzX2RldmljZSAqY2xhc3M7DQorCWludCByZXQ7DQorDQorCXJldCA9IG1pc2NfcmVnaXN0
ZXIoJmlub3RpZnlfZGV2aWNlKTsNCisJaWYgKHVubGlrZWx5KHJldCkpDQorCQlwYW5pYygiaW5v
dGlmeTogbWlzY19yZWdpc3RlciByZXR1cm5lZCAlZFxuIiwgcmV0KTsNCisNCisJbWF4X3F1ZXVl
ZF9ldmVudHMgPSA1MTI7DQorCW1heF91c2VyX2RldmljZXMgPSA2NDsNCisJbWF4X3VzZXJfd2F0
Y2hlcyA9IDE2Mzg0Ow0KKw0KKwljbGFzcyA9IGlub3RpZnlfZGV2aWNlLmNsYXNzOw0KKwljbGFz
c19kZXZpY2VfY3JlYXRlX2ZpbGUoY2xhc3MsICZjbGFzc19kZXZpY2VfYXR0cl9tYXhfcXVldWVk
X2V2ZW50cyk7DQorCWNsYXNzX2RldmljZV9jcmVhdGVfZmlsZShjbGFzcywgJmNsYXNzX2Rldmlj
ZV9hdHRyX21heF91c2VyX2RldmljZXMpOw0KKwljbGFzc19kZXZpY2VfY3JlYXRlX2ZpbGUoY2xh
c3MsICZjbGFzc19kZXZpY2VfYXR0cl9tYXhfdXNlcl93YXRjaGVzKTsNCisNCisJYXRvbWljX3Nl
dCgmaW5vdGlmeV9jb29raWUsIDApOw0KKw0KKwl3YXRjaF9jYWNoZXAgPSBrbWVtX2NhY2hlX2Ny
ZWF0ZSgiaW5vdGlmeV93YXRjaF9jYWNoZSIsDQorCQkJCQkgc2l6ZW9mKHN0cnVjdCBpbm90aWZ5
X3dhdGNoKSwNCisJCQkJCSAwLCBTTEFCX1BBTklDLCBOVUxMLCBOVUxMKTsNCisJZXZlbnRfY2Fj
aGVwID0ga21lbV9jYWNoZV9jcmVhdGUoImlub3RpZnlfZXZlbnRfY2FjaGUiLA0KKwkJCQkJIHNp
emVvZihzdHJ1Y3QgaW5vdGlmeV9rZXJuZWxfZXZlbnQpLA0KKwkJCQkJIDAsIFNMQUJfUEFOSUMs
IE5VTEwsIE5VTEwpOw0KKw0KKwlwcmludGsoS0VSTl9JTkZPICJpbm90aWZ5IGRldmljZSBtaW5v
cj0lZFxuIiwgaW5vdGlmeV9kZXZpY2UubWlub3IpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQor
bW9kdWxlX2luaXQoaW5vdGlmeV9pbml0KTsNCmRpZmYgLXVyTiBsaW51eC0yLjYuMTItcmMyLW1t
MS9mcy9LY29uZmlnIGxpbnV4L2ZzL0tjb25maWcNCi0tLSBsaW51eC0yLjYuMTItcmMyLW1tMS9m
cy9LY29uZmlnCTIwMDUtMDQtMDUgMTI6NDA6MDMuMDAwMDAwMDAwIC0wNDAwDQorKysgbGludXgv
ZnMvS2NvbmZpZwkyMDA1LTA0LTA1IDEyOjQxOjUxLjAwMDAwMDAwMCAtMDQwMA0KQEAgLTM0MSw2
ICszNDEsMTkgQEANCiAJICBJZiB5b3UgZG9uJ3Qga25vdyB3aGV0aGVyIHlvdSBuZWVkIGl0LCB0
aGVuIHlvdSBkb24ndCBuZWVkIGl0Og0KIAkgIGFuc3dlciBOLg0KIA0KK2NvbmZpZyBJTk9USUZZ
DQorCWJvb2wgIklub3RpZnkgZmlsZSBjaGFuZ2Ugbm90aWZpY2F0aW9uIHN1cHBvcnQiDQorCWRl
ZmF1bHQgeQ0KKwktLS1oZWxwLS0tDQorCSAgU2F5IFkgaGVyZSB0byBlbmFibGUgaW5vdGlmeSBz
dXBwb3J0IGFuZCB0aGUgL2Rldi9pbm90aWZ5IGNoYXJhY3Rlcg0KKwkgIGRldmljZS4gIElub3Rp
ZnkgaXMgYSBmaWxlIGNoYW5nZSBub3RpZmljYXRpb24gc3lzdGVtIGFuZCBhDQorCSAgcmVwbGFj
ZW1lbnQgZm9yIGRub3RpZnkuICBJbm90aWZ5IGZpeGVzIG51bWVyb3VzIHNob3J0Y29taW5ncyBp
bg0KKwkgIGRub3RpZnkgYW5kIGludHJvZHVjZXMgc2V2ZXJhbCBuZXcgZmVhdHVyZXMuICBJdCBh
bGxvd3MgbW9uaXRvcmluZw0KKwkgIG9mIGJvdGggZmlsZXMgYW5kIGRpcmVjdG9yaWVzIHZpYSBh
IHNpbmdsZSBvcGVuIGZkLiAgTXVsdGlwbGUgZmlsZQ0KKwkgIGV2ZW50cyBhcmUgc3VwcG9ydGVk
Lg0KKw0KKwkgIElmIHVuc3VyZSwgc2F5IFkuDQorDQogY29uZmlnIFFVT1RBDQogCWJvb2wgIlF1
b3RhIHN1cHBvcnQiDQogCWhlbHANCmRpZmYgLXVyTiBsaW51eC0yLjYuMTItcmMyLW1tMS9mcy9N
YWtlZmlsZSBsaW51eC9mcy9NYWtlZmlsZQ0KLS0tIGxpbnV4LTIuNi4xMi1yYzItbW0xL2ZzL01h
a2VmaWxlCTIwMDUtMDQtMDUgMTI6NDA6MDMuMDAwMDAwMDAwIC0wNDAwDQorKysgbGludXgvZnMv
TWFrZWZpbGUJMjAwNS0wNC0wNSAxMjo0MTo1MS4wMDAwMDAwMDAgLTA0MDANCkBAIC0xMiw2ICsx
Miw3IEBADQogCQlzZXFfZmlsZS5vIHhhdHRyLm8gbGliZnMubyBmcy13cml0ZWJhY2subyBtcGFn
ZS5vIGRpcmVjdC1pby5vIFwNCiAJCWlvcHJpby5vDQogDQorb2JqLSQoQ09ORklHX0lOT1RJRlkp
CQkrPSBpbm90aWZ5Lm8NCiBvYmotJChDT05GSUdfRVBPTEwpCQkrPSBldmVudHBvbGwubw0KIG9i
ai0kKENPTkZJR19DT01QQVQpCQkrPSBjb21wYXQubw0KIA0KZGlmZiAtdXJOIGxpbnV4LTIuNi4x
Mi1yYzItbW0xL2ZzL25hbWVpLmMgbGludXgvZnMvbmFtZWkuYw0KLS0tIGxpbnV4LTIuNi4xMi1y
YzItbW0xL2ZzL25hbWVpLmMJMjAwNS0wNC0wNSAxMjo0MDowMy4wMDAwMDAwMDAgLTA0MDANCisr
KyBsaW51eC9mcy9uYW1laS5jCTIwMDUtMDQtMDUgMTI6NDE6NTEuMDAwMDAwMDAwIC0wNDAwDQpA
QCAtMjEsNyArMjEsNyBAQA0KICNpbmNsdWRlIDxsaW51eC9uYW1laS5oPg0KICNpbmNsdWRlIDxs
aW51eC9xdW90YW9wcy5oPg0KICNpbmNsdWRlIDxsaW51eC9wYWdlbWFwLmg+DQotI2luY2x1ZGUg
PGxpbnV4L2Rub3RpZnkuaD4NCisjaW5jbHVkZSA8bGludXgvZnNub3RpZnkuaD4NCiAjaW5jbHVk
ZSA8bGludXgvc21wX2xvY2suaD4NCiAjaW5jbHVkZSA8bGludXgvcGVyc29uYWxpdHkuaD4NCiAj
aW5jbHVkZSA8bGludXgvc2VjdXJpdHkuaD4NCkBAIC0xMjk2LDcgKzEyOTYsNyBAQA0KIAlEUVVP
VF9JTklUKGRpcik7DQogCWVycm9yID0gZGlyLT5pX29wLT5jcmVhdGUoZGlyLCBkZW50cnksIG1v
ZGUsIG5kKTsNCiAJaWYgKCFlcnJvcikgew0KLQkJaW5vZGVfZGlyX25vdGlmeShkaXIsIEROX0NS
RUFURSk7DQorCQlmc25vdGlmeV9jcmVhdGUoZGlyLCBkZW50cnktPmRfbmFtZS5uYW1lKTsNCiAJ
CXNlY3VyaXR5X2lub2RlX3Bvc3RfY3JlYXRlKGRpciwgZGVudHJ5LCBtb2RlKTsNCiAJfQ0KIAly
ZXR1cm4gZXJyb3I7DQpAQCAtMTYwMSw3ICsxNjAxLDcgQEANCiAJRFFVT1RfSU5JVChkaXIpOw0K
IAllcnJvciA9IGRpci0+aV9vcC0+bWtub2QoZGlyLCBkZW50cnksIG1vZGUsIGRldik7DQogCWlm
ICghZXJyb3IpIHsNCi0JCWlub2RlX2Rpcl9ub3RpZnkoZGlyLCBETl9DUkVBVEUpOw0KKwkJZnNu
b3RpZnlfY3JlYXRlKGRpciwgZGVudHJ5LT5kX25hbWUubmFtZSk7DQogCQlzZWN1cml0eV9pbm9k
ZV9wb3N0X21rbm9kKGRpciwgZGVudHJ5LCBtb2RlLCBkZXYpOw0KIAl9DQogCXJldHVybiBlcnJv
cjsNCkBAIC0xNjc0LDcgKzE2NzQsNyBAQA0KIAlEUVVPVF9JTklUKGRpcik7DQogCWVycm9yID0g
ZGlyLT5pX29wLT5ta2RpcihkaXIsIGRlbnRyeSwgbW9kZSk7DQogCWlmICghZXJyb3IpIHsNCi0J
CWlub2RlX2Rpcl9ub3RpZnkoZGlyLCBETl9DUkVBVEUpOw0KKwkJZnNub3RpZnlfbWtkaXIoZGly
LCBkZW50cnktPmRfbmFtZS5uYW1lKTsNCiAJCXNlY3VyaXR5X2lub2RlX3Bvc3RfbWtkaXIoZGly
LGRlbnRyeSwgbW9kZSk7DQogCX0NCiAJcmV0dXJuIGVycm9yOw0KQEAgLTE3NjUsNyArMTc2NSw3
IEBADQogCX0NCiAJdXAoJmRlbnRyeS0+ZF9pbm9kZS0+aV9zZW0pOw0KIAlpZiAoIWVycm9yKSB7
DQotCQlpbm9kZV9kaXJfbm90aWZ5KGRpciwgRE5fREVMRVRFKTsNCisJCWZzbm90aWZ5X3JtZGly
KGRlbnRyeSwgZGVudHJ5LT5kX2lub2RlLCBkaXIpOw0KIAkJZF9kZWxldGUoZGVudHJ5KTsNCiAJ
fQ0KIAlkcHV0KGRlbnRyeSk7DQpAQCAtMTgzOCw5ICsxODM4LDEwIEBADQogDQogCS8qIFdlIGRv
bid0IGRfZGVsZXRlKCkgTkZTIHNpbGx5cmVuYW1lZCBmaWxlcy0tdGhleSBzdGlsbCBleGlzdC4g
Ki8NCiAJaWYgKCFlcnJvciAmJiAhKGRlbnRyeS0+ZF9mbGFncyAmIERDQUNIRV9ORlNGU19SRU5B
TUVEKSkgew0KKwkJZnNub3RpZnlfdW5saW5rKGRlbnRyeSwgZGlyKTsNCiAJCWRfZGVsZXRlKGRl
bnRyeSk7DQotCQlpbm9kZV9kaXJfbm90aWZ5KGRpciwgRE5fREVMRVRFKTsNCiAJfQ0KKw0KIAly
ZXR1cm4gZXJyb3I7DQogfQ0KIA0KQEAgLTE5MTQsNyArMTkxNSw3IEBADQogCURRVU9UX0lOSVQo
ZGlyKTsNCiAJZXJyb3IgPSBkaXItPmlfb3AtPnN5bWxpbmsoZGlyLCBkZW50cnksIG9sZG5hbWUp
Ow0KIAlpZiAoIWVycm9yKSB7DQotCQlpbm9kZV9kaXJfbm90aWZ5KGRpciwgRE5fQ1JFQVRFKTsN
CisJCWZzbm90aWZ5X2NyZWF0ZShkaXIsIGRlbnRyeS0+ZF9uYW1lLm5hbWUpOw0KIAkJc2VjdXJp
dHlfaW5vZGVfcG9zdF9zeW1saW5rKGRpciwgZGVudHJ5LCBvbGRuYW1lKTsNCiAJfQ0KIAlyZXR1
cm4gZXJyb3I7DQpAQCAtMTk4Nyw3ICsxOTg4LDcgQEANCiAJZXJyb3IgPSBkaXItPmlfb3AtPmxp
bmsob2xkX2RlbnRyeSwgZGlyLCBuZXdfZGVudHJ5KTsNCiAJdXAoJm9sZF9kZW50cnktPmRfaW5v
ZGUtPmlfc2VtKTsNCiAJaWYgKCFlcnJvcikgew0KLQkJaW5vZGVfZGlyX25vdGlmeShkaXIsIERO
X0NSRUFURSk7DQorCQlmc25vdGlmeV9jcmVhdGUoZGlyLCBuZXdfZGVudHJ5LT5kX25hbWUubmFt
ZSk7DQogCQlzZWN1cml0eV9pbm9kZV9wb3N0X2xpbmsob2xkX2RlbnRyeSwgZGlyLCBuZXdfZGVu
dHJ5KTsNCiAJfQ0KIAlyZXR1cm4gZXJyb3I7DQpAQCAtMjE1MSw2ICsyMTUyLDcgQEANCiB7DQog
CWludCBlcnJvcjsNCiAJaW50IGlzX2RpciA9IFNfSVNESVIob2xkX2RlbnRyeS0+ZF9pbm9kZS0+
aV9tb2RlKTsNCisJY2hhciAqb2xkX25hbWU7DQogDQogCWlmIChvbGRfZGVudHJ5LT5kX2lub2Rl
ID09IG5ld19kZW50cnktPmRfaW5vZGUpDQogIAkJcmV0dXJuIDA7DQpAQCAtMjE3MiwxOCArMjE3
NCwxOCBAQA0KIAlEUVVPVF9JTklUKG9sZF9kaXIpOw0KIAlEUVVPVF9JTklUKG5ld19kaXIpOw0K
IA0KKwlvbGRfbmFtZSA9IGZzbm90aWZ5X29sZG5hbWVfaW5pdChvbGRfZGVudHJ5KTsNCisNCiAJ
aWYgKGlzX2RpcikNCiAJCWVycm9yID0gdmZzX3JlbmFtZV9kaXIob2xkX2RpcixvbGRfZGVudHJ5
LG5ld19kaXIsbmV3X2RlbnRyeSk7DQogCWVsc2UNCiAJCWVycm9yID0gdmZzX3JlbmFtZV9vdGhl
cihvbGRfZGlyLG9sZF9kZW50cnksbmV3X2RpcixuZXdfZGVudHJ5KTsNCiAJaWYgKCFlcnJvcikg
ew0KLQkJaWYgKG9sZF9kaXIgPT0gbmV3X2RpcikNCi0JCQlpbm9kZV9kaXJfbm90aWZ5KG9sZF9k
aXIsIEROX1JFTkFNRSk7DQotCQllbHNlIHsNCi0JCQlpbm9kZV9kaXJfbm90aWZ5KG9sZF9kaXIs
IEROX0RFTEVURSk7DQotCQkJaW5vZGVfZGlyX25vdGlmeShuZXdfZGlyLCBETl9DUkVBVEUpOw0K
LQkJfQ0KKwkJY29uc3QgY2hhciAqbmV3X25hbWUgPSBvbGRfZGVudHJ5LT5kX25hbWUubmFtZTsN
CisJCWZzbm90aWZ5X21vdmUob2xkX2RpciwgbmV3X2Rpciwgb2xkX25hbWUsIG5ld19uYW1lKTsN
CiAJfQ0KKwlmc25vdGlmeV9vbGRuYW1lX2ZyZWUob2xkX25hbWUpOw0KKw0KIAlyZXR1cm4gZXJy
b3I7DQogfQ0KIA0KZGlmZiAtdXJOIGxpbnV4LTIuNi4xMi1yYzItbW0xL2ZzL29wZW4uYyBsaW51
eC9mcy9vcGVuLmMNCi0tLSBsaW51eC0yLjYuMTItcmMyLW1tMS9mcy9vcGVuLmMJMjAwNS0wNC0w
NSAxMjo0MDowMy4wMDAwMDAwMDAgLTA0MDANCisrKyBsaW51eC9mcy9vcGVuLmMJMjAwNS0wNC0w
NSAxMjo0MTo1MS4wMDAwMDAwMDAgLTA0MDANCkBAIC0xMCw3ICsxMCw3IEBADQogI2luY2x1ZGUg
PGxpbnV4L2ZpbGUuaD4NCiAjaW5jbHVkZSA8bGludXgvc21wX2xvY2suaD4NCiAjaW5jbHVkZSA8
bGludXgvcXVvdGFvcHMuaD4NCi0jaW5jbHVkZSA8bGludXgvZG5vdGlmeS5oPg0KKyNpbmNsdWRl
IDxsaW51eC9mc25vdGlmeS5oPg0KICNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4NCiAjaW5jbHVk
ZSA8bGludXgvc2xhYi5oPg0KICNpbmNsdWRlIDxsaW51eC90dHkuaD4NCkBAIC05NDQsOSArOTQ0
LDExIEBADQogCQlmZCA9IGdldF91bnVzZWRfZmQoKTsNCiAJCWlmIChmZCA+PSAwKSB7DQogCQkJ
c3RydWN0IGZpbGUgKmYgPSBmaWxwX29wZW4odG1wLCBmbGFncywgbW9kZSk7DQorDQogCQkJZXJy
b3IgPSBQVFJfRVJSKGYpOw0KIAkJCWlmIChJU19FUlIoZikpDQogCQkJCWdvdG8gb3V0X2Vycm9y
Ow0KKwkJCWZzbm90aWZ5X29wZW4oZi0+Zl9kZW50cnkpOw0KIAkJCWZkX2luc3RhbGwoZmQsIGYp
Ow0KIAkJfQ0KIG91dDoNCkBAIC05OTgsNyArMTAwMCw3IEBADQogCQkJcmV0dmFsID0gZXJyOw0K
IAl9DQogDQotCWRub3RpZnlfZmx1c2goZmlscCwgaWQpOw0KKwlmc25vdGlmeV9mbHVzaChmaWxw
LCBpZCk7DQogCWxvY2tzX3JlbW92ZV9wb3NpeChmaWxwLCBpZCk7DQogCWZwdXQoZmlscCk7DQog
CXJldHVybiByZXR2YWw7DQpkaWZmIC11ck4gbGludXgtMi42LjEyLXJjMi1tbTEvZnMvcmVhZF93
cml0ZS5jIGxpbnV4L2ZzL3JlYWRfd3JpdGUuYw0KLS0tIGxpbnV4LTIuNi4xMi1yYzItbW0xL2Zz
L3JlYWRfd3JpdGUuYwkyMDA1LTA0LTA1IDEyOjQwOjAzLjAwMDAwMDAwMCAtMDQwMA0KKysrIGxp
bnV4L2ZzL3JlYWRfd3JpdGUuYwkyMDA1LTA0LTA1IDEyOjQxOjUxLjAwMDAwMDAwMCAtMDQwMA0K
QEAgLTEwLDcgKzEwLDcgQEANCiAjaW5jbHVkZSA8bGludXgvZmlsZS5oPg0KICNpbmNsdWRlIDxs
aW51eC91aW8uaD4NCiAjaW5jbHVkZSA8bGludXgvc21wX2xvY2suaD4NCi0jaW5jbHVkZSA8bGlu
dXgvZG5vdGlmeS5oPg0KKyNpbmNsdWRlIDxsaW51eC9mc25vdGlmeS5oPg0KICNpbmNsdWRlIDxs
aW51eC9zZWN1cml0eS5oPg0KICNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4NCiAjaW5jbHVkZSA8
bGludXgvc3lzY2FsbHMuaD4NCkBAIC0yMzksNyArMjM5LDcgQEANCiAJCQllbHNlDQogCQkJCXJl
dCA9IGRvX3N5bmNfcmVhZChmaWxlLCBidWYsIGNvdW50LCBwb3MpOw0KIAkJCWlmIChyZXQgPiAw
KSB7DQotCQkJCWRub3RpZnlfcGFyZW50KGZpbGUtPmZfZGVudHJ5LCBETl9BQ0NFU1MpOw0KKwkJ
CQlmc25vdGlmeV9hY2Nlc3MoZmlsZS0+Zl9kZW50cnkpOw0KIAkJCQljdXJyZW50LT5yY2hhciAr
PSByZXQ7DQogCQkJfQ0KIAkJCWN1cnJlbnQtPnN5c2NyKys7DQpAQCAtMjg3LDcgKzI4Nyw3IEBA
DQogCQkJZWxzZQ0KIAkJCQlyZXQgPSBkb19zeW5jX3dyaXRlKGZpbGUsIGJ1ZiwgY291bnQsIHBv
cyk7DQogCQkJaWYgKHJldCA+IDApIHsNCi0JCQkJZG5vdGlmeV9wYXJlbnQoZmlsZS0+Zl9kZW50
cnksIEROX01PRElGWSk7DQorCQkJCWZzbm90aWZ5X21vZGlmeShmaWxlLT5mX2RlbnRyeSk7DQog
CQkJCWN1cnJlbnQtPndjaGFyICs9IHJldDsNCiAJCQl9DQogCQkJY3VycmVudC0+c3lzY3crKzsN
CkBAIC01MjMsOSArNTIzLDEyIEBADQogb3V0Og0KIAlpZiAoaW92ICE9IGlvdnN0YWNrKQ0KIAkJ
a2ZyZWUoaW92KTsNCi0JaWYgKChyZXQgKyAodHlwZSA9PSBSRUFEKSkgPiAwKQ0KLQkJZG5vdGlm
eV9wYXJlbnQoZmlsZS0+Zl9kZW50cnksDQotCQkJCSh0eXBlID09IFJFQUQpID8gRE5fQUNDRVNT
IDogRE5fTU9ESUZZKTsNCisJaWYgKChyZXQgKyAodHlwZSA9PSBSRUFEKSkgPiAwKSB7DQorCQlp
ZiAodHlwZSA9PSBSRUFEKQ0KKwkJCWZzbm90aWZ5X2FjY2VzcyhmaWxlLT5mX2RlbnRyeSk7DQor
CQllbHNlDQorCQkJZnNub3RpZnlfbW9kaWZ5KGZpbGUtPmZfZGVudHJ5KTsNCisJfQ0KIAlyZXR1
cm4gcmV0Ow0KIEVmYXVsdDoNCiAJcmV0ID0gLUVGQVVMVDsNCmRpZmYgLXVyTiBsaW51eC0yLjYu
MTItcmMyLW1tMS9pbmNsdWRlL2xpbnV4L2ZzLmggbGludXgvaW5jbHVkZS9saW51eC9mcy5oDQot
LS0gbGludXgtMi42LjEyLXJjMi1tbTEvaW5jbHVkZS9saW51eC9mcy5oCTIwMDUtMDQtMDUgMTI6
NDA6MDMuMDAwMDAwMDAwIC0wNDAwDQorKysgbGludXgvaW5jbHVkZS9saW51eC9mcy5oCTIwMDUt
MDQtMDUgMTI6NDE6NTEuMDAwMDAwMDAwIC0wNDAwDQpAQCAtNDcyLDYgKzQ3MiwxMSBAQA0KIAlz
dHJ1Y3QgZG5vdGlmeV9zdHJ1Y3QJKmlfZG5vdGlmeTsgLyogZm9yIGRpcmVjdG9yeSBub3RpZmlj
YXRpb25zICovDQogI2VuZGlmDQogDQorI2lmZGVmIENPTkZJR19JTk9USUZZDQorCXN0cnVjdCBs
aXN0X2hlYWQJaW5vdGlmeV93YXRjaGVzOyAvKiB3YXRjaGVzIG9uIHRoaXMgaW5vZGUgKi8NCisJ
c3RydWN0IHNlbWFwaG9yZQlpbm90aWZ5X3NlbTsJLyogcHJvdGVjdHMgdGhlIHdhdGNoZXMgbGlz
dCAqLw0KKyNlbmRpZg0KKw0KIAl1bnNpZ25lZCBsb25nCQlpX3N0YXRlOw0KIAl1bnNpZ25lZCBs
b25nCQlkaXJ0aWVkX3doZW47CS8qIGppZmZpZXMgb2YgZmlyc3QgZGlydHlpbmcgKi8NCiANCkBA
IC0xMzg3LDcgKzEzOTIsNiBAQA0KIGV4dGVybiBpbnQgZG9fcmVtb3VudF9zYihzdHJ1Y3Qgc3Vw
ZXJfYmxvY2sgKnNiLCBpbnQgZmxhZ3MsDQogCQkJIHZvaWQgKmRhdGEsIGludCBmb3JjZSk7DQog
ZXh0ZXJuIHNlY3Rvcl90IGJtYXAoc3RydWN0IGlub2RlICosIHNlY3Rvcl90KTsNCi1leHRlcm4g
aW50IHNldGF0dHJfbWFzayh1bnNpZ25lZCBpbnQpOw0KIGV4dGVybiBpbnQgbm90aWZ5X2NoYW5n
ZShzdHJ1Y3QgZGVudHJ5ICosIHN0cnVjdCBpYXR0ciAqKTsNCiBleHRlcm4gaW50IHBlcm1pc3Np
b24oc3RydWN0IGlub2RlICosIGludCwgc3RydWN0IG5hbWVpZGF0YSAqKTsNCiBleHRlcm4gaW50
IGdlbmVyaWNfcGVybWlzc2lvbihzdHJ1Y3QgaW5vZGUgKiwgaW50LA0KZGlmZiAtdXJOIGxpbnV4
LTIuNi4xMi1yYzItbW0xL2luY2x1ZGUvbGludXgvZnNub3RpZnkuaCBsaW51eC9pbmNsdWRlL2xp
bnV4L2Zzbm90aWZ5LmgNCi0tLSBsaW51eC0yLjYuMTItcmMyLW1tMS9pbmNsdWRlL2xpbnV4L2Zz
bm90aWZ5LmgJMTk2OS0xMi0zMSAxOTowMDowMC4wMDAwMDAwMDAgLTA1MDANCisrKyBsaW51eC9p
bmNsdWRlL2xpbnV4L2Zzbm90aWZ5LmgJMjAwNS0wNC0wNSAxMjo0MTo1MS4wMDAwMDAwMDAgLTA0
MDANCkBAIC0wLDAgKzEsMjI4IEBADQorI2lmbmRlZiBfTElOVVhfRlNfTk9USUZZX0gNCisjZGVm
aW5lIF9MSU5VWF9GU19OT1RJRllfSA0KKw0KKy8qDQorICogaW5jbHVkZS9saW51eC9mc19ub3Rp
ZnkuaCAtIGdlbmVyaWMgaG9va3MgZm9yIGZpbGVzeXN0ZW0gbm90aWZpY2F0aW9uLCB0bw0KKyAq
IHJlZHVjZSBpbi1zb3VyY2UgZHVwbGljYXRpb24gZnJvbSBib3RoIGRub3RpZnkgYW5kIGlub3Rp
ZnkuDQorICoNCisgKiBXZSBkb24ndCBjb21waWxlIGFueSBvZiB0aGlzIGF3YXkgaW4gc29tZSBj
b21wbGljYXRlZCBtZW5hZ2VyaWUgb2YgaWZkZWZzLg0KKyAqIEluc3RlYWQsIHdlIHJlbHkgb24g
dGhlIGNvZGUgaW5zaWRlIHRvIG9wdGltaXplIGF3YXkgYXMgbmVlZGVkLg0KKyAqDQorICogKEMp
IENvcHlyaWdodCAyMDA1IFJvYmVydCBMb3ZlDQorICovDQorDQorI2lmZGVmIF9fS0VSTkVMX18N
CisNCisjaW5jbHVkZSA8bGludXgvZG5vdGlmeS5oPg0KKyNpbmNsdWRlIDxsaW51eC9pbm90aWZ5
Lmg+DQorDQorLyoNCisgKiBmc25vdGlmeV9tb3ZlIC0gZmlsZSBvbGRfbmFtZSBhdCBvbGRfZGly
IHdhcyBtb3ZlZCB0byBuZXdfbmFtZSBhdCBuZXdfZGlyDQorICovDQorc3RhdGljIGlubGluZSB2
b2lkIGZzbm90aWZ5X21vdmUoc3RydWN0IGlub2RlICpvbGRfZGlyLCBzdHJ1Y3QgaW5vZGUgKm5l
d19kaXIsDQorCQkJCSBjb25zdCBjaGFyICpvbGRfbmFtZSwgY29uc3QgY2hhciAqbmV3X25hbWUp
DQorew0KKwl1MzIgY29va2llOw0KKw0KKwlpZiAob2xkX2RpciA9PSBuZXdfZGlyKQ0KKwkJaW5v
ZGVfZGlyX25vdGlmeShvbGRfZGlyLCBETl9SRU5BTUUpOw0KKwllbHNlIHsNCisJCWlub2RlX2Rp
cl9ub3RpZnkob2xkX2RpciwgRE5fREVMRVRFKTsNCisJCWlub2RlX2Rpcl9ub3RpZnkobmV3X2Rp
ciwgRE5fQ1JFQVRFKTsNCisJfQ0KKw0KKwljb29raWUgPSBpbm90aWZ5X2dldF9jb29raWUoKTsN
CisNCisJaW5vdGlmeV9pbm9kZV9xdWV1ZV9ldmVudChvbGRfZGlyLCBJTl9NT1ZFRF9GUk9NLCBj
b29raWUsIG9sZF9uYW1lKTsNCisJaW5vdGlmeV9pbm9kZV9xdWV1ZV9ldmVudChuZXdfZGlyLCBJ
Tl9NT1ZFRF9UTywgY29va2llLCBuZXdfbmFtZSk7DQorfQ0KKw0KKy8qDQorICogZnNub3RpZnlf
dW5saW5rIC0gZmlsZSB3YXMgdW5saW5rZWQNCisgKi8NCitzdGF0aWMgaW5saW5lIHZvaWQgZnNu
b3RpZnlfdW5saW5rKHN0cnVjdCBkZW50cnkgKmRlbnRyeSwgc3RydWN0IGlub2RlICpkaXIpDQor
ew0KKwlzdHJ1Y3QgaW5vZGUgKmlub2RlID0gZGVudHJ5LT5kX2lub2RlOw0KKw0KKwlpbm9kZV9k
aXJfbm90aWZ5KGRpciwgRE5fREVMRVRFKTsNCisJaW5vdGlmeV9pbm9kZV9xdWV1ZV9ldmVudChk
aXIsIElOX0RFTEVURV9GSUxFLCAwLCBkZW50cnktPmRfbmFtZS5uYW1lKTsNCisJaW5vdGlmeV9p
bm9kZV9xdWV1ZV9ldmVudChpbm9kZSwgSU5fREVMRVRFX1NFTEYsIDAsIE5VTEwpOw0KKw0KKwlp
bm90aWZ5X2lub2RlX2lzX2RlYWQoaW5vZGUpOw0KK30NCisNCisvKg0KKyAqIGZzbm90aWZ5X3Jt
ZGlyIC0gZGlyZWN0b3J5IHdhcyByZW1vdmVkDQorICovDQorc3RhdGljIGlubGluZSB2b2lkIGZz
bm90aWZ5X3JtZGlyKHN0cnVjdCBkZW50cnkgKmRlbnRyeSwgc3RydWN0IGlub2RlICppbm9kZSwN
CisJCQkJICBzdHJ1Y3QgaW5vZGUgKmRpcikNCit7DQorCWlub2RlX2Rpcl9ub3RpZnkoZGlyLCBE
Tl9ERUxFVEUpOw0KKwlpbm90aWZ5X2lub2RlX3F1ZXVlX2V2ZW50KGRpciwgSU5fREVMRVRFX1NV
QkRJUiwwLGRlbnRyeS0+ZF9uYW1lLm5hbWUpOw0KKwlpbm90aWZ5X2lub2RlX3F1ZXVlX2V2ZW50
KGlub2RlLCBJTl9ERUxFVEVfU0VMRiwgMCwgTlVMTCk7DQorDQorCWlub3RpZnlfaW5vZGVfaXNf
ZGVhZChpbm9kZSk7DQorfQ0KKw0KKy8qDQorICogZnNub3RpZnlfY3JlYXRlIC0gZmlsZW5hbWUg
d2FzIGxpbmtlZCBpbg0KKyAqLw0KK3N0YXRpYyBpbmxpbmUgdm9pZCBmc25vdGlmeV9jcmVhdGUo
c3RydWN0IGlub2RlICppbm9kZSwgY29uc3QgY2hhciAqZmlsZW5hbWUpDQorew0KKwlpbm9kZV9k
aXJfbm90aWZ5KGlub2RlLCBETl9DUkVBVEUpOw0KKwlpbm90aWZ5X2lub2RlX3F1ZXVlX2V2ZW50
KGlub2RlLCBJTl9DUkVBVEVfRklMRSwgMCwgZmlsZW5hbWUpOw0KK30NCisNCisvKg0KKyAqIGZz
bm90aWZ5X21rZGlyIC0gZGlyZWN0b3J5ICduYW1lJyB3YXMgY3JlYXRlZA0KKyAqLw0KK3N0YXRp
YyBpbmxpbmUgdm9pZCBmc25vdGlmeV9ta2RpcihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBjb25zdCBj
aGFyICpuYW1lKQ0KK3sNCisJaW5vZGVfZGlyX25vdGlmeShpbm9kZSwgRE5fQ1JFQVRFKTsNCisJ
aW5vdGlmeV9pbm9kZV9xdWV1ZV9ldmVudChpbm9kZSwgSU5fQ1JFQVRFX1NVQkRJUiwgMCwgbmFt
ZSk7DQorfQ0KKw0KKy8qDQorICogZnNub3RpZnlfYWNjZXNzIC0gZmlsZSB3YXMgcmVhZA0KKyAq
Lw0KK3N0YXRpYyBpbmxpbmUgdm9pZCBmc25vdGlmeV9hY2Nlc3Moc3RydWN0IGRlbnRyeSAqZGVu
dHJ5KQ0KK3sNCisJZG5vdGlmeV9wYXJlbnQoZGVudHJ5LCBETl9BQ0NFU1MpOw0KKwlpbm90aWZ5
X2RlbnRyeV9wYXJlbnRfcXVldWVfZXZlbnQoZGVudHJ5LCBJTl9BQ0NFU1MsIDAsDQorCQkJCQkg
IGRlbnRyeS0+ZF9uYW1lLm5hbWUpOw0KKwlpbm90aWZ5X2lub2RlX3F1ZXVlX2V2ZW50KGRlbnRy
eS0+ZF9pbm9kZSwgSU5fQUNDRVNTLCAwLCBOVUxMKTsNCit9DQorDQorLyoNCisgKiBmc25vdGlm
eV9tb2RpZnkgLSBmaWxlIHdhcyBtb2RpZmllZA0KKyAqLw0KK3N0YXRpYyBpbmxpbmUgdm9pZCBm
c25vdGlmeV9tb2RpZnkoc3RydWN0IGRlbnRyeSAqZGVudHJ5KQ0KK3sNCisJZG5vdGlmeV9wYXJl
bnQoZGVudHJ5LCBETl9NT0RJRlkpOw0KKwlpbm90aWZ5X2RlbnRyeV9wYXJlbnRfcXVldWVfZXZl
bnQoZGVudHJ5LCBJTl9NT0RJRlksIDAsDQorCQkJCQkgIGRlbnRyeS0+ZF9uYW1lLm5hbWUpOw0K
Kwlpbm90aWZ5X2lub2RlX3F1ZXVlX2V2ZW50KGRlbnRyeS0+ZF9pbm9kZSwgSU5fTU9ESUZZLCAw
LCBOVUxMKTsNCit9DQorDQorLyoNCisgKiBmc25vdGlmeV9vcGVuIC0gZmlsZSB3YXMgb3BlbmVk
DQorICovDQorc3RhdGljIGlubGluZSB2b2lkIGZzbm90aWZ5X29wZW4oc3RydWN0IGRlbnRyeSAq
ZGVudHJ5KQ0KK3sNCisJaW5vdGlmeV9pbm9kZV9xdWV1ZV9ldmVudChkZW50cnktPmRfaW5vZGUs
IElOX09QRU4sIDAsIE5VTEwpOw0KKwlpbm90aWZ5X2RlbnRyeV9wYXJlbnRfcXVldWVfZXZlbnQo
ZGVudHJ5LCBJTl9PUEVOLCAwLA0KKwkJCQkJICBkZW50cnktPmRfbmFtZS5uYW1lKTsNCit9DQor
DQorLyoNCisgKiBmc25vdGlmeV9jbG9zZSAtIGZpbGUgd2FzIGNsb3NlZA0KKyAqLw0KK3N0YXRp
YyBpbmxpbmUgdm9pZCBmc25vdGlmeV9jbG9zZShzdHJ1Y3QgZmlsZSAqZmlsZSkNCit7DQorCXN0
cnVjdCBkZW50cnkgKmRlbnRyeSA9IGZpbGUtPmZfZGVudHJ5Ow0KKwlzdHJ1Y3QgaW5vZGUgKmlu
b2RlID0gZGVudHJ5LT5kX2lub2RlOw0KKwljb25zdCBjaGFyICpmaWxlbmFtZSA9IGRlbnRyeS0+
ZF9uYW1lLm5hbWU7DQorCW1vZGVfdCBtb2RlID0gZmlsZS0+Zl9tb2RlOw0KKwl1MzIgbWFzazsN
CisNCisJbWFzayA9IChtb2RlICYgRk1PREVfV1JJVEUpID8gSU5fQ0xPU0VfV1JJVEUgOiBJTl9D
TE9TRV9OT1dSSVRFOw0KKwlpbm90aWZ5X2RlbnRyeV9wYXJlbnRfcXVldWVfZXZlbnQoZGVudHJ5
LCBtYXNrLCAwLCBmaWxlbmFtZSk7DQorCWlub3RpZnlfaW5vZGVfcXVldWVfZXZlbnQoaW5vZGUs
IG1hc2ssIDAsIE5VTEwpOw0KK30NCisNCisvKg0KKyAqIGZzbm90aWZ5X2NoYW5nZSAtIG5vdGlm
eV9jaGFuZ2UgZXZlbnQuICBmaWxlIHdhcyBtb2RpZmllZCBhbmQvb3IgbWV0YWRhdGENCisgKiB3
YXMgY2hhbmdlZC4NCisgKi8NCitzdGF0aWMgaW5saW5lIHZvaWQgZnNub3RpZnlfY2hhbmdlKHN0
cnVjdCBkZW50cnkgKmRlbnRyeSwgdW5zaWduZWQgaW50IGlhX3ZhbGlkKQ0KK3sNCisJaW50IGRu
X21hc2sgPSAwOw0KKwl1MzIgaW5fbWFzayA9IDA7DQorDQorCWlmIChpYV92YWxpZCAmIEFUVFJf
VUlEKSB7DQorCQlpbl9tYXNrIHw9IElOX0FUVFJJQjsNCisJCWRuX21hc2sgfD0gRE5fQVRUUklC
Ow0KKwl9DQorCWlmIChpYV92YWxpZCAmIEFUVFJfR0lEKSB7DQorCQlpbl9tYXNrIHw9IElOX0FU
VFJJQjsNCisJCWRuX21hc2sgfD0gRE5fQVRUUklCOw0KKwl9DQorCWlmIChpYV92YWxpZCAmIEFU
VFJfU0laRSkgew0KKwkJaW5fbWFzayB8PSBJTl9NT0RJRlk7DQorCQlkbl9tYXNrIHw9IEROX01P
RElGWTsNCisJfQ0KKwkvKiBib3RoIHRpbWVzIGltcGxpZXMgYSB1dGltZShzKSBjYWxsICovDQor
CWlmICgoaWFfdmFsaWQgJiAoQVRUUl9BVElNRSB8IEFUVFJfTVRJTUUpKSA9PSAoQVRUUl9BVElN
RSB8IEFUVFJfTVRJTUUpKQ0KKwl7DQorCQlpbl9tYXNrIHw9IElOX0FUVFJJQjsNCisJCWRuX21h
c2sgfD0gRE5fQVRUUklCOw0KKwl9IGVsc2UgaWYgKGlhX3ZhbGlkICYgQVRUUl9BVElNRSkgew0K
KwkJaW5fbWFzayB8PSBJTl9BQ0NFU1M7DQorCQlkbl9tYXNrIHw9IEROX0FDQ0VTUzsNCisJfSBl
bHNlIGlmIChpYV92YWxpZCAmIEFUVFJfTVRJTUUpIHsNCisJCWluX21hc2sgfD0gSU5fTU9ESUZZ
Ow0KKwkJZG5fbWFzayB8PSBETl9NT0RJRlk7DQorCX0NCisJaWYgKGlhX3ZhbGlkICYgQVRUUl9N
T0RFKSB7DQorCQlpbl9tYXNrIHw9IElOX0FUVFJJQjsNCisJCWRuX21hc2sgfD0gRE5fQVRUUklC
Ow0KKwl9DQorDQorCWlmIChkbl9tYXNrKQ0KKwkJZG5vdGlmeV9wYXJlbnQoZGVudHJ5LCBkbl9t
YXNrKTsNCisJaWYgKGluX21hc2spIHsNCisJCWlub3RpZnlfaW5vZGVfcXVldWVfZXZlbnQoZGVu
dHJ5LT5kX2lub2RlLCBpbl9tYXNrLCAwLCBOVUxMKTsNCisJCWlub3RpZnlfZGVudHJ5X3BhcmVu
dF9xdWV1ZV9ldmVudChkZW50cnksIGluX21hc2ssIDAsDQorCQkJCQkJICBkZW50cnktPmRfbmFt
ZS5uYW1lKTsNCisJfQ0KK30NCisNCisvKg0KKyAqIGZzbm90aWZ5X2ZsdXNoIC0gZmx1c2ggdGlt
ZSENCisgKi8NCitzdGF0aWMgaW5saW5lIHZvaWQgZnNub3RpZnlfZmx1c2goc3RydWN0IGZpbGUg
KmZpbHAsIGZsX293bmVyX3QgaWQpDQorew0KKwlkbm90aWZ5X2ZsdXNoKGZpbHAsIGlkKTsNCit9
DQorDQorI2lmZGVmIENPTkZJR19JTk9USUZZCS8qIGlub3RpZnkgaGVscGVycyAqLw0KKw0KKy8q
DQorICogZnNub3RpZnlfb2xkbmFtZV9pbml0IC0gc2F2ZSBvZmYgdGhlIG9sZCBmaWxlbmFtZSBi
ZWZvcmUgd2UgY2hhbmdlIGl0DQorICoNCisgKiB0aGlzIGNvdWxkIGJlIGtzdHJkdXAgaWYgb25s
eSB3ZSBjb3VsZCBhZGQgdGhhdCB0byBsaWIvc3RyaW5nLmMNCisgKi8NCitzdGF0aWMgaW5saW5l
IGNoYXIgKmZzbm90aWZ5X29sZG5hbWVfaW5pdChzdHJ1Y3QgZGVudHJ5ICpvbGRfZGVudHJ5KQ0K
K3sNCisJY2hhciAqb2xkX25hbWU7DQorDQorCW9sZF9uYW1lID0ga21hbGxvYyhzdHJsZW4ob2xk
X2RlbnRyeS0+ZF9uYW1lLm5hbWUpICsgMSwgR0ZQX0tFUk5FTCk7DQorCWlmIChvbGRfbmFtZSkN
CisJCXN0cmNweShvbGRfbmFtZSwgb2xkX2RlbnRyeS0+ZF9uYW1lLm5hbWUpOw0KKwlyZXR1cm4g
b2xkX25hbWU7DQorfQ0KKw0KKy8qDQorICogZnNub3RpZnlfb2xkbmFtZV9mcmVlIC0gZnJlZSB0
aGUgbmFtZSB3ZSBnb3QgZnJvbSBmc25vdGlmeV9vbGRuYW1lX2luaXQNCisgKi8NCitzdGF0aWMg
aW5saW5lIHZvaWQgZnNub3RpZnlfb2xkbmFtZV9mcmVlKGNvbnN0IGNoYXIgKm9sZF9uYW1lKQ0K
K3sNCisJa2ZyZWUob2xkX25hbWUpOw0KK30NCisNCisjZWxzZQkvKiBDT05GSUdfSU5PVElGWSAq
Lw0KKw0KK3N0YXRpYyBpbmxpbmUgY2hhciAqZnNub3RpZnlfb2xkbmFtZV9pbml0KHN0cnVjdCBk
ZW50cnkgKm9sZF9kZW50cnkpDQorew0KKwlyZXR1cm4gTlVMTDsNCit9DQorDQorc3RhdGljIGlu
bGluZSB2b2lkIGZzbm90aWZ5X29sZG5hbWVfZnJlZShjb25zdCBjaGFyICpvbGRfbmFtZSkNCit7
DQorfQ0KKw0KKyNlbmRpZgkvKiAhIENPTkZJR19JTk9USUZZICovDQorDQorI2VuZGlmCS8qIF9f
S0VSTkVMX18gKi8NCisNCisjZW5kaWYJLyogX0xJTlVYX0ZTX05PVElGWV9IICovDQpkaWZmIC11
ck4gbGludXgtMi42LjEyLXJjMi1tbTEvaW5jbHVkZS9saW51eC9pbm90aWZ5LmggbGludXgvaW5j
bHVkZS9saW51eC9pbm90aWZ5LmgNCi0tLSBsaW51eC0yLjYuMTItcmMyLW1tMS9pbmNsdWRlL2xp
bnV4L2lub3RpZnkuaAkxOTY5LTEyLTMxIDE5OjAwOjAwLjAwMDAwMDAwMCAtMDUwMA0KKysrIGxp
bnV4L2luY2x1ZGUvbGludXgvaW5vdGlmeS5oCTIwMDUtMDQtMDUgMTI6NDE6NTEuMDAwMDAwMDAw
IC0wNDAwDQpAQCAtMCwwICsxLDExMSBAQA0KKy8qDQorICogSW5vZGUgYmFzZWQgZGlyZWN0b3J5
IG5vdGlmaWNhdGlvbiBmb3IgTGludXgNCisgKg0KKyAqIENvcHlyaWdodCAoQykgMjAwNSBKb2hu
IE1jQ3V0Y2hhbg0KKyAqLw0KKw0KKyNpZm5kZWYgX0xJTlVYX0lOT1RJRllfSA0KKyNkZWZpbmUg
X0xJTlVYX0lOT1RJRllfSA0KKw0KKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPg0KKw0KKy8qDQor
ICogc3RydWN0IGlub3RpZnlfZXZlbnQgLSBzdHJ1Y3R1cmUgcmVhZCBmcm9tIHRoZSBpbm90aWZ5
IGRldmljZSBmb3IgZWFjaCBldmVudA0KKyAqDQorICogV2hlbiB5b3UgYXJlIHdhdGNoaW5nIGEg
ZGlyZWN0b3J5LCB5b3Ugd2lsbCByZWNlaXZlIHRoZSBmaWxlbmFtZSBmb3IgZXZlbnRzDQorICog
c3VjaCBhcyBJTl9DUkVBVEUsIElOX0RFTEVURSwgSU5fT1BFTiwgSU5fQ0xPU0UsIC4uLiwgcmVs
YXRpdmUgdG8gdGhlIHdkLg0KKyAqLw0KK3N0cnVjdCBpbm90aWZ5X2V2ZW50IHsNCisJX19zMzIJ
CXdkOwkJLyogd2F0Y2ggZGVzY3JpcHRvciAqLw0KKwlfX3UzMgkJbWFzazsJCS8qIHdhdGNoIG1h
c2sgKi8NCisJX191MzIJCWNvb2tpZTsJCS8qIGNvb2tpZSB0byBzeW5jaHJvbml6ZSB0d28gZXZl
bnRzICovDQorCV9fdTMyCQlsZW47CQkvKiBsZW5ndGggKGluY2x1ZGluZyBudWxscykgb2YgbmFt
ZSAqLw0KKwljaGFyCQluYW1lWzBdOwkvKiBzdHViIGZvciBwb3NzaWJsZSBuYW1lICovDQorfTsN
CisNCisvKg0KKyAqIHN0cnVjdCBpbm90aWZ5X3dhdGNoX3JlcXVlc3QgLSByZXByZXNlbnRzIGEg
d2F0Y2ggcmVxdWVzdA0KKyAqDQorICogUGFzcyB0byB0aGUgaW5vdGlmeSBkZXZpY2UgdmlhIHRo
ZSBJTk9USUZZX1dBVENIIGlvY3RsDQorICovDQorc3RydWN0IGlub3RpZnlfd2F0Y2hfcmVxdWVz
dCB7DQorCWludAkJZmQ7CQkvKiBmZCBvZiBmaWxlbmFtZSB0byB3YXRjaCAqLw0KKwlfX3UzMgkJ
bWFzazsJCS8qIGV2ZW50IG1hc2sgKi8NCit9Ow0KKw0KKy8qIHRoZSBmb2xsb3dpbmcgYXJlIGxl
Z2FsLCBpbXBsZW1lbnRlZCBldmVudHMgKi8NCisjZGVmaW5lIElOX0FDQ0VTUwkJMHgwMDAwMDAw
MQkvKiBGaWxlIHdhcyBhY2Nlc3NlZCAqLw0KKyNkZWZpbmUgSU5fTU9ESUZZCQkweDAwMDAwMDAy
CS8qIEZpbGUgd2FzIG1vZGlmaWVkICovDQorI2RlZmluZSBJTl9BVFRSSUIJCTB4MDAwMDAwMDQJ
LyogRmlsZSBjaGFuZ2VkIGF0dHJpYnV0ZXMgKi8NCisjZGVmaW5lIElOX0NMT1NFX1dSSVRFCQkw
eDAwMDAwMDA4CS8qIFdyaXR0YWJsZSBmaWxlIHdhcyBjbG9zZWQgKi8NCisjZGVmaW5lIElOX0NM
T1NFX05PV1JJVEUJMHgwMDAwMDAxMAkvKiBVbndyaXR0YWJsZSBmaWxlIGNsb3NlZCAqLw0KKyNk
ZWZpbmUgSU5fT1BFTgkJCTB4MDAwMDAwMjAJLyogRmlsZSB3YXMgb3BlbmVkICovDQorI2RlZmlu
ZSBJTl9NT1ZFRF9GUk9NCQkweDAwMDAwMDQwCS8qIEZpbGUgd2FzIG1vdmVkIGZyb20gWCAqLw0K
KyNkZWZpbmUgSU5fTU9WRURfVE8JCTB4MDAwMDAwODAJLyogRmlsZSB3YXMgbW92ZWQgdG8gWSAq
Lw0KKyNkZWZpbmUgSU5fREVMRVRFX1NVQkRJUgkweDAwMDAwMTAwCS8qIFN1YmRpciB3YXMgZGVs
ZXRlZCAqLw0KKyNkZWZpbmUgSU5fREVMRVRFX0ZJTEUJCTB4MDAwMDAyMDAJLyogU3ViZmlsZSB3
YXMgZGVsZXRlZCAqLw0KKyNkZWZpbmUgSU5fQ1JFQVRFX1NVQkRJUgkweDAwMDAwNDAwCS8qIFN1
YmRpciB3YXMgY3JlYXRlZCAqLw0KKyNkZWZpbmUgSU5fQ1JFQVRFX0ZJTEUJCTB4MDAwMDA4MDAJ
LyogU3ViZmlsZSB3YXMgY3JlYXRlZCAqLw0KKyNkZWZpbmUgSU5fREVMRVRFX1NFTEYJCTB4MDAw
MDEwMDAJLyogU2VsZiB3YXMgZGVsZXRlZCAqLw0KKyNkZWZpbmUgSU5fVU5NT1VOVAkJMHgwMDAw
MjAwMAkvKiBCYWNraW5nIGZzIHdhcyB1bm1vdW50ZWQgKi8NCisjZGVmaW5lIElOX1FfT1ZFUkZM
T1cJCTB4MDAwMDQwMDAJLyogRXZlbnQgcXVldWVkIG92ZXJmbG93ZWQgKi8NCisjZGVmaW5lIElO
X0lHTk9SRUQJCTB4MDAwMDgwMDAJLyogRmlsZSB3YXMgaWdub3JlZCAqLw0KKw0KKy8qIHNwZWNp
YWwgZmxhZ3MgKi8NCisjZGVmaW5lIElOX0FMTF9FVkVOVFMJCTB4ZmZmZmZmZmYJLyogQWxsIHRo
ZSBldmVudHMgKi8NCisjZGVmaW5lIElOX0NMT1NFCQkoSU5fQ0xPU0VfV1JJVEUgfCBJTl9DTE9T
RV9OT1dSSVRFKQ0KKw0KKyNkZWZpbmUgSU5PVElGWV9JT0NUTF9NQUdJQwknUScNCisjZGVmaW5l
IElOT1RJRllfSU9DVExfTUFYTlIJMg0KKw0KKyNkZWZpbmUgSU5PVElGWV9XQVRDSCAgCQlfSU9S
KElOT1RJRllfSU9DVExfTUFHSUMsIDEsIHN0cnVjdCBpbm90aWZ5X3dhdGNoX3JlcXVlc3QpDQor
I2RlZmluZSBJTk9USUZZX0lHTk9SRSAJCV9JT1IoSU5PVElGWV9JT0NUTF9NQUdJQywgMiwgaW50
KQ0KKw0KKyNpZmRlZiBfX0tFUk5FTF9fDQorDQorI2luY2x1ZGUgPGxpbnV4L2RjYWNoZS5oPg0K
KyNpbmNsdWRlIDxsaW51eC9mcy5oPg0KKyNpbmNsdWRlIDxsaW51eC9jb25maWcuaD4NCisNCisj
aWZkZWYgQ09ORklHX0lOT1RJRlkNCisNCitleHRlcm4gdm9pZCBpbm90aWZ5X2lub2RlX3F1ZXVl
X2V2ZW50KHN0cnVjdCBpbm9kZSAqLCBfX3UzMiwgX191MzIsDQorCQkJCSAgICAgIGNvbnN0IGNo
YXIgKik7DQorZXh0ZXJuIHZvaWQgaW5vdGlmeV9kZW50cnlfcGFyZW50X3F1ZXVlX2V2ZW50KHN0
cnVjdCBkZW50cnkgKiwgX191MzIsIF9fdTMyLA0KKwkJCQkJICAgICAgY29uc3QgY2hhciAqKTsN
CitleHRlcm4gdm9pZCBpbm90aWZ5X3VubW91bnRfaW5vZGVzKHN0cnVjdCBsaXN0X2hlYWQgKik7
DQorZXh0ZXJuIHZvaWQgaW5vdGlmeV9pbm9kZV9pc19kZWFkKHN0cnVjdCBpbm9kZSAqKTsNCitl
eHRlcm4gdTMyIGlub3RpZnlfZ2V0X2Nvb2tpZSh2b2lkKTsNCisNCisjZWxzZQ0KKw0KK3N0YXRp
YyBpbmxpbmUgdm9pZCBpbm90aWZ5X2lub2RlX3F1ZXVlX2V2ZW50KHN0cnVjdCBpbm9kZSAqaW5v
ZGUsDQorCQkJCQkgICAgIF9fdTMyIG1hc2ssIF9fdTMyIGNvb2tpZSwNCisJCQkJCSAgICAgY29u
c3QgY2hhciAqZmlsZW5hbWUpDQorew0KK30NCisNCitzdGF0aWMgaW5saW5lIHZvaWQgaW5vdGlm
eV9kZW50cnlfcGFyZW50X3F1ZXVlX2V2ZW50KHN0cnVjdCBkZW50cnkgKmRlbnRyeSwNCisJCQkJ
CQkgICAgIF9fdTMyIG1hc2ssIF9fdTMyIGNvb2tpZSwNCisJCQkJCQkgICAgIGNvbnN0IGNoYXIg
KmZpbGVuYW1lKQ0KK3sNCit9DQorDQorc3RhdGljIGlubGluZSB2b2lkIGlub3RpZnlfdW5tb3Vu
dF9pbm9kZXMoc3RydWN0IGxpc3RfaGVhZCAqbGlzdCkNCit7DQorfQ0KKw0KK3N0YXRpYyBpbmxp
bmUgdm9pZCBpbm90aWZ5X2lub2RlX2lzX2RlYWQoc3RydWN0IGlub2RlICppbm9kZSkNCit7DQor
fQ0KKw0KK3N0YXRpYyBpbmxpbmUgdTMyIGlub3RpZnlfZ2V0X2Nvb2tpZSh2b2lkKQ0KK3sNCisJ
cmV0dXJuIDA7DQorfQ0KKw0KKyNlbmRpZgkvKiBDT05GSUdfSU5PVElGWSAqLw0KKw0KKyNlbmRp
ZgkvKiBfX0tFUk5FTCBfXyAqLw0KKw0KKyNlbmRpZgkvKiBfTElOVVhfSU5PVElGWV9IICovDQpk
aWZmIC11ck4gbGludXgtMi42LjEyLXJjMi1tbTEvaW5jbHVkZS9saW51eC9zY2hlZC5oIGxpbnV4
L2luY2x1ZGUvbGludXgvc2NoZWQuaA0KLS0tIGxpbnV4LTIuNi4xMi1yYzItbW0xL2luY2x1ZGUv
bGludXgvc2NoZWQuaAkyMDA1LTA0LTA1IDEyOjQwOjAzLjAwMDAwMDAwMCAtMDQwMA0KKysrIGxp
bnV4L2luY2x1ZGUvbGludXgvc2NoZWQuaAkyMDA1LTA0LTA1IDEyOjQxOjUxLjAwMDAwMDAwMCAt
MDQwMA0KQEAgLTQyNiw2ICs0MjYsMTAgQEANCiAJYXRvbWljX3QgcHJvY2Vzc2VzOwkvKiBIb3cg
bWFueSBwcm9jZXNzZXMgZG9lcyB0aGlzIHVzZXIgaGF2ZT8gKi8NCiAJYXRvbWljX3QgZmlsZXM7
CQkvKiBIb3cgbWFueSBvcGVuIGZpbGVzIGRvZXMgdGhpcyB1c2VyIGhhdmU/ICovDQogCWF0b21p
Y190IHNpZ3BlbmRpbmc7CS8qIEhvdyBtYW55IHBlbmRpbmcgc2lnbmFscyBkb2VzIHRoaXMgdXNl
ciBoYXZlPyAqLw0KKyNpZmRlZiBDT05GSUdfSU5PVElGWQ0KKwlhdG9taWNfdCBpbm90aWZ5X3dh
dGNoZXM7IC8qIEhvdyBtYW55IGlub3RpZnkgd2F0Y2hlcyBkb2VzIHRoaXMgdXNlciBoYXZlPyAq
Lw0KKwlhdG9taWNfdCBpbm90aWZ5X2RldnM7CS8qIEhvdyBtYW55IGlub3RpZnkgZGV2cyBkb2Vz
IHRoaXMgdXNlciBoYXZlIG9wZW5lZD8gKi8NCisjZW5kaWYNCiAJLyogcHJvdGVjdGVkIGJ5IG1x
X2xvY2sJKi8NCiAJdW5zaWduZWQgbG9uZyBtcV9ieXRlczsJLyogSG93IG1hbnkgYnl0ZXMgY2Fu
IGJlIGFsbG9jYXRlZCB0byBtcXVldWU/ICovDQogCXVuc2lnbmVkIGxvbmcgbG9ja2VkX3NobTsg
LyogSG93IG1hbnkgcGFnZXMgb2YgbWxvY2tlZCBzaG0gPyAqLw0KZGlmZiAtdXJOIGxpbnV4LTIu
Ni4xMi1yYzItbW0xL2tlcm5lbC91c2VyLmMgbGludXgva2VybmVsL3VzZXIuYw0KLS0tIGxpbnV4
LTIuNi4xMi1yYzItbW0xL2tlcm5lbC91c2VyLmMJMjAwNS0wNC0wNSAxMjo0MDowMy4wMDAwMDAw
MDAgLTA0MDANCisrKyBsaW51eC9rZXJuZWwvdXNlci5jCTIwMDUtMDQtMDUgMTI6NDE6NTEuMDAw
MDAwMDAwIC0wNDAwDQpAQCAtMTIwLDYgKzEyMCwxMCBAQA0KIAkJYXRvbWljX3NldCgmbmV3LT5w
cm9jZXNzZXMsIDApOw0KIAkJYXRvbWljX3NldCgmbmV3LT5maWxlcywgMCk7DQogCQlhdG9taWNf
c2V0KCZuZXctPnNpZ3BlbmRpbmcsIDApOw0KKyNpZmRlZiBDT05GSUdfSU5PVElGWQ0KKwkJYXRv
bWljX3NldCgmbmV3LT5pbm90aWZ5X3dhdGNoZXMsIDApOw0KKwkJYXRvbWljX3NldCgmbmV3LT5p
bm90aWZ5X2RldnMsIDApOw0KKyNlbmRpZg0KIA0KIAkJbmV3LT5tcV9ieXRlcyA9IDA7DQogCQlu
ZXctPmxvY2tlZF9zaG0gPSAwOw0K


--=-rEd1m2fod+9RMM/DgPRp--
