Return-Path: <linux-kernel-owner+willy=40w.ods.org-S262652AbVCJPYh@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S262652AbVCJPYh (ORCPT <rfc822;willy@w.ods.org>);
	Thu, 10 Mar 2005 10:24:37 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S262660AbVCJPYh
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Thu, 10 Mar 2005 10:24:37 -0500
Received: from mummy.ncsc.mil ([144.51.88.129]:44263 "EHLO jazzhorn.ncsc.mil")
	by vger.kernel.org with ESMTP id S262652AbVCJPYV (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Thu, 10 Mar 2005 10:24:21 -0500
Subject: Re: [patch 1/1] SELinux AVC audit log ipaddr field support (for
	task_struct->curr_ip)
From: Stephen Smalley <sds@tycho.nsa.gov>
To: Lorenzo =?ISO-8859-1?Q?Hern=E1ndez_?=
	 =?ISO-8859-1?Q?Garc=EDa-Hierro?= <lorenzo@gnu.org>
Cc: "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
       selinux@tycho.nsa.gov, linux-audit@redhat.com,
       James Morris <jmorris@redhat.com>
In-Reply-To: <1110467140.9190.9.camel@localhost.localdomain>
References: <1110467140.9190.9.camel@localhost.localdomain>
Content-Type: text/plain; charset=UTF-8
Organization: National Security Agency
Date: Thu, 10 Mar 2005 10:16:49 -0500
Message-Id: <1110467809.8434.74.camel@moss-spartans.epoch.ncsc.mil>
Mime-Version: 1.0
X-Mailer: Evolution 2.0.2 (2.0.2-8) 
Content-Transfer-Encoding: 8bit
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

On Thu, 2005-03-10 at 16:05 +0100, Lorenzo Hernández García-Hierro
wrote:
> Provides support for a new field ipaddr within the SELinux
> AVC audit log, relying in task_struct->curr_ip (ipv4 only)
> provided by the task-curr_ip or grSecurity patch to be applied
> before.It was first implemented by Joshua Brindle (a.k.a Method)
> from the Hardened Gentoo project.
> 
> An example of the audit messages with ipaddr field:
> audit(1110432234.161:0): avc:  denied  { search } for  pid=19057
> exe=/usr/bin/wget name=portage dev=hda3 ino=1024647 ipaddr=192.168.1.30
> scontext=root:sysadm_r:portage_fetch_t tcontext=system_u:object_r:portage_tmp_t tclass=dir

Even if the basic idea were sound (doubtful), this would need to be
generalized (i.e. not ipv4-specific).  Also, I think I'd rather see
extensions to the audit data be incorporated into the audit framework,
not the AVC-specific audit code, and some of the existing avc_audit()
code migrated into the audit framework (e.g. the exe= information
currently generated by avc_audit could be done by audit_log_exit
instead).

-- 
Stephen Smalley <sds@tycho.nsa.gov>
National Security Agency

