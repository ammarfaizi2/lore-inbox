Return-Path: <linux-kernel-owner+willy=40w.ods.org-S1030223AbWJCP02@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1030223AbWJCP02 (ORCPT <rfc822;willy@w.ods.org>);
	Tue, 3 Oct 2006 11:26:28 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1030221AbWJCPZz
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Tue, 3 Oct 2006 11:25:55 -0400
Received: from mout2.freenet.de ([194.97.50.155]:21996 "EHLO mout2.freenet.de")
	by vger.kernel.org with ESMTP id S1030196AbWJCPZo (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Tue, 3 Oct 2006 11:25:44 -0400
Date: Tue, 03 Oct 2006 17:26:43 +0200
To: "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>
Subject: [PATCH 9/11] 2.6.18-mm3 pktcdvd: packet buffer control
Reply-To: balagi@justmail.de
From: "Thomas Maier" <balagi@justmail.de>
Cc: "petero2@telia.com" <petero2@telia.com>, "akpm@osdl.org" <akpm@osdl.org>
Content-Type: multipart/mixed; boundary=----------1PcVyBIKTDlUYAWLMbt7cF
MIME-Version: 1.0
Message-ID: <op.tguqitr2iudtyh@master>
User-Agent: Opera Mail/9.00 (Win32)
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

------------1PcVyBIKTDlUYAWLMbt7cF
Content-Type: text/plain; charset=iso-8859-15
Content-Transfer-Encoding: 7bit

Hello,

this patch allows to control the amount of packet buffers per
device.
See the Documentation/* files in the patch for further infos.

http://people.freenet.de/BalaGi/download/pktcdvd-9-packet-buffers_2.6.18.patch

Signed-off-by: Thomas Maier<balagi@justmail.de>

-Thomas Maier

------------1PcVyBIKTDlUYAWLMbt7cF
Content-Disposition: attachment; filename=pktcdvd-9-packet-buffers_2.6.18.patch
Content-Type: application/octet-stream; name=pktcdvd-9-packet-buffers_2.6.18.patch
Content-Transfer-Encoding: Base64

ZGlmZiAtdXJwTiA4LXdxdWV1ZS1jb25nZXN0aW9uL0RvY3VtZW50YXRpb24vQUJJ
L3Rlc3Rpbmcvc3lzZnMtY2xhc3MtcGt0Y2R2ZCA5LXBhY2tldC1idWZmZXJzL0Rv
Y3VtZW50YXRpb24vQUJJL3Rlc3Rpbmcvc3lzZnMtY2xhc3MtcGt0Y2R2ZAotLS0g
OC13cXVldWUtY29uZ2VzdGlvbi9Eb2N1bWVudGF0aW9uL0FCSS90ZXN0aW5nL3N5
c2ZzLWNsYXNzLXBrdGNkdmQJMjAwNi0xMC0wMyAxNTo0Njo0OS4wMDAwMDAwMDAg
KzAyMDAKKysrIDktcGFja2V0LWJ1ZmZlcnMvRG9jdW1lbnRhdGlvbi9BQkkvdGVz
dGluZy9zeXNmcy1jbGFzcy1wa3RjZHZkCTIwMDYtMTAtMDMgMTM6NDg6MjIuMDAw
MDAwMDAwICswMjAwCkBAIC0yMiw2ICsyMiwxMCBAQCB0aGVzZSBmaWxlcyBpbiB0
aGUgc3lzZnM6CiAKICAgICBkZXZpY2VfbWFwICAgICAoMDQ0NCkgIFNob3dzIHRo
ZSBkZXZpY2UgbWFwcGluZyBpbiBmb3JtYXQ6CiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHBrdGNkdmRbMC03XSA8cGt0ZGV2aWQ+IDxibGtkZXZpZD4KKwor
ICAgIHBhY2tldF9idWZmZXJzICgwNjQ0KSAgTnVtYmVyIG9mIGNvbmN1cnJlbnQg
cGFja2V0cyBwZXIKKyAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrdGNkdmQg
ZGV2aWNlLiBVc2VkIGZvciBuZXcgY3JlYXRlZAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZGV2aWNlcy4KIAkKIC9zeXMvY2xhc3MvcGt0Y2R2ZC9wa3RjZHZk
WzAtN10vCiAgICAgZGV2ICAgICAgICAgICAgICAgICAgICgwNDQ0KSBEZXZpY2Ug
aWQKZGlmZiAtdXJwTiA4LXdxdWV1ZS1jb25nZXN0aW9uL2RyaXZlcnMvYmxvY2sv
cGt0Y2R2ZC5jIDktcGFja2V0LWJ1ZmZlcnMvZHJpdmVycy9ibG9jay9wa3RjZHZk
LmMKLS0tIDgtd3F1ZXVlLWNvbmdlc3Rpb24vZHJpdmVycy9ibG9jay9wa3RjZHZk
LmMJMjAwNi0xMC0wMyAxMzo1NDo0My4wMDAwMDAwMDAgKzAyMDAKKysrIDktcGFj
a2V0LWJ1ZmZlcnMvZHJpdmVycy9ibG9jay9wa3RjZHZkLmMJMjAwNi0xMC0wMyAx
Mzo1NDo1NC4wMDAwMDAwMDAgKzAyMDAKQEAgLTkwLDYgKzkwLDcgQEAgc3RhdGlj
IHN0cnVjdCBwa3RjZHZkX2RldmljZSAqcGt0X2RldnNbTQogc3RhdGljIGludCBw
a3RkZXZfbWFqb3IgPSAwOyAvKiBkZWZhdWx0OiBkeW5hbWljIG1ham9yIG51bWJl
ciAqLwogc3RhdGljIGludCB3cml0ZV9jb25nZXN0aW9uX29uICA9IFBLVF9XUklU
RV9DT05HRVNUSU9OX09OOwogc3RhdGljIGludCB3cml0ZV9jb25nZXN0aW9uX29m
ZiA9IFBLVF9XUklURV9DT05HRVNUSU9OX09GRjsKK3N0YXRpYyBpbnQgcGFja2V0
X2J1ZmZlcnMgPSBQS1RfQlVGRkVSU19ERUZBVUxUOwogc3RhdGljIHN0cnVjdCBt
dXRleCBjdGxfbXV0ZXg7CS8qIFNlcmlhbGl6ZSBvcGVuL2Nsb3NlL3NldHVwL3Rl
YXJkb3duICovCiBzdGF0aWMgbWVtcG9vbF90ICpwc2RfcG9vbDsKIApAQCAtMTUy
LDYgKzE1MywxNCBAQCBzdGF0aWMgdm9pZCBpbml0X3dyaXRlX2Nvbmdlc3Rpb25f
bWFya3MoCiAJfQogfQogCitzdGF0aWMgdm9pZCBpbml0X3BhY2tldF9idWZmZXJz
KGludCAqbikKK3sKKwlpZiAoKm4gPCAxKQorCQkqbiA9IDE7CisJZWxzZSBpZiAo
Km4gPiAxMjgpCisJCSpuID0gMTI4OworfQorCiBzdGF0aWMgdm9pZCBwa3RfY291
bnRfc3RhdGVzKHN0cnVjdCBwa3RjZHZkX2RldmljZSAqcGQsIGludCAqc3RhdGVz
KQogewogCXN0cnVjdCBwYWNrZXRfZGF0YSAqcGt0OwpAQCAtMjAxLDYgKzIxMCw3
IEBAIHN0YXRpYyBpbnQgcGt0X3ByaW50X2luZm8oc3RydWN0IHBrdGNkdmQKIAll
bHNlCiAJCW1zZyA9ICJVbmtub3duIjsKIAlQUklOVCgiXHRibG9jayBtb2RlOlx0
XHQlc1xuIiwgbXNnKTsKKwlQUklOVCgiXHRjb25jdXJyZW50IHBhY2tldHM6XHQl
ZFxuIiwgcGFja2V0X2J1ZmZlcnMpOwogCiAJUFJJTlQoIlxuU3RhdGlzdGljczpc
biIpOwogCVBSSU5UKCJcdHBhY2tldHMgc3RhcnRlZDpcdCVsdVxuIiwgcGQtPnN0
YXRzLnBrdF9zdGFydGVkKTsKQEAgLTQ2NSw2ICs0NzUsNyBAQCBzdGF0aWMgdm9p
ZCBwa3Rfc3lzZnNfZGV2X3JlbW92ZShzdHJ1Y3QgCiAgICAgICAgICAgICAgICAg
ICAgICBhZGQgICAgICAgICAgICBtYXAgYmxvY2sgZGV2aWNlCiAgICAgICAgICAg
ICAgICAgICAgICByZW1vdmUgICAgICAgICB1bm1hcCBwYWNrZXQgZGV2CiAgICAg
ICAgICAgICAgICAgICAgICBkZXZpY2VfbWFwICAgICBzaG93IG1hcHBpbmdzCisg
ICAgICAgICAgICAgICAgICAgICBwYWNrZXRfYnVmZmVycyBudW1iZXIgb2YgcGFj
a2V0IGJ1ZmZlcnMgcGVyIGRldgogICoqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAKIHN0
YXRpYyB2b2lkIGNsYXNzX3BrdGNkdmRfcmVsZWFzZShzdHJ1Y3QgY2xhc3MgKmNs
cykKQEAgLTQ5MSw2ICs1MDIsMTEgQEAgc3RhdGljIHNzaXplX3QgY2xhc3NfcGt0
Y2R2ZF9zaG93X21hcChzdAogCXJldHVybiBuOwogfQogCitzdGF0aWMgc3NpemVf
dCBjbGFzc19wa3RjZHZkX3Nob3dfcGIoc3RydWN0IGNsYXNzICpjLCBjaGFyICpk
YXRhKQoreworCXJldHVybiBzcHJpbnRmKGRhdGEsICIlZFxuIiwgcGFja2V0X2J1
ZmZlcnMpOworfQorCiBzdGF0aWMgc3NpemVfdCBjbGFzc19wa3RjZHZkX3N0b3Jl
X2FkZChzdHJ1Y3QgY2xhc3MgKmMsIGNvbnN0IGNoYXIgKmJ1ZiwKIAkJCQkJc2l6
ZV90IGNvdW50KQogewpAQCAtNTE1LDEwICs1MzEsMjYgQEAgc3RhdGljIHNzaXpl
X3QgY2xhc3NfcGt0Y2R2ZF9zdG9yZV9yZW1vdgogCXJldHVybiAtRUlOVkFMOwog
fQogCitzdGF0aWMgc3NpemVfdCBjbGFzc19wa3RjZHZkX3N0b3JlX3BiKHN0cnVj
dCBjbGFzcyAqYywgY29uc3QgY2hhciAqYnVmLAorCQkJCQlzaXplX3QgY291bnQp
Cit7CisJaW50IHZhbDsKKwlERUNMQVJFX0JVRl9BU19TVFJJTkcoZGJ1ZiwgYnVm
LCBjb3VudCk7CisJaWYgKHNzY2FuZihkYnVmLCAiJWQiLCAmdmFsKSA9PSAxKSB7
CisJCW11dGV4X2xvY2tfbmVzdGVkKCZjdGxfbXV0ZXgsIFNJTkdMRV9ERVBUSF9O
RVNUSU5HKTsKKwkJaW5pdF9wYWNrZXRfYnVmZmVycygmdmFsKTsKKwkJcGFja2V0
X2J1ZmZlcnMgPSB2YWw7CisJCW11dGV4X3VubG9jaygmY3RsX211dGV4KTsKKwkJ
cmV0dXJuIGNvdW50OworCX0KKwlyZXR1cm4gLUVJTlZBTDsKK30KKwogc3RhdGlj
IHN0cnVjdCBjbGFzc19hdHRyaWJ1dGUgY2xhc3NfcGt0Y2R2ZF9hdHRyc1tdID0g
ewogIF9fQVRUUihhZGQsICAgICAgICAgICAgMDIwMCwgTlVMTCwgY2xhc3NfcGt0
Y2R2ZF9zdG9yZV9hZGQpLAogIF9fQVRUUihyZW1vdmUsICAgICAgICAgMDIwMCwg
TlVMTCwgY2xhc3NfcGt0Y2R2ZF9zdG9yZV9yZW1vdmUpLAogIF9fQVRUUihkZXZp
Y2VfbWFwLCAgICAgMDQ0NCwgY2xhc3NfcGt0Y2R2ZF9zaG93X21hcCwgTlVMTCks
CisgX19BVFRSKHBhY2tldF9idWZmZXJzLCAwNjQ0LCBjbGFzc19wa3RjZHZkX3No
b3dfcGIsIGNsYXNzX3BrdGNkdmRfc3RvcmVfcGIpLAogIF9fQVRUUl9OVUxMCiB9
OwogCkBAIC0yNjAzLDcgKzI2MzUsNyBAQCBzdGF0aWMgaW50IHBrdF9vcGVuX2Rl
dihzdHJ1Y3QgcGt0Y2R2ZF9kCiAJCWdvdG8gb3V0X3VuY2xhaW07CiAKIAlpZiAo
d3JpdGUpIHsKLQkJaWYgKCFwa3RfZ3Jvd19wa3RsaXN0KHBkLCBDT05GSUdfQ0RS
T01fUEtUQ0RWRF9CVUZGRVJTKSkgeworCQlpZiAoIXBrdF9ncm93X3BrdGxpc3Qo
cGQsIHBhY2tldF9idWZmZXJzKSkgewogCQkJcHJpbnRrKERSSVZFUl9OQU1FIjog
bm90IGVub3VnaCBtZW1vcnkgZm9yIGJ1ZmZlcnNcbiIpOwogCQkJcmV0ID0gLUVO
T01FTTsKIAkJCWdvdG8gb3V0X3VuY2xhaW07CkBAIC0zMTgwLDYgKzMyMTIsNyBA
QCBzdGF0aWMgaW50IF9faW5pdCBwa3RfaW5pdCh2b2lkKQogCiAJaW5pdF93cml0
ZV9jb25nZXN0aW9uX21hcmtzKCZ3cml0ZV9jb25nZXN0aW9uX29mZiwKIAkJCQkm
d3JpdGVfY29uZ2VzdGlvbl9vbik7CisJaW5pdF9wYWNrZXRfYnVmZmVycygmcGFj
a2V0X2J1ZmZlcnMpOwogCiAJbXV0ZXhfaW5pdCgmY3RsX211dGV4KTsKIApkaWZm
IC11cnBOIDgtd3F1ZXVlLWNvbmdlc3Rpb24vaW5jbHVkZS9saW51eC9wa3RjZHZk
LmggOS1wYWNrZXQtYnVmZmVycy9pbmNsdWRlL2xpbnV4L3BrdGNkdmQuaAotLS0g
OC13cXVldWUtY29uZ2VzdGlvbi9pbmNsdWRlL2xpbnV4L3BrdGNkdmQuaAkyMDA2
LTEwLTAzIDEzOjM3OjAxLjAwMDAwMDAwMCArMDIwMAorKysgOS1wYWNrZXQtYnVm
ZmVycy9pbmNsdWRlL2xpbnV4L3BrdGNkdmQuaAkyMDA2LTEwLTAzIDEzOjQ3OjU2
LjAwMDAwMDAwMCArMDIwMApAQCAtMTIyLDYgKzEyMiwxMyBAQCBzdHJ1Y3QgcGt0
X2N0cmxfY29tbWFuZCB7CiAjZGVmaW5lIFBLVF9VU0VfUFJPQ0ZTICAwCiAjZW5k
aWYKIAorLyogdXNlIGNvbmN1cnJlbnQgcGFja2V0cyBwZXIgZGV2aWNlICovCisj
aWZkZWYgQ09ORklHX0NEUk9NX1BLVENEVkRfQlVGRkVSUworI2RlZmluZSBQS1Rf
QlVGRkVSU19ERUZBVUxUIENPTkZJR19DRFJPTV9QS1RDRFZEX0JVRkZFUlMKKyNl
bHNlCisjZGVmaW5lIFBLVF9CVUZGRVJTX0RFRkFVTFQgOAorI2VuZGlmCisKIAog
LyogZGVmYXVsdCBiaW8gd3JpdGUgcXVldWUgY29uZ2VzdGlvbiBtYXJrcyAqLwog
I2RlZmluZSBQS1RfV1JJVEVfQ09OR0VTVElPTl9PTiA1MDAwCg==

------------1PcVyBIKTDlUYAWLMbt7cF--

