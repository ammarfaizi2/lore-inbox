Return-Path: <linux-kernel-owner+willy=40w.ods.org-S269954AbUJNDmd@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S269954AbUJNDmd (ORCPT <rfc822;willy@w.ods.org>);
	Wed, 13 Oct 2004 23:42:33 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S269955AbUJNDmd
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Wed, 13 Oct 2004 23:42:33 -0400
Received: from f076189.ppp.asahi-net.or.jp ([211.120.76.189]:12012 "EHLO
	mitou.ysato.dip.jp") by vger.kernel.org with ESMTP id S269954AbUJNDm3
	(ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Wed, 13 Oct 2004 23:42:29 -0400
Date: Thu, 14 Oct 2004 12:42:25 +0900
Message-ID: <m2655e6k4e.wl%ysato@users.sourceforge.jp>
From: Yoshinori Sato <ysato@users.sourceforge.jp>
To: Andrew Morton <akpm@osdl.org>
Cc: linux-kernel@vger.kernel.org
Subject: [PATCH] H8/300 some error/warning fix
User-Agent: Wanderlust/2.11.30 (Wonderwall) SEMI/1.14.6 (Maruoka) FLIM/1.14.6 (Marutamachi) APEL/10.6 Emacs/21.3 (i386-pc-linux-gnu) MULE/5.0 (SAKAKI)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Singed-off-by: Yoshinori Sato <ysato@users.sourceforge.jp>

diff -ru linux-2.6.8/arch/h8300/kernel/ptrace.c linux-2.6.8-h8300/arch/h8300/kernel/ptrace.c
--- linux-2.6.8/arch/h8300/kernel/ptrace.c	2004-08-14 14:36:44.000000000 +0900
+++ linux-2.6.8-h8300/arch/h8300/kernel/ptrace.c	2004-10-14 11:52:19.000000000 +0900
@@ -114,7 +114,7 @@
 
 	/* read the word at location addr in the USER area. */
 		case PTRACE_PEEKUSR: {
-			unsigned long tmp;
+			unsigned long tmp = 0;
 			
 			if ((addr & 3) || addr < 0 || addr >= sizeof(struct user)) {
 				ret = -EIO;
diff -ru linux-2.6.8/arch/h8300/lib/checksum.c linux-2.6.8-h8300/arch/h8300/lib/checksum.c
--- linux-2.6.8/arch/h8300/lib/checksum.c	2004-08-14 14:36:13.000000000 +0900
+++ linux-2.6.8-h8300/arch/h8300/lib/checksum.c	2004-10-14 12:02:43.000000000 +0900
@@ -32,6 +32,7 @@
    of the assembly has to go. */
 
 #include <net/checksum.h>
+#include <linux/module.h>
 
 static inline unsigned short from32to16(unsigned long x)
 {
diff -ru linux-2.6.8/arch/h8300/platform/h8300h/generic/timer.c linux-2.6.8-h8300/arch/h8300/platform/h8300h/generic/timer.c
--- linux-2.6.8/arch/h8300/platform/h8300h/generic/timer.c	2004-08-14 14:36:56.000000000 +0900
+++ linux-2.6.8-h8300/arch/h8300/platform/h8300h/generic/timer.c	2004-10-14 11:53:24.000000000 +0900
@@ -32,7 +32,7 @@
 
 #define H8300_TIMER_FREQ CONFIG_CPU_CLOCK*1000/8192 /* Timer input freq. */
 
-int platform_timer_setup(irqreturn_t (*timer_int)(int, void *, struct pt_regs *))
+void __init platform_timer_setup(irqreturn_t (*timer_int)(int, void *, struct pt_regs *))
 {
 	/* setup 8bit timer ch2 */
 	ctrl_outb(H8300_TIMER_FREQ / HZ, TCORA2);      /* set interval */
@@ -69,7 +69,7 @@
 
 #define H8300_TIMER_FREQ CONFIG_CPU_CLOCK*1000/8 /* Timer input freq. */
 
-int platform_timer_setup(irqreturn_t (*timer_int)(int, void *, struct pt_regs *))
+void __init platform_timer_setup(irqreturn_t (*timer_int)(int, void *, struct pt_regs *))
 {
 	*(unsigned short *)GRA= H8300_TIMER_FREQ / HZ;  /* set interval */
 	*(unsigned short *)TCNT=0;                      /* clear counter */
diff -ru linux-2.6.8/include/asm-h8300/bitops.h linux-2.6.8-h8300/include/asm-h8300/bitops.h
--- linux-2.6.8/include/asm-h8300/bitops.h	2004-08-14 14:36:56.000000000 +0900
+++ linux-2.6.8-h8300/include/asm-h8300/bitops.h	2004-10-14 11:48:50.000000000 +0900
@@ -273,6 +273,8 @@
 	return result + __ffs(tmp);
 }
 
+#define find_first_bit(addr, size) find_next_bit(addr, size, 0)
+
 /*
  * Every architecture must define this function. It's the fastest
  * way of searching a 140-bit bitmap where the first 100 bits are
