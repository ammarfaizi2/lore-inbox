Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261832AbTEBGI2 (ORCPT <rfc822;willy@w.ods.org>);
	Fri, 2 May 2003 02:08:28 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261849AbTEBGH1
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Fri, 2 May 2003 02:07:27 -0400
Received: from i235066.ppp.asahi-net.or.jp ([61.125.235.66]:56559 "EHLO
	mitou.ysato.zive.net") by vger.kernel.org with ESMTP
	id S261832AbTEBGGA (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Fri, 2 May 2003 02:06:00 -0400
Date: Fri, 02 May 2003 15:18:23 +0900
Message-ID: <m21xzhrhw0.wl@ysato.zive.net>
From: Yoshinori Sato <ysato@users.sourceforge.jp>
To: Linus Torvalds <torvalds@transmeta.com>
Cc: linux-kernel Mailinglist <linux-kernel@vger.kernel.org>
Subject: [PATCH] H8/300 support update (3/4)
User-Agent: Wanderlust/2.10.0 (Venus) SEMI/1.14.4 (Hosorogi) FLIM/1.14.4
 (=?ISO-8859-4?Q?Kashiharajing=FE-mae?=) APEL/10.4 Emacs/21.2
 (i386-pc-linux-gnu) MULE/5.0 (SAKAKI)
MIME-Version: 1.0 (generated by SEMI 1.14.4 - "Hosorogi")
Content-Type: multipart/mixed;
 boundary="Multipart_Fri_May__2_15:18:23_2003-1"
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

--Multipart_Fri_May__2_15:18:23_2003-1
Content-Type: text/plain; charset=US-ASCII

include

o cleanup ldsctipts.

-- 
Yoshinori Sato
<ysato@users.sourceforge.jp>


--Multipart_Fri_May__2_15:18:23_2003-1
Content-Type: application/octet-stream; type=patch
Content-Disposition: attachment; filename="linux-2.5.68-h8300-lds.diff"
Content-Transfer-Encoding: 7bit

Index: arch/h8300/vmlinux.lds.S
===================================================================
RCS file: /var/lib/cvs/linux-2.5/arch/h8300/vmlinux.lds.S,v
retrieving revision 1.1.1.1
retrieving revision 1.3
diff -u -r1.1.1.1 -r1.3
--- arch/h8300/vmlinux.lds.S	21 Apr 2003 02:22:44 -0000	1.1.1.1
+++ arch/h8300/vmlinux.lds.S	1 May 2003 13:34:19 -0000	1.3
@@ -36,3 +36,114 @@
 #endif
 #endif
 
+_jiffies = _jiffies_64 + 4;
+
+SECTIONS
+{
+	.vectors :
+	{
+	__vector = . ;
+		*(.vectors*)
+	} > vector
+        .text :
+	{
+		*(.int_redirect)
+	__stext = . ;
+        	*(.text)
+	. = ALIGN(0x4) ;
+		*(.exit.text)
+		*(.text.*)
+	. = ALIGN(0x4) ;
+		*(.exitcall.exit)
+	. = ALIGN(0x4) ;
+		*(.kstrtab)
+	. = ALIGN(0x4) ;
+		*(.rodata*)
+	. = ALIGN(16);          /* Exception table              */
+	___start___ex_table = .;
+		*(__ex_table)
+	___stop___ex_table = .;
+
+        ___start___ksymtab = .;  /* Kernel symbol table          */
+		 *(__ksymtab)
+	___stop___ksymtab = .;
+
+	. = ALIGN(0x4) ;
+	__etext = . ;
+	} > rom
+	.data : AT( ADDR(.text)+SIZEOF(.text))
+	{
+	__sdata = . ;
+	___data_start = . ;
+
+	. = ALIGN(0x2000) ;
+		*(.data.init_task)
+	. = ALIGN(0x4) ;
+		*(.data)
+	. = ALIGN(0x4) ;
+		*(.data.*)	
+
+	. = ALIGN(0x4) ;
+	___init_begin = .;
+	__sinittext = .; 
+		*(.init.text)
+	__einittext = .; 
+		*(.init.data)
+	. = ALIGN(0x4) ;
+	___setup_start = .;
+		*(.init.setup)
+	. = ALIGN(0x4) ;
+	___setup_end = .;
+	___start___param = .;
+		*(__param)
+	___stop___param = .;
+	___initcall_start = .;
+		*(.initcall1.init)
+		*(.initcall2.init)
+		*(.initcall3.init)
+		*(.initcall4.init)
+		*(.initcall5.init)
+		*(.initcall6.init)
+		*(.initcall7.init)
+	___initcall_end = .;
+	___con_initcall_start = .;
+		*(.con_initcall.init)
+	___con_initcall_end = .;
+		. = ALIGN(4);
+	___initramfs_start = .;
+  		*(.init.ramfs)
+  	___initramfs_end = .;
+	. = ALIGN(0x4) ;
+	___init_end = .;
+
+	__edata = . ;
+	} > ram
+	__begin_data = LOADADDR(.data) ;
+	.erom :
+	{
+	__erom = . ;
+	} > erom
+        .bss :
+        {
+	. = ALIGN(0x4) ;
+	__sbss = . ;
+		*(.bss)
+	. = ALIGN(0x4) ;
+		*(COMMON)
+	. = ALIGN(0x4) ;
+	__ebss = . ;
+	__end = . ;
+	__ramstart = .;
+	} > ram
+	.blkimg : AT( LOADADDR(.data) + SIZEOF(.data))
+	{
+	__blkimg = . ;
+		*(.rootimg*)
+	} > ram
+        .dummy :
+        {
+        COMMAND_START = . - 0x200 ;
+	__ramend = . ;
+	} > eram
+}
+
Index: arch/h8300/platform/h8300h/generic/ram.ld
===================================================================
RCS file: /var/lib/cvs/linux-2.5/arch/h8300/platform/h8300h/generic/ram.ld,v
retrieving revision 1.1.1.1
retrieving revision 1.2
diff -u -r1.1.1.1 -r1.2
--- arch/h8300/platform/h8300h/generic/ram.ld	21 Apr 2003 02:22:44 -0000	1.1.1.1
+++ arch/h8300/platform/h8300h/generic/ram.ld	25 Apr 2003 17:24:54 -0000	1.2
@@ -12,65 +12,3 @@
 	eram   : ORIGIN = 0x600000, LENGTH = 0
         iram   : ORIGIN = 0xffbf20, LENGTH = 0x4000
 	}
-
-SECTIONS
-{
-	.bootvec :
-	{
-	*(.bootvec)
-	} > ram
-        .text :
-	{
-	__stext = . ;
-        *(.text)
-	__etext = . ;
-        } > ram
-	.rodata :
-	{
-	___data_rom_start = ALIGN ( 4 ) ;
-	} > ram
-	.erom :
-	{
-	__erom = . ;
-	} > ram
-	.data : 
-	{
-	__ramstart = . ;
-	__sdata = . ;
-	___data_start = . ;
-        *(.data)
-	__edata = . ;
-	edata = ALIGN( 0x10 ) ;
-	___data_end = ALIGN( 0x10 ) ;
-	} > ram
-        .bss :
-        {
-	__sbss = . ;
-	___bss_start = . ;
-	*(.bss)
-	*(COMMON)
-	__ebss = . ;
-	___bss_end = . ;
-	} > ram
-/*
-	.rootimg :
-	{
-	__rootimage = . ;
-	} > rdisk
-*/
-	.dummy1 :
-	{
-	end = ALIGN( 0x10 ) ;
-	__end = ALIGN( 0x10 ) ;
-	} > uram
-	.ram_vec : AT(___bss_end)
-	{
-	__ram_vector       = . ;
-	} > iram 
-	__ram_vector_image = LOADADDR(.ram_vec) ;
-        .dummy2 :
-        {
-        _COMMAND_START = . - 0x200 ;
-	__ramend = . ;
-	} > eram
-}
Index: arch/h8300/platform/h8300h/generic/rom.ld
===================================================================
RCS file: /var/lib/cvs/linux-2.5/arch/h8300/platform/h8300h/generic/rom.ld,v
retrieving revision 1.1.1.1
retrieving revision 1.3
diff -u -r1.1.1.1 -r1.3
--- arch/h8300/platform/h8300h/generic/rom.ld	21 Apr 2003 02:22:44 -0000	1.1.1.1
+++ arch/h8300/platform/h8300h/generic/rom.ld	1 May 2003 13:38:31 -0000	1.3
@@ -1,122 +1,13 @@
 OUTPUT_ARCH(h8300h)
 ENTRY("__start")
 
-/*INPUT(rootimage.o)*/
-
-_jiffies = _jiffies_64 + 4;
-
 MEMORY 
 	{
 	vector : ORIGIN = 0x000000, LENGTH = 0x000100
 	rom    : ORIGIN = 0x000100, LENGTH = 0x200000-0x000100
 	erom   : ORIGIN = 0x200000, LENGTH = 1
-	ram    : ORIGIN = 0x200000, LENGTH = 0x100000
-	eram   : ORIGIN = 0x2fa000, LENGTH = 1
+	ram    : ORIGIN = 0x200000, LENGTH = 0x400000
+	eram   : ORIGIN = 0x600000, LENGTH = 1
 	}
 
-SECTIONS
-{
-	.vectors :
-	{
-	__vector = . ;
-		*(.vectors*)
-	} > vector
-        .text :
-	{
-		*(.int_redirect)
-	__stext = . ;
-        	*(.text)
-	. = ALIGN(0x4) ;
-		*(.exit.text)
-		*(.text.*)
-	. = ALIGN(0x4) ;
-		*(.exitcall.exit)
-	. = ALIGN(0x4) ;
-		*(.kstrtab)
-	. = ALIGN(0x4) ;
-		*(.rodata*)
-	. = ALIGN(16);          /* Exception table              */
-	___start___ex_table = .;
-		*(__ex_table)
-	___stop___ex_table = .;
-
-        ___start___ksymtab = .;  /* Kernel symbol table          */
-		 *(__ksymtab)
-	___stop___ksymtab = .;
-
-	. = ALIGN(0x4) ;
-	__etext = . ;
-	} > rom
-	.data : AT( ADDR(.text)+SIZEOF(.text))
-	{
-	__sdata = . ;
-	___data_start = . ;
-
-	. = ALIGN(0x2000) ;
-		*(.data.init_task)
-	. = ALIGN(0x4) ;
-		*(.data)
-	. = ALIGN(0x4) ;
-		*(.data.*)	
-
-	. = ALIGN(0x4) ;
-	___init_begin = .;
-		*(.init.text)
-		*(.init.data)
-	. = ALIGN(0x4) ;
-	___setup_start = .;
-		*(.init.setup)
-	. = ALIGN(0x4) ;
-	___setup_end = .;
-	___start___param = .;
-		*(__param)
-	___stop___param = .;
-	___initcall_start = .;
-		*(.initcall1.init)
-		*(.initcall2.init)
-		*(.initcall3.init)
-		*(.initcall4.init)
-		*(.initcall5.init)
-		*(.initcall6.init)
-		*(.initcall7.init)
-	___initcall_end = .;
-	___con_initcall_start = .;
-		*(.con_initcall.init)
-	___con_initcall_end = .;
-		. = ALIGN(4);
-	___initramfs_start = .;
-  		*(.init.ramfs)
-  	___initramfs_end = .;
-	. = ALIGN(0x4) ;
-	___init_end = .;
-
-	__edata = . ;
-	} > ram
-	__begin_data = LOADADDR(.data) ;
-	.blkimg : AT( LOADADDR(.data) + SIZEOF(.data))
-	{
-	__blkimg = . ;
-		*(.rootimg*)
-	} > rom
-	.erom :
-	{
-	__erom = . ;
-	} > erom
-        .bss :
-        {
-	. = ALIGN(0x4) ;
-	__sbss = . ;
-		*(.bss)
-	. = ALIGN(0x4) ;
-		*(COMMON)
-	. = ALIGN(0x4) ;
-	__ebss = . ;
-	__end = . ;
-	__ramstart = .;
-	} > ram
-        .dummy :
-        {
-        COMMAND_START = . - 0x200 ;
-	__ramend = . ;
-	} > eram
-}
+INPUT(rootimage.o)

--Multipart_Fri_May__2_15:18:23_2003-1--
