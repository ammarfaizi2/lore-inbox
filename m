Return-Path: <linux-kernel-owner+willy=40w.ods.org-S1752558AbVHGSzQ@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1752558AbVHGSzQ (ORCPT <rfc822;willy@w.ods.org>);
	Sun, 7 Aug 2005 14:55:16 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1752556AbVHGSzP
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Sun, 7 Aug 2005 14:55:15 -0400
Received: from dvhart.com ([64.146.134.43]:58240 "EHLO localhost.localdomain")
	by vger.kernel.org with ESMTP id S1752561AbVHGSzN (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Sun, 7 Aug 2005 14:55:13 -0400
Date: Sun, 07 Aug 2005 11:55:16 -0700
From: "Martin J. Bligh" <mbligh@mbligh.org>
Reply-To: "Martin J. Bligh" <mbligh@mbligh.org>
To: Adrian Bunk <bunk@stusta.de>
Cc: linux-kernel <linux-kernel@vger.kernel.org>
Subject: Re: EXPORT_SYMBOL generates "is deprecated" noise
Message-ID: <255090000.1123440916@[10.10.2.4]>
In-Reply-To: <20050807182312.GG3513@stusta.de>
References: <251790000.1123438079@[10.10.2.4]> <20050807182312.GG3513@stusta.de>
X-Mailer: Mulberry/2.2.1 (Linux/x86)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org



--Adrian Bunk <bunk@stusta.de> wrote (on Sunday, August 07, 2005 20:23:12 +0200):

> On Sun, Aug 07, 2005 at 11:07:59AM -0700, Martin J. Bligh wrote:
>> I'm getting lots of errors like this nowadays:
>> 
>> drivers/serial/8250.c:2651: warning: `register_serial' is deprecated 
>> (declared at drivers/serial/8250.c:2607)
>> 
>> Which is just: "EXPORT_SYMBOL(register_serial);"
>> 
>> Sorry, but that's just compile-time noise, not anything useful.
>> Warning on real usages of it might be handy (we can go fix the users)
>> but not EXPORT_SYMBOL - we can't kill the export until the function
>> goes away. The more noise we have, the harder it is to see real errors 
>> and warnings.
>> 
>> I took a quick poke around, but can't see what generates this stuff.
>> What is doing these checks, and can we please make an exception for
>> EXPORT_SYMBOL (and EXPORT_SYMBOL_GPL) somehow?
> 
> This is generated by the __deprecated marker (#define'd to 
> __attribute__((deprecated)) ) at the prototype in 
> include/linux/serial.h.
> 
> You could somehow #ifdef the warning away, but IMHO this would be more 
> ugly than living with the warning until the last user is gone.

If it's going to spout crap when I'm not even using the deprecated
function, it's worse than useless, I'm afraid. 

I tried some "smart" nested definitions to just wrap it inside EXPORT_SYMBOL, 
but the ordering of evaluation is all wrong. Bah ;-(

M.

