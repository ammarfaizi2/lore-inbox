Return-Path: <linux-kernel-owner+willy=40w.ods.org-S267631AbUHPNfT@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S267631AbUHPNfT (ORCPT <rfc822;willy@w.ods.org>);
	Mon, 16 Aug 2004 09:35:19 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S267634AbUHPNdg
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Mon, 16 Aug 2004 09:33:36 -0400
Received: from cantor.suse.de ([195.135.220.2]:38098 "EHLO Cantor.suse.de")
	by vger.kernel.org with ESMTP id S267626AbUHPNc7 (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Mon, 16 Aug 2004 09:32:59 -0400
Date: Mon, 16 Aug 2004 15:31:44 +0200
Message-ID: <s5h1xi7b45b.wl@alsa2.suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Ingo Molnar <mingo@elte.hu>
Cc: Lee Revell <rlrevell@joe-job.com>, Florian Schmidt <mista.tapas@gmx.net>,
       linux-kernel <linux-kernel@vger.kernel.org>,
       Felipe Alfaro Solana <felipe_alfaro@linuxmail.org>
Subject: Re: [patch] voluntary-preempt-2.6.8-rc3-O4
In-Reply-To: <20040810092249.GA29875@elte.hu>
References: <1090832436.6936.105.camel@mindpipe>
	<20040726124059.GA14005@elte.hu>
	<20040726204720.GA26561@elte.hu>
	<20040729222657.GA10449@elte.hu>
	<20040801193043.GA20277@elte.hu>
	<20040809104649.GA13299@elte.hu>
	<20040809130558.GA17725@elte.hu>
	<20040809190201.64dab6ea@mango.fruits.de>
	<1092103522.761.2.camel@mindpipe>
	<20040810085849.GC26081@elte.hu>
	<20040810092249.GA29875@elte.hu>
User-Agent: Wanderlust/2.10.1 (Watching The Wheels) SEMI/1.14.5 (Awara-Onsen) FLIM/1.14.5 (Demachiyanagi) APEL/10.6 MULE XEmacs/21.4 (patch 15) (Security Through Obscurity) (i386-suse-linux)
MIME-Version: 1.0 (generated by SEMI 1.14.5 - "Awara-Onsen")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

At Tue, 10 Aug 2004 11:22:49 +0200,
Ingo Molnar wrote:
> 
> 
> * Ingo Molnar <mingo@elte.hu> wrote:
> 
> > another idea: you are running this on a C3, using CONFIG_MCYRIXIII,
> > correct? That is one of the rare configs that triggers X86_USE_3DNOW
> > and MMX ops. If 3dnow is in any way handicapped in that CPU then that
> > could cause trouble. Could you compile for e.g. CONFIG_M586TSC? [that
> > option should be fully compatible with a C3.] - this will exclude the
> > MMX page clearing ops.
> 
> another (more remote) possibility is that the timestamp counter gets
> somehow messed up during MMX ops. Does the ALSA detector use the
> timestamp counter, or does it only use jiffies?

No, neither of them.  It checks the DMA buffer position, so the
accuracy of the latency measurement depends on the size of DMA buffer 
fragment (called "period" in ALSA).

The only thing related with the time in the pcm layer is the call of
do_gettimeofday() when status ioctl is called (or at each DMA
interrupt, depending on the running mode).


Takashi
