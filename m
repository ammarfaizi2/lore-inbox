Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261346AbTJFLAV (ORCPT <rfc822;willy@w.ods.org>);
	Mon, 6 Oct 2003 07:00:21 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261615AbTJFLAV
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Mon, 6 Oct 2003 07:00:21 -0400
Received: from mail.gmx.de ([213.165.64.20]:22168 "HELO mail.gmx.net")
	by vger.kernel.org with SMTP id S261346AbTJFLAO (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Mon, 6 Oct 2003 07:00:14 -0400
X-Authenticated: #1033915
Message-ID: <3F814B37.5040009@GMX.li>
Date: Mon, 06 Oct 2003 13:00:07 +0200
From: Jan Schubert <Jan.Schubert@GMX.li>
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.4) Gecko/20031005
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: Massimo Dal Zotto <dz@debian.org>, linux-kernel@vger.kernel.org
Subject: Re: 2.6.0_test6: CONFIG_I8K produces wrong/no keycodes for special
 buttons
References: <200310061034.h96AYGVP021010@dizzy.dz.net>
In-Reply-To: <200310061034.h96AYGVP021010@dizzy.dz.net>
X-Enigmail-Version: 0.76.7.0
X-Enigmail-Supports: pgp-inline, pgp-mime
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Massimo Dal Zotto wrote:

>The inspiron 8000 has 4 multimedia buttons, 2 volume buttons and 3 Fn-key
>combinations. Other Dell laptops have only one or two buttons.
>
>The multimedia buttons generate the following raw scancodes which can be
>dumped with showkey -s:
>
>    0xe0 0x01	play
>    0xe0 0x02	stop
>    0xe0 0x03	back
>    0xe0 0x04	forward
>
>Since the raw scancodes are generate by the keyboard like any other key
>they should be handled by the 2.6.0 kernel as in 2.4.x. If this doesn't
>work it is a bug in the kernel. Did you try showkey -s with 2.6.0?
>
This is what i get:
play - <nothing>
Stop -
0xe0 0x22
0xe0 0xa2
back - <nothing>
forward-
0x6a
0xea

>For some obscure reason known only to Dell the volume buttons and the Fn-
>keys are trapped by the SMM BIOS and can be read only by the i8k driver
>which under kernel 2.4.x can be programmed to generate the original raw
>scancodes generated by the keyboard:
>
>    0xe0 0x20	fn+vol_mute
>    0xe0 0x2e	vol_up, fn+vol_down
>    0xe0 0x30	vol_up, Fn+vol_up
>
These keys seems to work, but don't produce any keycodes. The same 
happens when pressing the (special) Volume-keys.

>(SMM BIOS can be programmed to handle volume buttons as normal keys
>by disabling the Fn- key but then you don't have the Fn- function,
>including bios access and suspend)
>
Suspend and Bios-Setup will work (when accessing the Bios-Setup there is 
no way to come back to my system - this worked some time ago).

>Unfortunately the keyboard interface has changed in 2.6.0 and it is not
>possible to generate the 0xe0, 0x0N sequence as in 2.4.x, so this feature
>has been disabled and you must use i8kbuttons instead. If anybody knows
>how to generate the corresponding scancodes in kernel 2.6.0 please let
>me know.
>
Is i8kbuttons usable for the play, stop, back and forward-button? This 
would be new to me, AFAIK you can only map the volume-keys.

toral distfiles # i8kbuttons --help
Usage:  i8kbuttons [<option>...]

Options:

        -v|--verbose
        -u|--up <command>
        -d|--down <command>
        -m|--mute <command>
        -r|--repeat <milliseconds>
        -t|--timeout <milliseconds>

Thx, Jan

