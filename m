Return-Path: <linux-kernel-owner+willy=40w.ods.org-S1756419AbWKVSr0@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1756419AbWKVSr0 (ORCPT <rfc822;willy@w.ods.org>);
	Wed, 22 Nov 2006 13:47:26 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1756420AbWKVSr0
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Wed, 22 Nov 2006 13:47:26 -0500
Received: from bay2-f252.bay2.hotmail.com ([65.54.246.77]:31306 "EHLO
	bay0-omc1-s5.bay0.hotmail.com") by vger.kernel.org with ESMTP
	id S1756413AbWKVSrY (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Wed, 22 Nov 2006 13:47:24 -0500
Message-ID: <BAY20-F15F470BD5809D7E91E8196D8E30@phx.gbl>
X-Originating-IP: [80.178.108.101]
X-Originating-Email: [yan_952@hotmail.com]
From: "Burman Yan" <yan_952@hotmail.com>
To: linux-kernel@vger.kernel.org
Cc: khali@linux-fr.org
Subject: [PATCH 2.6.19-rc6] hwmon: HP Mobile data protection system 3D driver version 0.6
Date: Wed, 22 Nov 2006 20:47:21 +0200
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="----=_NextPart_000_5adc_3ade_777f"
X-OriginalArrivalTime: 22 Nov 2006 18:47:23.0727 (UTC) FILETIME=[A5F79DF0:01C70E66]
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

This is a multi-part message in MIME format.

------=_NextPart_000_5adc_3ade_777f
Content-Type: text/plain; format=flowed

Hi.

Here is the driver for the accelerometer present on HP nc6400. The 
difference from my
previous patch is that I replaced spinlock+counter with atomic_t + some 
minor cosmetics.

Yan Burman

_________________________________________________________________
Express yourself instantly with MSN Messenger! Download today it's FREE! 
http://messenger.msn.click-url.com/go/onm00200471ave/direct/01/

------=_NextPart_000_5adc_3ade_777f
Content-Type: application/octet-stream; name="mdps-0.6.patch"
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename="mdps-0.6.patch"

SFAgTW9iaWxlIERhdGEgUHJvdGVjdGlvbiBTeXN0ZW0gM0QgQUNQSSBkcml2
ZXIuIFNpbWlsYXIgdG8gaGRhcHMgaW4gZnVuY3Rpb25hbGl0eS4KVGhpcyBk
cml2ZXIgcHJvdmlkZXMgNCBraW5kcyBvZiBmdW5jdGlvbmFsaXR5OgoxKSBD
cmVhdGVzIGEgbWlzYyBkZXZpY2UgL2Rldi9hY2NlbCB0aGF0IGFjdHMgc2lt
aWxhciB0byAvZGV2L3J0YyBhbmQgdW5ibG9ja3MKdGhlIHByb2Nlc3MgcmVh
ZGluZyBmcm9tIGl0IHdoZW4gdGhlIGRldmljZSBkZXRlY3RzIGZyZWUtZmFs
bCBpbnRlcnJ1cHQKMikgRnVuY3Rpb25zIGFzIGFuIGlucHV0IGNsYXNzIGRl
dmljZSB0byBwcm92aWRlIHNpbWlsYXIgZnVuY3Rpb25hbGl0eSB0bwpoZGFw
cywgaW4gb3JkZXIgdG8gYmUgYWJsZSB0byB1c2UgdGhlIGxhcHRvcCBhcyBh
IGpveXN0aWNrCjMpIFByb3ZpZGVzIGFuIGludGVyZmFjZSBzaW1pbGFyIHRv
IGhkYXBzLCBzbyB0aGF0IGhkYXBzZCBjb3VsZCB3b3JrIHdpdGggaXQKNCkg
TWFrZXMgaXQgcG9zc2libGUgdG8gcG93ZXIgdGhlIGRldmljZSBvZmYuCgpG
b3IgY29tbWVudHMgbWFpbCB0bzogeWFuXzk1MkBob3RtYWlsLmNvbQoKU2ln
bmVkLW9mZi1ieTogWWFuIEJ1cm1hbiA8eWFuXzk1MkBob3RtYWlsLmNvbT4K
CmRpZmYgLU5ydWJwIGxpbnV4LTIuNi4xOS1yYzVfb3JpZy9Eb2N1bWVudGF0
aW9uL2h3bW9uL21kcHMgbGludXgtMi42LjE5LXJjNV9tZHBzL0RvY3VtZW50
YXRpb24vaHdtb24vbWRwcwotLS0gbGludXgtMi42LjE5LXJjNV9vcmlnL0Rv
Y3VtZW50YXRpb24vaHdtb24vbWRwcwkxOTcwLTAxLTAxIDAyOjAwOjAwLjAw
MDAwMDAwMCArMDIwMAorKysgbGludXgtMi42LjE5LXJjNV9tZHBzL0RvY3Vt
ZW50YXRpb24vaHdtb24vbWRwcwkyMDA2LTExLTE0IDIwOjI2OjU1LjAwMDAw
MDAwMCArMDIwMApAQCAtMCwwICsxLDQ1IEBACitLZXJuZWwgZHJpdmVyIG1k
cHMKKz09PT09PT09PT09PT09PT09PQorCitTdXBwb3J0ZWQgY2hpcHM6CisK
KyAgKiBTVE1pY3JvZWxlY3Ryb25pY3MgTElTM0xWMDJETCBhbmQgTElTM0xW
MDJEUQorCitBdXRob3I6CisgICAgICAgIFlhbiBCdXJtYW4gPHlhbl85NTJA
aG90bWFpbC5jb20+CisKKworRGVzY3JpcHRpb24KKy0tLS0tLS0tLS0tCisK
K1RoaXMgZHJpdmVyIHByb3ZpZGVzIHN1cHBvcnQgZm9yIHRoZSBIUCBNb2Jp
bGUgRGF0YSBQcm90ZWN0aW9uCitTeXN0ZW0gM0QgKG1kcHMpLCB3aGljaCBp
cyBhbiBhY2NlbGVyb21ldGVyLiBPbmx5IEhQIG5jNjQwMCBhbmQgbmM2NDIw
CithcmUgc3VwcG9ydGVkIHJpZ2h0IG5vdywgYnV0IGl0IG1heSB3b3JrIG9u
IG90aGVyIG1vZGVscyBhcyB3ZWxsLiBUaGUKK2FjY2VsZXJvbWV0ZXIgZGF0
YSBpcyByZWFkYWJsZSB2aWEgL3N5cy9kZXZpY2VzL3BsYXRmb3JtL21kcHMu
CisKK1N5c2ZzIGF0dHJpYnV0ZXMgdW5kZXIgL3N5cy9kZXZpY2VzL3BsYXRm
b3JtL21kcHMvOgorcG9zaXRpb24gLSAyRCBwb3NpdGlvbiB0aGF0IHRoZSBh
Y2NlbGVyb21ldGVyIHJlcG9ydHMuIEZvcm1hdDogIih4LHkpIgorcG9zaXRp
b24zZCAtIDNEIHBvc2l0aW9uIHRoYXQgdGhlIGFjY2VsZXJvbWV0ZXIgcmVw
b3J0cy4gRm9ybWF0OiAiKHgseSx6KSIKK2NhbGlicmF0ZSAtIHJlYWQ6IHZh
bHVlcyAoeCwgeSkgdGhhdCBhcmUgdXNlZCBhcyB0aGUgYmFzZSBmb3IgaW5w
dXQgY2xhc3MgZGV2aWNlIG9wZXJhdGlvbi4KKyAgICAgICAgICAgIHdyaXRl
OiBmb3JjZXMgdGhlIGJhc2UgdG8gYmUgcmVjYWxpYnJhdGVkLgorcmF0ZSAt
IHJlcG9ydHMgdGhlIHNhbXBsaW5nIHJhdGUgb2YgdGhlIGFjY2VsZXJvbWV0
ZXIgZGV2aWNlIGluIEhaCitzdGF0ZSAtIHJlYWQ6IHRoZSBjdXJyZW50IHBv
d2VyIHN0YXRlIG9mIHRoZSBhY2NlbGVyb21ldGVyIGRldmljZQorICAgICAg
ICB3cml0ZTogIjAiIG9yICIxIiB0byBwb3dlciBvbi9vZmYgdGhlIGRldmlj
ZQoram95c3RpY2sgLSB3aGV0aGVyIHRoZSBpbnB1dCBjbGFzcyBkZXZpY2Ug
aXMgYWN0aXZlIG9yIG5vdAorCitMb2FkIHRpbWUgcGFyYW1ldGVyczoKK2Jv
b2wgam95c3RpY2sgLSB3aGV0aGVyIHRvIGVuYWJsZSB0aGUgaW5wdXQgY2xh
c3MgZGV2aWNlIG9yIG5vdCAoZGVmYXVsdCAxKQorYm9vbCBwb3dlcl9vZmYg
LSB3aGV0aGVyIHRvIHBvd2VyIG9mZiB0aGUgZGV2aWNlIG9uIG1vZHVsZSBs
b2FkIChkZWZhdWx0IDApCisKK1RoaXMgZHJpdmVyIGFsc28gcHJvdmlkZXMg
YW4gYWJzb2x1dGUgaW5wdXQgY2xhc3MgZGV2aWNlLCBhbGxvd2luZwordGhl
IGxhcHRvcCB0byBhY3QgYXMgYSBwaW5iYWxsIG1hY2hpbmUtZXNxdWUgam95
c3RpY2suCisKK0Fub3RoZXIgZmVhdHVyZSBvZiB0aGUgZHJpdmVyIGlzIG1p
c2MgZGV2aWNlIGNhbGxlZCBtZHBzIHRoYXQgYWN0cworc2ltaWxhciB0byAv
ZGV2L3J0YyBhbmQgcmVhY3RzIG9uIGZyZWUtZmFsbCBpbnRlcnJ1cHRzIHJl
Y2VpdmVkIGZyb20KK3RoZSBkZXZpY2UuCisKK1RoZSBkZXZpY2UgaXMgYSBt
aXNjIGNoYXJhY3RlciBkZXZpY2UgbmFtZWQgYWNjZWwuIEl0IHN1cHBvcnRz
IGJsb2NraW5nIG9wZXJhdGlvbnMsCitwb2xsL3NlbGVjdCBhbmQgZmFzeW5j
IG9wZXJhdGlvbiBtb2Rlcy4KK1lvdSBtdXN0IHJlYWQgNCBieXRlcyBmcm9t
IHRoZSBkZXZpY2UuIFRoZSByZXN1bHQgaXMgbnVtYmVyIG9mIGZyZWUtZmFs
bCBpbnRlcnJ1cHRzIHNpbmNlCit0aGUgbGFzdCBzdWNjZXNzZnVsIHJlYWQu
CisKZGlmZiAtTnJ1YnAgbGludXgtMi42LjE5LXJjNV9vcmlnL2RyaXZlcnMv
aHdtb24vS2NvbmZpZyBsaW51eC0yLjYuMTktcmM1X21kcHMvZHJpdmVycy9o
d21vbi9LY29uZmlnCi0tLSBsaW51eC0yLjYuMTktcmM1X29yaWcvZHJpdmVy
cy9od21vbi9LY29uZmlnCTIwMDYtMTEtMDkgMTI6MTY6MjEuMDAwMDAwMDAw
ICswMjAwCisrKyBsaW51eC0yLjYuMTktcmM1X21kcHMvZHJpdmVycy9od21v
bi9LY29uZmlnCTIwMDYtMTEtMTQgMjA6MzE6NTYuMDAwMDAwMDAwICswMjAw
CkBAIC01MzAsNiArNTMwLDI2IEBAIGNvbmZpZyBTRU5TT1JTX0hEQVBTCiAJ
ICBTYXkgWSBoZXJlIGlmIHlvdSBoYXZlIGFuIGFwcGxpY2FibGUgbGFwdG9w
IGFuZCB3YW50IHRvIGV4cGVyaWVuY2UKIAkgIHRoZSBhd2Vzb21lIHBvd2Vy
IG9mIGhkYXBzLgogCitjb25maWcgU0VOU09SU19NRFBTCisgICAgICAgIHRy
aXN0YXRlICJIUCBNb2JpbGUgRGF0YSBQcm90ZWN0aW9uIFN5c3RlbSAzRCAo
bWRwcykiCisgICAgICAgIGRlcGVuZHMgb24gQUNQSSAmJiBIV01PTiAmJiBJ
TlBVVCAmJiBYODYKKyAgICAgICAgZGVmYXVsdCBuCisgICAgICAgIGhlbHAK
KyAgICAgICAgICBUaGlzIGRyaXZlciBwcm92aWRlcyBzdXBwb3J0IGZvciB0
aGUgSFAgTW9iaWxlIERhdGEgUHJvdGVjdGlvbgorICAgICAgICAgIFN5c3Rl
bSAzRCAobWRwcyksIHdoaWNoIGlzIGFuIGFjY2VsZXJvbWV0ZXIuIE9ubHkg
SFAgbmM2NDAwIGFuZCBuYzY0MjAKKyAgICAgICAgICBhcmUgc3VwcG9ydGVk
IHJpZ2h0IG5vdywgYnV0IGl0IG1heSB3b3JrIG9uIG90aGVyIG1vZGVscyBh
cyB3ZWxsLiBUaGUKKyAgICAgICAgICBhY2NlbGVyb21ldGVyIGRhdGEgaXMg
cmVhZGFibGUgdmlhIC9zeXMvZGV2aWNlcy9wbGF0Zm9ybS9tZHBzLgorCisg
ICAgICAgICAgVGhpcyBkcml2ZXIgYWxzbyBwcm92aWRlcyBhbiBhYnNvbHV0
ZSBpbnB1dCBjbGFzcyBkZXZpY2UsIGFsbG93aW5nCisgICAgICAgICAgdGhl
IGxhcHRvcCB0byBhY3QgYXMgYSBwaW5iYWxsIG1hY2hpbmUtZXNxdWUgam95
c3RpY2suCisKKyAgICAgICAgICBBbm90aGVyIGZlYXR1cmUgb2YgdGhlIGRy
aXZlciBpcyBtaXNjIGRldmljZSBjYWxsZWQgbWRwcyB0aGF0IGFjdHMKKyAg
ICAgICAgICBzaW1pbGFyIHRvIC9kZXYvcnRjIGFuZCByZWFjdHMgb24gZnJl
ZS1mYWxsIGludGVycnVwdHMgcmVjZWl2ZWQgZnJvbQorICAgICAgICAgIHRo
ZSBkZXZpY2UuCisKKyAgICAgICAgICBUaGlzIGRyaXZlciBjYW4gYWxzbyBi
ZSBidWlsdCBhcyBhIG1vZHVsZS4gIElmIHNvLCB0aGUgbW9kdWxlCisgICAg
ICAgICAgd2lsbCBiZSBjYWxsZWQgbWRwcy4KKwogY29uZmlnIEhXTU9OX0RF
QlVHX0NISVAKIAlib29sICJIYXJkd2FyZSBNb25pdG9yaW5nIENoaXAgZGVi
dWdnaW5nIG1lc3NhZ2VzIgogCWRlcGVuZHMgb24gSFdNT04KZGlmZiAtTnJ1
YnAgbGludXgtMi42LjE5LXJjNV9vcmlnL2RyaXZlcnMvaHdtb24vTWFrZWZp
bGUgbGludXgtMi42LjE5LXJjNV9tZHBzL2RyaXZlcnMvaHdtb24vTWFrZWZp
bGUKLS0tIGxpbnV4LTIuNi4xOS1yYzVfb3JpZy9kcml2ZXJzL2h3bW9uL01h
a2VmaWxlCTIwMDYtMTEtMDkgMTI6MTY6MjEuMDAwMDAwMDAwICswMjAwCisr
KyBsaW51eC0yLjYuMTktcmM1X21kcHMvZHJpdmVycy9od21vbi9NYWtlZmls
ZQkyMDA2LTExLTE1IDIzOjQxOjI3LjAwMDAwMDAwMCArMDIwMApAQCAtMjYs
NiArMjYsNyBAQCBvYmotJChDT05GSUdfU0VOU09SU19GU0NQT1MpCSs9IGZz
Y3Bvcy5vCiBvYmotJChDT05GSUdfU0VOU09SU19HTDUxOFNNKQkrPSBnbDUx
OHNtLm8KIG9iai0kKENPTkZJR19TRU5TT1JTX0dMNTIwU00pCSs9IGdsNTIw
c20ubwogb2JqLSQoQ09ORklHX1NFTlNPUlNfSERBUFMpCSs9IGhkYXBzLm8K
K29iai0kKENPTkZJR19TRU5TT1JTX01EUFMpCSs9IG1kcHMubwogb2JqLSQo
Q09ORklHX1NFTlNPUlNfSVQ4NykJKz0gaXQ4Ny5vCiBvYmotJChDT05GSUdf
U0VOU09SU19LOFRFTVApCSs9IGs4dGVtcC5vCiBvYmotJChDT05GSUdfU0VO
U09SU19MTTYzKQkrPSBsbTYzLm8KZGlmZiAtTnJ1YnAgbGludXgtMi42LjE5
LXJjNV9vcmlnL2RyaXZlcnMvaHdtb24vbWRwcy5jIGxpbnV4LTIuNi4xOS1y
YzVfbWRwcy9kcml2ZXJzL2h3bW9uL21kcHMuYwotLS0gbGludXgtMi42LjE5
LXJjNV9vcmlnL2RyaXZlcnMvaHdtb24vbWRwcy5jCTE5NzAtMDEtMDEgMDI6
MDA6MDAuMDAwMDAwMDAwICswMjAwCisrKyBsaW51eC0yLjYuMTktcmM1X21k
cHMvZHJpdmVycy9od21vbi9tZHBzLmMJMjAwNi0xMS0xOSAyMDozNzowMi4w
MDAwMDAwMDAgKzAyMDAKQEAgLTAsMCArMSw3MTUgQEAKKy8qCisgKiAgbWRw
cy5jIC0gSFAgTW9iaWxlIERhdGEgUHJvdGVjdGlvbiBTeXN0ZW0gM0QgQUNQ
SSBkcml2ZXIKKyAqCisgKiAgQ29weXJpZ2h0IChDKSAyMDA2IFlhbiBCdXJt
YW4KKyAqCisgKiAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlv
dSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyAqICBpdCB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGFzIHB1Ymxpc2hlZCBieQorICogIHRoZSBGcmVlIFNvZnR3YXJlIEZv
dW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9y
CisgKiAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKyAq
CisgKiAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3Bl
IHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgKiAgYnV0IFdJVEhPVVQgQU5Z
IFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkg
b2YKKyAqICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJU
SUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCisgKiAgR05VIEdlbmVyYWwgUHVi
bGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyAqCisgKiAgWW91IHNo
b3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwg
UHVibGljIExpY2Vuc2UKKyAqICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsg
aWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZQorICogIEZvdW5k
YXRpb24sIEluYy4sIDU5IFRlbXBsZSBQbGFjZSwgU3VpdGUgMzMwLCBCb3N0
b24sIE1BICAwMjExMS0xMzA3ICBVU0EKKyAqLworCisjaW5jbHVkZSA8bGlu
dXgva2VybmVsLmg+CisjaW5jbHVkZSA8bGludXgvaW5pdC5oPgorI2luY2x1
ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+
CisjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2aWNlLmg+CisjaW5jbHVk
ZSA8bGludXgvaW50ZXJydXB0Lmg+CisjaW5jbHVkZSA8bGludXgvaW5wdXQu
aD4KKyNpbmNsdWRlIDxsaW51eC9rdGhyZWFkLmg+CisjaW5jbHVkZSA8bGlu
dXgvZGVsYXkuaD4KKyNpbmNsdWRlIDxsaW51eC9taXNjZGV2aWNlLmg+Cisj
aW5jbHVkZSA8bGludXgvd2FpdC5oPgorI2luY2x1ZGUgPGxpbnV4L3BvbGwu
aD4KKyNpbmNsdWRlIDxsaW51eC9mcmVlemVyLmg+CisKKyNpbmNsdWRlIDxh
Y3BpL2FjcGlfZHJpdmVycy5oPgorI2luY2x1ZGUgPGFjcGkvYWNuYW1lc3Au
aD4KKworI2luY2x1ZGUgPGFzbS91YWNjZXNzLmg+CisjaW5jbHVkZSA8YXNt
L2F0b21pYy5oPgorCisjZGVmaW5lIFZFUlNJT04gIjAuNiIKKworI2RlZmlu
ZSBEUklWRVJfTkFNRSAgICAgIm1kcHMiCisjZGVmaW5lIEFDUElfTURQU19D
TEFTUyAiYWNjZWxlcm9tZXRlciIKKyNkZWZpbmUgQUNQSV9NRFBTX0lEICAg
ICJIUFEwMDA0IgorCisvKiBUaGUgYWN0dWFsIGNoaXAgaXMgU1RNaWNyb2Vs
ZWN0cm9uaWNzIExJUzNMVjAyREwgb3IgTElTM0xWMDJEUSAqLworCisjZGVm
aW5lIE1EUFNfV0hPX0FNX0kgICAgICAgIDB4MEYgLypyICAgICAgMDAxMTEw
MTAgKi8KKyNkZWZpbmUgTURQU19PRkZTRVRfWCAgICAgICAgMHgxNiAvKnJ3
ICAgICAgICAgICAgICAqLworI2RlZmluZSBNRFBTX09GRlNFVF9ZICAgICAg
ICAweDE3IC8qcncgICAgICAgICAgICAgICovCisjZGVmaW5lIE1EUFNfT0ZG
U0VUX1ogICAgICAgIDB4MTggLypydyAgICAgICAgICAgICAgKi8KKyNkZWZp
bmUgTURQU19HQUlOX1ggICAgICAgICAgMHgxOSAvKnJ3ICAgICAgICAgICAg
ICAqLworI2RlZmluZSBNRFBTX0dBSU5fWSAgICAgICAgICAweDFBIC8qcncg
ICAgICAgICAgICAgICovCisjZGVmaW5lIE1EUFNfR0FJTl9aICAgICAgICAg
IDB4MUIgLypydyAgICAgICAgICAgICAgKi8KKyNkZWZpbmUgTURQU19DVFJM
X1JFRzEgICAgICAgMHgyMCAvKnJ3ICAgICAwMDAwMDExMSAqLworI2RlZmlu
ZSBNRFBTX0NUUkxfUkVHMiAgICAgICAweDIxIC8qcncgICAgIDAwMDAwMDAw
ICovCisjZGVmaW5lIE1EUFNfQ1RSTF9SRUczICAgICAgIDB4MjIgLypydyAg
ICAgMDAwMDEwMDAgKi8KKyNkZWZpbmUgTURQU19IUF9GSUxURVIgUkVTRVQg
MHgyMyAvKnIgICAgICAgICAgICAgICAqLworI2RlZmluZSBNRFBTX1NUQVRV
U19SRUcgICAgICAweDI3IC8qcncgICAgIDAwMDAwMDAwICovCisjZGVmaW5l
IE1EUFNfT1VUWF9MICAgICAgICAgIDB4MjggLypyICAgICAgICAgICAgICAg
Ki8KKyNkZWZpbmUgTURQU19PVVRYX0ggICAgICAgICAgMHgyOSAvKnIgICAg
ICAgICAgICAgICAqLworI2RlZmluZSBNRFBTX09VVFlfTCAgICAgICAgICAw
eDJBIC8qciAgICAgICAgICAgICAgICovCisjZGVmaW5lIE1EUFNfT1VUWV9I
ICAgICAgICAgIDB4MkIgLypyICAgICAgICAgICAgICAgKi8KKyNkZWZpbmUg
TURQU19PVVRaX0wgICAgICAgICAgMHgyQyAvKnIgICAgICAgICAgICAgICAq
LworI2RlZmluZSBNRFBTX09VVFpfSCAgICAgICAgICAweDJEIC8qciAgICAg
ICAgICAgICAgICovCisjZGVmaW5lIE1EUFNfRkZfV1VfQ0ZHICAgICAgIDB4
MzAgLypydyAgICAgMDAwMDAwMDAgKi8KKyNkZWZpbmUgTURQU19GRl9XVV9T
UkMgICAgICAgMHgzMSAvKnJ3ICAgICAwMDAwMDAwMCAqLworI2RlZmluZSBN
RFBTX0ZGX1dVX0FDSyAgICAgICAweDMyIC8qciAgICAgICAgICAgICAgICov
CisjZGVmaW5lIE1EUFNfRkZfV1VfVEhTX0wgICAgIDB4MzQgLypydyAgICAg
MDAwMDAwMDAgKi8KKyNkZWZpbmUgTURQU19GRl9XVV9USFNfSCAgICAgMHgz
NSAvKnJ3ICAgICAwMDAwMDAwMCAqLworI2RlZmluZSBNRFBTX0ZGX1dVX0RV
UkFUSU9OICAweDM2IC8qcncgICAgIDAwMDAwMDAwICovCisjZGVmaW5lIE1E
UFNfRERfQ0ZHICAgICAgICAgIDB4MzggLypydyAgICAgMDAwMDAwMDAgKi8K
KyNkZWZpbmUgTURQU19ERF9TUkMgICAgICAgICAgMHgzOSAvKnJ3ICAgICAw
MDAwMDAwMCAqLworI2RlZmluZSBNRFBTX0REX0FDSyAgICAgICAgICAweDNB
IC8qciAgICAgICAgICAgICAgICovCisjZGVmaW5lIE1EUFNfRERfVEhTSV9M
ICAgICAgIDB4M0MgLypydyAgICAgMDAwMDAwMDAgKi8KKyNkZWZpbmUgTURQ
U19ERF9USFNJX0ggICAgICAgMHgzRCAvKnJ3ICAgICAwMDAwMDAwMCAqLwor
I2RlZmluZSBNRFBTX0REX1RIU0VfTCAgICAgICAweDNFIC8qcncgICAgIDAw
MDAwMDAwICovCisjZGVmaW5lIE1EUFNfRERfVEhTRV9IICAgICAgIDB4M0Yg
LypydyAgICAgMDAwMDAwMDAgKi8KKworI2RlZmluZSBNRFBTX0lEIDB4M0EK
KworLyogam95c3RpY2sgZGV2aWNlIHBvbGwgaW50ZXJ2YWwgaW4gbWlsbGlz
ZWNvbmRzICovCisjZGVmaW5lIE1EUFNfUE9MTF9JTlRFUlZBTCAzMAorCitz
dGF0aWMgdW5zaWduZWQgaW50IGpveXN0aWNrID0gMTsKK21vZHVsZV9wYXJh
bShqb3lzdGljaywgYm9vbCwgU19JUlVHTyk7CitNT0RVTEVfUEFSTV9ERVND
KGpveXN0aWNrLCAiRW5hYmxlIHRoZSBpbnB1dCBkZXZpY2Ugb24gbW9kdWxl
IGxvYWQiKTsKKworc3RhdGljIHVuc2lnbmVkIGludCBwb3dlcl9vZmY7Citt
b2R1bGVfcGFyYW0ocG93ZXJfb2ZmLCBib29sLCBTX0lSVUdPKTsKK01PRFVM
RV9QQVJNX0RFU0MocG93ZXJfb2ZmLCAiVHVybiBvZmYgZGV2aWNlIG9uIG1v
ZHVsZSBsb2FkIik7CisKK3N0cnVjdCBhY3BpX21kcHMKK3sKKwlzdHJ1Y3Qg
YWNwaV9kZXZpY2UgICAgICpkZXZpY2U7ICAgIC8qIFRoZSBBQ1BJIGRldmlj
ZSAqLworCXUzMiAgICAgICAgICAgICAgICAgICAgIGlycTsgICAgICAgLyog
SVJRIG51bWJlciAqLworCXN0cnVjdCBpbnB1dF9kZXYgICAgICAgKmlkZXY7
ICAgICAgLyogaW5wdXQgZGV2aWNlICovCisJc3RydWN0IHRhc2tfc3RydWN0
ICAgICAqa3RocmVhZDsgICAvKiBrdGhyZWFkIGZvciBpbnB1dCAqLworCWlu
dCAgICAgICAgICAgICAgICAgICAgIHhjYWxpYjsgICAgLyogY2FsaWJyYXRl
ZCBudWxsIHZhbHVlIGZvciB4ICovCisJaW50ICAgICAgICAgICAgICAgICAg
ICAgeWNhbGliOyAgICAvKiBjYWxpYnJhdGVkIG51bGwgdmFsdWUgZm9yIHkg
Ki8KKwlpbnQgICAgICAgICAgICAgICAgICAgICBpc19vbjsgICAgIC8qIHdo
ZXRoZXIgdGhlIGRldmljZSBpcyBvbiBvciBvZmYgKi8KKwlzdHJ1Y3QgcGxh
dGZvcm1fZGV2aWNlICpwZGV2OyAgICAgIC8qIHBsYXRmb3JtIGRldmljZSAq
LworCWF0b21pY190ICAgICAgICAgICAgICAgIGNvdW50OyAgICAgLyogaG93
IG1hbnkgdGltZXMgd2UgZ290IGludGVycnVwdHMgYWZ0ZXIgdGhlIGxhc3Qg
cmVhZCAqLworCXN0cnVjdCBmYXN5bmNfc3RydWN0ICAgKmFzeW5jX3F1ZXVl
OworCWF0b21pY190ICAgICAgICAgICAgICAgIGF2YWlsYWJsZTsgLyogS2Vl
cCB0cmFjayBvZiB3aGV0aGVyIHRoZSBkZXZpY2UgaXMgb3BlbiAqLworCXdh
aXRfcXVldWVfaGVhZF90ICAgICAgIG1pc2Nfd2FpdDsgLyogV2FpdCBxdWV1
ZSBmb3IgdGhlIG1pc2MgZGV2aWNlICovCit9OworCitzdGF0aWMgc3RydWN0
IGFjcGlfbWRwcyBtZHBzOworCitzdGF0aWMgaW50IG1kcHNfYWRkKHN0cnVj
dCBhY3BpX2RldmljZSAqZGV2aWNlKTsKK3N0YXRpYyBpbnQgbWRwc19yZW1v
dmUoc3RydWN0IGFjcGlfZGV2aWNlICpkZXZpY2UsIGludCB0eXBlKTsKK3N0
YXRpYyBpbnQgbWRwc19zdXNwZW5kKHN0cnVjdCBhY3BpX2RldmljZSAqZGV2
aWNlLCBpbnQgc3RhdGUpOworc3RhdGljIGludCBtZHBzX3Jlc3VtZShzdHJ1
Y3QgYWNwaV9kZXZpY2UgKmRldmljZSwgaW50IHN0YXRlKTsKK3N0YXRpYyBp
bnQgbWRwc19yZW1vdmVfZnModm9pZCk7CitzdGF0aWMgaW50IG1kcHNfYWRk
X2ZzKHN0cnVjdCBhY3BpX2RldmljZSAqZGV2aWNlKTsKK3N0YXRpYyB2b2lk
IG1kcHNfam95c3RpY2tfZW5hYmxlKHZvaWQpOworc3RhdGljIHZvaWQgbWRw
c19qb3lzdGlja19kaXNhYmxlKHZvaWQpOworCitzdGF0aWMgc3RydWN0IGFj
cGlfZHJpdmVyIG1kcHNfZHJpdmVyID0KK3sKKwkubmFtZSAgPSBEUklWRVJf
TkFNRSwKKwkuY2xhc3MgPSBBQ1BJX01EUFNfQ0xBU1MsCisJLmlkcyAgID0g
QUNQSV9NRFBTX0lELAorCS5vcHMgPSB7CisJCS5hZGQgICAgID0gbWRwc19h
ZGQsCisJCS5yZW1vdmUgID0gbWRwc19yZW1vdmUsCisjaWZkZWYgQ09ORklH
X1BNCisJCS5zdXNwZW5kID0gbWRwc19zdXNwZW5kLAorCQkucmVzdW1lICA9
IG1kcHNfcmVzdW1lCisjZW5kaWYKKwl9Cit9OworCisvKiogQ3JlYXRlIGEg
c2luZ2xlIHZhbHVlIGZyb20gMiBieXRlcyByZWNlaXZlZCBmcm9tIHRoZSBh
Y2NlbGVyb21ldGVyCisgKiBAcGFyYW0gaGkgdGhlIGhpZ2ggYnl0ZQorICog
QHBhcmFtIGxvIHRoZSBsb3cgYnl0ZQorICogQHJldHVybiB0aGUgcmVzdWx0
aW5nIHZhbHVlCisgKi8KK3N0YXRpYyBpbmxpbmUgczE2IG1kcHNfZ2x1ZV9i
eXRlcyh1bnNpZ25lZCBsb25nIGhpLCB1bnNpZ25lZCBsb25nIGxvKQorewor
CS8qIEluICIxMiBiaXQgcmlnaHQganVzdGlmaWVkIiBtb2RlLCBiaXQgNiwg
Yml0IDcsIGJpdCA4ID0gYml0IDUgKi8KKwlpZiAoaGkgJiAweDEwKQorCQlo
aSB8PSAweEUwOworCXJldHVybiAoczE2KSgoaGkgPDwgOCkgfCBsbyk7Cit9
CisKK3N0YXRpYyBhY3BpX3N0YXR1cyByZWFkX2FjcGlfaW50X3BhcmFtKGFj
cGlfaGFuZGxlIGhhbmRsZSwgYWNwaV9zdHJpbmcgbWV0aG9kLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IHZhbCwgdW5z
aWduZWQgbG9uZyAqcmV0KQoreworCXVuaW9uIGFjcGlfb2JqZWN0IGFyZzAg
PSB7IEFDUElfVFlQRV9JTlRFR0VSIH07CisJc3RydWN0IGFjcGlfb2JqZWN0
X2xpc3QgYXJncyA9IHsgMSwgJmFyZzAgfTsKKworCWFyZzAuaW50ZWdlci52
YWx1ZSA9IHZhbDsKKworCXJldHVybiBhY3BpX2V2YWx1YXRlX2ludGVnZXIo
aGFuZGxlLCBtZXRob2QsICZhcmdzLCByZXQpOworfQorCisvKiogQUNQSSBf
U1RBIG1ldGhvZDogZ2V0IGRldmljZSBzdGF0dXMKKyAqIEBwYXJhbSBoYW5k
bGUgdGhlIGhhbmRsZSBvZiB0aGUgZGV2aWNlCisgKiBAcGFyYW1bb3V0XSBy
ZXQgcmVzdWx0IG9mIHRoZSBvcGVyYXRpb24KKyAqIEByZXR1cm4gQUVfT0sg
b24gc3VjY2VzcworICovCitzdGF0aWMgaW5saW5lIGFjcGlfc3RhdHVzIG1k
cHNfX1NUQShhY3BpX2hhbmRsZSBoYW5kbGUsIHVuc2lnbmVkIGxvbmcgKnJl
dCkKK3sKKwlyZXR1cm4gYWNwaV9ldmFsdWF0ZV9pbnRlZ2VyKGhhbmRsZSwg
TUVUSE9EX05BTUVfX1NUQSwgTlVMTCwgcmV0KTsKK30KKworLyoqIEFDUEkg
QUxSRCBtZXRob2Q6IHJlYWQgYSByZWdpc3RlcgorICogQHBhcmFtIGhhbmRs
ZSB0aGUgaGFuZGxlIG9mIHRoZSBkZXZpY2UKKyAqIEBwYXJhbSByZWcgdGhl
IHJlZ2lzdGVyIHRvIHJlYWQKKyAqIEBwYXJhbVtvdXRdIHJldCByZXN1bHQg
b2YgdGhlIG9wZXJhdGlvbgorICogQHJldHVybiBBRV9PSyBvbiBzdWNjZXNz
CisgKi8KK3N0YXRpYyBpbmxpbmUgYWNwaV9zdGF0dXMgbWRwc19BTFJEKGFj
cGlfaGFuZGxlIGhhbmRsZSwgaW50IHJlZywKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGxvbmcgKnJldCkKK3sKKwly
ZXR1cm4gcmVhZF9hY3BpX2ludF9wYXJhbShoYW5kbGUsICJBTFJEIiwgcmVn
LCByZXQpOworfQorCisvKiogQUNQSSBfSU5JIG1ldGhvZDogaW5pdGlhbGl6
ZSB0aGUgZGV2aWNlLgorICogQHBhcmFtIGhhbmRsZSB0aGUgaGFuZGxlIG9m
IHRoZSBkZXZpY2UKKyAqIEByZXR1cm4gMCBvbiBzdWNjZXNzCisgKi8KK3N0
YXRpYyBpbmxpbmUgYWNwaV9zdGF0dXMgbWRwc19fSU5JKGFjcGlfaGFuZGxl
IGhhbmRsZSkKK3sKKwlyZXR1cm4gYWNwaV9ldmFsdWF0ZV9vYmplY3QoaGFu
ZGxlLCBNRVRIT0RfTkFNRV9fSU5JLCBOVUxMLCBOVUxMKTsKK30KKworLyoq
IEFDUEkgQUxXUiBtZXRob2Q6IHdyaXRlIHRvIGEgcmVnaXN0ZXIKKyAqIEBw
YXJhbSBoYW5kbGUgdGhlIGhhbmRsZSBvZiB0aGUgZGV2aWNlCisgKiBAcGFy
YW0gcmVnIHRoZSByZWdpc3RlciB0byB3cml0ZSB0bworICogQHBhcmFtIHZh
bCB0aGUgdmFsdWUgdG8gd3JpdGUKKyAqIEBwYXJhbVtvdXRdIHJldCByZXN1
bHQgb2YgdGhlIG9wZXJhdGlvbgorICogQHJldHVybiBBRV9PSyBvbiBzdWNj
ZXNzCisgKi8KK3N0YXRpYyBhY3BpX3N0YXR1cyBtZHBzX0FMV1IoYWNwaV9o
YW5kbGUgaGFuZGxlLCBpbnQgcmVnLCBpbnQgdmFsLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nICpyZXQpCit7CisJdW5p
b24gYWNwaV9vYmplY3QgaW5fb2JqWzJdOworCXN0cnVjdCBhY3BpX29iamVj
dF9saXN0IGFyZ3M7CisKKwlhcmdzLmNvdW50ICAgICAgICAgICAgICA9IDI7
CisJYXJncy5wb2ludGVyICAgICAgICAgICAgPSBpbl9vYmo7CisJaW5fb2Jq
WzBdLnR5cGUgICAgICAgICAgPSBBQ1BJX1RZUEVfSU5URUdFUjsKKwlpbl9v
YmpbMF0uaW50ZWdlci52YWx1ZSA9IHJlZzsKKwlpbl9vYmpbMV0udHlwZSAg
ICAgICAgICA9IEFDUElfVFlQRV9JTlRFR0VSOworCWluX29ialsxXS5pbnRl
Z2VyLnZhbHVlID0gdmFsOworCisJcmV0dXJuIGFjcGlfZXZhbHVhdGVfaW50
ZWdlcihoYW5kbGUsICJBTFdSIiwgJmFyZ3MsIHJldCk7Cit9CisKKy8qKiBH
ZXQgWCBhbmQgWSBheGlzIHZhbHVlcyBmcm9tIHRoZSBhY2NlbGVvbXRlcgor
ICogQHBhcmFtIGhhbmRsZSB0aGUgaGFuZGxlIHRvIHRoZSBkZXZpY2UKKyAq
IEBwYXJhbVtvdXRdIHggd2hlcmUgdG8gc3RvcmUgdGhlIFggYXhpcyB2YWx1
ZQorICogQHBhcmFtW291dF0geSB3aGVyZSB0byBzdG9yZSB0aGUgWSBheGlz
IHZhbHVlCisgKi8KK3N0YXRpYyB2b2lkIG1kcHNfZ2V0X3h5KGFjcGlfaGFu
ZGxlIGhhbmRsZSwgaW50ICp4LCBpbnQgKnkpCit7CisJdW5zaWduZWQgbG9u
ZyB4X2xvLCB4X2hpLCB5X2xvLCB5X2hpOworCisJbWRwc19BTFJEKG1kcHMu
ZGV2aWNlLT5oYW5kbGUsIE1EUFNfT1VUWF9MLCAmeF9sbyk7CisJbWRwc19B
TFJEKG1kcHMuZGV2aWNlLT5oYW5kbGUsIE1EUFNfT1VUWF9ILCAmeF9oaSk7
CisJbWRwc19BTFJEKG1kcHMuZGV2aWNlLT5oYW5kbGUsIE1EUFNfT1VUWV9M
LCAmeV9sbyk7CisJbWRwc19BTFJEKG1kcHMuZGV2aWNlLT5oYW5kbGUsIE1E
UFNfT1VUWV9ILCAmeV9oaSk7CisKKwkqeCA9IG1kcHNfZ2x1ZV9ieXRlcyh4
X2hpLCB4X2xvKTsKKwkqeSA9IG1kcHNfZ2x1ZV9ieXRlcyh5X2hpLCB5X2xv
KTsKK30KKworLyoqIEt0aHJlYWQgcG9sbGluZyBmdW5jdGlvbgorICogQHBh
cmFtIGRhdGEgdW51c2VkIC0gaGVyZSB0byBjb25mb3JtIHRvIHRocmVhZGZu
IHByb3RvdHlwZQorICogQHJldHVybiAwIHVudXNlZCAtIGhlcmUgdG8gY29u
Zm9ybSB0byB0aHJlYWRmbiBwcm90b3R5cGUKKyAqLworc3RhdGljIGludCBt
ZHBzX2pveXN0aWNrX2t0aHJlYWQodm9pZCAqZGF0YSkKK3sKKwlpbnQgeCwg
eTsKKworCXdoaWxlICgha3RocmVhZF9zaG91bGRfc3RvcCgpKSB7CisJCW1k
cHNfZ2V0X3h5KG1kcHMuZGV2aWNlLT5oYW5kbGUsICZ4LCAmeSk7CisKKwkJ
LyogbmVlZCB0byBpbnZlcnQgdGhlIFggYXhpcyBmb3IgdGhpcyB0byBsb29r
IG5hdHVyYWwgKi8KKwkJaW5wdXRfcmVwb3J0X2FicyhtZHBzLmlkZXYsIEFC
U19YLCAtKHggLSBtZHBzLnhjYWxpYikpOworCQlpbnB1dF9yZXBvcnRfYWJz
KG1kcHMuaWRldiwgQUJTX1ksIHkgLSBtZHBzLnljYWxpYik7CisKKwkJaW5w
dXRfc3luYyhtZHBzLmlkZXYpOworCisJCXRyeV90b19mcmVlemUoKTsKKwkJ
bXNsZWVwX2ludGVycnVwdGlibGUoTURQU19QT0xMX0lOVEVSVkFMKTsKKwl9
CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGlubGluZSB2b2lkIG1kcHNf
cG93ZXJvZmYoYWNwaV9oYW5kbGUgaGFuZGxlKQoreworCXVuc2lnbmVkIGxv
bmcgcmV0OworCW1kcHMuaXNfb24gPSAwOworCS8qIGRpc2FibGUgWCxZLFog
YXhpcyBhbmQgcG93ZXIgZG93biAqLworCW1kcHNfQUxXUihoYW5kbGUsIE1E
UFNfQ1RSTF9SRUcxLCAweDAwLCAmcmV0KTsKK30KKworc3RhdGljIGlubGlu
ZSB2b2lkIG1kcHNfcG93ZXJvbihhY3BpX2hhbmRsZSBoYW5kbGUpCit7CisJ
bWRwcy5pc19vbiA9IDE7CisJbWRwc19fSU5JKGhhbmRsZSk7Cit9CisKKyNp
ZmRlZiBDT05GSUdfUE0KK3N0YXRpYyBpbnQgbWRwc19zdXNwZW5kKHN0cnVj
dCBhY3BpX2RldmljZSAqZGV2aWNlLCBpbnQgc3RhdGUpCit7CisJLyogbWFr
ZSBzdXJlIHRoZSBkZXZpY2UgaXMgb2ZmIHdoZW4gd2Ugc3VzcGVuZCAqLwor
CW1kcHNfcG93ZXJvZmYobWRwcy5kZXZpY2UtPmhhbmRsZSk7CisKKwlyZXR1
cm4gMDsKK30KKyNlbmRpZgorCitzdGF0aWMgaW50IG1kcHNfcmVzdW1lKHN0
cnVjdCBhY3BpX2RldmljZSAqZGV2aWNlLCBpbnQgc3RhdGUpCit7CisJLyog
bWFrZSBzdXJlIHRoZSBkZXZpY2Ugd2VudCBvbmxpbmUgKi8KKwltZHBzX3Bv
d2Vyb24obWRwcy5kZXZpY2UtPmhhbmRsZSk7CisKKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIGlycXJldHVybl90IG1kcHNfaXJxKGludCBpcnEsIHZvaWQg
KmRldl9pZCkKK3sKKwlhdG9taWNfaW5jKCZtZHBzLmNvdW50KTsKKworCXdh
a2VfdXBfaW50ZXJydXB0aWJsZSgmbWRwcy5taXNjX3dhaXQpOworCWtpbGxf
ZmFzeW5jKCZtZHBzLmFzeW5jX3F1ZXVlLCBTSUdJTywgUE9MTF9JTik7CisK
KwlyZXR1cm4gSVJRX0hBTkRMRUQ7Cit9CisKK3N0YXRpYyBpbnQgbWRwc19t
aXNjX29wZW4oc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZp
bGUpCit7CisJaW50IHJldDsKKworCWlmICghYXRvbWljX2RlY19hbmRfdGVz
dCgmbWRwcy5hdmFpbGFibGUpKSB7CisJCWF0b21pY19pbmMoJm1kcHMuYXZh
aWxhYmxlKTsKKwkJcmV0dXJuIC1FQlVTWTsgLyogYWxyZWFkeSBvcGVuICov
CisJfQorCisJYXRvbWljX3NldCgmbWRwcy5jb3VudCwgMCk7CisKKwlyZXQg
PSByZXF1ZXN0X2lycShtZHBzLmlycSwgbWRwc19pcnEsIDAsICJtZHBzIiwg
bWRwc19pcnEpOworCWlmIChyZXQpIHsKKwkJcHJpbnRrKEtFUk5fSU5GTyAi
bWRwczogKElSUSVkKSBhbGxvY2F0aW9uIGZhaWxlZFxuIiwgbWRwcy5pcnEp
OworCQlyZXR1cm4gLUVOT0RFVjsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGludCBtZHBzX21pc2NfcmVsZWFzZShzdHJ1Y3QgaW5vZGUgKmlu
b2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKK3sKKwlmYXN5bmNfaGVscGVyKC0x
LCBmaWxlLCAwLCAmbWRwcy5hc3luY19xdWV1ZSk7CisKKwlmcmVlX2lycSht
ZHBzLmlycSwgbWRwc19pcnEpOworCisJYXRvbWljX2luYygmbWRwcy5hdmFp
bGFibGUpOyAvKiByZWxlYXNlIHRoZSBkZXZpY2UgKi8KKwlyZXR1cm4gMDsK
K30KKworc3RhdGljIHNzaXplX3QgbWRwc19taXNjX3JlYWQoc3RydWN0IGZp
bGUgKmZpbGUsIGNoYXIgX191c2VyICpidWYsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzaXplX3QgY291bnQsIGxvZmZfdCAqcG9zKQorewor
CURFQ0xBUkVfV0FJVFFVRVVFKHdhaXQsIGN1cnJlbnQpOworCXUzMiBkYXRh
OworCXNzaXplX3QgcmV0dmFsID0gY291bnQ7CisKKwlpZiAoY291bnQgIT0g
c2l6ZW9mKHUzMikpCisJCXJldHVybiAtRUlOVkFMOworCisJYWRkX3dhaXRf
cXVldWUoJm1kcHMubWlzY193YWl0LCAmd2FpdCk7CisJZm9yICg7Oykgewor
CQlzZXRfY3VycmVudF9zdGF0ZShUQVNLX0lOVEVSUlVQVElCTEUpOworCQlk
YXRhID0gYXRvbWljX3hjaGcoJm1kcHMuY291bnQsIDApOworCisJCWlmIChk
YXRhKQorCQkJYnJlYWs7CisKKwkJaWYgKGZpbGUtPmZfZmxhZ3MgJiBPX05P
TkJMT0NLKSB7CisJCQlyZXR2YWwgPSAtRUFHQUlOOworCQkJZ290byBvdXQ7
CisJCX0KKworCQlpZiAoc2lnbmFsX3BlbmRpbmcoY3VycmVudCkpIHsKKwkJ
CXJldHZhbCA9IC1FUkVTVEFSVFNZUzsKKwkJCWdvdG8gb3V0OworCQl9CisK
KwkJc2NoZWR1bGUoKTsKKwl9CisKKwlpZiAoY29weV90b191c2VyKGJ1Ziwg
JmRhdGEsIHNpemVvZihkYXRhKSkpCisJCXJldHZhbCA9IC1FRkFVTFQ7CisK
K291dDoKKwlzZXRfY3VycmVudF9zdGF0ZShUQVNLX1JVTk5JTkcpOworCXJl
bW92ZV93YWl0X3F1ZXVlKCZtZHBzLm1pc2Nfd2FpdCwgJndhaXQpOworCisJ
cmV0dXJuIHJldHZhbDsKK30KKworc3RhdGljIHVuc2lnbmVkIGludCBtZHBz
X21pc2NfcG9sbChzdHJ1Y3QgZmlsZSAqZmlsZSwgcG9sbF90YWJsZSAqd2Fp
dCkKK3sKKwlwb2xsX3dhaXQoZmlsZSwgJm1kcHMubWlzY193YWl0LCB3YWl0
KTsKKworCWlmIChhdG9taWNfcmVhZCgmbWRwcy5jb3VudCkpCisJCXJldHVy
biBQT0xMSU4gfCBQT0xMUkROT1JNOworCisJcmV0dXJuIDA7Cit9CisKK3N0
YXRpYyBpbnQgbWRwc19taXNjX2Zhc3luYyhpbnQgZmQsIHN0cnVjdCBmaWxl
ICpmaWxlLCBpbnQgb24pCit7CisJcmV0dXJuIGZhc3luY19oZWxwZXIoZmQs
IGZpbGUsIG9uLCAmbWRwcy5hc3luY19xdWV1ZSk7Cit9CisKK3N0YXRpYyBj
b25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIG1kcHNfbWlzY19mb3BzID0g
eworCS5vd25lciAgID0gVEhJU19NT0RVTEUsCisJLmxsc2VlayAgPSBub19s
bHNlZWssCisJLnJlYWQgICAgPSBtZHBzX21pc2NfcmVhZCwKKwkub3BlbiAg
ICA9IG1kcHNfbWlzY19vcGVuLAorCS5yZWxlYXNlID0gbWRwc19taXNjX3Jl
bGVhc2UsCisJLnBvbGwgICAgPSBtZHBzX21pc2NfcG9sbCwKKwkuZmFzeW5j
ICA9IG1kcHNfbWlzY19mYXN5bmMsCit9OworCitzdGF0aWMgc3RydWN0IG1p
c2NkZXZpY2UgbWRwc19taXNjX2RldmljZSA9IHsKKwkubWlub3IgICA9IE1J
U0NfRFlOQU1JQ19NSU5PUiwKKwkubmFtZSAgICA9ICJhY2NlbCIsCisJLmZv
cHMgICAgPSAmbWRwc19taXNjX2ZvcHMsCit9OworCitzdGF0aWMgYWNwaV9z
dGF0dXMKK21kcHNfZ2V0X3Jlc291cmNlKHN0cnVjdCBhY3BpX3Jlc291cmNl
ICpyZXNvdXJjZSwgdm9pZCAqY29udGV4dCkKK3sKKwlpZiAocmVzb3VyY2Ut
PnR5cGUgPT0gQUNQSV9SRVNPVVJDRV9UWVBFX0VYVEVOREVEX0lSUSkgewor
CQlzdHJ1Y3QgYWNwaV9yZXNvdXJjZV9leHRlbmRlZF9pcnEgKmlycTsKKwkJ
dTMyICpkZXZpY2VfaXJxID0gY29udGV4dDsKKworCQlpcnEgPSAmcmVzb3Vy
Y2UtPmRhdGEuZXh0ZW5kZWRfaXJxOworCQkqZGV2aWNlX2lycSA9IGlycS0+
aW50ZXJydXB0c1swXTsKKwl9CisKKwlyZXR1cm4gQUVfT0s7Cit9CisKK3N0
YXRpYyB2b2lkIG1kcHNfZW51bV9yZXNvdXJjZXMoc3RydWN0IGFjcGlfZGV2
aWNlICpkZXZpY2UpCit7CisJYWNwaV9zdGF0dXMgc3RhdHVzOworCisJc3Rh
dHVzID0gYWNwaV93YWxrX3Jlc291cmNlcyhkZXZpY2UtPmhhbmRsZSwgTUVU
SE9EX05BTUVfX0NSUywKKwkJCQkJbWRwc19nZXRfcmVzb3VyY2UsICZtZHBz
LmlycSk7CisJaWYgKEFDUElfRkFJTFVSRShzdGF0dXMpKQorCQlwcmludGso
S0VSTl9ERUJVRyAibWRwczogRXJyb3IgZ2V0dGluZyByZXNvdXJjZXNcbiIp
OworfQorCitzdGF0aWMgaW50IG1kcHNfYWRkKHN0cnVjdCBhY3BpX2Rldmlj
ZSAqZGV2aWNlKQoreworCXVuc2lnbmVkIGxvbmcgdmFsOworCWludCByZXQ7
CisKKwlpZiAoIWRldmljZSkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwltZHBz
LmRldmljZSA9IGRldmljZTsKKwlzdHJjcHkoYWNwaV9kZXZpY2VfbmFtZShk
ZXZpY2UpLCBEUklWRVJfTkFNRSk7CisJc3RyY3B5KGFjcGlfZGV2aWNlX2Ns
YXNzKGRldmljZSksIEFDUElfTURQU19DTEFTUyk7CisJYWNwaV9kcml2ZXJf
ZGF0YShkZXZpY2UpID0gJm1kcHM7CisKKwltZHBzX0FMUkQoZGV2aWNlLT5o
YW5kbGUsIE1EUFNfV0hPX0FNX0ksICZ2YWwpOworCWlmICh2YWwgIT0gTURQ
U19JRCkgeworCQlwcmludGsoS0VSTl9JTkZPICJtZHBzOiBBY2NlbGVyb21l
dGVyIGNoaXAgbm90IExJUzNMVjAyRHtMLFF9XG4iKTsKKwkJcmV0dXJuIC1F
Tk9ERVY7CisJfQorCisJbWRwc19hZGRfZnMoZGV2aWNlKTsKKwltZHBzX3Jl
c3VtZShkZXZpY2UsIDMpOworCisJaWYgKGpveXN0aWNrKQorCQltZHBzX2pv
eXN0aWNrX2VuYWJsZSgpOworCisJaWYgKHBvd2VyX29mZikgLyogc2VlIGlm
IHVzZXIgd2FudGVkIHRvIHBvd2VyIG9mZiB0aGUgZGV2aWNlIG9uIGxvYWQg
Ki8KKwkJbWRwc19wb3dlcm9mZihtZHBzLmRldmljZS0+aGFuZGxlKTsKKwor
CW1kcHNfZW51bV9yZXNvdXJjZXMoZGV2aWNlKTsgLyogb2J0YWluIElSUSBu
dW1lciBvZiBvdXIgZGV2aWNlIGZyb20gQUNQSSAqLworCisJLyogaWYgd2Ug
ZGlkIG5vdCBnZXQgYW4gSVJRIGZyb20gQUNQSSAtIHdlIGhhdmUgbm90aGlu
ZyBtb3JlIHRvIGRvICovCisJaWYgKCFtZHBzLmlycSkKKwkJcmV0dXJuIDA7
CisKKwlhdG9taWNfc2V0KCZtZHBzLmF2YWlsYWJsZSwgMSk7IC8qIGluaXQg
dGhlIG1pc2MgZGV2aWNlIG9wZW4gY291bnQgKi8KKwlpbml0X3dhaXRxdWV1
ZV9oZWFkKCZtZHBzLm1pc2Nfd2FpdCk7CisKKwlyZXQgPSBtaXNjX3JlZ2lz
dGVyKCZtZHBzX21pc2NfZGV2aWNlKTsKKwlpZiAocmV0KQorCQlwcmludGso
S0VSTl9FUlIgIm1kcHM6IG1pc2NfcmVnaXN0ZXIgZmFpbGVkXG4iKTsKKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgaW50IG1kcHNfcmVtb3ZlKHN0cnVj
dCBhY3BpX2RldmljZSAqZGV2aWNlLCBpbnQgdHlwZSkKK3sKKwlpZiAoIWRl
dmljZSkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlpZiAobWRwcy5pcnEpCisJ
CW1pc2NfZGVyZWdpc3RlcigmbWRwc19taXNjX2RldmljZSk7CisKKwlpZiAo
am95c3RpY2spCisJCW1kcHNfam95c3RpY2tfZGlzYWJsZSgpOworCisJcmV0
dXJuIG1kcHNfcmVtb3ZlX2ZzKCk7Cit9CisKK3N0YXRpYyB2b2lkIG1kcHNf
Y2FsaWJyYXRlX2pveXN0aWNrKHZvaWQpCit7CisJaW50IHgsIHk7CisJbWRw
c19nZXRfeHkobWRwcy5kZXZpY2UtPmhhbmRsZSwgJngsICZ5KTsKKworCW1k
cHMueGNhbGliID0geDsKKwltZHBzLnljYWxpYiA9IHk7Cit9CisKK3N0YXRp
YyBpbnQgbWRwc19qb3lzdGlja19vcGVuKHN0cnVjdCBpbnB1dF9kZXYgKmRl
dikKK3sKKwltZHBzLmt0aHJlYWQgPSBrdGhyZWFkX3J1bihtZHBzX2pveXN0
aWNrX2t0aHJlYWQsIE5VTEwsICJrbWRwcyIpOworCWlmIChJU19FUlIobWRw
cy5rdGhyZWFkKSkKKwkJcmV0dXJuIFBUUl9FUlIobWRwcy5rdGhyZWFkKTsK
KworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBtZHBzX2pveXN0aWNr
X2Nsb3NlKHN0cnVjdCBpbnB1dF9kZXYgKmRldikKK3sKKwlrdGhyZWFkX3N0
b3AobWRwcy5rdGhyZWFkKTsKK30KKworc3RhdGljIHZvaWQgbWRwc19qb3lz
dGlja19lbmFibGUodm9pZCkKK3sKKwlpZiAobWRwcy5pZGV2KQorCQlyZXR1
cm47CisKKwltZHBzLmlkZXYgPSBpbnB1dF9hbGxvY2F0ZV9kZXZpY2UoKTsK
KwlpZiAoIW1kcHMuaWRldikKKwkJcmV0dXJuOworCisJbWRwc19jYWxpYnJh
dGVfam95c3RpY2soKTsKKworCW1kcHMuaWRldi0+bmFtZSAgICAgICA9ICJI
UCBNb2JpbGUgRGF0YSBQcm90ZWN0aW9uIFN5c3RlbSI7CisJbWRwcy5pZGV2
LT5pZC5idXN0eXBlID0gQlVTX0hPU1Q7CisJbWRwcy5pZGV2LT5pZC52ZW5k
b3IgID0gMDsKKworCXNldF9iaXQoRVZfQUJTLCBtZHBzLmlkZXYtPmV2Yml0
KTsKKworCWlucHV0X3NldF9hYnNfcGFyYW1zKG1kcHMuaWRldiwgQUJTX1gs
IC0yMDQ4LCAyMDQ4LCAzLCAwKTsKKwlpbnB1dF9zZXRfYWJzX3BhcmFtcyht
ZHBzLmlkZXYsIEFCU19ZLCAtMjA0OCwgMjA0OCwgMywgMCk7CisKKwltZHBz
LmlkZXYtPm9wZW4gID0gbWRwc19qb3lzdGlja19vcGVuOworCW1kcHMuaWRl
di0+Y2xvc2UgPSBtZHBzX2pveXN0aWNrX2Nsb3NlOworCisJaWYgKGlucHV0
X3JlZ2lzdGVyX2RldmljZShtZHBzLmlkZXYpKSB7CisJCWlucHV0X2ZyZWVf
ZGV2aWNlKG1kcHMuaWRldik7CisJCW1kcHMuaWRldiA9IE5VTEw7CisJfQor
fQorCitzdGF0aWMgdm9pZCBtZHBzX2pveXN0aWNrX2Rpc2FibGUodm9pZCkK
K3sKKwlpZiAoIW1kcHMuaWRldikKKwkJcmV0dXJuOworCisJaW5wdXRfdW5y
ZWdpc3Rlcl9kZXZpY2UobWRwcy5pZGV2KTsKKwltZHBzLmlkZXYgPSBOVUxM
OworfQorCisvKiBTeXNmcyBzdHVmZiAqLworc3RhdGljIHNzaXplX3QgbWRw
c19wb3NpdGlvbl9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJp
YnV0ZSAqYXR0ciwgY2hhciAqYnVmKQoreworCWludCB4LCB5OworCW1kcHNf
Z2V0X3h5KG1kcHMuZGV2aWNlLT5oYW5kbGUsICZ4LCAmeSk7CisJcmV0dXJu
IHNwcmludGYoYnVmLCAiKCVkLCVkKVxuIiwgeCwgeSk7Cit9CisKK3N0YXRp
YyBzc2l6ZV90IG1kcHNfcG9zaXRpb24zZF9zaG93KHN0cnVjdCBkZXZpY2Ug
KmRldiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7CisJ
dW5zaWduZWQgbG9uZyB6X2xvLCB6X2hpOworCWludCB4LCB5LCB6OworCisJ
bWRwc19nZXRfeHkobWRwcy5kZXZpY2UtPmhhbmRsZSwgJngsICZ5KTsKKwor
CW1kcHNfQUxSRChtZHBzLmRldmljZS0+aGFuZGxlLCBNRFBTX09VVFpfTCwg
JnpfbG8pOworCW1kcHNfQUxSRChtZHBzLmRldmljZS0+aGFuZGxlLCBNRFBT
X09VVFpfSCwgJnpfaGkpOworCXogPSBtZHBzX2dsdWVfYnl0ZXMoel9oaSwg
el9sbyk7CisKKwlyZXR1cm4gc3ByaW50ZihidWYsICIoJWQsJWQsJWQpXG4i
LCB4LCB5LCB6KTsKK30KKworc3RhdGljIHNzaXplX3QgbWRwc19zdGF0ZV9z
aG93KHN0cnVjdCBkZXZpY2UgKmRldiwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hh
ciAqYnVmKQoreworCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVzXG4iLCAobWRw
cy5pc19vbiA/ICJvbiIgOiAib2ZmIikpOworfQorCitzdGF0aWMgc3NpemVf
dCBtZHBzX2pveXN0aWNrX3Nob3coc3RydWN0IGRldmljZSAqZGV2LAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkZXZpY2Vf
YXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7CisJcmV0dXJuIHNwcmlu
dGYoYnVmLCAiJXNcbiIsIChqb3lzdGljayA/ICJlbmFibGVkIiA6ICJkaXNh
YmxlZCIpKTsKK30KKworc3RhdGljIHNzaXplX3QgbWRwc19jYWxpYnJhdGVf
c2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRy
LCBjaGFyICpidWYpCit7CisJcmV0dXJuIHNwcmludGYoYnVmLCAiKCVkLCVk
KVxuIiwgbWRwcy54Y2FsaWIsIG1kcHMueWNhbGliKTsKK30KKworc3RhdGlj
IHNzaXplX3QgbWRwc19jYWxpYnJhdGVfc3RvcmUoc3RydWN0IGRldmljZSAq
ZGV2LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBj
b3VudCkKK3sKKwltZHBzX2NhbGlicmF0ZV9qb3lzdGljaygpOworCXJldHVy
biBjb3VudDsKK30KKworc3RhdGljIHNzaXplX3QgbWRwc19yYXRlX3Nob3co
c3RydWN0IGRldmljZSAqZGV2LAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1
ZikKK3sKKwl1bnNpZ25lZCBsb25nIGN0cmw7CisJaW50IHJhdGUgPSAwOwor
CisJbWRwc19BTFJEKG1kcHMuZGV2aWNlLT5oYW5kbGUsIE1EUFNfQ1RSTF9S
RUcxLCAmY3RybCk7CisKKwkvKiBnZXQgdGhlIHNhbXBsaW5nIHJhdGUgb2Yg
dGhlIGFjY2VsZXJvbWV0ZXIgaW4gSFogKi8KKwlzd2l0Y2ggKChjdHJsICYg
MHgzMCkgPj4gNCkKKwl7CisJY2FzZSAwMDoKKwkJcmF0ZSA9IDQwOworCQli
cmVhazsKKworCWNhc2UgMDE6CisJCXJhdGUgPSAxNjA7CisJCWJyZWFrOwor
CisJY2FzZSAwMjoKKwkJcmF0ZSA9IDY0MDsKKwkJYnJlYWs7CisKKwljYXNl
IDAzOgorCQlyYXRlID0gMjU2MDsKKwkJYnJlYWs7CisJfQorCisJcmV0dXJu
IHNwcmludGYoYnVmLCAiJWRcbiIsIHJhdGUpOworfQorCitzdGF0aWMgc3Np
emVfdCBtZHBzX3N0YXRlX3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRldmljZV9h
dHRyaWJ1dGUgKmF0dHIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGNvdW50KQoreworCWludCBz
dGF0ZTsKKwlpZiAoc3NjYW5mKGJ1ZiwgIiVkIiwgJnN0YXRlKSAhPSAxIHx8
IChzdGF0ZSAhPSAxICYmIHN0YXRlICE9IDApKQorCQlyZXR1cm4gLUVJTlZB
TDsKKworCW1kcHMuaXNfb24gPSBzdGF0ZTsKKworCWlmIChtZHBzLmlzX29u
KQorCQltZHBzX3Bvd2Vyb24obWRwcy5kZXZpY2UtPmhhbmRsZSk7CisJZWxz
ZQorCQltZHBzX3Bvd2Vyb2ZmKG1kcHMuZGV2aWNlLT5oYW5kbGUpOworCisJ
cmV0dXJuIGNvdW50OworfQorCitzdGF0aWMgREVWSUNFX0FUVFIocG9zaXRp
b24sIFNfSVJVR08sIG1kcHNfcG9zaXRpb25fc2hvdywgTlVMTCk7CitzdGF0
aWMgREVWSUNFX0FUVFIocG9zaXRpb24zZCwgU19JUlVHTywgbWRwc19wb3Np
dGlvbjNkX3Nob3csIE5VTEwpOworc3RhdGljIERFVklDRV9BVFRSKGNhbGli
cmF0ZSwgU19JUlVHT3xTX0lXVVNSLCBtZHBzX2NhbGlicmF0ZV9zaG93LCBt
ZHBzX2NhbGlicmF0ZV9zdG9yZSk7CitzdGF0aWMgREVWSUNFX0FUVFIocmF0
ZSwgU19JUlVHTywgbWRwc19yYXRlX3Nob3csIE5VTEwpOworc3RhdGljIERF
VklDRV9BVFRSKHN0YXRlLCBTX0lSVUdPfFNfSVdVU1IsIG1kcHNfc3RhdGVf
c2hvdywgbWRwc19zdGF0ZV9zdG9yZSk7CitzdGF0aWMgREVWSUNFX0FUVFIo
am95c3RpY2ssIFNfSVJVR08sIG1kcHNfam95c3RpY2tfc2hvdywgTlVMTCk7
CisKK3N0YXRpYyBzdHJ1Y3QgYXR0cmlidXRlICptZHBzX2F0dHJpYnV0ZXNb
XSA9IHsKKwkmZGV2X2F0dHJfcG9zaXRpb24uYXR0ciwKKwkmZGV2X2F0dHJf
cG9zaXRpb24zZC5hdHRyLAorCSZkZXZfYXR0cl9jYWxpYnJhdGUuYXR0ciwK
KwkmZGV2X2F0dHJfcmF0ZS5hdHRyLAorCSZkZXZfYXR0cl9zdGF0ZS5hdHRy
LAorCSZkZXZfYXR0cl9qb3lzdGljay5hdHRyLAorCU5VTEwKK307CisKK3N0
YXRpYyBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwIG1kcHNfYXR0cmlidXRlX2dy
b3VwID0geworCS5hdHRycyA9IG1kcHNfYXR0cmlidXRlcworfTsKKworc3Rh
dGljIGludCBtZHBzX2FkZF9mcyhzdHJ1Y3QgYWNwaV9kZXZpY2UgKmRldmlj
ZSkKK3sKKwltZHBzLnBkZXYgPSBwbGF0Zm9ybV9kZXZpY2VfcmVnaXN0ZXJf
c2ltcGxlKERSSVZFUl9OQU1FLCAtMSwgTlVMTCwgMCk7CisJaWYgKElTX0VS
UihtZHBzLnBkZXYpKQorCQlyZXR1cm4gUFRSX0VSUihtZHBzLnBkZXYpOwor
CisJcmV0dXJuIHN5c2ZzX2NyZWF0ZV9ncm91cCgmbWRwcy5wZGV2LT5kZXYu
a29iaiwgJm1kcHNfYXR0cmlidXRlX2dyb3VwKTsKK30KKworc3RhdGljIGlu
dCBtZHBzX3JlbW92ZV9mcyh2b2lkKQoreworCXN5c2ZzX3JlbW92ZV9ncm91
cCgmbWRwcy5wZGV2LT5kZXYua29iaiwgJm1kcHNfYXR0cmlidXRlX2dyb3Vw
KTsKKwlwbGF0Zm9ybV9kZXZpY2VfdW5yZWdpc3RlcihtZHBzLnBkZXYpOwor
CXJldHVybiAwOworfQorCitzdGF0aWMgaW50IF9faW5pdCBtZHBzX2luaXRf
bW9kdWxlKHZvaWQpCit7CisJaW50IHJldDsKKwlhY3BpX3N0YXR1cyBzdGF0
dXM7CisJYWNwaV9oYW5kbGUgaGFuZGxlID0gMDsKKworCWlmIChhY3BpX2Rp
c2FibGVkKQorCQlyZXR1cm4gLUVOT0RFVjsKKworCS8qIGRldmljZSBkZXRl
Y3Rpb246IHNlZSBpZiBvdXIgZGV2aWNlIGlzIHByZXNlbnQgaW4gQUNQSSAq
LworCXN0YXR1cyA9IGFjcGlfZ2V0X2hhbmRsZShOVUxMLCAiXFxfU0IuQzAw
Mi5BQ0VMIiwgJmhhbmRsZSk7CisJaWYgKEFDUElfRkFJTFVSRShzdGF0dXMp
KSB7CisJCXByaW50ayhLRVJOX0VSUiAibWRwczogSFAgTW9iaWxlIERhdGEg
UHJvdGVjdGlvbiBTeXN0ZW0gM0Qgbm90IGZvdW5kXG4iKTsKKwkJcmV0dXJu
IC1FTk9ERVY7CisJfQorCisJcmV0ID0gYWNwaV9idXNfcmVnaXN0ZXJfZHJp
dmVyKCZtZHBzX2RyaXZlcik7CisJaWYgKHJldCA8IDApCisJCXJldHVybiBy
ZXQ7CisJCisJcHJpbnRrKEtFUk5fSU5GTyAibWRwczogKCIgVkVSU0lPTiAi
KSBsb2FkZWQuXG4iKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9p
ZCBfX2V4aXQgbWRwc19leGl0X21vZHVsZSh2b2lkKQoreworCWFjcGlfYnVz
X3VucmVnaXN0ZXJfZHJpdmVyKCZtZHBzX2RyaXZlcik7Cit9CisKK01PRFVM
RV9ERVNDUklQVElPTigiSFAgdGhyZWUtYXhpcyBkaWdpdGFsIGFjY2VsZXJv
bWV0ZXIgQUNQSSBkcml2ZXIiKTsKK01PRFVMRV9BVVRIT1IoIllhbiBCdXJt
YW4gKHlhbl85NTJAaG90bWFpbC5jb20pIik7CitNT0RVTEVfVkVSU0lPTihW
RVJTSU9OKTsKK01PRFVMRV9MSUNFTlNFKCJHUEwiKTsKKworbW9kdWxlX2lu
aXQobWRwc19pbml0X21vZHVsZSk7Cittb2R1bGVfZXhpdChtZHBzX2V4aXRf
bW9kdWxlKTsK


------=_NextPart_000_5adc_3ade_777f--
