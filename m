Return-Path: <linux-kernel-owner+willy=40w.ods.org-S1751241AbWDUJjR@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1751241AbWDUJjR (ORCPT <rfc822;willy@w.ods.org>);
	Fri, 21 Apr 2006 05:39:17 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1751255AbWDUJjR
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Fri, 21 Apr 2006 05:39:17 -0400
Received: from emailhub.stusta.mhn.de ([141.84.69.5]:61702 "HELO
	mailout.stusta.mhn.de") by vger.kernel.org with SMTP
	id S1751241AbWDUJjQ (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Fri, 21 Apr 2006 05:39:16 -0400
Date: Fri, 21 Apr 2006 11:39:14 +0200
From: Adrian Bunk <bunk@stusta.de>
To: Ram Pai <linuxram@us.ibm.com>
Cc: Sam Ravnborg <sam@ravnborg.org>, linux-kernel@vger.kernel.org,
       akpm@osdl.org, arjan@infradead.org, greg@kroah.com, hch@infradead.org,
       mathur@us.ibm.com
Subject: Re: [RFC PATCH 1/3] export symbol report: overview
Message-ID: <20060421093914.GD19754@stusta.de>
References: <20060420223653.EF73E470030@localhost> <20060421074317.GB17492@mars.ravnborg.org> <1145607615.7323.212.camel@localhost>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <1145607615.7323.212.camel@localhost>
User-Agent: Mutt/1.5.11+cvs20060403
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

On Fri, Apr 21, 2006 at 01:20:15AM -0700, Ram Pai wrote:
> On Fri, 2006-04-21 at 09:43 +0200, Sam Ravnborg wrote:
> > On Thu, Apr 20, 2006 at 03:36:53PM -0700, Ram Pai wrote:
> > > This patch series enables on-demand report generation of export symbol usage by
> > > inkernel modules. The report is available at
> > > 
> > > A report generated by executing 
> > >  	make allmodconfig
> > >  	make export_report
> > > is available at http://www.sudhaa.com/~ram/misc/export_report.txt
> > > 
> > > This report lists:
> > > 1. the usage count of all exported symbols by in-kernel modules.
> > > 2. For each in-kernel module lists
> > > 	a) the in-kernel modules it depend on.
> > > 	b) list of exported symbols from that in-kernel modules it depend on.
> > > 
> > > Highlights: 
> > > 	On x86 architecture
> > >  	(1) 880 exported symbols not used by any in-kernel modules.
> > >         (2) 1792 exported symbols used only once.
> > > 
> > > This patch series has comments by Adrian Bunk incorporated.
> > 
> > Hi Ram Pai.
> > 
> > In principle what your patch does is a simple port-processign of
> > Module.symvers.
> > Insead of introducing another step in the buildprocess then for this
> > functionality we should just call your script direct.
> > This is not something the average users will do often, so having to
> > type:
> > ./scripts/export-report.pl
> > 
> > And then let the perl script pick up default values for where to find
> > *.mod.c files and Module.symvers.
> > 
> > Thoughts?
> 
> Well, if the Module.symvers file does not exist than the script will
> fail; unless the script invokes the 'make modules'. 
> 
> Incorporating it into the Makefile can ease its use,
> because we can transparently trigger rules that can make the
> Module.symvers file.
> 
> I guess its a question of which way makes it easy to use? and my 
> thoughts are leaning towards incorporating it into the Makefile.
> 
> I can make it either way. You suggest.

Sam is the one who can judge best on how to implement your proposal 
best, but there's one thing you should have in mind:

This is a script that isn't for users compiling their own kernel - it's 
a tool only a small subset of the kernel developers will use.

It does therefore not need a sophisticated error handling for cases like 
a not yet compiled kernel or CONFIG_MODULES=n.

> RP

cu
Adrian

-- 

       "Is there not promise of rain?" Ling Tan asked suddenly out
        of the darkness. There had been need of rain for many days.
       "Only a promise," Lao Er said.
                                       Pearl S. Buck - Dragon Seed

