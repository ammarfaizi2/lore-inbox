Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S265179AbTFEVlg (ORCPT <rfc822;willy@w.ods.org>);
	Thu, 5 Jun 2003 17:41:36 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S265182AbTFEVlg
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Thu, 5 Jun 2003 17:41:36 -0400
Received: from [61.211.239.235] ([61.211.239.235]:37797 "EHLO
	maison.kyo-ko.org") by vger.kernel.org with ESMTP id S265179AbTFEVlf
	(ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Thu, 5 Jun 2003 17:41:35 -0400
Date: Fri, 06 Jun 2003 06:54:59 +0900
Message-ID: <87n0gwyyto.wl%miura@da-cha.org>
From: Hiroshi Miura <miura@da-cha.org>
To: Alan Cox <alan@redhat.com>, Dave Jones <davej@suse.de>
Cc: Linux Kernel Development <linux-kernel@vger.kernel.org>
Subject: Re: [PATCH 2.5.70] NatSemi Geode out-of-order store enables
In-Reply-To: <200306051406.h55E6Yp25484@devserv.devel.redhat.com>
References: <87y90gzrbn.wl%miura@da-cha.org>
User-Agent: Wanderlust/2.10.0 (Venus) SEMI/1.14.4
 (=?ISO-2022-JP?B?GyRCOllPJExaGyhC?=) FLIM/1.14.4
 (=?ISO-2022-JP?B?GyRCM2A4Nj9ANVxBMBsoQg==?=) APEL/10.4 Emacs/21.3
 (i386-pc-linux-gnu) MULE/5.0 (=?ISO-2022-JP?B?GyRCOC1MWhsoQg==?=)
MIME-Version: 1.0 (generated by SEMI 1.14.4 - =?ISO-2022-JP?B?IhskQjpZGyhC?=
 =?ISO-2022-JP?B?GyRCTyRMWhsoQiI=?=)
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Hello,

At Thu, 5 Jun 2003 10:06:34 -0400 (EDT),
Alan Cox wrote:
>
> > Most geode specific code already merged, but it need
> > a definition of CONFIG_OOSTORE to speedup geode.
> 
> The OOSTORE shouldnt be needed according to the natsemi info,
> you can just drop the ifdef

Thanks. 

This patch does it. And remove CONFIG_NOHIGHMEM because
Geode supports MEM up to 512MB from GX1 datasheet.

Please apply it.

/usr/src$ diff -u linux-2.5.70/arch/i386/kernel/cpu/cyrix.c.keep  linux-2.5.70/arch/i386/kernel/cpu/cyrix.c
--- linux-2.5.70/arch/i386/kernel/cpu/cyrix.c.keep      2003-06-06 06:41:09.000000000 +0900
+++ linux-2.5.70/arch/i386/kernel/cpu/cyrix.c   2003-06-06 06:41:23.000000000 +0900
@@ -109,7 +109,6 @@
 
 static void __init set_cx86_reorder(void)
 {
-#ifdef CONFIG_OOSTORE
        u8 ccr3;
 
        printk(KERN_INFO "Enable Memory access reorder on Cyrix/NSC processor.\n");
@@ -118,12 +117,9 @@
 
        /* Load/Store Serialize to mem access disable (=reorder it) */
        setCx86(CX86_PCR0, getCx86(CX86_PCR0) & ~0x80);
-#ifdef CONFIG_NOHIGHMEM
        /* set load/store serialize from 1GB to 4GB */
        ccr3 |= 0xe0;
-#endif
        setCx86(CX86_CCR3, ccr3);
-#endif
 }
 
 static void __init set_cx86_memwb(void)


 
-- 
Hiroshi Miura  --- http://www.da-cha.org/ 
NTTDATA Corp. Marketing & Business Strategy Planning Dept. --- miurahr@nttdata.co.jp 
Key fingerprint = 9117 9407 5684 FBF1 4063  15B4 401D D077 04AB 8617
-- My hacking life is happy as the day is long

