Return-Path: <linux-kernel-owner+willy=40w.ods.org-S262686AbVAFCxS@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S262686AbVAFCxS (ORCPT <rfc822;willy@w.ods.org>);
	Wed, 5 Jan 2005 21:53:18 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S262709AbVAFCxR
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Wed, 5 Jan 2005 21:53:17 -0500
Received: from vds-320151.amen-pro.com ([62.193.204.86]:42372 "EHLO
	vds-320151.amen-pro.com") by vger.kernel.org with ESMTP
	id S262686AbVAFCwZ (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Wed, 5 Jan 2005 21:52:25 -0500
Subject: [PATCH] Enhanced Trusted Path Execution (TPE) Linux Security Module
From: Lorenzo =?ISO-8859-1?Q?Hern=E1ndez_?=
	 =?ISO-8859-1?Q?Garc=EDa-Hierro?= <lorenzo@gnu.org>
To: linux-kernel@vger.kernel.org
Cc: linux-security-module@wirex.com
Content-Type: multipart/signed; micalg=pgp-sha1; protocol="application/pgp-signature"; boundary="=-WvlOs3B+kFDWnW7qSdaj"
Date: Thu, 06 Jan 2005 03:51:48 +0100
Message-Id: <1104979908.8060.34.camel@localhost.localdomain>
Mime-Version: 1.0
X-Mailer: Evolution 2.0.2 
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org


--=-WvlOs3B+kFDWnW7qSdaj
Content-Type: multipart/mixed; boundary="=-5Hk3cYK5sQ1w9xikxsHY"


--=-5Hk3cYK5sQ1w9xikxsHY
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,
This patch adds support for an enhanced Trusted Path Execution (TPE)
subsystem relying in the Linux Security Modules framework.
It's a rewrite of the IBM's TPE LSM module by Niki A. Rahimi, which adds
a couple of improvements and feature enhancements.

The most notable of them are support for per-gid basis access control
lists in runtime and kernel-configuration time (adds support for trusted
and untrusted user groups), procfs interface for statistics and runtime
information and debugging capabilities (for limiting the garbage
messages).

Also, the documentation has been rewritten and under the "Trusted Path
Execution (EXPERIMENTAL)" configuration option, has been added a "GID
for trusted users" key to make possible to set a default gid for a
specific trusted user group.

The reasons that give sense for including this, are that standard
Vanilla kernels have SELinux and LSM (SELinux already supports TPE
functionalities), but SELinux has less possibilities of being used by
those desktop or just not experienced users who are not already using
their distribution-specific SELinux implementation, even if they want
simple protections for their every-day system use, also, the
availability of some patch-sets with security enhancements (like
grsecurity) distracts users of being using the LSM framework or even
SELinux itself, in addition, this TPE has more features than
grsecurity's one in terms of per-users and groups acl basis, which make
easy the management of the TPE protection.
In short, after a first review you can see that it could worthy to
include this in the kernel sources.

Note: the code, as it is right now, has some limitations that would be
solved in a relatively short time manner, more short if more people
contribute to it.

The limitations of the current code are described
in ./Documentation/tpe-lsm.txt

Patch against 2.6.10 attached.
(not inside msg body for preventing messing up by archives-managing
software)

I will make available an independent-packaged version ASAP, which could
be built outside the kernel sources, at http://selinux.tuxedo-es.org

Cheers,
PS: I would appreciate to be CC'ed, as I'm not subscribed to the list.
(Just for mail traffic volume reasons, which i don't have time to
handle)
--=20
Lorenzo Hern=E1ndez Garc=EDa-Hierro <lorenzo@gnu.org> [1024D/6F2B2DEC]
[2048g/9AE91A22] Hardened Debian head developer & project manager

--=-5Hk3cYK5sQ1w9xikxsHY
Content-Disposition: attachment; filename=tpe-20050106.diff
Content-Type: text/x-patch; name=tpe-20050106.diff; charset=ISO-8859-1
Content-Transfer-Encoding: base64

ZGlmZiAtTnVyIC4uL2xpbnV4LTIuNi4xMC9Eb2N1bWVudGF0aW9uL3RwZS1sc20udHh0IGxpbnV4
LTIuNi4xMC10cGUvRG9jdW1lbnRhdGlvbi90cGUtbHNtLnR4dA0KLS0tIC4uL2xpbnV4LTIuNi4x
MC9Eb2N1bWVudGF0aW9uL3RwZS1sc20udHh0CTE5NzAtMDEtMDEgMDE6MDA6MDAuMDAwMDAwMDAw
ICswMTAwDQorKysgbGludXgtMi42LjEwLXRwZS9Eb2N1bWVudGF0aW9uL3RwZS1sc20udHh0CTIw
MDUtMDEtMDYgMDI6NTI6MzQuMDAwMDAwMDAwICswMTAwDQpAQCAtMCwwICsxLDg5IEBADQorVHJ1
c3RlZCBQYXRoIEV4ZWN1dGlvbiBMaW51eCBTZWN1cml0eSBNb2R1bGUNCitDb3B5cmlnaHQgKEMp
IDIwMDMgSUJNIENvcnAuIDxuYXJhaGltaUB1cy5pYm0uY29tPg0KK0NvcHlyaWdodCAoQykgMjAw
NSBMb3JlbnpvIEhlcm5hbmRleiBHYXJjaWEtSGllcnJvIDxsb3JlbnpvQGdudS5vcmc+DQorQXV0
aG9yOiBMb3JlbnpvIEhlcm7DoW5kZXogR2FyY2lhLUhpZXJybyAoT3JpZ2luYWw6IE5pa2kgUmFo
aW1pKQ0KK1RoaXMgZmlsZSBpcyBkaXN0cmlidXRlZCBhY2NvcmRpbmcgdG8gdGhlIEdOVSBHZW5l
cmFsIFB1YmxpYyBMaWNlbnNlLg0KK1RoaXMgbW9kdWxlIHdhcyB0ZXN0ZWQgb24gdGhlIExpbnV4
IGtlcm5lbCAyLjYuOSBhbmQgMi42LjEwLg0KKw0KK1RoZSBwdXJwb3NlIG9mIHRoZSBUcnVzdGVk
IFBhdGggRXhlY3V0aW9uIExpbnV4IFNlY3VyaXR5IE1vZHVsZSBpcyB0byBlbmFibGUgYQ0KK2No
ZWNrIGluIHRoZSBMaW51eCBrZXJuZWwgdG8gbGltaXQgdGhlIHJ1bm5pbmcgb2YgZXhlY3V0YWJs
ZXMgaW4gdHJ1c3RlZCBwYXRocw0KK3NvIHRoYXQgdGhlIHBvdGVudGlhbCBmb3IgbWFsaWNpb3Vz
IGNvZGUgdG8gYmUgcnVuIG9uIHRoZSBzeXN0ZW0gaXMgcmVkdWNlZC4NCitBIHRydXN0ZWQgcGF0
aCBpcyBvbmUgaW4gd2hpY2ggdGhlIHBhcmVudCBkaXJlY3Rvcnkgb2YgYSBmaWxlIGlzIG93bmVk
IGJ5IHJvb3QNCithbmQgaXMgbmVpdGhlciBncm91cCBub3Igb3RoZXIgd3JpdGVhYmxlLiANCitU
aGUgbW9kdWxlIHJlbGllcyBvbiBhIGtlcm5lbCBob29rIHdoaWNoIGNoZWNrcyB0byBzZWUgaWYg
dGhlIGdpdmVuIHBhdGggaXMNCit0cnVzdGVkIG9yIG5vdCBhbmQgd2hvIGlzIHRoZSB1c2VyIChv
ciBncm91cCBtZW1iZXIpIHRoYXQgY2F1c2VkIHRoZSBldmVudCAoZXhlY3V0aW9uKS4NCitUaGlz
IGNoZWNrIHRha2VzIHBsYWNlIGRpcmVjdGx5IHVwb24gYW4gYXR0ZW1wdCB0byBleGVjdXRlIHRo
ZSBjb2RlIGJ5IHVzaW5nIHRoZSANCiticHJtX3NldF9zZWN1cml0eSBob29rLiANCisNCitMaW1p
dGF0aW9uczogUmlnaHQgbm93LCB0aGUgZW5naW5lIGRvZXMgbm90IHVzZSB0aGUgYnBybV9zZWN1
cmVleGVjIGhvb2sgdG8gDQorcHJldmVudCB1c2Ugb2Ygc2Vuc2l0aXZlIExEXyogdmFyaWFibGVz
IGJ5IHVudHJ1c3RlZCB1c2VycyBvciBncm91cHMsIGFsc28gaXQNCitkb2VzIG5vdCB1c2UgbW1h
cCBub3IgbXByb3RlY3QgTFNNIGhvb2tzIHRoYXQgY291bGQgcHJldmVudCBieXBhc3Mgb2YgdGhl
DQorYnBybV9zZXRfc2VjdXJpdHkgY2hlY2tzLCBhcyBjb21tZW50ZWQgYnkgU3RlcGhlbiBTLiBT
bWFsbGV5IDxzZHNAZXBvY2gubmNzYy5taWw+Lg0KK1RoaXMgZmVhdHVyZXMgd291bGQgYmUgZGV2
ZWxvcGVkIEFTQVAsIGJ1dCBpdCdzIG5vdCBhIGNyaXRpY2FsLCBibG9ja2luZyBpc3N1ZS4NCisN
CitUaGUgbW9kdWxlIGFsc28gY3JlYXRlcyB0d28gVHJ1c3RlZCBQYXRoIGFjY2VzcyBjb250cm9s
IGxpc3RzIHdoaWNoIGNhbiBiZSBhY2Nlc3NlZA0KK2J5IGEgc3lzZnMgbW91bnRwb2ludCwgaW5z
aWRlIHRoZSAuL3RwZWZzLyBzdWJkaXIgKGllOiAvc3lzL3RwZWZzKSwgd3JpdGVhYmxlIGJ5IHJv
b3QsDQord2hvIGNhbiBhZGQgYW5kIGRlbGV0ZSB1aWRzICh1c2VyIGlkJ3MpIGFuZCBhIGVudGly
ZSByYW5nZSBvZiB1c2VycyB1c2luZyB0aGUgKG5ldykgbmF0aXZlDQorc3VwcG9ydCBmb3IgcGVy
LWdpZCAoZ3JvdXAgaWQpIGJhc2lzIGFjY2VzcyBjb250cm9sIGxpc3RzLiBBIHVzZXIgb24gdGhl
IGxpc3QgaXMgDQorY29uc2lkZXJlZCB0cnVzdGVkLg0KK0Fsc28sIGl0IGNyZWF0ZXMgYSBwcm9j
ZnMgZW50cnkgY2FsbGVkICJ0cGUiIChpZTogL3Byb2MvdHBlKSB3aGljaCBwcm92aWRlcw0KK3Zl
cnNpb24gaW5mb3JtYXRpb24sIHRvdGFsIGFtb3VudCBvZiB0cnVzdGVkIHVzZXJzLCB0b3RhbCBh
bW91bnQgb2YgdHJ1c3RlZCBncm91cHMgYW5kDQorb3RoZXIgaW5mb3JtYXRpb24sIGRlcGVuZGlu
ZyBvbiB0aGUgY29kZSByZXZpc2lvbiksIGFuZCB0aG9zZSB3aG8gd2FudCBleHRyYSBnYXJiYWdl
DQorZnJvbSB0aGUga2VybmVsIHdpbGwgbGlrZSB0byBlbmFibGVkIGRlYnVnZ2luZyBieSBwYXNz
aW5nIGRlYnVnPTEgdG8gdGhlIG1vZHVsZSBwYXJhbWV0ZXJzLg0KK0J5IGRlZmF1bHQsIHJvb3Qg
aXMgaGFyZCBjb2RlZCBvbnRvIHRoaXMgbGlzdCB3aXRoIGFsc28gYSB0cnVzdGVkIGdpZA0KK3do
aWNoIGdldHMgYXV0b21hdGljYWxseSBhZGRlZCB3aGVuIHNlbGVjdGluZyB0aGUgIkdJRCBmb3Ig
dHJ1c3RlZCB1c2VycyIgb3B0aW9uIGluIGtlcm5lbA0KK2NvbmZpZ3VyYXRpb24gKFNFQ1VSSVRZ
X1RQRV9UUlVTVEVEX0dJRCkuDQorDQorVGh1cyBpZiB1c2VyIEEgYXR0ZW1wdHMgdG8gcnVuIGFu
IGV4ZWN1dGFibGUgaW4gcGF0aCBBLCB0aGUgZm9sbG93aW5nIHNjZW5hcmlvcw0KK2NhbiBwbGF5
IG91dDoNCisNCisxLiBUcnVzdGVkIHVzZXIsdHJ1c3RlZCBwYXRoIAkJCT0gVXNlciBpcyBhYmxl
IHRvIHJ1biB0aGUgZXhlY3V0YWJsZS4NCisyLiBUcnVzdGVkIHVzZXIsdHJ1c3RlZCBwYXRoLHRy
dXN0ZWQgZ3JvdXAJPSBVc2VyIGlzIGFibGUgdG8gcnVuIHRoZSBleGVjdXRhYmxlLg0KKzMuIFRy
dXN0ZWQgdXNlcix1bnRydXN0ZWQgcGF0aCAgCQk9IFVzZXIgaXMgYWJsZSB0byBydW4gdGhlIGV4
ZWN1dGFibGUuDQorNC4gVHJ1c3RlZCB1c2VyLHVudHJ1c3RlZCBwYXRoLHRydXN0ZWQgZ3JvdXAJ
PSBVc2VyIGlzIGFibGUgdG8gcnVuIHRoZSBleGVjdXRhYmxlLg0KKzUuIFRydXN0ZWQgdXNlcix1
bnRydXN0ZWQgcGF0aCx1bnRydXN0ZWQgZ3JvdXAJPSBVc2VyIGlzIGFibGUgdG8gcnVuIHRoZSBl
eGVjdXRhYmxlLg0KKzYuIFVudHJ1c3RlZCB1c2VyLHRydXN0ZWQgcGF0aAkgCQk9IFVzZXIgaXMg
YWJsZSB0byBydW4gdGhlIGV4ZWN1dGFibGUuDQorNy4gVW50cnVzdGVkIHVzZXIsdHJ1c3RlZCBw
YXRoLHRydXN0ZWQgZ3JvdXAgCT0gVXNlciBpcyBhYmxlIHRvIHJ1biB0aGUgZXhlY3V0YWJsZS4N
Cis4LiBVbnRydXN0ZWQgdXNlcix0cnVzdGVkIHBhdGgsdW50cnVzdGVkIGdyb3VwIAk9IFVzZXIg
aXMgYWJsZSB0byBydW4gdGhlIGV4ZWN1dGFibGUuDQorOS4gVW50cnVzdGVkIHVzZXIsdW50cnVz
dGVkIHBhdGgJCT0gVXNlciBpcyBub3QgYWJsZSB0byBydW4gdGhlIGV4ZWN1dGFibGUuIw0KKzEw
LiBVbnRydXN0ZWQgdXNlcix1bnRydXN0ZWQgcGF0aCx0cnVzdGVkIGdyb3VwCT0gVXNlciBpcyBh
YmxlIHRvIHJ1biB0aGUgZXhlY3V0YWJsZS4NCisxMS4gVW50cnVzdGVkIHVzZXIsdW50cnVzdGVk
IHBhdGgsdW50cnVzdGVkIGdyb3VwPSBVc2VyIGlzIG5vdCBhYmxlIHRvIHJ1biB0aGUgZXhlY3V0
YWJsZS4jDQorDQorSW4gc2hvcnQsIGlmIHRoZSBwYXRoIGFuZCB1c2VyIGFyZSBib3RoIHVudHJ1
c3RlZCAoYW5kIGFsc28gaWYgdGhlIGdyb3VwDQoraXMgdW50cnVzdGVkKSwgZXhlY3V0aW9uIHdp
bGwgYmUgZGVuaWVkIHNlbmRpbmcgYSBtZXNzYWdlIHdpdGggdGhlIHVpZCxnaWQsDQorZXVpZCxl
Z2lkLHBpZCBhbmQgYmluYXJ5IHRoYXQgY2F1c2VkIHRoZSBldmVudC4NCisNCitJbiBvcmRlciB0
byBhY3R1YWxseSBtb2RpZnkgdGhlIGFjY2VzcyBjb250cm9sIGxpc3QgZm9yIFRQRSwgdGhlIG1v
ZHVsZSB1c2VzDQorYSBzeXNmcyBzdWJzeXN0ZW0gY2FsbGVkIHRwZWZzLiBUaGUgdHBlZnMgY29u
dGFpbnMgZm91ciBmaWxlczsgYWRkLCBkZWwsIGFkZC1ncm91cA0KK2FuZCBkZWwtZ3JvdXAuDQor
UGVyZm9ybWluZyByZWFkIGFuZCB3cml0ZSBvcGVyYXRpb25zIG9uIHRoZSBhZm9yZW1lbnRpb25l
ZCBmaWxlcyBjcmVhdGVzIGEgdXNlcg0KK3RvIHN5c3RlbSBpbnRlcmZhY2UgdGhhdCB3aWxsIGFs
dGVyIHRoZSBUUEUgYWNjZXNzIGNvbnRyb2wgbGlzdC4gU2VlIA0KKyJNb2RpZnlpbmcgdGhlIFRQ
RSBBY2Nlc3MgQ29udHJvbCBMaXN0cyIgYmVsb3cgZm9yIHRoZSBtZXRob2RzIG9mIGFsdGVyaW5n
IHRoZSBsaXN0IA0KK3VzaW5nIHRoZXNlIGZpbGVzLg0KK05vdGU6IFRoZSBvcmlnaW5hbCB0d28g
ZmlsZSBhcHByb2FjaCB3YXMgdXRpbGl6ZWQgcmF0aGVyIHRoYW4gYSBzaW5nbGUgZmlsZSBpbiBv
cmRlciB0bw0KK2tlZXAgdGhlIGNvZGUgYW5kIGFkbWluaXN0cmF0aW9uIG9mIHRoZSBtb2R1bGUg
c2ltcGxlIGZvciBib3RoIHRoZSBrZXJuZWwgYW5kDQordGhlIHVzZXIsIGFuZCBpdCB3YXMgd2hl
biBvbmx5IHVpZC1iYXNlZCBhY2Nlc3MgY29udHJvbCBsaXN0cyB3ZXJlIHN1cHBvcnRlZCwgbm93
DQoraSd2ZSBmb2xsb3dlZCB0aGUgc2FtZSBzdHlsZSB0byBwcm92aWRlIGJhY2t3YXJkcyBjb21w
YXRpYmlsaXR5Lg0KKw0KK0luc3RhbGxhdGlvbjogDQorMS4gUmVjb21waWxlIHRoZSBrZXJuZWwg
dG8gaW5jbHVkZSBMU00gYW5kIFRQRSBhcyBhIG1vZHVsZSAob3IgZXZlbiBnZXQgYQ0KKyAgIGtl
cm5lbC1pbmRlcGVuZGVudCBwYWNrYWdlZCBUUEUgbW9kdWxlLg0KKzIuIG1vdW50IC10IHN5c2Zz
IHN5c2ZzIDxtb3VudHBvaW50Pg0KKzMuIG1vZHByb2JlIHRwZSBkZWJ1Zz0xLzAgKGlmIHlvdSB3
YW50IHRvIHVzZSBkZWJ1Z2dpbmcgc2V0IHRvIDEpDQorNC4gU2VlICJNb2RpZnlpbmcgdGhlIFRQ
RSBBY2Nlc3MgQ29udHJvbCBMaXN0cyIgYmVsb3cgIGZvciBpbnN0cnVjdGlvbnMgb24gaG93IHRv
IA0KK2FkZC9kZWxldGUgdXNlcnMgYW5kIGdyb3VwcyB0by9mcm9tIHRoZSBsaXN0Lg0KKw0KK01v
ZGlmeWluZyB0aGUgVFBFIEFjY2VzcyBDb250cm9sIExpc3RzOg0KKw0KKy0gQWRkaW5nIGEgdXNl
cgkJOiBlY2hvIDx1aWQ+ID4gPG1vdW50cG9pbnQ+L3RwZWZzL2FkZA0KKy0gRGVsZXRpbmcgYSB1
c2VyCTogZWNobyA8dWlkPiA+IDxtb3VudHBvaW50Pi90cGVmcy9kZWwNCistIEFkZGluZyBhIGdy
b3VwCTogZWNobyA8Z2lkPiA+IDxtb3VudHBvaW50Pi90cGVmcy9hZGQtZ3JvdXANCistIERlbGV0
aW5nIGEgZ3JvdXAJOiBlY2hvIDxnaWQ+ID4gPG1vdW50cG9pbnQ+L3RwZWZzL2RlbC1ncm91cA0K
Ky0gU2hvdyB1aWQgbGlzdCB0byB1c2Vyc3BhY2U6IGNhdCA8bW91bnRwb2ludD4vdHBlZnMvYWRk
DQorLSBTaG93IGdpZCBsaXN0IHRvIHVzZXJzcGFjZTogY2F0IDxtb3VudHBvaW50Pi90cGVmcy9h
ZGQtZ3JvdXANCistIFNob3cgdmVyc2lvbiBhbmQgc3RhdGlzdGljcyBpbmZvcm1hdGlvbjogY2F0
IC9wcm9jL3RwZQ0KKw0KK05vdGU6IEFkdmFuY2VkIHVzZXJzIHdvdWxkIGJlIGludGVyZXN0ZWQg
aW4gd3JpdGluZyBhIHNjcmlwdCBvciBzb21ldGhpbmcNCit0byBtb2RpZnkgdGhlIGFjY2VzcyBj
b250cm9sIGxpc3RzIGluIGEgZmluZS1ncmFpbmVkIG1hbm5lciwgYnV0IHRoaXMgaXMgb3V0DQor
b2YgdGhlIGdvYWxzIG9mIHRoZSBUUEUgZGV2ZWxvcG1lbnQsIGFueXdheSwgZmVlbCBmcmVlIHRv
IHNlbmQgeW91ciBjb250cmlidXRpb25zDQordG8gbG9yZW56b0BnbnUub3JnLg0KZGlmZiAtTnVy
IC4uL2xpbnV4LTIuNi4xMC9zZWN1cml0eS9LY29uZmlnIGxpbnV4LTIuNi4xMC10cGUvc2VjdXJp
dHkvS2NvbmZpZw0KLS0tIC4uL2xpbnV4LTIuNi4xMC9zZWN1cml0eS9LY29uZmlnCTIwMDUtMDEt
MDMgMTk6NDM6MDUuMDAwMDAwMDAwICswMTAwDQorKysgbGludXgtMi42LjEwLXRwZS9zZWN1cml0
eS9LY29uZmlnCTIwMDUtMDEtMDYgMDM6NDU6MDkuMTE1MjUyNTI4ICswMTAwDQpAQCAtODQsNiAr
ODQsMzcgQEANCiANCiAJICBJZiB5b3UgYXJlIHVuc3VyZSBob3cgdG8gYW5zd2VyIHRoaXMgcXVl
c3Rpb24sIGFuc3dlciBOLg0KIA0KK2NvbmZpZyBTRUNVUklUWV9UUEUNCisJdHJpc3RhdGUgIlRy
dXN0ZWQgUGF0aCBFeGVjdXRpb24gKEVYUEVSSU1FTlRBTCkiDQorCWRlcGVuZHMgb24gU0VDVVJJ
VFkgJiYgRVhQRVJJTUVOVEFMDQorCWhlbHANCisJICBUaGUgVFBFIG1vZHVsZSBlbmZvcmNlcyBh
IGNoZWNrIG9uIHRoZSBydW5uaW5nIG9mIGV4ZWN1dGFibGVzLg0KKwkgIEl0IHdpbGwgbm90IGFs
bG93IGV4ZWN1dGlvbiBpZiB0aGUgcHJvZ3JhbSBpcyBsb2NhdGVkIGluIGEgDQorCSAgInRydXN0
ZWQgcGF0aCIgYW5kIHRoZSBjdXJyZW50IHVzZXIgaXMgInVudHJ1c3RlZCIuIEEgdHJ1c3RlZA0K
KwkgIHBhdGggaXMgb25lIHdoaWNoIGlzIHJvb3Qgb3duZWQgYW5kIG5laXRoZXIgZ3JvdXAgbm9y
IG90aGVyIA0KKyAgIAkgIHdyaXRlYWJsZS4gQW4gdXNlciBpcyBjb25zaWRlcmVkIHRydXN0ZWQg
aWYgdGhlaXIgdWlkIGlzIGFkZGVkDQorIAkgIHRvIGEgdHJ1c3RlZCBsaXN0IGluIG1lbW9yeSwg
YWxzbywgdXNlciBncm91cHMgY2FuIGJlIHRydXN0ZWQNCisgCSAgaW4ga2VybmVsIGNvbXBpbGUt
dGltZSBhbmQgcnVudGltZSBieSBhZGRpbmcgdGhlbSB0byB0aGUgZ2lkLWJhc2lzDQorIAkgIGFj
Y2VzcyBjb250cm9sIGxpc3QuUm9vdCBpcyB0cnVzdGVkLCBieSBkZWZhdWx0LkEgcHJvYyBpbnRl
cmZhY2UNCisgCSAgL3Byb2MvdHBlIGlzIGNyZWF0ZWQgd2hlbiBtb2R1bGUgbG9hZHMsIGl0IHNo
b3dzIHZlcnNpb24gYW5kIEFDTA0KKyAJICBpbmZvcm1hdGlvbiB0byB1c2UgdGhpcmQtcGFydHkg
Y2hlY2tlcnMgb3Igc2NyaXB0cy4NCisJICBPcmlnaW5hbCBjb2RlIGZvciAyLjUuNTkgYnkgTmlr
aSBBLiBSYWhpbWkgPG5hcmFoaW1pQHVzLmlibS5jb20+Lg0KKwkgIA0KKwkgIChjKSAyMDA1LCBM
b3JlbnpvIEhlcm5hbmRleiBHYXJjaWEtSGllcnJvIDxsb3JlbnpvQGdudS5vcmc+Lg0KKwkgIA0K
KwkgIFJlYWQgLi9Eb2N1bWVudGF0aW9uL3RwZS1sc20udHh0IGZvciBtb3JlIGluZm9ybWF0aW9u
LgkgIA0KKwkgIElmIHlvdSBhcmUgdW5zdXJlIGhvdyB0byBhbnN3ZXIgdGhpcyBxdWVzdGlvbiwg
YW5zd2VyIE4uDQorDQorY29uZmlnIFNFQ1VSSVRZX1RQRV9UUlVTVEVEX0dJRA0KKwlpbnQgIkdJ
RCBmb3IgdHJ1c3RlZCB1c2VycyINCisJZGVwZW5kcyBvbiBTRUNVUklUWV9UUEUNCisJZGVmYXVs
dCAxMzM3DQorCWhlbHANCisJIFVzZXJzIHdpdGggdGhlIHByaW1hcnkgZ3JvdXAgaWQgZ2l2ZW4g
aGVyZSB3aWxsIG5vdCBiZSBzdWJqZWN0IHRvIHRoZSANCisJIHRydXN0ZWQgcGF0aCByZXN0cmlj
dGlvbnMgYnkgZGVmYXVsdC4gVGhlc2UgdXNlcnMgd2lsbCB0aGVyZWZvcmUNCisJIHJlcHJlc2Vu
dCBhIHNlY3VyaXR5IHJpc2sgdG8gdGhlbXNlbHZlcyBhbmQgcG90ZW50aWFsbHkgdG8gdGhlIHN5
c3RlbS4NCisJIFBsZWFzZSBiZSBzdXJlIHRoYXQgeW91IGNhbiB0cnVzdCB0aGUgbWVtYmVycyBv
ZiB0aGlzIGdyb3VwLg0KKwkgDQogc291cmNlIHNlY3VyaXR5L3NlbGludXgvS2NvbmZpZw0KIA0K
IGVuZG1lbnUNCmRpZmYgLU51ciAuLi9saW51eC0yLjYuMTAvc2VjdXJpdHkvTWFrZWZpbGUgbGlu
dXgtMi42LjEwLXRwZS9zZWN1cml0eS9NYWtlZmlsZQ0KLS0tIC4uL2xpbnV4LTIuNi4xMC9zZWN1
cml0eS9NYWtlZmlsZQkyMDA1LTAxLTAzIDE5OjQzOjA1LjAwMDAwMDAwMCArMDEwMA0KKysrIGxp
bnV4LTIuNi4xMC10cGUvc2VjdXJpdHkvTWFrZWZpbGUJMjAwNS0wMS0wNCAwMjoxMDo0NS4wMDAw
MDAwMDAgKzAxMDANCkBAIC0xNywzICsxNyw0IEBADQogb2JqLSQoQ09ORklHX1NFQ1VSSVRZX0NB
UEFCSUxJVElFUykJKz0gY29tbW9uY2FwLm8gY2FwYWJpbGl0eS5vDQogb2JqLSQoQ09ORklHX1NF
Q1VSSVRZX1JPT1RQTFVHKQkJKz0gY29tbW9uY2FwLm8gcm9vdF9wbHVnLm8NCiBvYmotJChDT05G
SUdfU0VDVVJJVFlfU0VDTFZMKQkJKz0gc2VjbHZsLm8NCitvYmotJChDT05GSUdfU0VDVVJJVFlf
VFBFKQkJKz0gdHBlLm8NCmRpZmYgLU51ciAuLi9saW51eC0yLjYuMTAvc2VjdXJpdHkvdHBlLmMg
bGludXgtMi42LjEwLXRwZS9zZWN1cml0eS90cGUuYw0KLS0tIC4uL2xpbnV4LTIuNi4xMC9zZWN1
cml0eS90cGUuYwkxOTcwLTAxLTAxIDAxOjAwOjAwLjAwMDAwMDAwMCArMDEwMA0KKysrIGxpbnV4
LTIuNi4xMC10cGUvc2VjdXJpdHkvdHBlLmMJMjAwNS0wMS0wNiAwMjo1MTozNS4wMDAwMDAwMDAg
KzAxMDANCkBAIC0wLDAgKzEsNjI0IEBADQorLyoNCisgKiBUcnVzdGVkIFBhdGggRXhlY3V0aW9u
IFNlY3VyaXR5IE1vZHVsZQ0KKyAqDQorICogVGhpcyBtb2R1bGUgcHJvdmlkZXMgYSBUcnVzdGVk
IFBhdGggRXhlY3V0aW9uIChUUEUpIGVuZ2luZSB0byB0aGUNCisgKiBMaW51eCBrZXJuZWwuIFRQ
RSBvcmlnaW5hdGVkIGFzIGEga2VybmVsIHBhdGNoIHRvIE9wZW5CU0QgMi40IGJ5DQorICogcm91
dGV8ZGFlbW9uOSBhbmQgTWlrZSBTY2hpZm1hbiAoc2VlIFBocmFjayA1NCkuIElCTSBvcmlnaW5h
bGx5IG1vZGlmaWVkDQorICogdGhlIG9yaWdpbmFsIHByb2plY3QgdG8gZml0IHdpdGhpbiB0aGUg
Y29uc3RyYWludHMgb2YgdGhlIExTTSBmcmFtZXdvcmsNCisgKiBhbmQgc28gaXQgc2hvdWxkIGJl
IG5vdGVkIHRoYXQgdGhpcyBpcyBub3QgdGhlIHNhbWUgcHJvamVjdC4gQWxzbywNCisgKiB0aGUg
bW9kdWxlIG1ha2VzIHVzZSBvZiB0aGUgc3lzZnMgZmlsZXN5c3RlbS4gDQorICogSSByZXdyb3Rl
IHRoZSBtb2R1bGUgaW4gb3JkZXIgdG8gYWRkIGRlYnVnZ2luZywgYmV0dGVyIGluZm9ybWF0aW9u
DQorICogb3V0cHV0dGluZywgc3VwcG9ydCBmb3IgcGVyLVVzZXItR3JvdXBzIGFjY2VzcyBjb250
cm9sIGxpc3RzIGF0IHJ1bnRpbWUNCisgKiBhbmQga2VybmVsLWNvbmZpZ3VyYXRpb24gbGV2ZWws
IGEgcHJvY2ZzIGludGVyZmFjZSBmb3IgZ2VuZXJhbCBpbmZvcm1hdGlvbg0KKyAqIGdhdGhlcmlu
ZyBmcm9tIHRoZSBUUEUgc3Vic3lzdGVtIGFuZCBhIGZldyBvdGhlciBlbmhhbmNlbWVudHMgd2hp
Y2ggbWFrZSB0aGUNCisgKiBjb2RlIGFsbW9zdCBhIGNvbXBsZXRlIHJld3JpdGUuDQorICoNCisg
KiBDb3B5cmlnaHQgKEMpIDE5OTggcm91dGV8ZGFlbW9uOSBhbmQgTWlrZSBELiBTY2hpZmZtYW4N
CisgKiBDb3B5cmlnaHQgKEMpIDIwMDEtMjAwMiAgR3JlZyBLcm9haC1IYXJ0bWFuIDxncmVna2hA
dXMuaWJtLmNvbT4NCisgKiBDb3B5cmlnaHQgKEMpIDIwMDMgSUJNIENvcnAuIDxuYXJhaGltaUB1
cy5pYm0uY29tPg0KKyAqIENvcHlyaWdodCAoQykgMjAwNSBMb3JlbnpvIEhlcm5hbmRleiBHYXJj
aWEtSGllcnJvIDxsb3JlbnpvQGdudS5vcmc+DQorICogQWxsIHJpZ2h0cyByZXZlcnNlZC4NCisg
Kg0KKyAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0
ZSBpdCBhbmQvb3INCisgKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2Vu
ZXJhbCBQdWJsaWMgTGljZW5zZQ0KKyAqIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2Fy
ZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyDQorICogb2YgdGhlIExpY2Vuc2UsIG9yIChh
dCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uDQorICoNCisgKiBUaGlzIHByb2dyYW0g
aXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwNCisgKiBi
dXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50
eSBvZg0KKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVS
UE9TRS4gIFNlZSB0aGUNCisgKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBk
ZXRhaWxzLg0KKyAqLw0KKw0KKyNpbmNsdWRlIDxsaW51eC9jb25maWcuaD4NCisjaW5jbHVkZSA8
bGludXgvbW9kdWxlLmg+DQorI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4NCisjaW5jbHVkZSA8bGlu
dXgvc21wX2xvY2suaD4NCisjaW5jbHVkZSA8bGludXgvaW5pdC5oPg0KKyNpbmNsdWRlIDxsaW51
eC9rZXJuZWwuaD4NCisjaW5jbHVkZSA8bGludXgvc2VjdXJpdHkuaD4NCisjaW5jbHVkZSA8bGlu
dXgvc2tidWZmLmg+IA0KKyNpbmNsdWRlIDxsaW51eC9uZXRsaW5rLmg+IA0KKyNpbmNsdWRlIDxs
aW51eC90eXBlcy5oPg0KKyNpbmNsdWRlIDxsaW51eC9mcy5oPg0KKyNpbmNsdWRlIDxhc20vdWFj
Y2Vzcy5oPg0KKyNpbmNsdWRlIDxsaW51eC9wYWdlbWFwLmg+DQorI2luY2x1ZGUgPGxpbnV4L25h
bWVpLmg+IA0KKyNpbmNsdWRlIDxsaW51eC92ZnMuaD4NCisjaW5jbHVkZSA8bGludXgvbW91bnQu
aD4NCisjaW5jbHVkZSA8bGludXgvc3RyaW5nLmg+DQorI2luY2x1ZGUgPGxpbnV4L3N5c2ZzLmg+
DQorI2luY2x1ZGUgPGxpbnV4L3Byb2NfZnMuaD4NCisNCisjaW5jbHVkZSAidHBlLmgiDQorDQor
c3RhdGljIGludCBzZWNvbmRhcnk7DQorc3RhdGljIHNwaW5sb2NrX3QgdHBlX2FjbF9sb2NrID0g
U1BJTl9MT0NLX1VOTE9DS0VEOw0KK3N0YXRpYyBzcGlubG9ja190IHRwZV9ncm91cF9hY2xfbG9j
ayA9IFNQSU5fTE9DS19VTkxPQ0tFRDsNCisNCisvKiBkZWJ1Z2dpbmcgKi8NCitzdGF0aWMgaW50
IGRlYnVnID0gMDsNCisNCisvKiBnZXQgZGVidWc9MS8wIHBhcmFtICovDQorbW9kdWxlX3BhcmFt
KGRlYnVnLCBib29sLCAwNjAwKTsNCitNT0RVTEVfUEFSTV9ERVNDKGRlYnVnLCAiRGVidWcgZW5h
YmxlZCBvciBub3QiKTsNCisNCisjaWYgZGVmaW5lZChDT05GSUdfU0VDVVJJVFlfVFBFX01PRFVM
RSkNCisjZGVmaW5lIE1ZX05BTUUgVEhJU19NT0RVTEUtPm5hbWUNCisjZWxzZQ0KKyNkZWZpbmUg
TVlfTkFNRSAiVFBFIg0KKyNkZWZpbmUgTEVHQUNZX05BTUUgInRwZSINCisjZW5kaWYNCisNCisv
KiBNb2R1bGUgaW5mb3JtYXRpb24gKi8NCisjZGVmaW5lIERFU0NSSVBUSU9OICJUcnVzdGVkIFBh
dGggRXhlY3V0aW9uIExTTSBJbXBsZW1lbnRhdGlvbiINCisjZGVmaW5lIEFVVEhPUiAiTG9yZW56
byBIZXJuYW5kZXogR2FyY2lhLUhpZXJybyA8bG9yZW56b0BnbnUub3JnPiINCisjZGVmaW5lIExJ
Q0VOU0UgIkdQTCINCisNCisvKiBUUEUgL3Byb2MgZW50cnkgKi8NCitzdHJ1Y3QgcHJvY19kaXJf
ZW50cnkgKlRQRV9wZW50cnk7DQorDQorLyogT3V0cHV0dGluZyBhbmQgZGVidWdnaW5nIGZ1bmN0
aW9ucyAqLw0KKy8qIERlYnVnIHNob3VsZCBiZSBleHBsaWNpdGx5IGVuYWJsZWQgKGRlYnVnPTEp
IHRvIGdpdmUgb3V0cHV0IGJhY2sgZnJvbSBkYmcoKSAqLw0KKyNkZWZpbmUgZGJnKGZtdCwgYXJn
Li4uKQkJCQkJCQlcDQorCQlkbyB7CQkJCQkJCQlcDQorCQlpZiAoMSAmJiBkZWJ1ZykgIHsJCQkJ
CQlcDQorCQkJcHJpbnRrKEtFUk5fREVCVUcgIiVzOiAiIGZtdCAsIE1ZX05BTUUsICMjIGFyZyk7
CVwNCisJCQl9CQkJCQkJCVwNCisJCX0gd2hpbGUgKDApCQkJCQkJDQorDQorLyogS0VSTl9JTkZP
IG1lc3NhZ2VzIHVzZSBraW5mbygpIHJhdGhlciB0aGFuIHByaW50aygpIGZvciBiZXR0ZXIgb3V0
cHV0dGluZyBsYXlvdXQgKi8NCisjZGVmaW5lIGtpbmZvKGZtdCwgYXJnLi4uKQkJCQkJCQlcDQor
CQlkbyB7CQkJCQkJCQlcDQorCQlpZiAoMSkgIHsJCQkJCQkJXA0KKwkJCXByaW50ayhLRVJOX0lO
Rk8gIiVzOiAiIGZtdCAsIE1ZX05BTUUsICMjIGFyZyk7CQlcDQorCQkJfQkJCQkJCQlcDQorCQl9
IHdoaWxlICgwKQ0KKw0KKw0KKy8qICBJbnNlcnRpb24gc29ydCB0aGUgbGlzdC4gKi8NCitzdGF0
aWMgdm9pZCB0cGVfc29ydCAoaW50IGxvdywgaW50IGhpZ2gpICAvKiAobGlzdCBsb3cgZWxlbWVu
dCwgbGlzdCBoaWdoIGVsZW1lbnQpICovDQorew0KKyAgICAgICBpbnQgaSxqLG47DQorICAgICAg
IC8qIFN0YW5kYXJkIGluc2VydGlvbiBzb3J0LiAqLw0KKyAgICAgICBmb3IgKGkgPSBsb3cgKyAx
OyBpIDw9IGhpZ2g7IGkrKykgew0KKyAgICAgICAgICAgICAgIGlmICh0cGVfYWNsW2ldIDwgdHBl
X2FjbFtsb3ddKSB7DQorICAgICAgICAgICAgICAgICAgICAgICB0cGVfYWNsW2xvd10gXj0gdHBl
X2FjbFtpXTsNCisgICAgICAgICAgICAgICAgICAgICAgIHRwZV9hY2xbaV0gXj0gdHBlX2FjbFts
b3ddOw0KKyAgICAgICAgICAgICAgICAgICAgICAgdHBlX2FjbFtsb3ddIF49IHRwZV9hY2xbaV07
DQorICAgICAgICAgICAgICAgfSANCisgICAgICAgfQ0KKyAgICAgICAvKiB0cGVfYWNsICovDQor
ICAgICAgIGZvciAoaSA9IGxvdyArIDI7IGkgPD0gaGlnaDsgaSsrKSB7DQorICAgICAgICAgICAg
ICAgaiA9IGk7DQorICAgICAgICAgICAgICAgbiA9IHRwZV9hY2xbaV07DQorICAgICAgICAgICAg
ICAgd2hpbGUgKG4gPCB0cGVfYWNsW2ogLSAxXSkgew0KKyAgICAgICAgICAgICAgICAgICAgICAg
dHBlX2FjbFtqXSA9IHRwZV9hY2xbaiAtIDFdOw0KKyAgICAgICAgICAgICAgICAgICAgICAgai0t
Ow0KKyAgICAgICAgICAgICAgIH0NCisgICAgICAgICAgICAgICB0cGVfYWNsW2pdID0gbjsNCisg
ICAgICAgfQ0KK30NCitzdGF0aWMgdm9pZCB0cGVfZ3JvdXBfc29ydCAoaW50IGxvdywgaW50IGhp
Z2gpICAvKiAobGlzdCBsb3cgZWxlbWVudCwgbGlzdCBoaWdoIGVsZW1lbnQpICovDQorew0KKyAg
ICAgICBpbnQgaSxqLG47DQorICAgICAgIC8qIFN0YW5kYXJkIGluc2VydGlvbiBzb3J0IGZvciB0
cGVfZ3JvdXBfYWNsLiAqLw0KKyAgICAgICBmb3IgKGkgPSBsb3cgKyAxOyBpIDw9IGhpZ2g7IGkr
Kykgew0KKyAgICAgICAgICAgICAgIGlmICh0cGVfZ3JvdXBfYWNsW2ldIDwgdHBlX2dyb3VwX2Fj
bFtsb3ddKSB7DQorICAgICAgICAgICAgICAgICAgICAgICB0cGVfZ3JvdXBfYWNsW2xvd10gXj0g
dHBlX2dyb3VwX2FjbFtpXTsNCisgICAgICAgICAgICAgICAgICAgICAgIHRwZV9ncm91cF9hY2xb
aV0gXj0gdHBlX2dyb3VwX2FjbFtsb3ddOw0KKyAgICAgICAgICAgICAgICAgICAgICAgdHBlX2dy
b3VwX2FjbFtsb3ddIF49IHRwZV9ncm91cF9hY2xbaV07DQorICAgICAgICAgICAgICAgfSANCisg
ICAgICAgfQ0KKyAgICAgICAvKiB0cGVfZ3JvdXBfYWNsICovDQorICAgICAgIGZvciAoaSA9IGxv
dyArIDI7IGkgPD0gaGlnaDsgaSsrKSB7DQorICAgICAgICAgICAgICAgaiA9IGk7DQorICAgICAg
ICAgICAgICAgbiA9IHRwZV9ncm91cF9hY2xbaV07DQorICAgICAgICAgICAgICAgd2hpbGUgKG4g
PCB0cGVfZ3JvdXBfYWNsW2ogLSAxXSkgew0KKyAgICAgICAgICAgICAgICAgICAgICAgdHBlX2dy
b3VwX2FjbFtqXSA9IHRwZV9ncm91cF9hY2xbaiAtIDFdOw0KKyAgICAgICAgICAgICAgICAgICAg
ICAgai0tOw0KKyAgICAgICAgICAgICAgIH0NCisgICAgICAgICAgICAgICB0cGVfZ3JvdXBfYWNs
W2pdID0gbjsNCisgICAgICAgfQ0KK30NCisNCisvKiAgQXR0ZW1wdCB0byBhZGQgYW4gVUlEIGNh
bmRpZGF0ZSB0byB0aGUgbGlzdC4gICovDQorc3RhdGljIGludCB0cGVfYWRkICh1aWRfdCBhZGRf
Y2FuZGlkYXRlKQ0KK3sNCisgICAgICAgaW50IHJldHZhbCA9IC1FSU5WQUw7DQorDQorICAgICAg
IC8qIEZ1bGwgbGlzdC4gKi8NCisgICAgICAgaWYgKHRwZV9hY2xfY2FuZGlkYXRlcyA9PSAoVFBF
X0FDTF9TSVpFIC0gMikpIHsNCisgICAgICAgICAgICAgICBraW5mbygiVW5hYmxlIHRvIGFkZCB1
c2VyICVkLiBMaXN0IGlzIGZ1bGwuXG4iLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGFkZF9jYW5kaWRhdGUpOw0KKyAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KKyAgICAgICB9
DQorIA0KKyAgICAgICBpZiAoYWRkX2NhbmRpZGF0ZSA9PSAwKSB7DQorICAgICAgICAgICAgICAg
a2luZm8oIkludmFsaWQgdXNlciBpZC4gQ2Fubm90IGFkZC5cbiIpOw0KKyAgICAgICAgICAgICAg
IGdvdG8gb3V0Ow0KKyAgICAgICB9DQorDQorICAgICAgIC8qIERvbid0IGFkZCBkdXBsaWNhdGVz
ICovDQorICAgICAgIGlmICgodHBlX3NlYXJjaChhZGRfY2FuZGlkYXRlKSkgPT0gTkFDSykgew0K
KyAgICAgICAgICAgICAgIC8qIEFkZCB0byB0aGUgZW5kIG9mIHRoZSBsaXN0LCB0aGVuIHNvcnQu
ICovDQorICAgICAgICAgICAgICAgdHBlX2FjbF9jYW5kaWRhdGVzKys7DQorICAgICAgICAgICAg
ICAgdHBlX2FjbFt0cGVfYWNsX2NhbmRpZGF0ZXNdID0gYWRkX2NhbmRpZGF0ZTsNCisgICAgICAg
ICAgICAgICB0cGVfYWNsW3RwZV9hY2xfY2FuZGlkYXRlcyArIDFdID0gJ1wwJzsgLyogdGVybWlu
YXRlIGFycmF5ICovDQorICAgICAgICAgICAgICAgdHBlX3NvcnQoMCwgdHBlX2FjbF9jYW5kaWRh
dGVzKTsNCisgICAgICAgICAgICAgICBraW5mbygiVUlEICVkIGFkZGVkIGFzIHRydXN0ZWQgdG8g
YWNjZXNzIGNvbnRyb2wgbGlzdFxuIiwNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBhZGRfY2FuZGlkYXRlKTsNCisgICAgICAgfSBlbHNlIHsNCisgICAgICAgICAgICAgICBraW5m
bygiRHVwbGljYXRlIFVJRCAlZCBub3QgYWRkZWRcbiIsDQorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgYWRkX2NhbmRpZGF0ZSk7DQorICAgICAgICAgICAgICAgZ290byBvdXQ7DQor
ICAgICAgIH0NCisgICAgICAgcmV0dmFsID0gMDsNCitvdXQ6DQorICAgICAgIHJldHVybiByZXR2
YWw7DQorfQ0KKw0KKy8qICBBdHRlbXB0IHRvIGFkZCBhbiBHSUQgY2FuZGlkYXRlIHRvIHRoZSBs
aXN0LiAgKi8NCitzdGF0aWMgaW50IHRwZV9ncm91cF9hZGQgKGdpZF90IGFkZF9jYW5kaWRhdGUp
DQorew0KKyAgICAgICBpbnQgcmV0dmFsID0gLUVJTlZBTDsNCisNCisgICAgICAgLyogRnVsbCBs
aXN0LiAqLw0KKyAgICAgICBpZiAodHBlX2FjbF9ncm91cF9jYW5kaWRhdGVzID09IChUUEVfQUNM
X1NJWkUgLSAyKSkgew0KKyAgICAgICAgICAgICAgIGtpbmZvKCJVbmFibGUgdG8gYWRkIHVzZXIg
JWQuIExpc3QgaXMgZnVsbC5cbiIsDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
YWRkX2NhbmRpZGF0ZSk7DQorICAgICAgICAgICAgICAgZ290byBvdXQ7DQorICAgICAgIH0NCisg
DQorICAgICAgIGlmIChhZGRfY2FuZGlkYXRlID09IDApIHsNCisgICAgICAgICAgICAgICBraW5m
bygiSW52YWxpZCB1c2VyaWQuIENhbm5vdCBhZGQuXG4iKTsNCisgICAgICAgICAgICAgICBnb3Rv
IG91dDsNCisgICAgICAgfQ0KKw0KKyAgICAgICAvKiBEb24ndCBhZGQgZHVwbGljYXRlcyAqLw0K
KyAgICAgICBpZiAoKHRwZV9zZWFyY2hfZ3JvdXAoYWRkX2NhbmRpZGF0ZSkpID09IE5BQ0spIHsN
CisgICAgICAgICAgICAgICAvKiBBZGQgdG8gdGhlIGVuZCBvZiB0aGUgbGlzdCwgdGhlbiBzb3J0
LiAqLw0KKyAgICAgICAgICAgICAgIHRwZV9hY2xfZ3JvdXBfY2FuZGlkYXRlcysrOw0KKyAgICAg
ICAgICAgICAgIHRwZV9ncm91cF9hY2xbdHBlX2FjbF9ncm91cF9jYW5kaWRhdGVzXSA9IGFkZF9j
YW5kaWRhdGU7DQorICAgICAgICAgICAgICAgdHBlX2dyb3VwX2FjbFt0cGVfYWNsX2dyb3VwX2Nh
bmRpZGF0ZXMgKyAxXSA9ICdcMCc7IC8qIHRlcm1pbmF0ZSBhcnJheSAqLw0KKyAgICAgICAgICAg
ICAgIHRwZV9ncm91cF9zb3J0KDAsIHRwZV9hY2xfZ3JvdXBfY2FuZGlkYXRlcyk7DQorICAgICAg
ICAgICAgICAga2luZm8oIkdJRCAlZCBhZGRlZCBhcyB0cnVzdGVkIHRvIGFjY2VzcyBjb250cm9s
IGxpc3RcbiIsDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkX2NhbmRpZGF0
ZSk7DQorICAgICAgIH0gZWxzZSB7DQorICAgICAgICAgICAgICAga2luZm8oIkR1cGxpY2F0ZSBH
SUQgJWQgbm90IGFkZGVkXG4iLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFk
ZF9jYW5kaWRhdGUpOw0KKyAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KKyAgICAgICB9DQorICAg
ICAgIHJldHZhbCA9IDA7DQorb3V0Og0KKyAgICAgICByZXR1cm4gcmV0dmFsOw0KK30gDQorIA0K
Ky8qICBBdHRlbXB0IHRvIHJlbW92ZSBhIGNhbmRpZGF0ZSBmcm9tIHRoZSBsaXN0LiAgT25seSBm
YWlscyBpZiB0aGUgZW50cnkgaXMgKi8NCisvKiAgbm90IHRoZXJlLiAqLw0KK3N0YXRpYyBpbnQg
dHBlX3JlbW92ZSAodWlkX3QgcmVtX2NhbmRpZGF0ZSkNCit7DQorICAgICAgIGludCBuOw0KKyAg
ICAgICBpbnQgcmV0dmFsID0gLUVJTlZBTDsNCisgICAgICAgaWYgKHRwZV9hY2xfY2FuZGlkYXRl
cyA9PSAwKSB7DQorICAgICAgICAgICAgICAgLyogRW1wdHkgbGlzdCAqLw0KKyAgICAgICAgICAg
ICAgIGdvdG8gb3V0Ow0KKyAgICAgICB9DQorICAgICAgIGlmIChyZW1fY2FuZGlkYXRlID09IDAp
IHsNCisgICAgICAgICAgICAgICBraW5mbygiSW52YWxpZCB1c2VyaWQuIENhbm5vdCByZW1vdmUu
XG4iKTsNCisgICAgICAgICAgICAgICBnb3RvIG91dDsNCisgICAgICAgfQ0KKyANCisgICAgICAg
biA9IHRwZV9zZWFyY2gocmVtX2NhbmRpZGF0ZSk7DQorICAgICAgIGlmIChuICE9IE5BQ0spIHsN
CisgICAgICAgICAgICAgICAvKiBSZW1vdmUgY2FuZGlkYXRlIChtYXJrIHNsb3QgYXMgdW51c2Vk
KSwgcmVzb3J0IHRoZSBsaXN0LiAqLw0KKyAgICAgICAgICAgICAgIHRwZV9hY2xbbl0gPSBUUEVf
SU5JVElBTElaRVI7DQorICAgICAgICAgICAgICAgdHBlX2FjbF9jYW5kaWRhdGVzLS07DQorICAg
ICAgICAgICAgICAgdHBlX3NvcnQoMCwgdHBlX2FjbF9jYW5kaWRhdGVzKTsNCisgICAgICAgICAg
ICAgICBraW5mbygiVUlEICVkIHJlbW92ZWQgZnJvbSB0cnVzdCBsaXN0XG4iLA0KKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHJlbV9jYW5kaWRhdGUpOw0KKyAgICAgICAgICAgICAg
IHJldHZhbCA9IDA7DQorICAgICAgICAgICAgICAgZ290byBvdXQ7DQorICAgICAgIH0NCisgICAg
ICAgLyogTm90IGZvdW5kLiAqLw0KKyAgICAgICBraW5mbygiVUlEICVkIG5vdCBmb3VuZCBpbiB0
cnVzdCBsaXN0XG4iLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICByZW1fY2FuZGlkYXRlKTsN
CitvdXQ6DQorICAgICAgIHJldHVybiByZXR2YWw7DQorfQ0KKw0KKy8qIEdJRCByZW1vdmluZyAq
Lw0KK3N0YXRpYyBpbnQgdHBlX2dyb3VwX3JlbW92ZSAoZ2lkX3QgcmVtX2NhbmRpZGF0ZSkNCit7
DQorICAgICAgIGludCBuOw0KKyAgICAgICBpbnQgcmV0dmFsID0gLUVJTlZBTDsNCisgICAgICAg
aWYgKHRwZV9hY2xfZ3JvdXBfY2FuZGlkYXRlcyA9PSAwKSB7DQorICAgICAgICAgICAgICAgLyog
RW1wdHkgZ3JvdXBzIGxpc3QgKi8NCisgICAgICAgICAgICAgICBnb3RvIG91dDsNCisgICAgICAg
fQ0KKyAgICAgICBpZiAocmVtX2NhbmRpZGF0ZSA9PSAwKSB7DQorICAgICAgICAgICAgICAga2lu
Zm8oIkludmFsaWQgR0lELiBDYW5ub3QgcmVtb3ZlLlxuIik7DQorICAgICAgICAgICAgICAgZ290
byBvdXQ7DQorICAgICAgIH0NCisgDQorICAgICAgIG4gPSB0cGVfc2VhcmNoX2dyb3VwKHJlbV9j
YW5kaWRhdGUpOw0KKyAgICAgICBpZiAobiAhPSBOQUNLKSB7DQorICAgICAgICAgICAgICAgLyog
UmVtb3ZlIGNhbmRpZGF0ZSAobWFyayBzbG90IGFzIHVudXNlZCksIHJlc29ydCB0aGUgbGlzdC4g
Ki8NCisgICAgICAgICAgICAgICB0cGVfZ3JvdXBfYWNsW25dID0gVFBFX0lOSVRJQUxJWkVSOw0K
KyAgICAgICAgICAgICAgIHRwZV9hY2xfZ3JvdXBfY2FuZGlkYXRlcy0tOw0KKyAgICAgICAgICAg
ICAgIHRwZV9ncm91cF9zb3J0KDAsIHRwZV9hY2xfZ3JvdXBfY2FuZGlkYXRlcyk7DQorICAgICAg
ICAgICAgICAga2luZm8oIkdJRCAlZCByZW1vdmVkIGZyb20gdHJ1c3QgbGlzdFxuIiwNCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1fY2FuZGlkYXRlKTsNCisgICAgICAgICAg
ICAgICByZXR2YWwgPSAwOw0KKyAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KKyAgICAgICB9DQor
ICAgICAgIC8qIE5vdCBmb3VuZC4gKi8NCisgICAgICAga2luZm8oIkdJRCAlZCBub3QgZm91bmQg
aW4gdHJ1c3QgbGlzdFxuIiwNCisgICAgICAgICAgICAgICAgICAgICAgICAgcmVtX2NhbmRpZGF0
ZSk7DQorb3V0Og0KKyAgICAgICByZXR1cm4gcmV0dmFsOw0KK30NCisNCisNCisvKiBCZWdpbm5p
bmcgb2YgYSBzeXNmcyBzdWJzeXN0ZW0gZm9yIHRwZSAqLw0KK3N0YXRpYyBzdHJ1Y3Qgc3Vic3lz
dGVtIHRwZWZzX3N1YnN5czsNCisNCitzdHJ1Y3QgdHBlX2xpc3Qgew0KKyAgICAgICBjaGFyICpu
YW1lOw0KKyANCisgICAgICAgc3RydWN0IGxpc3RfaGVhZCAgICAgICAgc2xvdF9saXN0Ow0KKyAg
ICAgICBzdHJ1Y3Qga29iamVjdCAgICAgICAgICBrb2JqOw0KK307DQorIA0KK3N0cnVjdCB0cGVm
c19hdHRyaWJ1dGUgew0KKyAgICAgICBzdHJ1Y3QgYXR0cmlidXRlIGF0dHI7DQorICAgICAgIHNz
aXplX3QgKCpzaG93KShzdHJ1Y3QgdHBlX2xpc3QgKiwgY2hhciAqKTsNCisgICAgICAgc3NpemVf
dCAoKnN0b3JlKShzdHJ1Y3QgdHBlX2xpc3QgKiwgY29uc3QgY2hhciAqLCBzaXplX3QpOw0KK307
DQorDQorc3RhdGljIHNzaXplX3QgdHBlZnNfYXR0cl9zaG93KHN0cnVjdCBrb2JqZWN0ICprb2Jq
LCBzdHJ1Y3QgYXR0cmlidXRlICphdHRyLA0KK2NoYXIgKmJ1ZikNCit7DQorICAgICAgIHN0cnVj
dCB0cGVfbGlzdCAqbGlzdCA9IGNvbnRhaW5lcl9vZihrb2JqLCBzdHJ1Y3QgdHBlX2xpc3QsIGtv
YmopOw0KKyAgICAgICBzdHJ1Y3QgdHBlZnNfYXR0cmlidXRlICphdHRyaWJ1dGUgPSBjb250YWlu
ZXJfb2YoYXR0ciwgc3RydWN0DQorICAgICAgIHRwZWZzX2F0dHJpYnV0ZSwgYXR0cik7DQorICAg
ICAgIHJldHVybiBhdHRyaWJ1dGUtPnNob3cgPyBhdHRyaWJ1dGUtPnNob3cobGlzdCwgYnVmKSA6
IDA7DQorfQ0KKw0KK3N0YXRpYyBzc2l6ZV90IHRwZWZzX2F0dHJfc3RvcmUoc3RydWN0IGtvYmpl
Y3QgKmtvYmosIHN0cnVjdCBhdHRyaWJ1dGUgKmF0dHIsDQorY29uc3QgY2hhciAqYnVmLCBzaXpl
X3QgbGVuKQ0KK3sNCisgICAgICAgc3RydWN0IHRwZV9saXN0ICpsaXN0ID0gY29udGFpbmVyX29m
KGtvYmosIHN0cnVjdCB0cGVfbGlzdCwga29iaik7DQorICAgICAgIHN0cnVjdCB0cGVmc19hdHRy
aWJ1dGUgKmF0dHJpYnV0ZSA9IGNvbnRhaW5lcl9vZihhdHRyLCBzdHJ1Y3QNCisgICAgICAgdHBl
ZnNfYXR0cmlidXRlLCBhdHRyKTsNCisgICAgICAgcmV0dXJuIGF0dHJpYnV0ZS0+c3RvcmUgPyBh
dHRyaWJ1dGUtPnN0b3JlKGxpc3QsIGJ1ZiwgbGVuKSA6IDA7DQorfQ0KKw0KK3N0YXRpYyBzdHJ1
Y3Qgc3lzZnNfb3BzIHRwZWZzX3N5c2ZzX29wcyA9IHsNCisgICAgICAgLnNob3cgPSB0cGVmc19h
dHRyX3Nob3csDQorICAgICAgIC5zdG9yZSA9IHRwZWZzX2F0dHJfc3RvcmUsDQorfTsNCisNCitz
dGF0aWMgc3RydWN0IGtvYmpfdHlwZSB0cGVmc19rdHlwZSA9IHsNCisgICAgICAgLnN5c2ZzX29w
cyA9ICZ0cGVmc19zeXNmc19vcHMNCit9Ow0KKw0KK3N0YXRpYyBkZWNsX3N1YnN5cyh0cGVmcywg
JnRwZWZzX2t0eXBlLCBOVUxMKTsNCisNCitzdGF0aWMgc3NpemVfdCB0cnVzdGVkbGlzdGFkZF9y
ZWFkX2ZpbGUgKHN0cnVjdCB0cGVfbGlzdCAqbGlzdCwgY2hhciAqYnVmKQ0KK3sNCisgICAgICAg
aW50IGk7DQorICAgICAgIGludCByZXR2YWwgPSAwOw0KKyAgICAgICBjaGFyICp1c2VyID0gTlVM
TDsNCisgICAgICAgY2hhciBidWZmZXJbNDAwXTsNCisNCisgICAgICAgdXNlciA9IChjaGFyICop
X19nZXRfZnJlZV9wYWdlKEdGUF9LRVJORUwpOw0KKyAgICAgICBpZiAoIXVzZXIpDQorICAgICAg
ICAgICAgICAgcmV0dXJuIC1FTk9NRU07DQorDQorICAgICAgIGlmICh0cGVfYWNsID09IE5VTEwp
IHsNCisgICAgICAgICAgICAgIGtpbmZvKCJFbXB0eSBBY2Nlc3MgQ29udHJvbCBMaXN0XG4iKTsN
CisgICAgICAgICAgICAgICByZXR1cm4gLUVOT0RBVEE7IA0KKyAgICAgICB9DQorDQorICAgICAg
IGJ1ZmZlclswXSA9ICdcMCc7DQorICAgICAgIGtpbmZvKCIlZCB0cnVzdGVkIHVzZXIocyk6IFxu
IiwgdHBlX2FjbF9jYW5kaWRhdGVzKTsNCisgICAgICAgc3Bpbl9sb2NrKCZ0cGVfYWNsX2xvY2sp
Ow0KKyAgICAgICBmb3IgKGk9MDsgaSA8IHRwZV9hY2xfY2FuZGlkYXRlczsgaSsrKSB7DQorICAg
ICAgICAgICAgICAgcHJpbnRrKEtFUk5fSU5GTyAiJWQgIiwgdHBlX2FjbFtpXSk7DQorICAgICAg
ICAgICAgICAgcmV0dmFsID0gc3ByaW50Zih1c2VyLCAiJWRcbiIsIHRwZV9hY2xbaV0pOyANCisg
ICAgICAgICAgICAgICBzdHJjYXQoYnVmZmVyLCB1c2VyKTsNCisgICAgICAgfQ0KKyAgICAgICAv
KiBsZWF2ZSBwcmludGsoKSBjYWxscyBhbG9uZSwgbm90IGtpbmZvKCkgKi8NCisgICAgICAgcHJp
bnRrKEtFUk5fSU5GTyAiXG4iKTsNCisgICAgICAgc3Bpbl91bmxvY2soJnRwZV9hY2xfbG9jayk7
DQorIA0KKyAgICAgICByZXR2YWwgPSBzbnByaW50ZihidWYsIDQwOTYsICIlc1xuIiwgYnVmZmVy
KTsNCisNCisgICAgICAgZnJlZV9wYWdlKCh1bnNpZ25lZCBsb25nKXVzZXIpOw0KKyAgICAgICBy
ZXR1cm4gcmV0dmFsOw0KK30NCisNCitzdGF0aWMgc3NpemVfdCB0cnVzdGVkbGlzdGFkZF93cml0
ZV9maWxlIChzdHJ1Y3QgdHBlX2xpc3QgKmxpc3QsIGNvbnN0IGNoYXIgKmJ1ZiwNCitzaXplX3Qg
Y291bnQpDQorew0KKyAgICAgICBpbnQgcmV0dmFsOyANCisgICAgICAgdW5zaWduZWQgbG9uZyBh
ZGRfY2FuZGlkYXRlOw0KKw0KKyAgICAgICBhZGRfY2FuZGlkYXRlID0gc2ltcGxlX3N0cnRvdWwo
YnVmLCBOVUxMLCAxMCk7IA0KKw0KKyAgICAgICBkYmcoInZhbHVlIG9mIGFkZF9jYW5kaWRhdGUg
aXMgJWQuXG4iLCAoaW50KWFkZF9jYW5kaWRhdGUpOw0KKyAgICAgICBzcGluX2xvY2soJnRwZV9h
Y2xfbG9jayk7DQorICAgICAgIHJldHZhbCA9IHRwZV9hZGQoYWRkX2NhbmRpZGF0ZSk7DQorICAg
ICAgIHNwaW5fdW5sb2NrKCZ0cGVfYWNsX2xvY2spOw0KKyAgICAgICBpZiAocmV0dmFsKSB7DQor
ICAgICAgICAgICAgICAgcmV0dXJuIHJldHZhbDsNCisgICAgICAgfSANCisgICAgICAgcmV0dXJu
IGNvdW50Ow0KKw0KK30NCisNCisvKiBwZXItR0lEIGJhc2lzIEFDTCBzdXBwb3J0ICovDQorDQor
c3RhdGljIHNzaXplX3QgdHJ1c3RlZGxpc3RhZGRfZ3JvdXBfd3JpdGVfZmlsZSAoc3RydWN0IHRw
ZV9saXN0ICpsaXN0LCBjb25zdCBjaGFyICpidWYsDQorc2l6ZV90IGNvdW50KQ0KK3sNCisgICAg
ICAgaW50IHJldHZhbDsgDQorICAgICAgIHVuc2lnbmVkIGxvbmcgYWRkX2dyb3VwX2NhbmRpZGF0
ZTsNCisNCisgICAgICAgYWRkX2dyb3VwX2NhbmRpZGF0ZSA9IHNpbXBsZV9zdHJ0b3VsKGJ1Ziwg
TlVMTCwgMTApOyANCisNCisgICAgICAgZGJnKCJ2YWx1ZSBvZiBhZGRfZ3JvdXBfY2FuZGlkYXRl
IGlzICVkLlxuIiwgKGludClhZGRfZ3JvdXBfY2FuZGlkYXRlKTsNCisgICAgICAgc3Bpbl9sb2Nr
KCZ0cGVfZ3JvdXBfYWNsX2xvY2spOw0KKyAgICAgICByZXR2YWwgPSB0cGVfZ3JvdXBfYWRkKGFk
ZF9ncm91cF9jYW5kaWRhdGUpOyAvKiB0cGVfZ3JvdXBfYWRkKCkgbmluamEgbW9ua2V5ICovDQor
ICAgICAgIHNwaW5fdW5sb2NrKCZ0cGVfZ3JvdXBfYWNsX2xvY2spOw0KKyAgICAgICBpZiAocmV0
dmFsKSB7DQorICAgICAgICAgICAgICAgcmV0dXJuIHJldHZhbDsNCisgICAgICAgfSANCisgICAg
ICAgcmV0dXJuIGNvdW50Ow0KKw0KK30NCitzdGF0aWMgc3NpemVfdCB0cnVzdGVkbGlzdGFkZF9n
cm91cF9yZWFkX2ZpbGUgKHN0cnVjdCB0cGVfbGlzdCAqbGlzdCwgY2hhciAqYnVmKQ0KK3sNCisg
ICAgICAgaW50IGk7DQorICAgICAgIGludCByZXR2YWwgPSAwOw0KKyAgICAgICBjaGFyICpncm91
cCA9IE5VTEw7DQorICAgICAgIGNoYXIgYnVmZmVyWzQwMF07DQorDQorICAgICAgIGdyb3VwID0g
KGNoYXIgKilfX2dldF9mcmVlX3BhZ2UoR0ZQX0tFUk5FTCk7DQorICAgICAgIGlmICghZ3JvdXAp
DQorICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07DQorDQorICAgICAgIGlmICh0cGVfYWNs
ID09IE5VTEwpIHsNCisgICAgICAgICAgICAgIGtpbmZvKCJFbXB0eSB1c2VyIGdyb3VwcyBBY2Nl
c3MgQ29udHJvbCBMaXN0XG4iKTsNCisgICAgICAgICAgICAgICByZXR1cm4gLUVOT0RBVEE7IA0K
KyAgICAgICB9DQorDQorICAgICAgIGJ1ZmZlclswXSA9ICdcMCc7DQorICAgICAgIGtpbmZvKCIl
ZCB0cnVzdGVkIGdyb3VwKHMpOiBcbiIsIHRwZV9hY2xfZ3JvdXBfY2FuZGlkYXRlcyk7DQorICAg
ICAgIHNwaW5fbG9jaygmdHBlX2dyb3VwX2FjbF9sb2NrKTsNCisgICAgICAgZm9yIChpPTA7IGkg
PCB0cGVfYWNsX2dyb3VwX2NhbmRpZGF0ZXM7IGkrKykgew0KKyAgICAgICAgICAgICAgIHByaW50
ayhLRVJOX0lORk8gIiVkICIsIHRwZV9ncm91cF9hY2xbaV0pOw0KKyAgICAgICAgICAgICAgIHJl
dHZhbCA9IHNwcmludGYoZ3JvdXAsICIlZFxuIiwgdHBlX2dyb3VwX2FjbFtpXSk7IA0KKyAgICAg
ICAgICAgICAgIHN0cmNhdChidWZmZXIsIGdyb3VwKTsNCisgICAgICAgfQ0KKyAgICAgICAvKiBs
ZWF2ZSBwcmludGsoKSBjYWxscyBhbG9uZSwgbm90IGtpbmZvKCkgKi8NCisgICAgICAgcHJpbnRr
KEtFUk5fSU5GTyAiXG4iKTsNCisgICAgICAgc3Bpbl91bmxvY2soJnRwZV9ncm91cF9hY2xfbG9j
ayk7DQorIA0KKyAgICAgICByZXR2YWwgPSBzbnByaW50ZihidWYsIDQwOTYsICIlc1xuIiwgYnVm
ZmVyKTsNCisNCisgICAgICAgZnJlZV9wYWdlKCh1bnNpZ25lZCBsb25nKWdyb3VwKTsNCisgICAg
ICAgcmV0dXJuIHJldHZhbDsNCit9DQorLyogZW5kcyBzeXNmcyB0cGVmcyBncm91cCBhY2wgbWFu
YWdlbWVudCAqLw0KKw0KK3N0cnVjdCB0cGVmc19hdHRyaWJ1dGUgdHBlZnNfbGlzdGFkZF9hdHRy
ID0gew0KKyAgICAgICAuYXR0ciA9IHsubmFtZSA9ICJhZGQiLCAubW9kZSA9IFNfSUZSRUcgfCBT
X0lSVUdPIHwgU19JV1VTUn0sDQorICAgICAgIC5zaG93ID0gdHJ1c3RlZGxpc3RhZGRfcmVhZF9m
aWxlLA0KKyAgICAgICAuc3RvcmUgPSB0cnVzdGVkbGlzdGFkZF93cml0ZV9maWxlDQorfTsNCisv
KiBsaXN0YWRkX2dyb3VwIHBlci1HSUQgYmFzaXMgQUNMICovDQorc3RydWN0IHRwZWZzX2F0dHJp
YnV0ZSB0cGVmc19saXN0YWRkX2dyb3VwX2F0dHIgPSB7DQorICAgICAgIC5hdHRyID0gey5uYW1l
ID0gImFkZC1ncm91cCIsIC5tb2RlID0gU19JRlJFRyB8IFNfSVJVR08gfCBTX0lXVVNSfSwNCisg
ICAgICAgLnNob3cgPSB0cnVzdGVkbGlzdGFkZF9ncm91cF9yZWFkX2ZpbGUsDQorICAgICAgIC5z
dG9yZSA9IHRydXN0ZWRsaXN0YWRkX2dyb3VwX3dyaXRlX2ZpbGUNCit9Ow0KKy8qIHRydXN0ZWQg
VUlEcyBkZWxldGlvbiAqLw0KK3N0YXRpYyBzc2l6ZV90IHRydXN0ZWRsaXN0ZGVsX3dyaXRlX2Zp
bGUgKHN0cnVjdCB0cGVfbGlzdCAqbGlzdCwgY29uc3QgY2hhciAqYnVmLA0KK3NpemVfdCBjb3Vu
dCkNCit7DQorICAgICAgIGludCByZXR2YWw7IA0KKyAgICAgICB1bnNpZ25lZCBsb25nIHJlbV9j
YW5kaWRhdGU7DQorDQorICAgICAgIHJlbV9jYW5kaWRhdGUgPSBzaW1wbGVfc3RydG91bChidWYs
IE5VTEwsIDEwKTsNCisgDQorICAgICAgIGRiZygidmFsdWUgb2YgcmVtX2NhbmRpZGF0ZSBpcyAl
ZC5cbiIsIChpbnQpcmVtX2NhbmRpZGF0ZSk7DQorICAgICAgIHNwaW5fbG9jaygmdHBlX2FjbF9s
b2NrKTsNCisgICAgICAgcmV0dmFsID0gdHBlX3JlbW92ZShyZW1fY2FuZGlkYXRlKTsNCisgICAg
ICAgc3Bpbl91bmxvY2soJnRwZV9hY2xfbG9jayk7DQorICAgICAgIGlmIChyZXR2YWwpIHsNCisg
ICAgICAgICAgICAgICByZXR1cm4gcmV0dmFsOw0KKyAgICAgICB9IA0KKyAgICAgICByZXR1cm4g
Y291bnQ7DQorDQorfQ0KKy8qIHRydXN0ZWQgR0lEcyBkZWxldGlvbiAqLw0KK3N0YXRpYyBzc2l6
ZV90IHRydXN0ZWRsaXN0ZGVsX2dyb3VwX3dyaXRlX2ZpbGUgKHN0cnVjdCB0cGVfbGlzdCAqbGlz
dCwgY29uc3QgY2hhciAqYnVmLA0KK3NpemVfdCBjb3VudCkNCit7DQorICAgICAgIGludCByZXR2
YWw7IA0KKyAgICAgICB1bnNpZ25lZCBsb25nIHJlbV9ncm91cF9jYW5kaWRhdGU7DQorDQorICAg
ICAgIHJlbV9ncm91cF9jYW5kaWRhdGUgPSBzaW1wbGVfc3RydG91bChidWYsIE5VTEwsIDEwKTsN
CisgDQorICAgICAgIGRiZygidmFsdWUgb2YgcmVtX2NhbmRpZGF0ZSBpcyAlZC5cbiIsIChpbnQp
cmVtX2dyb3VwX2NhbmRpZGF0ZSk7DQorICAgICAgIHNwaW5fbG9jaygmdHBlX2dyb3VwX2FjbF9s
b2NrKTsNCisgICAgICAgcmV0dmFsID0gdHBlX2dyb3VwX3JlbW92ZShyZW1fZ3JvdXBfY2FuZGlk
YXRlKTsNCisgICAgICAgc3Bpbl91bmxvY2soJnRwZV9ncm91cF9hY2xfbG9jayk7DQorICAgICAg
IGlmIChyZXR2YWwpIHsNCisgICAgICAgICAgICAgICByZXR1cm4gcmV0dmFsOw0KKyAgICAgICB9
IA0KKyAgICAgICByZXR1cm4gY291bnQ7DQorDQorfQ0KKw0KK3N0cnVjdCB0cGVmc19hdHRyaWJ1
dGUgdHBlZnNfbGlzdGRlbF9hdHRyID0gew0KKyAgICAgICAuYXR0ciA9IHsubmFtZSA9ICJkZWwi
LCAubW9kZSA9IFNfSUZSRUcgfCBTX0lSVUdPIHwgU19JV1VTUn0sDQorICAgICAgIC5zdG9yZSA9
IHRydXN0ZWRsaXN0ZGVsX3dyaXRlX2ZpbGUNCit9Ow0KKy8qIHN5c2ZzL3RwZWZzL2RlbC1ncm91
cCAqLw0KK3N0cnVjdCB0cGVmc19hdHRyaWJ1dGUgdHBlZnNfbGlzdGRlbF9ncm91cF9hdHRyID0g
ew0KKyAgICAgICAuYXR0ciA9IHsubmFtZSA9ICJkZWwtZ3JvdXAiLCAubW9kZSA9IFNfSUZSRUcg
fCBTX0lSVUdPIHwgU19JV1VTUn0sDQorICAgICAgIC5zdG9yZSA9IHRydXN0ZWRsaXN0ZGVsX2dy
b3VwX3dyaXRlX2ZpbGUNCit9Ow0KKw0KKy8qIFRQRSAvcHJvYyBlbnRyeSBtYW5hZ2luZyAqLw0K
K3NzaXplX3QNCitwcm9jZmlsZV9yZWFkKGNoYXIgKmJ1ZmZlciwNCisJICAgICAgY2hhciAqKmJ1
ZmZlcl9sb2NhdGlvbiwNCisJICAgICAgb2ZmX3Qgb2Zmc2V0LCBpbnQgYnVmZmVyX2xlbmd0aCwg
aW50ICplb2YsIHZvaWQgKmRhdGEpDQorew0KKwlpbnQgbGVuID0gMDsJCS8qIFRoZSBudW1iZXIg
b2YgYnl0ZXMgYWN0dWFsbHkgdXNlZCAqLw0KKwljaGFyICp2ZXJtYWdpYyA9IFZFUlNJT047DQor
CWlmIChvZmZzZXQgPiAwKSB7DQorCQlkYmcoIm9mZnNldCAlZCA6IC9wcm9jL3RwZSA6IHByb2Nm
aWxlX3JlYWQsIFwNCisJCSAgICAgICB3cm90ZSAlZCBieXRlc1xuIiwgKGludCkob2Zmc2V0KSwg
bGVuKTsNCisJCSplb2YgPSAxOw0KKwkJcmV0dXJuIGxlbjsNCisJfQ0KKwkvKiBXZSB3cml0ZSB0
aGUgZGF0YSB0byB0aGUgcHJvY2ZzIGVudHJ5ICovDQorCWxlbiA9IHNwcmludGYoYnVmZmVyLA0K
KwkJICAgICAgIlZlcnNpb246ICVzXG5UcnVzdGVkIHVzZXJzOiAlZFxuVHJ1c3RlZCBncm91cHM6
ICVkXG4iDQorCQkgICAgICAsIHZlcm1hZ2ljLCB0cGVfYWNsX2NhbmRpZGF0ZXMsIHRwZV9hY2xf
Z3JvdXBfY2FuZGlkYXRlcyk7DQorCS8qIFZvaWxhISAqLw0KKwlkYmcoImxlYXZpbmcgL3Byb2Mv
dHBlIDogcHJvY2ZpbGVfcmVhZCwgd3JvdGUgJWQgQnl0ZXNcbiIsIGxlbik7DQorCXJldHVybiBs
ZW47DQorfQ0KKw0KKy8qIE1vZHVsZSBjb2RlICovDQorDQorc3RhdGljIGludCB0cGVfYnBybV9z
ZXRfc2VjdXJpdHkgKHN0cnVjdCBsaW51eF9iaW5wcm0gKmJwcm0pDQorew0KKyAgICAgICB1aWRf
dCBwdGh1aWQgPSBicHJtLT5maWxlLT5mX2RlbnRyeS0+ZF9wYXJlbnQtPmRfaW5vZGUtPmlfdWlk
Ow0KKyAgICAgICBtb2RlX3QgcHRobW9kZSA9IGJwcm0tPmZpbGUtPmZfZGVudHJ5LT5kX3BhcmVu
dC0+ZF9pbm9kZS0+aV9tb2RlOw0KKyAgICAgICBpZigoIVRSVVNURURfUEFUSChwdGhtb2RlLCBw
dGh1aWQpKSAmJiAoIVRSVVNURURfVVNFUihjdXJyZW50LT5ldWlkKSkgDQorICAgICAgIAkmJiAo
IVRSVVNURURfR1JPVVAoYnBybS0+ZV9naWQpKSkgew0KKyAgICAgICAgICAgICAgICAgICAgICAg
a2luZm8oIlVudHJ1c3RlZCBleGVjdXRpb246ICVzICINCisJCQkJInVpZC9ldWlkPSVkLyVkIGdp
ZC9lZ2lkPSVkLyVkIHBpZD0lZCINCisJCQkJIlxuIiwgYnBybS0+ZmlsZW5hbWUsIGN1cnJlbnQt
PnVpZCwgYnBybS0+ZV91aWQsDQorCQkJCSAgICAgIGN1cnJlbnQtPmdpZCwgYnBybS0+ZV9naWQs
IGN1cnJlbnQtPnBpZCk7DQorICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLUVBQ0NFUzsN
CisgICAgICAgfSANCisgICAgICAgcmV0dXJuIDA7DQorfQ0KKw0KK3N0cnVjdCBzZWN1cml0eV9v
cGVyYXRpb25zIHRwZV9zZWN1cml0eV9vcHMgPSB7DQorICAgICAgICBicHJtX3NldF9zZWN1cml0
eTogICAgICAgICAgICAgIHRwZV9icHJtX3NldF9zZWN1cml0eSwNCit9Ow0KKw0KK3N0YXRpYyBp
bnQgX19pbml0IHRwZV9tb2R1bGVfaW5pdCAodm9pZCkNCit7DQorICAgICAgIGludCByZXR2YWw7
DQorICAgICAgIGludCBjZm9vID0gMDsNCisgICAgICAgLyogcmVnaXN0ZXIgb3Vyc2VsdmVzIHdp
dGggdGhlIHNlY3VyaXR5IGZyYW1ld29yayAqLw0KKyAgICAgICBpZiAocmVnaXN0ZXJfc2VjdXJp
dHkgKCZ0cGVfc2VjdXJpdHlfb3BzKSkgew0KKyAgICAgICAgICAgICAgIHByaW50ayAoS0VSTl9J
TkZPDQorICAgICAgICAgICAgICAgICAgICAgICAiRmFpbHVyZSByZWdpc3RlcmluZyB0cGUgbW9k
dWxlIHdpdGggdGhlIGtlcm5lbFxuIik7DQorICAgICAgICAgICAgICAgLyogdHJ5IHJlZ2lzdGVy
aW5nIHdpdGggcHJpbWFyeSBtb2R1bGUgKi8NCisgICAgICAgICAgICAgICBpZiAobW9kX3JlZ19z
ZWN1cml0eSAoTEVHQUNZX05BTUUsICZ0cGVfc2VjdXJpdHlfb3BzKSkgew0KKyAgICAgICAgICAg
ICAgICAgICAgICAgcHJpbnRrIChLRVJOX0lORk8gIkZhaWx1cmUgcmVnaXN0ZXJpbmcgdHBlIG1v
ZHVsZSAiDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aXRoIHByaW1hcnkgc2Vj
dXJpdHkgbW9kdWxlLlxuIik7DQorICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZB
TDsNCisgICAgICAgICAgICAgICB9DQorICAgICAgICAgICAgICAgc2Vjb25kYXJ5ID0gMTsNCisg
ICAgICAgfQ0KKyANCisgICAgICAgLyogcmVnaXN0ZXIgdHBlIHN1YnN5c3RlbSAqLw0KKyAgICAg
ICBraW5mbygiUmVnaXN0ZXJpbmcgVFBFIHN1YnN5c3RlbS5cbiIpOw0KKyAgICAgICByZXR2YWwg
PSBzdWJzeXN0ZW1fcmVnaXN0ZXIoJnRwZWZzX3N1YnN5cyk7DQorICAgICAgIGlmIChyZXR2YWwp
IHsNCisgICAgICAgICAgICAgICBraW5mbygic3Vic3lzdGVtX3JlZ2lzdGVyIGZhaWxlZCB3aXRo
ICVkXG4iLCByZXR2YWwpOw0KKyAgICAgICAgICAgICAgIHJldHVybiByZXR2YWw7DQorICAgICAg
IH0NCisgICAgICAga2luZm8oIlJlZ2lzdGVyaW5nIHRwZWZzIHN1cHBvcnQgZm9yIHN5c2ZzLlxu
Iik7DQorICAgICAgIHN5c2ZzX2NyZWF0ZV9maWxlKCZ0cGVmc19zdWJzeXMua3NldC5rb2JqLCAm
dHBlZnNfbGlzdGFkZF9hdHRyLmF0dHIpOw0KKyAgICAgICBzeXNmc19jcmVhdGVfZmlsZSgmdHBl
ZnNfc3Vic3lzLmtzZXQua29iaiwgJnRwZWZzX2xpc3RkZWxfYXR0ci5hdHRyKTsNCisgICAgICAg
LyogY3JlYXRlIHRoZSBncm91cC9naWQgYWNsIHN5c2ZzIHRwZWZzIGZpbGVzICovDQorICAgICAg
IHN5c2ZzX2NyZWF0ZV9maWxlKCZ0cGVmc19zdWJzeXMua3NldC5rb2JqLCAmdHBlZnNfbGlzdGFk
ZF9ncm91cF9hdHRyLmF0dHIpOw0KKyAgICAgICBzeXNmc19jcmVhdGVfZmlsZSgmdHBlZnNfc3Vi
c3lzLmtzZXQua29iaiwgJnRwZWZzX2xpc3RkZWxfZ3JvdXBfYXR0ci5hdHRyKTsNCisgICAgICAg
DQorICAgICAgIGtpbmZvKCJSZWdpc3RlcmluZyB3aXRoIExTTSBzdWJzeXN0ZW0uXG4iKTsNCisJ
dHBlX2luaXQoKTsNCisJLyogVFBFIC9wcm9jLyAiYmlsYm8iIGVudHJ5IGJlZ2lucyA6KSAqLw0K
KwlUUEVfcGVudHJ5ID0gY3JlYXRlX3Byb2NfZW50cnkoVFBFX1BST0NfRU5UUllfTkFNRSwgMDY0
NCwgTlVMTCk7DQorCVRQRV9wZW50cnktPnJlYWRfcHJvYyA9IHByb2NmaWxlX3JlYWQ7DQorCVRQ
RV9wZW50cnktPm93bmVyID0gVEhJU19NT0RVTEU7DQorCVRQRV9wZW50cnktPm1vZGUgPSBTX0lG
UkVHIHwgU19JUlVHTzsNCisJVFBFX3BlbnRyeS0+dWlkID0gMDsNCisJVFBFX3BlbnRyeS0+Z2lk
ID0gMDsNCisJVFBFX3BlbnRyeS0+c2l6ZSA9IDIwOw0KKwlpZiAoVFBFX3BlbnRyeSA9PSBOVUxM
KSB7DQorCQljZm9vID0gLUVOT01FTTsgLyoqLw0KKwkJcmVtb3ZlX3Byb2NfZW50cnkoVFBFX1BS
T0NfRU5UUllfTkFNRSwgJnByb2Nfcm9vdCk7DQorCQlraW5mbygiRXJyb3I6IENvdWxkIG5vdCBp
bml0aWFsaXplIC9wcm9jL3RwZVxuIik7DQorCX0gZWxzZSB7DQorCQlraW5mbygiL3Byb2MgZW50
cnkgaW5pdGlhbGl6ZWQuXG4iKTsNCisJfQ0KKwlraW5mbygiVHJ1c3RlZCBQYXRoIEV4ZWN1dGlv
biBlbmdpbmUgaW5pdGlhbGl6ZWQuXG4iKTsNCisJcmV0dXJuIGNmb287DQorfQ0KKw0KK3N0YXRp
YyB2b2lkIF9fZXhpdCB0cGVfZXhpdCAodm9pZCkNCit7DQorICAgICAgIHJlbW92ZV9wcm9jX2Vu
dHJ5KFRQRV9QUk9DX0VOVFJZX05BTUUsICZwcm9jX3Jvb3QpOyAvKiByZW1vdmUgVFBFIC9wcm9j
IGVudHJ5ICovCQ0KKyAgICAgICBzeXNmc19yZW1vdmVfZmlsZSgmdHBlZnNfc3Vic3lzLmtzZXQu
a29iaiwgJnRwZWZzX2xpc3RhZGRfYXR0ci5hdHRyKTsNCisgICAgICAgc3lzZnNfcmVtb3ZlX2Zp
bGUoJnRwZWZzX3N1YnN5cy5rc2V0LmtvYmosICZ0cGVmc19saXN0ZGVsX2F0dHIuYXR0cik7DQor
ICAgICAgIC8qIHJlbW92ZSBzeXNmcy90cGVmcy9hZGQtZ3JvdXAgYW5kIGRlbC1ncm91cCAqLw0K
KyAgICAgICBzeXNmc19yZW1vdmVfZmlsZSgmdHBlZnNfc3Vic3lzLmtzZXQua29iaiwgJnRwZWZz
X2xpc3RhZGRfZ3JvdXBfYXR0ci5hdHRyKTsNCisgICAgICAgc3lzZnNfcmVtb3ZlX2ZpbGUoJnRw
ZWZzX3N1YnN5cy5rc2V0LmtvYmosICZ0cGVmc19saXN0ZGVsX2dyb3VwX2F0dHIuYXR0cik7DQor
ICAgICAgIHN1YnN5c3RlbV91bnJlZ2lzdGVyKCZ0cGVmc19zdWJzeXMpOyANCisgDQorICAgICAg
IC8qIHJlbW92ZSBvdXJzZWx2ZXMgZnJvbSB0aGUgc2VjdXJpdHkgZnJhbWV3b3JrICovDQorICAg
ICAgIGlmIChzZWNvbmRhcnkpIHsNCisgICAgICAgICAgICAgICBpZiAobW9kX3VucmVnX3NlY3Vy
aXR5IChMRUdBQ1lfTkFNRSwgJnRwZV9zZWN1cml0eV9vcHMpKQ0KKyAgICAgICAgICAgICAgICAg
ICAgICAgcHJpbnRrIChLRVJOX0lORk8gIkZhaWx1cmUgdW5yZWdpc3RlcmluZyB0cGUgbW9kdWxl
ICINCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpdGggcHJpbWFyeSBtb2R1bGUu
XG4iKTsNCisgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCisgICAgICAgfQ0KKyANCisg
ICAgICAgaWYgKHVucmVnaXN0ZXJfc2VjdXJpdHkgKCZ0cGVfc2VjdXJpdHlfb3BzKSkgew0KKyAg
ICAgICAgICAgICAgIHByaW50ayAoS0VSTl9JTkZPDQorICAgICAgICAgICAgICAgICAgICAgICAi
RmFpbHVyZSB1bnJlZ2lzdGVyaW5nIHRwZSBtb2R1bGUgd2l0aCB0aGUga2VybmVsXG4iKTsNCisg
ICAgICAgfQ0KKyAgICAgICBraW5mbygiVHJ1c3RlZCBQYXRoIEV4ZWN1dGlvbiBzdWJzeXN0ZW0g
dW5sb2FkZWQuXG4iKTsNCisNCit9DQorDQorbW9kdWxlX2luaXQgKHRwZV9tb2R1bGVfaW5pdCk7
DQorbW9kdWxlX2V4aXQgKHRwZV9leGl0KTsNCisNCisvKiBNb2RpbmZvIHBlcmxzICovDQorTU9E
VUxFX0RFU0NSSVBUSU9OKERFU0NSSVBUSU9OKTsNCitNT0RVTEVfQVVUSE9SKEFVVEhPUik7DQor
TU9EVUxFX0xJQ0VOU0UoTElDRU5TRSk7DQpkaWZmIC1OdXIgLi4vbGludXgtMi42LjEwL3NlY3Vy
aXR5L3RwZS5oIGxpbnV4LTIuNi4xMC10cGUvc2VjdXJpdHkvdHBlLmgNCi0tLSAuLi9saW51eC0y
LjYuMTAvc2VjdXJpdHkvdHBlLmgJMTk3MC0wMS0wMSAwMTowMDowMC4wMDAwMDAwMDAgKzAxMDAN
CisrKyBsaW51eC0yLjYuMTAtdHBlL3NlY3VyaXR5L3RwZS5oCTIwMDUtMDEtMDYgMDI6NTE6MzUu
MDAwMDAwMDAwICswMTAwDQpAQCAtMCwwICsxLDE1NSBAQA0KKy8qDQorICogVHJ1c3RlZCBQYXRo
IEV4ZWN1dGlvbiBTZWN1cml0eSBNb2R1bGUNCisgKg0KKyAqIFRoaXMgbW9kdWxlIHByb3ZpZGVz
IGEgVHJ1c3RlZCBQYXRoIEV4ZWN1dGlvbiAoVFBFKSBlbmdpbmUgdG8gdGhlDQorICogTGludXgg
a2VybmVsLiBUUEUgb3JpZ2luYXRlZCBhcyBhIGtlcm5lbCBwYXRjaCB0byBPcGVuQlNEIDIuNCBi
eQ0KKyAqIHJvdXRlfGRhZW1vbjkgYW5kIE1pa2UgU2NoaWZtYW4gKHNlZSBQaHJhY2sgNTQpLiBJ
Qk0gb3JpZ2luYWxseSBtb2RpZmllZA0KKyAqIHRoZSBvcmlnaW5hbCBwcm9qZWN0IHRvIGZpdCB3
aXRoaW4gdGhlIGNvbnN0cmFpbnRzIG9mIHRoZSBMU00gZnJhbWV3b3JrDQorICogYW5kIHNvIGl0
IHNob3VsZCBiZSBub3RlZCB0aGF0IHRoaXMgaXMgbm90IHRoZSBzYW1lIHByb2plY3QuIEFsc28s
DQorICogdGhlIG1vZHVsZSBtYWtlcyB1c2Ugb2YgdGhlIHN5c2ZzIGZpbGVzeXN0ZW0uIA0KKyAq
IEkgcmV3cm90ZSB0aGUgbW9kdWxlIGluIG9yZGVyIHRvIGFkZCBkZWJ1Z2dpbmcsIGJldHRlciBp
bmZvcm1hdGlvbg0KKyAqIG91dHB1dHRpbmcsIHN1cHBvcnQgZm9yIHBlci1Vc2VyLUdyb3VwcyBh
Y2Nlc3MgY29udHJvbCBsaXN0cyBhdCBydW50aW1lDQorICogYW5kIGtlcm5lbC1jb25maWd1cmF0
aW9uIGxldmVsLCBhIHByb2NmcyBpbnRlcmZhY2UgZm9yIGdlbmVyYWwgaW5mb3JtYXRpb24NCisg
KiBnYXRoZXJpbmcgZnJvbSB0aGUgVFBFIHN1YnN5c3RlbSBhbmQgYSBmZXcgb3RoZXIgZW5oYW5j
ZW1lbnRzIHdoaWNoIG1ha2UgdGhlDQorICogY29kZSBhbG1vc3QgYSBjb21wbGV0ZSByZXdyaXRl
Lg0KKyAqDQorICogQ29weXJpZ2h0IChDKSAyMDAzIElCTSBDb3JwLiA8bmFyYWhpbWlAdXMuaWJt
LmNvbT4NCisgKiBDb3B5cmlnaHQgKEMpIDIwMDUgTG9yZW56byBIZXJuYW5kZXogR2FyY2lhLUhp
ZXJybyA8bG9yZW56b0BnbnUub3JnPg0KKyAqIEFsbCByaWdodHMgcmV2ZXJzZWQuDQorICoNCisg
KiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQg
YW5kL29yDQorICogbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwg
UHVibGljIExpY2Vuc2UNCisgKiBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMg0KKyAqIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91
ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLg0KKyAqDQorICogVGhpcyBwcm9ncmFtIGlzIGRp
c3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsDQorICogYnV0IFdJ
VEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YN
CisgKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0Uu
ICBTZWUgdGhlDQorICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWls
cy4NCisgKi8NCisNCisjaWZuZGVmIF9fVFBFX0gNCisjZGVmaW5lIF9fVFBFX0gNCisNCisjaW5j
bHVkZSA8bGludXgvdHlwZXMuaD4NCisjaW5jbHVkZSA8YXNtL3VhY2Nlc3MuaD4NCisNCisvKiBW
ZXJtYWdpYyBhbmQgL3Byb2MgZW50cnkgbmFtZSAqLw0KKw0KKyNkZWZpbmUgVkVSU0lPTiAJCSIy
MDA1MDYwMSINCisjZGVmaW5lIExTTV9WRVJTSU9OIAkJTlVMTCAvKiB1bnVzZWQgKi8NCisjZGVm
aW5lIFRQRV9QUk9DX0VOVFJZX05BTUUgCSJ0cGUiIAkvKiAvcHJvYyBlbnRyeSBuYW1lICovDQor
DQorLyogUGVyLXVzZXIgZ3JvdXAgYmFzaXMgcHJvdGVjdGlvbiBzdHVmZiAqLw0KKw0KK3N0YXRp
YyBpbnQgdHBlX3RydXN0ZWRfZ2lkID0gMDsNCisjaWZkZWYgQ09ORklHX1NFQ1VSSVRZX1RQRV9U
UlVTVEVEX0dJRA0KKwl0cGVfdHJ1c3RlZF9naWQgPSBDT05GSUdfU0VDVVJJVFlfVFBFX1RSVVNU
RURfR0lEOw0KKyNlbmRpZg0KKy8qDQorICogIHN5c2NhbGwgc3R1ZmYNCisgKi8NCisjZGVmaW5l
IFRQRV9BQ0xfU0laRSAgICA4MiAgICAgIC8qIE1heGltdW0gbnVtYmVyIG9mIHVzZXJzIGluIHRo
ZSBsaXN0IA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBwbHVzIHR3by4gVGhp
cyB3YXMgYW4gb3JpZ2luYWwNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogY29t
cG9uZW50IG9mIFRQRS4gVGhpcyB3aWxsIGJlIA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKiBmaXhlZCBsYXRlciBvbi4NCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICovIA0KKyANCisjZGVmaW5lIFRQRV9JTklUSUFMSVpFUiAtMSAgICAgIC8qIEEgVUlEIHRoYXQg
aXNuJ3QgdXNlZCAqLw0KKw0KKyNkZWZpbmUgQUNLICAgICAgICAgICAgIDEgICAgICAgLyogcG9z
aXRpdmUgYWNrbm93bGVkZ2VtZW50ICovDQorI2RlZmluZSBOQUNLICAgICAgICAgICAgLTEgICAg
ICAvKiBuZWdhdGl2ZSBhY2tub3dsZWRnZW1lbnQgKi8NCisjZGVmaW5lIERVUCAgICAgICAgICAg
IDMgICAgICAgLyogZHVwbGljYXRlIGlkIHJldHVybiBmb3IgdHBlX2FkZCAqLw0KKw0KKy8qDQor
ICogIFZlcmlmeSB0aGUgcGF0aC4gDQorICovDQorI2RlZmluZSBUUlVTVEVEX1BBVEgobW9kZSwg
dWlkKSBcDQorKCEobW9kZSAmIChTX0lXR1JQIHwgU19JV09USCkpICYmICh1aWQgPT0gMCkpDQor
DQorc3RhdGljIHVpZF90IHRwZV9hY2xbVFBFX0FDTF9TSVpFXTsgICAgLyogdHJ1c3RlZCB1c2Vy
cyBsaXN0ICovDQorc3RhdGljIGdpZF90IHRwZV9ncm91cF9hY2xbVFBFX0FDTF9TSVpFXTsgICAg
LyogdHJ1c3RlZCB1c2VyIGdyb3VwcyBsaXN0ICovDQorc3RhdGljIGludCB0cGVfYWNsX2NhbmRp
ZGF0ZXM7ICAgICAgICAgLyogbnVtYmVyIG9mIHVzZXJzIG9uIHRoZSBsaXN0ICovDQorc3RhdGlj
IGludCB0cGVfYWNsX2dyb3VwX2NhbmRpZGF0ZXM7ICAgICAgICAgLyogbnVtYmVyIG9mIHVzZXIg
Z3JvdXBzIG9uIHRoZSBsaXN0ICovDQorDQorLyoNCisgKiBWZXJpZnkgdGhlIHVzZXIuIFRoaXMg
bWFjcm8gaXMgcGFzc2VkIHRoZSB1c2VyJ3MgSUQgZnJvbSB0aGUgDQorICogdHBlX2Jwcm1fc2V0
X3NlY3VyaXR5IGhvb2suIA0KKyAqLw0KKw0KKyNkZWZpbmUgVFJVU1RFRF9VU0VSKFVJRCkgKHRw
ZV92ZXJpZnkoVUlEKSA9PSBBQ0spDQorDQorLyoNCisgKiBWZXJpZnkgdGhlIHVzZXIgZ3JvdXAu
IFRoaXMgbWFjcm8gaXMgcGFzc2VkIHRoZSB1c2VyJ3MgZ3JvdXAgSUQgZnJvbSB0aGUgDQorICog
dHBlX2Jwcm1fc2V0X3NlY3VyaXR5IGhvb2suIA0KKyAqLw0KKw0KKyNkZWZpbmUgVFJVU1RFRF9H
Uk9VUChHSUQpICh0cGVfZ3JvdXBfdmVyaWZ5KEdJRCkgPT0gQUNLKQ0KKw0KKy8qICBJbml0aWFs
aXplIHRoZSBhcnJheSB3aXRoIGRlZmF1bHQgdmFsdWVzIChUUEVfSU5JVElBTElaRVIpLiAqLw0K
Kw0KKy8qIERlYnVnZ2luZyBhbmQgb3V0cHV0dGluZyBmdW5jdGlvbnMgKi8NCisNCitzdGF0aWMg
aW5saW5lIHZvaWQgdHBlX2luaXQgKHZvaWQpDQorew0KKyAgICAgICBtZW1zZXQodHBlX2FjbCwg
VFBFX0lOSVRJQUxJWkVSLCBzaXplb2YodWlkX3QpICogVFBFX0FDTF9TSVpFKTsNCisgICAgICAg
cHJpbnRrKEtFUk5fSU5GTyAiVFBFOiBBY2Nlc3MgQ29udHJvbCBMaXN0IGNyZWF0ZWQuXG4iKTsN
CisgICAgICAgdHBlX2FjbF9jYW5kaWRhdGVzID0gMTsNCisgICAgICAgaWYgKCEodHBlX3RydXN0
ZWRfZ2lkID09IDApKSANCisgICAgICAgCXsNCisgICAgICAgCQl0cGVfYWNsX2dyb3VwX2NhbmRp
ZGF0ZXMgPSAyOw0KKyAgICAgICAJfSBlbHNlIHsNCisgICAgICAgCQl0cGVfYWNsX2dyb3VwX2Nh
bmRpZGF0ZXMgPSAxOyANCisgICAgICAgCX0NCisgICAgICAgdHBlX2FjbFswXSA9IDA7DQorICAg
ICAgIGlmICghKHRwZV90cnVzdGVkX2dpZCA9PSAwKSkgDQorICAgICAgIAl7DQorICAgICAgIAkJ
dHBlX2dyb3VwX2FjbFswXSA9IDA7DQorICAgICAgIAkJDQorICAgICAgIAkJdHBlX2dyb3VwX2Fj
bFsxXSA9IHRwZV90cnVzdGVkX2dpZDsNCisgICAgICAgCX0gZWxzZSB7DQorICAgICAgIAkJdHBl
X2dyb3VwX2FjbFswXSA9IDA7DQorICAgICAgIAl9DQorfQ0KKw0KKy8qICBMb2NhdGUgYSB1aWQg
aW4gdGhlIGxpc3QgKi8NCitzdGF0aWMgaW5saW5lIGludCB0cGVfc2VhcmNoICh1aWRfdCBjYW5k
aWRhdGUpDQoreyANCisgICAgICAgaW50IGk7DQorICAgICAgIGZvciAoaSA9IDA7IGkgPCB0cGVf
YWNsX2NhbmRpZGF0ZXM7IGkrKykgew0KKyAgICAgICAgICAgICAgIGlmIChjYW5kaWRhdGUgPT0g
dHBlX2FjbFtpXSkgew0KKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7DQorICAgICAg
ICAgICAgICAgfQ0KKyAgICAgICB9DQorICAgICAgIHJldHVybiBOQUNLOw0KK30NCisNCisvKiAg
VmVyaWZ5IGEgY2FuZGlkYXRlIHVzZXIuICovDQorc3RhdGljIGlubGluZSBpbnQgdHBlX3Zlcmlm
eSAodWlkX3QgY2FuZGlkYXRlKQ0KK3sNCisgICAgICAgaWYgKCh0cGVfc2VhcmNoKGNhbmRpZGF0
ZSkpICE9IE5BQ0spIHsgDQorICAgICAgICAgICAgICAgcmV0dXJuIChBQ0spOw0KKyAgICAgICB9
DQorICAgICAgIHJldHVybiAoTkFDSyk7DQorfQ0KKw0KKy8qICBWZXJpZnkgYSBjYW5kaWRhdGUg
dXNlciBncm91cC4gKi8NCitzdGF0aWMgaW5saW5lIGludCB0cGVfc2VhcmNoX2dyb3VwIChnaWRf
dCBncm91cF9jYW5kaWRhdGUpDQoreyANCisgICAgICAgaW50IGk7DQorICAgICAgIGZvciAoaSA9
IDA7IGkgPCB0cGVfYWNsX2dyb3VwX2NhbmRpZGF0ZXM7IGkrKykgew0KKyAgICAgICAgICAgICAg
IGlmIChncm91cF9jYW5kaWRhdGUgPT0gdHBlX2dyb3VwX2FjbFtpXSkgew0KKyAgICAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuIGk7DQorICAgICAgICAgICAgICAgfQ0KKyAgICAgICB9DQorICAg
ICAgIHJldHVybiBOQUNLOw0KK30NCitzdGF0aWMgaW5saW5lIGludCB0cGVfZ3JvdXBfdmVyaWZ5
IChnaWRfdCBncm91cF9jYW5kaWRhdGUpDQorew0KKyAgICAgaWYgKCh0cGVfc2VhcmNoX2dyb3Vw
KGdyb3VwX2NhbmRpZGF0ZSkpICE9IE5BQ0spIHsNCisgICAgICAgICAgICAgICByZXR1cm4gKEFD
Syk7DQorICAgICAgIH0NCisgICAgICAgcmV0dXJuIChOQUNLKTsNCit9DQorDQorI2VuZGlmICAv
KiBfX1RQRV9IICovDQo=


--=-5Hk3cYK5sQ1w9xikxsHY--

--=-WvlOs3B+kFDWnW7qSdaj
Content-Type: application/pgp-signature; name=signature.asc
Content-Description: Esta parte del mensaje =?ISO-8859-1?Q?est=E1?= firmada
	digitalmente

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQBB3KfEDcEopW8rLewRAjamAJ9mMdsDEWOk5FKxtlSlk2blFNXrXwCgmDcJ
U+70VYcOQUnvnYp/7Dr7bUQ=
=XNrl
-----END PGP SIGNATURE-----

--=-WvlOs3B+kFDWnW7qSdaj--

