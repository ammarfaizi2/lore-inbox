Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S267473AbTAQKP0>; Fri, 17 Jan 2003 05:15:26 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S267479AbTAQKP0>; Fri, 17 Jan 2003 05:15:26 -0500
Received: from ccinets2.cc.okayama-u.ac.jp ([150.46.41.3]:49161 "EHLO
	ccinets2.cc.okayama-u.ac.jp") by vger.kernel.org with ESMTP
	id <S267473AbTAQKPZ>; Fri, 17 Jan 2003 05:15:25 -0500
Mime-Version: 1.0
X-Mailer: Macintosh Eudora Version 4.3.2-J
Message-Id: <p04320400ba4d865425c0@[10.46.110.41]>
In-Reply-To: <200301170816.51641@bilbo.math.uni-mannheim.de>
References: <200301171304.55582.yama@o2.biotech.okayama-u.ac.jp>
 <200301170816.51641@bilbo.math.uni-mannheim.de>
Date: Fri, 17 Jan 2003 19:26:35 +0900
To: Rolf Eike Beer <eike-kernel@sf-tec.de>,
       Mamoru Yamanishi <yama@o2.biotech.okayama-u.ac.jp>
From: Mamoru Yamanishi <yama@biotech.okayama-u.ac.jp>
Subject: Re: PROBLEM: bad device file for cdrom while using devfs and
 ide-scsi
Cc: linux-kernel@vger.kernel.org
Content-Type: text/plain; charset="us-ascii" ; format="flowed"
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Thanks replying.

>  > [2.] Full description of the problem/report:
>>
>>	I use Kernle-2.4.20 with devfs and ide-scsi.
>>	"devfs" is mounted at boot.
>>
>>	I wonder that the symbolic-link to actual device file of cdrom is not
>>	correct, which is placed in /dev as
>>
>  >		"cdrom0 -> ../scsi/host0/bus0/target0/lun0/cd"
>>
>>	It should be placed in subdirectory /dev/cdroms, or it should be
>>	linked to "scsi/host0/bus0/target0/lun0/cd", I think.
>>
>>	Without ide-scsi, there is /dev/cdroms/cdrom0 which is correctry
>>	linked to actual device file.
>>
>>	I was looking around the kernel source codes, but I cannot find
>>	where it was.
>
>Are you sure that sr_mod is loaded? After installing ide-scsi the cdrom drive
>is a scsi cdrom so you must load the scsi cdrom driver (module sr_mod). If it
>is not in the `lsmod` output you should try "modprobe sr_mod".

The problem is only mis-linked device file.

	# My cdrom can be accessed with /dev/sr0, which is
	# SCSI CD-ROM driver.  For previous compatibility,
	# I make a symbolic link /dev/sr0 to /dev/cdrom,
	# and they works fine.

Device files under devfs are dynamically generated by kernel, right?
For some representative devices, I think, the symbolic links are
also made for user's convenience.  "cdrom0" and "sr0" are such
links, I think.  On my environment, "sr0" has proper link to
actual one, but "cdrom0" do not.

The kernel might generate these links, right?
So I wonder there are some bugs.

Considering the behavior when I boot without ide-scsi, I think
proper place, where "cdrom0" is placed, is /dev/cdroms/cdrom0.
If so, the link "cdrom0 -> ../scsi/host0/bus0/target0/lun0/cd"
become ok.

Sorry for bad explanation in English.
-- 
-------------8<-------------8<-------------8<-------------
Mamoru Yamanishi, Ph. D. <yama@biotech.okayama-u.ac.jp>

Department of Bioscience and Biotechnology
Faculty of Engineering, Okayama University
+81-86-251-8196(voice)/+81-86-251-8264(GIII fax)
