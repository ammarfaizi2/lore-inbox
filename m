Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S263435AbTKQMh2 (ORCPT <rfc822;willy@w.ods.org>);
	Mon, 17 Nov 2003 07:37:28 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S263485AbTKQMh1
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Mon, 17 Nov 2003 07:37:27 -0500
Received: from f17.mail.ru ([194.67.57.47]:43020 "EHLO f17.mail.ru")
	by vger.kernel.org with ESMTP id S263435AbTKQMh0 (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Mon, 17 Nov 2003 07:37:26 -0500
From: =?koi8-r?Q?=22?=Andrey Borzenkov=?koi8-r?Q?=22=20?= 
	<arvidjaar@mail.ru>
To: =?koi8-r?Q?=22?=Takashi Iwai=?koi8-r?Q?=22=20?= <tiwai@suse.de>
Cc: linux-kernel@vger.kernel.org,
       =?koi8-r?Q?=22?=Rusty Russell=?koi8-r?Q?=22=20?= 
	<rusty@rustcorp.com.au>
Subject: Re: modules.pnpmap output support
Mime-Version: 1.0
X-Mailer: mPOP Web-Mail 2.19
X-Originating-IP: [212.248.25.26]
Date: Mon, 17 Nov 2003 15:37:25 +0300
Reply-To: =?koi8-r?Q?=22?=Andrey Borzenkov=?koi8-r?Q?=22=20?= 
	  <arvidjaar@mail.ru>
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7BIT
Message-Id: <E1ALidB-000MWd-00.arvidjaar-mail-ru@f17.mail.ru>
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org


>> > The attached patch makes depmod to output modules.pnpmap file
>> > generated from the pnp device table.
>> > 

thank you. I was about to do it for hotplug.

>> > The output format is not compatible with the old modules.isapnpmap.
>> > The new format shows the pnp id string (e.g. CTL0301) while the old
>> > format uses the hex numbers.  I don't think it's worthy to keep the
>> > compatibility for this (since the new one is more intuitive), but it'd
>> > be easy to follow the old style.
>> 

can you get full ID out of sysfs? This is required for
coldplugging to work (I think mainly of loading drivers
for on-board legacy devices detected by PNP BIOS like floppy,
parport, serial).

Oh, BTW, it reminds me - file2alias prints hex in upper
case while both sysfs and hotplug present them in lower case
(for sure for USB and PCI, and for PNP entries detected by 
PNP BIOS). Should not we unify representation?

>> That seems strange.  If you don't worry about backwards compatibility,
>> then the new scripts/file2alias.c approach is better, 

welcome to the family :)

> which generates
>> aliases for each module (depmod then collects these into
>> /lib/modules/`uname -r`/modules.alias for speed).
>> 
>> The tables generated by depmod are purely for backwards compatibility,
>> although it does look like they will be required throughout 2.6 at
>> this stage.
>> 
>> Does that clarify?
>
>ah, ok, that makes sense.
>
> but still, file2alias (as of test9) doesn't output the entries for pnp
> devices...

Sure it does not, noone did it as yet. If you do it please let me
know, specifically about format for aliases.

Thank you

-andrey
