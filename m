Return-Path: <linux-kernel-owner+willy=40w.ods.org-S266516AbUGPOnq@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S266516AbUGPOnq (ORCPT <rfc822;willy@w.ods.org>);
	Fri, 16 Jul 2004 10:43:46 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S266519AbUGPOnq
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Fri, 16 Jul 2004 10:43:46 -0400
Received: from cantor.suse.de ([195.135.220.2]:23189 "EHLO Cantor.suse.de")
	by vger.kernel.org with ESMTP id S266516AbUGPOnh (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Fri, 16 Jul 2004 10:43:37 -0400
Date: Fri, 16 Jul 2004 16:41:01 +0200
Message-ID: <s5hbrig6mma.wl@alsa2.suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: "Timothy Miller" <theosib@hotmail.com>
Cc: miller@techsource.com, linux-kernel@vger.kernel.org
Subject: Re: HELP: Cannot get ALSA working on via82xx
In-Reply-To: <BAY1-F12tY48eOLJSs100037ffc@hotmail.com>
References: <BAY1-F12tY48eOLJSs100037ffc@hotmail.com>
User-Agent: Wanderlust/2.10.1 (Watching The Wheels) SEMI/1.14.5 (Awara-Onsen) FLIM/1.14.5 (Demachiyanagi) APEL/10.6 MULE XEmacs/21.4 (patch 15) (Security Through Obscurity) (i386-suse-linux)
MIME-Version: 1.0 (generated by SEMI 1.14.5 - "Awara-Onsen")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

At Fri, 16 Jul 2004 10:35:07 -0400,
Timothy Miller wrote:
> 
> > >
> > > I'm not sure if I have via686 or not.  Various tools like lspci don't
> > > seem to reveal much.
> >
> >Hmm, lspci must show the string like 'VIA86C686A' or 'VIA8235' ('VIA'
> >can be 'VT').
> 
> Multimedia audio controller: VIA Technologies, Inc. VT8233/A/8235/8237 AC97 
> Audio Controller (rev 50)
> 
> Is this meaningful?

Yes, it's VIA8235.


> > > That's one of the problems I keep running into with Linux.  There aren't
> > > good tools for finding out what you have, and even when you do find out
> > > what you have, it's hard to figure out which modules you need, because
> > > the module names don't correspond well with the chipset name.
> >
> >You can use alsaconf script.  It will detect the right module.
> 
> I ran that just now... it ripped out the dxs_support option, it didn't seem 
> to do anything with regard to modules, and the sound system is going 
> completely nuts.

Then your device needs a workaround with dxs_support.
(Or possibly an ACPI issue?)

> > > Furthermore, there doesn't seem to be a good way to relate module names
> > > with menuconfig entries.  When someone says to use xyz module, I can't
> > > figure out which menuconfig option to select, so I have to compile ALL
> > > of them as modules, and when someone tells me to use a given menu
> > > option, I can't figure out which module corresponds to it.
> >
> >That's true.  The sure way would be to retrieve the pci id table from
> >the source code...
> >
> > > > You can try snd-mpu401 module instead.
> > >
> > > Well, I have a module snd-mpu401, but when I modprobe it, I get an error
> > > about a non-existant device.
> >
> >Then you might need to give the correct port number and the irq
> >number as module parameters.  Perhaps you can get them from BIOS.
> >
> 
> I'll have to look, but I'm not sure the BIOS says anything about it.  
> Shouldn't it be "plug and play" anyhow?  I thought the days of manually 
> configuring IRQ's were gone...

... only if you set up ACPI :)


> > >  > When ACPI is enabled, the
> > > > configuration will be done automatically.
> > > > The midi device can be available as the second card.
> > >
> > > Ah, well, I had nightmares trying to use ACPI.  I use just APM for
> > > things like power-off (power-off works with APM, but not with ACPI).
> > > Maybe some of the experts can help me to figure out how to get it all to
> > > work.
> > >
> > > I'm about ready to give up on ALSA and go back to OSS.  Maybe someone
> > > can help me to figure out how to get MIDI sequencing to work with OSS
> > > instead.  OSS would at least do audio right without noise and popping
> > > sounds, etc.
> >
> >I guess you see a kernel message when you load snd-via8xx driver
> >regarding dxs_support option (suppose that your chip is VIA823x)?
> >
> >In worst case, you can eliminate the  noises with dxs_support=2
> >option.
> 
> Everyone else says to use 3, but since that doesn't work, I guess I'll try 
> 2.  :)

3 is the default behavior.  Try either 1 or 4 at first.
(See ALSA-Configuration.txt.)


> >Anyway, OSS VIA driver also doesn't support MIDI for VIA823x.
> >It's for VIA686 only, as well as on ALSA driver.
> 
> Hmm... maybe I don't have MIDI hardware then.  Time to look into timidity.

If you thought of a MIDI playback (like timidity does), this board has
anyway no such function on hardware.  A softsynth is the only choice.


Takashi
