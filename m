Return-Path: <linux-kernel-owner+willy=40w.ods.org-S262203AbVANWYh@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S262203AbVANWYh (ORCPT <rfc822;willy@w.ods.org>);
	Fri, 14 Jan 2005 17:24:37 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S262199AbVANWYh
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Fri, 14 Jan 2005 17:24:37 -0500
Received: from mailer.campus.mipt.ru ([194.85.82.4]:49583 "EHLO
	mailer.campus.mipt.ru") by vger.kernel.org with ESMTP
	id S262203AbVANWNK (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Fri, 14 Jan 2005 17:13:10 -0500
Date: Sat, 15 Jan 2005 01:34:33 +0300
From: Evgeniy Polyakov <johnpol@2ka.mipt.ru>
To: johnpol@2ka.mipt.ru
Cc: linux-kernel@vger.kernel.org, Michal Ludvig <michal@logix.cz>,
       Fruhwirth Clemens <clemens@endorphin.org>,
       Andrew Morton <akpm@osdl.org>, James Morris <jmorris@redhat.com>,
       cryptoapi@lists.logix.cz, "David S. Miller" <davem@davemloft.net>
Subject: Re: [PATCH 1/2] CryptoAPI: prepare for processing multiple buffers
 at a time
Message-ID: <20050115013433.22271553@zanzibar.2ka.mipt.ru>
In-Reply-To: <20050115013103.05698f1a@zanzibar.2ka.mipt.ru>
References: <20050115013103.05698f1a@zanzibar.2ka.mipt.ru>
Reply-To: johnpol@2ka.mipt.ru
Organization: MIPT
X-Mailer: Sylpheed-Claws 0.9.12b (GTK+ 1.2.10; i386-pc-linux-gnu)
Mime-Version: 1.0
Content-Type: multipart/mixed;
 boundary="Multipart=_Sat__15_Jan_2005_01_34_33_+0300__ip60RHbG7Y9TX42"
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

This is a multi-part message in MIME format.

--Multipart=_Sat__15_Jan_2005_01_34_33_+0300__ip60RHbG7Y9TX42
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

 via-padlock - patch to enable xcrypt instructions on various VIA CPUs (for example Nehemiah family).
 	It is totally Michal's work, I've just ported it to acrypto.
 	Not tested.
 
 fcrypt - driver for CE-InfoSys FastCrypt PCI card equipped with a SuperCrypt CE99C003B chip that 
 	can offload DES and 3DES encryption from the CPU.
 	It is totally Michal's work too, I've just ported it to acrypto.
 	Not tested.

	Evgeniy Polyakov

Only failure makes us experts. -- Theo de Raadt

--Multipart=_Sat__15_Jan_2005_01_34_33_+0300__ip60RHbG7Y9TX42
Content-Type: application/octet-stream;
 name="fcrypt-04_01_2005.tar.gz"
Content-Disposition: attachment;
 filename="fcrypt-04_01_2005.tar.gz"
Content-Transfer-Encoding: base64

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
AUuzu54AoAAA

--Multipart=_Sat__15_Jan_2005_01_34_33_+0300__ip60RHbG7Y9TX42
Content-Type: application/octet-stream;
 name="via-padlock.patch-04_01_2005"
Content-Disposition: attachment;
 filename="via-padlock.patch-04_01_2005"
Content-Transfer-Encoding: base64

ZGlmZiAtTnJ1IC90bXAvZW1wdHkvTWFrZWZpbGUgdmlhLXBhZGxvY2svTWFrZWZpbGUKLS0tIC90
bXAvZW1wdHkvTWFrZWZpbGUJMTk3MC0wMS0wMSAwMzowMDowMC4wMDAwMDAwMDAgKzAzMDAKKysr
IHZpYS1wYWRsb2NrL01ha2VmaWxlCTIwMDQtMTAtMjYgMDc6MjA6MTEuMDAwMDAwMDAwICswNDAw
CkBAIC0wLDAgKzEsNiBAQAorb2JqLW0JCSs9IHBhZGxvY2subworcGFkbG9jay1vYmpzCTo9IHBh
ZGxvY2stYWVzLm8gcGFkbG9jay1nZW5lcmljLm8KKworY2xlYW46CisJcm0gLWYgKi5vICoua28g
Ki5tb2QuKiAuKi5jbWQgKn4KKwlybSAtcmYgLnRtcF92ZXJzaW9ucwpkaWZmIC1OcnUgL3RtcC9l
bXB0eS9wYWRsb2NrLWFlcy5jIHZpYS1wYWRsb2NrL3BhZGxvY2stYWVzLmMKLS0tIC90bXAvZW1w
dHkvcGFkbG9jay1hZXMuYwkxOTcwLTAxLTAxIDAzOjAwOjAwLjAwMDAwMDAwMCArMDMwMAorKysg
dmlhLXBhZGxvY2svcGFkbG9jay1hZXMuYwkyMDA0LTEyLTIwIDEyOjQ5OjEyLjIyNTM4NDUyOCAr
MDMwMApAQCAtMCwwICsxLDU1MyBAQAorLyogCisgKiBDcnlwdG9ncmFwaGljIEFQSS4KKyAqCisg
KiBTdXBwb3J0IGZvciBWSUEgUGFkTG9jayBoYXJkd2FyZSBjcnlwdG8gZW5naW5lLgorICoKKyAq
IExpbnV4IGRldmVsb3BlcnM6CisgKiAgTWljaGFsIEx1ZHZpZyA8bWx1ZHZpZ0BzdXNlLmN6Pgor
ICoKKyAqIEtleSBleHBhbnNpb24gcm91dGluZSB0YWtlbiBmcm9tIGNyeXB0by9hZXMuYworICoK
KyAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBp
dCBhbmQvb3IgbW9kaWZ5CisgKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFs
IFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQorICogdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyAqIChhdCB5b3Vy
IG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisgKgorICogLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisg
KiBDb3B5cmlnaHQgKGMpIDIwMDIsIERyIEJyaWFuIEdsYWRtYW4gPGJyZ0BnbGFkbWFuLm1lLnVr
PiwgV29yY2VzdGVyLCBVSy4KKyAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuCisgKgorICogTElDRU5T
RSBURVJNUworICoKKyAqIFRoZSBmcmVlIGRpc3RyaWJ1dGlvbiBhbmQgdXNlIG9mIHRoaXMgc29m
dHdhcmUgaW4gYm90aCBzb3VyY2UgYW5kIGJpbmFyeQorICogZm9ybSBpcyBhbGxvd2VkICh3aXRo
IG9yIHdpdGhvdXQgY2hhbmdlcykgcHJvdmlkZWQgdGhhdDoKKyAqCisgKiAgIDEuIGRpc3RyaWJ1
dGlvbnMgb2YgdGhpcyBzb3VyY2UgY29kZSBpbmNsdWRlIHRoZSBhYm92ZSBjb3B5cmlnaHQKKyAq
ICAgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBk
aXNjbGFpbWVyOworICoKKyAqICAgMi4gZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBpbmNs
dWRlIHRoZSBhYm92ZSBjb3B5cmlnaHQKKyAqICAgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29u
ZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyCisgKiAgICAgIGluIHRoZSBkb2N1
bWVudGF0aW9uIGFuZC9vciBvdGhlciBhc3NvY2lhdGVkIG1hdGVyaWFsczsKKyAqCisgKiAgIDMu
IHRoZSBjb3B5cmlnaHQgaG9sZGVyJ3MgbmFtZSBpcyBub3QgdXNlZCB0byBlbmRvcnNlIHByb2R1
Y3RzCisgKiAgICAgIGJ1aWx0IHVzaW5nIHRoaXMgc29mdHdhcmUgd2l0aG91dCBzcGVjaWZpYyB3
cml0dGVuIHBlcm1pc3Npb24uCisgKgorICogQUxURVJOQVRJVkVMWSwgcHJvdmlkZWQgdGhhdCB0
aGlzIG5vdGljZSBpcyByZXRhaW5lZCBpbiBmdWxsLCB0aGlzIHByb2R1Y3QKKyAqIG1heSBiZSBk
aXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIChHUEwpLAorICogaW4gd2hpY2ggY2FzZSB0aGUgcHJvdmlzaW9ucyBvZiB0aGUgR1BMIGFw
cGx5IElOU1RFQUQgT0YgdGhvc2UgZ2l2ZW4gYWJvdmUuCisgKgorICogRElTQ0xBSU1FUgorICoK
KyAqIFRoaXMgc29mdHdhcmUgaXMgcHJvdmlkZWQgJ2FzIGlzJyB3aXRoIG5vIGV4cGxpY2l0IG9y
IGltcGxpZWQgd2FycmFudGllcworICogaW4gcmVzcGVjdCBvZiBpdHMgcHJvcGVydGllcywgaW5j
bHVkaW5nLCBidXQgbm90IGxpbWl0ZWQgdG8sIGNvcnJlY3RuZXNzCisgKiBhbmQvb3IgZml0bmVz
cyBmb3IgcHVycG9zZS4KKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICovCisKKyNpbmNsdWRlIDxs
aW51eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxsaW51eC9pbml0Lmg+CisjaW5jbHVkZSA8bGludXgv
dHlwZXMuaD4KKyNpbmNsdWRlIDxsaW51eC9lcnJuby5oPgorI2luY2x1ZGUgPGxpbnV4L2NyeXB0
by5oPgorI2luY2x1ZGUgPGFzbS9ieXRlb3JkZXIuaD4KKyNpbmNsdWRlIDxsaW51eC9tbS5oPgor
CisjaW5jbHVkZSA8YXNtL3NjYXR0ZXJsaXN0Lmg+CisKKyNpbmNsdWRlICJwYWRsb2NrLmgiCisK
KyNpbmNsdWRlICIuLi9jcnlwdG9fZGVmLmgiCisjaW5jbHVkZSAiLi4vYWNyeXB0by5oIgorI2lu
Y2x1ZGUgIi4uL2NyeXB0b19zdGF0LmgiCisKK3N0YXRpYyBpbmxpbmUgaW50IGFlc19od19leHRr
ZXlfYXZhaWxhYmxlICh1OCBrZXlfbGVuKTsKKworc3RhdGljIGlubGluZSAKK3UzMiBnZW5lcmlj
X3JvdHIzMiAoY29uc3QgdTMyIHgsIGNvbnN0IHVuc2lnbmVkIGJpdHMpCit7CisJY29uc3QgdW5z
aWduZWQgbiA9IGJpdHMgJSAzMjsKKwlyZXR1cm4gKHggPj4gbikgfCAoeCA8PCAoMzIgLSBuKSk7
Cit9CisKK3N0YXRpYyBpbmxpbmUgCit1MzIgZ2VuZXJpY19yb3RsMzIgKGNvbnN0IHUzMiB4LCBj
b25zdCB1bnNpZ25lZCBiaXRzKQoreworCWNvbnN0IHVuc2lnbmVkIG4gPSBiaXRzICUgMzI7CisJ
cmV0dXJuICh4IDw8IG4pIHwgKHggPj4gKDMyIC0gbikpOworfQorCisjZGVmaW5lIHJvdGwgZ2Vu
ZXJpY19yb3RsMzIKKyNkZWZpbmUgcm90ciBnZW5lcmljX3JvdHIzMgorCisvKgorICogI2RlZmlu
ZSBieXRlKHgsIG5yKSAoKHVuc2lnbmVkIGNoYXIpKCh4KSA+PiAobnIqOCkpKSAKKyAqLworaW5s
aW5lIHN0YXRpYyB1OAorYnl0ZShjb25zdCB1MzIgeCwgY29uc3QgdW5zaWduZWQgbikKK3sKKwly
ZXR1cm4geCA+PiAobiA8PCAzKTsKK30KKworI2RlZmluZSB1MzJfaW4oeCkgbGUzMl90b19jcHUo
Kihjb25zdCB1MzIgKikoeCkpCisjZGVmaW5lIHUzMl9vdXQodG8sIGZyb20pICgqKHUzMiAqKSh0
bykgPSBjcHVfdG9fbGUzMihmcm9tKSkKKworc3RhdGljIHU4IHBvd190YWJbMjU2XTsKK3N0YXRp
YyB1OCBsb2dfdGFiWzI1Nl07CitzdGF0aWMgdTggc2J4X3RhYlsyNTZdOworc3RhdGljIHU4IGlz
Yl90YWJbMjU2XTsKK3N0YXRpYyB1MzIgcmNvX3RhYlsxMF07CitzdGF0aWMgdTMyIGZ0X3RhYls0
XVsyNTZdOworc3RhdGljIHUzMiBpdF90YWJbNF1bMjU2XTsKKworc3RhdGljIHUzMiBmbF90YWJb
NF1bMjU2XTsKK3N0YXRpYyB1MzIgaWxfdGFiWzRdWzI1Nl07CisKK3N0YXRpYyBpbmxpbmUgdTgK
K2ZfbXVsdCAodTggYSwgdTggYikKK3sKKwl1OCBhYSA9IGxvZ190YWJbYV0sIGNjID0gYWEgKyBs
b2dfdGFiW2JdOworCisJcmV0dXJuIHBvd190YWJbY2MgKyAoY2MgPCBhYSA/IDEgOiAwKV07Cit9
CisKKyNkZWZpbmUgZmZfbXVsdChhLGIpICAgIChhICYmIGIgPyBmX211bHQoYSwgYikgOiAwKQor
CisjZGVmaW5lIGZfcm4oYm8sIGJpLCBuLCBrKQkJCQkJXAorICAgIGJvW25dID0gIGZ0X3RhYlsw
XVtieXRlKGJpW25dLDApXSBeCQkJCVwKKyAgICAgICAgICAgICBmdF90YWJbMV1bYnl0ZShiaVso
biArIDEpICYgM10sMSldIF4JCVwKKyAgICAgICAgICAgICBmdF90YWJbMl1bYnl0ZShiaVsobiAr
IDIpICYgM10sMildIF4JCVwKKyAgICAgICAgICAgICBmdF90YWJbM11bYnl0ZShiaVsobiArIDMp
ICYgM10sMyldIF4gKihrICsgbikKKworI2RlZmluZSBpX3JuKGJvLCBiaSwgbiwgaykJCQkJCVwK
KyAgICBib1tuXSA9ICBpdF90YWJbMF1bYnl0ZShiaVtuXSwwKV0gXgkJCQlcCisgICAgICAgICAg
ICAgaXRfdGFiWzFdW2J5dGUoYmlbKG4gKyAzKSAmIDNdLDEpXSBeCQlcCisgICAgICAgICAgICAg
aXRfdGFiWzJdW2J5dGUoYmlbKG4gKyAyKSAmIDNdLDIpXSBeCQlcCisgICAgICAgICAgICAgaXRf
dGFiWzNdW2J5dGUoYmlbKG4gKyAxKSAmIDNdLDMpXSBeICooayArIG4pCisKKyNkZWZpbmUgbHNf
Ym94KHgpCQkJCVwKKyAgICAoIGZsX3RhYlswXVtieXRlKHgsIDApXSBeCQkJXAorICAgICAgZmxf
dGFiWzFdW2J5dGUoeCwgMSldIF4JCQlcCisgICAgICBmbF90YWJbMl1bYnl0ZSh4LCAyKV0gXgkJ
CVwKKyAgICAgIGZsX3RhYlszXVtieXRlKHgsIDMpXSApCisKKyNkZWZpbmUgZl9ybChibywgYmks
IG4sIGspCQkJCQlcCisgICAgYm9bbl0gPSAgZmxfdGFiWzBdW2J5dGUoYmlbbl0sMCldIF4JCQkJ
XAorICAgICAgICAgICAgIGZsX3RhYlsxXVtieXRlKGJpWyhuICsgMSkgJiAzXSwxKV0gXgkJXAor
ICAgICAgICAgICAgIGZsX3RhYlsyXVtieXRlKGJpWyhuICsgMikgJiAzXSwyKV0gXgkJXAorICAg
ICAgICAgICAgIGZsX3RhYlszXVtieXRlKGJpWyhuICsgMykgJiAzXSwzKV0gXiAqKGsgKyBuKQor
CisjZGVmaW5lIGlfcmwoYm8sIGJpLCBuLCBrKQkJCQkJXAorICAgIGJvW25dID0gIGlsX3RhYlsw
XVtieXRlKGJpW25dLDApXSBeCQkJCVwKKyAgICAgICAgICAgICBpbF90YWJbMV1bYnl0ZShiaVso
biArIDMpICYgM10sMSldIF4JCVwKKyAgICAgICAgICAgICBpbF90YWJbMl1bYnl0ZShiaVsobiAr
IDIpICYgM10sMildIF4JCVwKKyAgICAgICAgICAgICBpbF90YWJbM11bYnl0ZShiaVsobiArIDEp
ICYgM10sMyldIF4gKihrICsgbikKKworc3RhdGljIHZvaWQKK2dlbl90YWJzICh2b2lkKQorewor
CXUzMiBpLCB0OworCXU4IHAsIHE7CisKKwkvKiBsb2cgYW5kIHBvd2VyIHRhYmxlcyBmb3IgR0Yo
MioqOCkgZmluaXRlIGZpZWxkIHdpdGgKKwkgICAweDAxMWIgYXMgbW9kdWxhciBwb2x5bm9taWFs
IC0gdGhlIHNpbXBsZXN0IHBybWl0aXZlCisJICAgcm9vdCBpcyAweDAzLCB1c2VkIGhlcmUgdG8g
Z2VuZXJhdGUgdGhlIHRhYmxlcyAqLworCisJZm9yIChpID0gMCwgcCA9IDE7IGkgPCAyNTY7ICsr
aSkgeworCQlwb3dfdGFiW2ldID0gKHU4KSBwOworCQlsb2dfdGFiW3BdID0gKHU4KSBpOworCisJ
CXAgXj0gKHAgPDwgMSkgXiAocCAmIDB4ODAgPyAweDAxYiA6IDApOworCX0KKworCWxvZ190YWJb
MV0gPSAwOworCisJZm9yIChpID0gMCwgcCA9IDE7IGkgPCAxMDsgKytpKSB7CisJCXJjb190YWJb
aV0gPSBwOworCisJCXAgPSAocCA8PCAxKSBeIChwICYgMHg4MCA/IDB4MDFiIDogMCk7CisJfQor
CisJZm9yIChpID0gMDsgaSA8IDI1NjsgKytpKSB7CisJCXAgPSAoaSA/IHBvd190YWJbMjU1IC0g
bG9nX3RhYltpXV0gOiAwKTsKKwkJcSA9ICgocCA+PiA3KSB8IChwIDw8IDEpKSBeICgocCA+PiA2
KSB8IChwIDw8IDIpKTsKKwkJcCBePSAweDYzIF4gcSBeICgocSA+PiA2KSB8IChxIDw8IDIpKTsK
KwkJc2J4X3RhYltpXSA9IHA7CisJCWlzYl90YWJbcF0gPSAodTgpIGk7CisJfQorCisJZm9yIChp
ID0gMDsgaSA8IDI1NjsgKytpKSB7CisJCXAgPSBzYnhfdGFiW2ldOworCisJCXQgPSBwOworCQlm
bF90YWJbMF1baV0gPSB0OworCQlmbF90YWJbMV1baV0gPSByb3RsICh0LCA4KTsKKwkJZmxfdGFi
WzJdW2ldID0gcm90bCAodCwgMTYpOworCQlmbF90YWJbM11baV0gPSByb3RsICh0LCAyNCk7CisK
KwkJdCA9ICgodTMyKSBmZl9tdWx0ICgyLCBwKSkgfAorCQkgICAgKCh1MzIpIHAgPDwgOCkgfAor
CQkgICAgKCh1MzIpIHAgPDwgMTYpIHwgKCh1MzIpIGZmX211bHQgKDMsIHApIDw8IDI0KTsKKwor
CQlmdF90YWJbMF1baV0gPSB0OworCQlmdF90YWJbMV1baV0gPSByb3RsICh0LCA4KTsKKwkJZnRf
dGFiWzJdW2ldID0gcm90bCAodCwgMTYpOworCQlmdF90YWJbM11baV0gPSByb3RsICh0LCAyNCk7
CisKKwkJcCA9IGlzYl90YWJbaV07CisKKwkJdCA9IHA7CisJCWlsX3RhYlswXVtpXSA9IHQ7CisJ
CWlsX3RhYlsxXVtpXSA9IHJvdGwgKHQsIDgpOworCQlpbF90YWJbMl1baV0gPSByb3RsICh0LCAx
Nik7CisJCWlsX3RhYlszXVtpXSA9IHJvdGwgKHQsIDI0KTsKKworCQl0ID0gKCh1MzIpIGZmX211
bHQgKDE0LCBwKSkgfAorCQkgICAgKCh1MzIpIGZmX211bHQgKDksIHApIDw8IDgpIHwKKwkJICAg
ICgodTMyKSBmZl9tdWx0ICgxMywgcCkgPDwgMTYpIHwKKwkJICAgICgodTMyKSBmZl9tdWx0ICgx
MSwgcCkgPDwgMjQpOworCisJCWl0X3RhYlswXVtpXSA9IHQ7CisJCWl0X3RhYlsxXVtpXSA9IHJv
dGwgKHQsIDgpOworCQlpdF90YWJbMl1baV0gPSByb3RsICh0LCAxNik7CisJCWl0X3RhYlszXVtp
XSA9IHJvdGwgKHQsIDI0KTsKKwl9Cit9CisKKyNkZWZpbmUgc3Rhcl94KHgpICgoKHgpICYgMHg3
ZjdmN2Y3ZikgPDwgMSkgXiAoKCgoeCkgJiAweDgwODA4MDgwKSA+PiA3KSAqIDB4MWIpCisKKyNk
ZWZpbmUgaW1peF9jb2woeSx4KSAgICAgICBcCisgICAgdSAgID0gc3Rhcl94KHgpOyAgICAgICAg
XAorICAgIHYgICA9IHN0YXJfeCh1KTsgICAgICAgIFwKKyAgICB3ICAgPSBzdGFyX3godik7ICAg
ICAgICBcCisgICAgdCAgID0gdyBeICh4KTsgICAgICAgICAgXAorICAgKHkpICA9IHUgXiB2IF4g
dzsgICAgICAgIFwKKyAgICh5KSBePSByb3RyKHUgXiB0LCAgOCkgXiBcCisgICAgICAgICAgcm90
cih2IF4gdCwgMTYpIF4gXAorICAgICAgICAgIHJvdHIodCwyNCkKKworLyogaW5pdGlhbGlzZSB0
aGUga2V5IHNjaGVkdWxlIGZyb20gdGhlIHVzZXIgc3VwcGxpZWQga2V5ICovCisKKyNkZWZpbmUg
bG9vcDQoaSkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCit7ICAgdCA9IHJv
dHIodCwgIDgpOyB0ID0gbHNfYm94KHQpIF4gcmNvX3RhYltpXTsgICAgXAorICAgIHQgXj0gRV9L
RVlbNCAqIGldOyAgICAgRV9LRVlbNCAqIGkgKyA0XSA9IHQ7ICAgIFwKKyAgICB0IF49IEVfS0VZ
WzQgKiBpICsgMV07IEVfS0VZWzQgKiBpICsgNV0gPSB0OyAgICBcCisgICAgdCBePSBFX0tFWVs0
ICogaSArIDJdOyBFX0tFWVs0ICogaSArIDZdID0gdDsgICAgXAorICAgIHQgXj0gRV9LRVlbNCAq
IGkgKyAzXTsgRV9LRVlbNCAqIGkgKyA3XSA9IHQ7ICAgIFwKK30KKworI2RlZmluZSBsb29wNihp
KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKK3sgICB0ID0gcm90cih0LCAg
OCk7IHQgPSBsc19ib3godCkgXiByY29fdGFiW2ldOyAgICBcCisgICAgdCBePSBFX0tFWVs2ICog
aV07ICAgICBFX0tFWVs2ICogaSArIDZdID0gdDsgICAgXAorICAgIHQgXj0gRV9LRVlbNiAqIGkg
KyAxXTsgRV9LRVlbNiAqIGkgKyA3XSA9IHQ7ICAgIFwKKyAgICB0IF49IEVfS0VZWzYgKiBpICsg
Ml07IEVfS0VZWzYgKiBpICsgOF0gPSB0OyAgICBcCisgICAgdCBePSBFX0tFWVs2ICogaSArIDNd
OyBFX0tFWVs2ICogaSArIDldID0gdDsgICAgXAorICAgIHQgXj0gRV9LRVlbNiAqIGkgKyA0XTsg
RV9LRVlbNiAqIGkgKyAxMF0gPSB0OyAgIFwKKyAgICB0IF49IEVfS0VZWzYgKiBpICsgNV07IEVf
S0VZWzYgKiBpICsgMTFdID0gdDsgICBcCit9CisKKyNkZWZpbmUgbG9vcDgoaSkgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCit7ICAgdCA9IHJvdHIodCwgIDgpOyA7IHQgPSBs
c19ib3godCkgXiByY29fdGFiW2ldOyAgXAorICAgIHQgXj0gRV9LRVlbOCAqIGldOyAgICAgRV9L
RVlbOCAqIGkgKyA4XSA9IHQ7ICAgIFwKKyAgICB0IF49IEVfS0VZWzggKiBpICsgMV07IEVfS0VZ
WzggKiBpICsgOV0gPSB0OyAgICBcCisgICAgdCBePSBFX0tFWVs4ICogaSArIDJdOyBFX0tFWVs4
ICogaSArIDEwXSA9IHQ7ICAgXAorICAgIHQgXj0gRV9LRVlbOCAqIGkgKyAzXTsgRV9LRVlbOCAq
IGkgKyAxMV0gPSB0OyAgIFwKKyAgICB0ICA9IEVfS0VZWzggKiBpICsgNF0gXiBsc19ib3godCk7
ICAgIFwKKyAgICBFX0tFWVs4ICogaSArIDEyXSA9IHQ7ICAgICAgICAgICAgICAgIFwKKyAgICB0
IF49IEVfS0VZWzggKiBpICsgNV07IEVfS0VZWzggKiBpICsgMTNdID0gdDsgICBcCisgICAgdCBe
PSBFX0tFWVs4ICogaSArIDZdOyBFX0tFWVs4ICogaSArIDE0XSA9IHQ7ICAgXAorICAgIHQgXj0g
RV9LRVlbOCAqIGkgKyA3XTsgRV9LRVlbOCAqIGkgKyAxNV0gPSB0OyAgIFwKK30KKworc3RhdGlj
IGludAorYWVzX3NldF9rZXkodm9pZCAqY3R4X2FyZywgY29uc3QgdTggKmluX2tleSwgdW5zaWdu
ZWQgaW50IGtleV9sZW4pCit7CisJc3RydWN0IGFlc19jdHggKmN0eCA9IGN0eF9hcmc7CisJdTMy
IGksIHQsIHUsIHYsIHc7CisJdTMyIFBbQUVTX0VYVEVOREVEX0tFWV9TSVpFXTsKKwl1MzIgcm91
bmRzOworCisJaWYgKGtleV9sZW4gIT0gMTYgJiYga2V5X2xlbiAhPSAyNCAmJiBrZXlfbGVuICE9
IDMyKSB7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWN0eC0+a2V5X2xlbmd0aCA9IGtleV9s
ZW47CisKKwljdHgtPkUgPSBjdHgtPmVfZGF0YTsKKwljdHgtPkQgPSBjdHgtPmRfZGF0YTsKKwor
CS8qIEVuc3VyZSAxNi1CeXRlcyBhbGlnbm1lbnRhdGlvbiBvZiBrZXlzIGZvciBWSUEgUGFkTG9j
ay4gKi8KKwlpZiAoKGludCkoY3R4LT5lX2RhdGEpICYgMHgwRikKKwkJY3R4LT5FICs9IDQgLSAo
KChpbnQpKGN0eC0+ZV9kYXRhKSAmIDB4MEYpIC8gc2l6ZW9mIChjdHgtPmVfZGF0YVswXSkpOwor
CisJaWYgKChpbnQpKGN0eC0+ZF9kYXRhKSAmIDB4MEYpCisJCWN0eC0+RCArPSA0IC0gKCgoaW50
KShjdHgtPmRfZGF0YSkgJiAweDBGKSAvIHNpemVvZiAoY3R4LT5kX2RhdGFbMF0pKTsKKworCUVf
S0VZWzBdID0gdTMyX2luIChpbl9rZXkpOworCUVfS0VZWzFdID0gdTMyX2luIChpbl9rZXkgKyA0
KTsKKwlFX0tFWVsyXSA9IHUzMl9pbiAoaW5fa2V5ICsgOCk7CisJRV9LRVlbM10gPSB1MzJfaW4g
KGluX2tleSArIDEyKTsKKworCS8qIERvbid0IGdlbmVyYXRlIGV4dGVuZGVkIGtleXMgaWYgdGhl
IGhhcmR3YXJlIGNhbiBkbyBpdC4gKi8KKwlpZiAoYWVzX2h3X2V4dGtleV9hdmFpbGFibGUoa2V5
X2xlbikpCisJCXJldHVybiAwOworCisJc3dpdGNoIChrZXlfbGVuKSB7CisJY2FzZSAxNjoKKwkJ
dCA9IEVfS0VZWzNdOworCQlmb3IgKGkgPSAwOyBpIDwgMTA7ICsraSkKKwkJCWxvb3A0IChpKTsK
KwkJYnJlYWs7CisKKwljYXNlIDI0OgorCQlFX0tFWVs0XSA9IHUzMl9pbiAoaW5fa2V5ICsgMTYp
OworCQl0ID0gRV9LRVlbNV0gPSB1MzJfaW4gKGluX2tleSArIDIwKTsKKwkJZm9yIChpID0gMDsg
aSA8IDg7ICsraSkKKwkJCWxvb3A2IChpKTsKKwkJYnJlYWs7CisKKwljYXNlIDMyOgorCQlFX0tF
WVs0XSA9IHUzMl9pbiAoaW5fa2V5ICsgMTYpOworCQlFX0tFWVs1XSA9IHUzMl9pbiAoaW5fa2V5
ICsgMjApOworCQlFX0tFWVs2XSA9IHUzMl9pbiAoaW5fa2V5ICsgMjQpOworCQl0ID0gRV9LRVlb
N10gPSB1MzJfaW4gKGluX2tleSArIDI4KTsKKwkJZm9yIChpID0gMDsgaSA8IDc7ICsraSkKKwkJ
CWxvb3A4IChpKTsKKwkJYnJlYWs7CisJfQorCisJRF9LRVlbMF0gPSBFX0tFWVswXTsKKwlEX0tF
WVsxXSA9IEVfS0VZWzFdOworCURfS0VZWzJdID0gRV9LRVlbMl07CisJRF9LRVlbM10gPSBFX0tF
WVszXTsKKworCWZvciAoaSA9IDQ7IGkgPCBrZXlfbGVuICsgMjQ7ICsraSkgeworCQlpbWl4X2Nv
bCAoRF9LRVlbaV0sIEVfS0VZW2ldKTsKKwl9CisKKwkvKiBQYWRMb2NrIG5lZWRzIGEgZGlmZmVy
ZW50IGZvcm1hdCBvZiB0aGUgZGVjcnlwdGlvbiBrZXkuICovCisJcm91bmRzID0gMTAgKyAoa2V5
X2xlbiAtIDE2KSAvIDQ7CisKKwlmb3IgKGkgPSAwOyBpIDwgcm91bmRzOyBpKyspIHsKKwkJUFso
KGkgKyAxKSAqIDQpICsgMF0gPSBEX0tFWVsoKHJvdW5kcyAtIGkgLSAxKSAqIDQpICsgMF07CisJ
CVBbKChpICsgMSkgKiA0KSArIDFdID0gRF9LRVlbKChyb3VuZHMgLSBpIC0gMSkgKiA0KSArIDFd
OworCQlQWygoaSArIDEpICogNCkgKyAyXSA9IERfS0VZWygocm91bmRzIC0gaSAtIDEpICogNCkg
KyAyXTsKKwkJUFsoKGkgKyAxKSAqIDQpICsgM10gPSBEX0tFWVsoKHJvdW5kcyAtIGkgLSAxKSAq
IDQpICsgM107CisJfQorCisJUFswXSA9IEVfS0VZWyhyb3VuZHMgKiA0KSArIDBdOworCVBbMV0g
PSBFX0tFWVsocm91bmRzICogNCkgKyAxXTsKKwlQWzJdID0gRV9LRVlbKHJvdW5kcyAqIDQpICsg
Ml07CisJUFszXSA9IEVfS0VZWyhyb3VuZHMgKiA0KSArIDNdOworCisJbWVtY3B5KERfS0VZLCBQ
LCBBRVNfRVhURU5ERURfS0VZX1NJWkVfQik7CisKKwlyZXR1cm4gMDsKK30KKworLyogVGVsbHMg
d2hldGhlciB0aGUgQUNFIGlzIGNhcGFibGUgdG8gZ2VuZXJhdGUKKyAgIHRoZSBleHRlbmRlZCBr
ZXkgZm9yIGEgZ2l2ZW4ga2V5X2xlbi4gKi8KK3N0YXRpYyBpbmxpbmUgaW50IGFlc19od19leHRr
ZXlfYXZhaWxhYmxlKHU4IGtleV9sZW4pCit7CisJLyogVE9ETzogV2Ugc2hvdWxkIGNoZWNrIHRo
ZSBhY3R1YWwgQ1BVIG1vZGVsL3N0ZXBwaW5nCisJICAgICAgICAgYXMgaXQncyBsaWtlbHkgdGhh
dCB0aGUgY2FwYWJpbGl0eSB3aWxsIGJlCisJICAgICAgICAgYWRkZWQgaW4gdGhlIG5leHQgQ1BV
IHJldmlzaW9ucy4gKi8KKwlpZiAoa2V5X2xlbiA9PSAxNikKKwkJcmV0dXJuIDE7CisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyB2b2lkIGFlc19wYWRsb2NrKHZvaWQgKmN0eF9hcmcsIHU4ICpvdXRf
YXJnLCBjb25zdCB1OCAqaW5fYXJnLAorCQkJY29uc3QgdTggKml2X2FyZywgc2l6ZV90IG5ieXRl
cywgaW50IGVuY2RlYywKKwkJCWludCBtb2RlKQoreworCXN0cnVjdCBhZXNfY3R4ICpjdHggPSBj
dHhfYXJnOworCWNoYXIgYmlnYnVmW3NpemVvZih1bmlvbiBjd29yZCkgKyAxNl07CisJdW5pb24g
Y3dvcmQgKmN3b3JkOworCXZvaWQgKmtleTsKKworCWlmICgoKGxvbmcpYmlnYnVmKSAmIDB4MEYp
CisJCWN3b3JkID0gKHZvaWQqKShiaWdidWYgKyAxNiAtICgobG9uZyliaWdidWYgJiAweDBGKSk7
CisJZWxzZQorCQljd29yZCA9ICh2b2lkKiliaWdidWY7CisKKwkvKiBQcmVwYXJlIENvbnRyb2wg
d29yZC4gKi8KKwltZW1zZXQgKGN3b3JkLCAwLCBzaXplb2YodW5pb24gY3dvcmQpKTsKKwljd29y
ZC0+Yi5lbmNkZWMgPSAhZW5jZGVjOwkvKiBpbiB0aGUgcmVzdCBvZiBjcnlwdG9hcGkgRU5DPTEv
REVDPTAgKi8KKwljd29yZC0+Yi5yb3VuZHMgPSAxMCArIChjdHgtPmtleV9sZW5ndGggLSAxNikg
LyA0OworCWN3b3JkLT5iLmtzaXplID0gKGN0eC0+a2V5X2xlbmd0aCAtIDE2KSAvIDg7CisKKwkv
KiBJcyB0aGUgaGFyZHdhcmUgY2FwYWJsZSB0byBnZW5lcmF0ZSB0aGUgZXh0ZW5kZWQga2V5PyAq
LworCWlmICghYWVzX2h3X2V4dGtleV9hdmFpbGFibGUoY3R4LT5rZXlfbGVuZ3RoKSkKKwkJY3dv
cmQtPmIua2V5Z2VuID0gMTsKKworCS8qIGN0eC0+RSBzdGFydHMgd2l0aCBhIHBsYWluIGtleSAt
IGlmIHRoZSBoYXJkd2FyZSBpcyBjYXBhYmxlCisJICAgdG8gZ2VuZXJhdGUgdGhlIGV4dGVuZGVk
IGtleSBpdHNlbGYgd2UgbXVzdCBzdXBwbHkKKwkgICB0aGUgcGxhaW4ga2V5IGZvciBib3RoIEVu
Y3J5cHRpb24gYW5kIERlY3J5cHRpb24uICovCisJaWYgKGVuY2RlYyA9PSAgQ1JZUFRPX09QX0VO
Q1JZUFQgfHwgY3dvcmQtPmIua2V5Z2VuID09IDApCisJCWtleSA9IGN0eC0+RTsKKwllbHNlCisJ
CWtleSA9IGN0eC0+RDsKKwkKKwlwYWRsb2NrX2FsaWduZXIob3V0X2FyZywgaW5fYXJnLCBpdl9h
cmcsIGtleSwgY3dvcmQsCisJCQluYnl0ZXMsIEFFU19CTE9DS19TSVpFLCBlbmNkZWMsIG1vZGUp
OworfQorCitzdGF0aWMgdm9pZCBhZXNfcGFkbG9ja19lY2Iodm9pZCAqY3R4LCB1OCAqZHN0LCBj
b25zdCB1OCAqc3JjLCBjb25zdCB1OCAqaXYsCisJCQkgICAgc2l6ZV90IG5ieXRlcywgaW50IGVu
Y2RlYykKK3sKKwlhZXNfcGFkbG9jayhjdHgsIGRzdCwgc3JjLCBOVUxMLCBuYnl0ZXMsIGVuY2Rl
YywgQ1JZUFRPX01PREVfRUNCKTsKK30KKworc3RhdGljIHZvaWQgYWVzX3BhZGxvY2tfY2JjKHZv
aWQgKmN0eCwgdTggKmRzdCwgY29uc3QgdTggKnNyYywgY29uc3QgdTggKml2LAorCQkJICAgIHNp
emVfdCBuYnl0ZXMsIGludCBlbmNkZWMpCit7CisJYWVzX3BhZGxvY2soY3R4LCBkc3QsIHNyYywg
aXYsIG5ieXRlcywgZW5jZGVjLCBDUllQVE9fTU9ERV9DQkMpOworfQorCitzdGF0aWMgdm9pZCBh
ZXNfcGFkbG9ja19jZmIodm9pZCAqY3R4LCB1OCAqZHN0LCBjb25zdCB1OCAqc3JjLCBjb25zdCB1
OCAqaXYsCisJCQkgICAgc2l6ZV90IG5ieXRlcywgaW50IGVuY2RlYykKK3sKKwlhZXNfcGFkbG9j
ayhjdHgsIGRzdCwgc3JjLCBpdiwgbmJ5dGVzLCBlbmNkZWMsIENSWVBUT19NT0RFX0NGQik7Cit9
CisKK3N0YXRpYyB2b2lkIGFlc19wYWRsb2NrX29mYih2b2lkICpjdHgsIHU4ICpkc3QsIGNvbnN0
IHU4ICpzcmMsIGNvbnN0IHU4ICppdiwKKwkJCSAgICBzaXplX3QgbmJ5dGVzLCBpbnQgZW5jZGVj
KQoreworCWFlc19wYWRsb2NrKGN0eCwgZHN0LCBzcmMsIGl2LCBuYnl0ZXMsIGVuY2RlYywgQ1JZ
UFRPX01PREVfT0ZCKTsKK30KKworc3RhdGljIHN0cnVjdCBjcnlwdG9fY2FwYWJpbGl0eSBwYWRs
b2NrX2NhcHNbXSA9IAoreworCXtDUllQVE9fT1BfRU5DUllQVCwgQ1JZUFRPX1RZUEVfQUVTXzEy
OCwgQ1JZUFRPX01PREVfRUNCLCAxMDAwfSwKKwl7Q1JZUFRPX09QX0VOQ1JZUFQsIENSWVBUT19U
WVBFX0FFU18xMjgsIENSWVBUT19NT0RFX0NCQywgMTAwMH0sCisJe0NSWVBUT19PUF9FTkNSWVBU
LCBDUllQVE9fVFlQRV9BRVNfMTI4LCBDUllQVE9fTU9ERV9DRkIsIDEwMDB9LAorCXtDUllQVE9f
T1BfRU5DUllQVCwgQ1JZUFRPX1RZUEVfQUVTXzEyOCwgQ1JZUFRPX01PREVfT0ZCLCAxMDAwfSwK
KworCXtDUllQVE9fT1BfRU5DUllQVCwgQ1JZUFRPX1RZUEVfQUVTXzE5MiwgQ1JZUFRPX01PREVf
RUNCLCAxMDAwfSwKKwl7Q1JZUFRPX09QX0VOQ1JZUFQsIENSWVBUT19UWVBFX0FFU18xOTIsIENS
WVBUT19NT0RFX0NCQywgMTAwMH0sCisJe0NSWVBUT19PUF9FTkNSWVBULCBDUllQVE9fVFlQRV9B
RVNfMTkyLCBDUllQVE9fTU9ERV9DRkIsIDEwMDB9LAorCXtDUllQVE9fT1BfRU5DUllQVCwgQ1JZ
UFRPX1RZUEVfQUVTXzE5MiwgQ1JZUFRPX01PREVfT0ZCLCAxMDAwfSwKKwkKKwl7Q1JZUFRPX09Q
X0VOQ1JZUFQsIENSWVBUT19UWVBFX0FFU18yNTYsIENSWVBUT19NT0RFX0VDQiwgMTAwMH0sCisJ
e0NSWVBUT19PUF9FTkNSWVBULCBDUllQVE9fVFlQRV9BRVNfMjU2LCBDUllQVE9fTU9ERV9DQkMs
IDEwMDB9LAorCXtDUllQVE9fT1BfRU5DUllQVCwgQ1JZUFRPX1RZUEVfQUVTXzI1NiwgQ1JZUFRP
X01PREVfQ0ZCLCAxMDAwfSwKKwl7Q1JZUFRPX09QX0VOQ1JZUFQsIENSWVBUT19UWVBFX0FFU18y
NTYsIENSWVBUT19NT0RFX09GQiwgMTAwMH0sCisJCisJe0NSWVBUT19PUF9ERUNSWVBULCBDUllQ
VE9fVFlQRV9BRVNfMTI4LCBDUllQVE9fTU9ERV9FQ0IsIDEwMDB9LAorCXtDUllQVE9fT1BfREVD
UllQVCwgQ1JZUFRPX1RZUEVfQUVTXzEyOCwgQ1JZUFRPX01PREVfQ0JDLCAxMDAwfSwKKwl7Q1JZ
UFRPX09QX0RFQ1JZUFQsIENSWVBUT19UWVBFX0FFU18xMjgsIENSWVBUT19NT0RFX0NGQiwgMTAw
MH0sCisJe0NSWVBUT19PUF9ERUNSWVBULCBDUllQVE9fVFlQRV9BRVNfMTI4LCBDUllQVE9fTU9E
RV9PRkIsIDEwMDB9LAorCisJe0NSWVBUT19PUF9ERUNSWVBULCBDUllQVE9fVFlQRV9BRVNfMTky
LCBDUllQVE9fTU9ERV9FQ0IsIDEwMDB9LAorCXtDUllQVE9fT1BfREVDUllQVCwgQ1JZUFRPX1RZ
UEVfQUVTXzE5MiwgQ1JZUFRPX01PREVfQ0JDLCAxMDAwfSwKKwl7Q1JZUFRPX09QX0RFQ1JZUFQs
IENSWVBUT19UWVBFX0FFU18xOTIsIENSWVBUT19NT0RFX0NGQiwgMTAwMH0sCisJe0NSWVBUT19P
UF9ERUNSWVBULCBDUllQVE9fVFlQRV9BRVNfMTkyLCBDUllQVE9fTU9ERV9PRkIsIDEwMDB9LAor
CQorCXtDUllQVE9fT1BfREVDUllQVCwgQ1JZUFRPX1RZUEVfQUVTXzI1NiwgQ1JZUFRPX01PREVf
RUNCLCAxMDAwfSwKKwl7Q1JZUFRPX09QX0RFQ1JZUFQsIENSWVBUT19UWVBFX0FFU18yNTYsIENS
WVBUT19NT0RFX0NCQywgMTAwMH0sCisJe0NSWVBUT19PUF9ERUNSWVBULCBDUllQVE9fVFlQRV9B
RVNfMjU2LCBDUllQVE9fTU9ERV9DRkIsIDEwMDB9LAorCXtDUllQVE9fT1BfREVDUllQVCwgQ1JZ
UFRPX1RZUEVfQUVTXzI1NiwgQ1JZUFRPX01PREVfT0ZCLCAxMDAwfSwKK307CitzdGF0aWMgaW50
IHBhZGxvY2tfY2FwX251bWJlciA9IHNpemVvZihwYWRsb2NrX2NhcHMpL3NpemVvZihwYWRsb2Nr
X2NhcHNbMF0pOworCitzdGF0aWMgdm9pZCBwYWRsb2NrX2RhdGFfcmVhZHkoc3RydWN0IGNyeXB0
b19kZXZpY2UgKmRldik7CitzdGF0aWMgaW50IHBhZGxvY2tfZGF0YV9yZWFkeV9yZWVudHJ5Owor
CitzdGF0aWMgc3RydWN0IGNyeXB0b19kZXZpY2UgcGFkbG9ja19kZXZpY2UgPQoreworCS5uYW1l
CQkJPSAidmlhLXBhZGxvY2siLAorCS5kYXRhX3JlYWR5CQk9IHBhZGxvY2tfZGF0YV9yZWFkeSwK
KwkuY2FwCQkJPSAmcGFkbG9ja19jYXBzWzBdLAorfTsKKworc3RhdGljIHZvaWQgcHJvY2Vzc19z
ZXNzaW9uKHN0cnVjdCBjcnlwdG9fc2Vzc2lvbiAqcykKK3sKKwlpbnQgZXJyOworCXU4ICprZXks
ICpkc3QsICpzcmMsICppdjsKKwlzaXplX3Qgc2l6ZSwga2V5bGVuOworCQorCWtleSA9ICgodTgg
KilwYWdlX2FkZHJlc3Mocy0+ZGF0YS5zZ19rZXkucGFnZSkpICsgcy0+ZGF0YS5zZ19rZXkub2Zm
c2V0OworCWtleWxlbiA9IHMtPmRhdGEuc2dfa2V5Lmxlbmd0aDsKKwlkc3QgPSAoKHU4ICopcGFn
ZV9hZGRyZXNzKHMtPmRhdGEuc2dfZHN0LnBhZ2UpKSArIHMtPmRhdGEuc2dfZHN0Lm9mZnNldDsK
KwlzcmMgPSAoKHU4ICopcGFnZV9hZGRyZXNzKHMtPmRhdGEuc2dfc3JjLnBhZ2UpKSArIHMtPmRh
dGEuc2dfc3JjLm9mZnNldDsKKwlzaXplID0gcy0+ZGF0YS5zZ19zcmMubGVuZ3RoOworCWl2ID0g
KCh1OCAqKXBhZ2VfYWRkcmVzcyhzLT5kYXRhLnNnX2l2LnBhZ2UpKSArIHMtPmRhdGEuc2dfaXYu
b2Zmc2V0OworCQorCWVyciA9IGFlc19zZXRfa2V5KHMtPmRhdGEucHJpdiwga2V5LCBrZXlsZW4p
OworCWlmIChlcnIpCisJCXJldHVybjsKKworCXN3aXRjaCAocy0+Y2kubW9kZSkKKwl7CisJCWNh
c2UgQ1JZUFRPX01PREVfRUNCOgorCQkJYWVzX3BhZGxvY2tfZWNiKHMtPmRhdGEucHJpdiwgZHN0
LCBzcmMsIGl2LCBzaXplLCBzLT5jaS5vcGVyYXRpb24pOworCQkJYnJlYWs7CisJCWNhc2UgQ1JZ
UFRPX01PREVfQ0JDOgorCQkJYWVzX3BhZGxvY2tfY2JjKHMtPmRhdGEucHJpdiwgZHN0LCBzcmMs
IGl2LCBzaXplLCBzLT5jaS5vcGVyYXRpb24pOworCQkJYnJlYWs7CisJCWNhc2UgQ1JZUFRPX01P
REVfQ0ZCOgorCQkJYWVzX3BhZGxvY2tfY2ZiKHMtPmRhdGEucHJpdiwgZHN0LCBzcmMsIGl2LCBz
aXplLCBzLT5jaS5vcGVyYXRpb24pOworCQkJYnJlYWs7CisJCWNhc2UgQ1JZUFRPX01PREVfT0ZC
OgorCQkJYWVzX3BhZGxvY2tfb2ZiKHMtPmRhdGEucHJpdiwgZHN0LCBzcmMsIGl2LCBzaXplLCBz
LT5jaS5vcGVyYXRpb24pOworCQkJYnJlYWs7CisJfQorCisJcy0+ZGF0YS5zZ19kc3QubGVuZ3Ro
ID0gc2l6ZTsKKworCXJldHVybjsKK30KKworc3RhdGljIHZvaWQgcGFkbG9ja19kYXRhX3JlYWR5
KHN0cnVjdCBjcnlwdG9fZGV2aWNlICpkZXYpCit7CisJc3RydWN0IGNyeXB0b19zZXNzaW9uICpz
LCAqbjsKKworCWlmIChwYWRsb2NrX2RhdGFfcmVhZHlfcmVlbnRyeSkKKwkJcmV0dXJuOworCisJ
cGFkbG9ja19kYXRhX3JlYWR5X3JlZW50cnkrKzsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUo
cywgbiwgJmRldi0+c2Vzc2lvbl9saXN0LCBkZXZfcXVldWVfZW50cnkpCisJeworCQlpZiAoIXNl
c3Npb25fY29tcGxldGVkKHMpKQorCQl7CisJCQlzdGFydF9wcm9jZXNzX3Nlc3Npb24ocyk7CisJ
CQlwcm9jZXNzX3Nlc3Npb24ocyk7CisJCQljcnlwdG9fc3RhdF9jb21wbGV0ZV9pbmMocyk7CisJ
CQljcnlwdG9fc2Vzc2lvbl9kZXF1ZXVlX3JvdXRlKHMpOworCQkJY29tcGxldGVfc2Vzc2lvbihz
KTsKKwkJCXN0b3BfcHJvY2Vzc19zZXNzaW9uKHMpOworCQl9CisJfQorCXBhZGxvY2tfZGF0YV9y
ZWFkeV9yZWVudHJ5LS07Cit9CisKK2ludCBwYWRsb2NrX2luaXRfYWVzKHZvaWQpCit7CisJdTMy
IGNwdWlkLCBlZHg7CisJdTMyIHZhbCA9IDB4QzAwMDAwMDA7CisKKwljcHVpZCA9IGNwdWlkX2Vh
eCh2YWwpOworCWVkeCA9IGNwdWlkX2VkeCh2YWwpOworCXByaW50aygidmFsPSV4LCBjcHVpZD0l
eCwgZWR4PSV4LlxuIiwgdmFsLCBjcHVpZCwgZWR4KTsKKwlpZiAoY3B1aWQgPj0gdmFsICsgMSkK
Kwl7CisJCXByaW50aygiQm9hcmQgc3VwcG9ydHMgQUNFLlxuIik7CisJfQorCWVsc2UKKwl7CisJ
CXByaW50aygiQm9hcmQgZG9lcyBub3Qgc3VwcG9ydCBBQ0UuXG4iKTsKKwkJcmV0dXJuIC1FTk9E
RVY7CisJfQorCQorCXByaW50ayhLRVJOX05PVElDRSAiVXNpbmcgVklBIFBhZExvY2sgQUNFIGZv
ciBBRVMgYWxnb3JpdGhtIChtdWx0aWJsb2NrKS5cbiIpOworCisJcGFkbG9ja19kZXZpY2UuY2Fw
X251bWJlciA9IHBhZGxvY2tfY2FwX251bWJlcjsKKwkKKwlnZW5fdGFicygpOworCXJldHVybiBj
cnlwdG9fZGV2aWNlX2FkZCgmcGFkbG9ja19kZXZpY2UpOworfQorCit2b2lkIHBhZGxvY2tfZmlu
aV9hZXModm9pZCkKK3sKKwljcnlwdG9fZGV2aWNlX3JlbW92ZSgmcGFkbG9ja19kZXZpY2UpOwor
fQpkaWZmIC1OcnUgL3RtcC9lbXB0eS9wYWRsb2NrLWdlbmVyaWMuYyB2aWEtcGFkbG9jay9wYWRs
b2NrLWdlbmVyaWMuYwotLS0gL3RtcC9lbXB0eS9wYWRsb2NrLWdlbmVyaWMuYwkxOTcwLTAxLTAx
IDAzOjAwOjAwLjAwMDAwMDAwMCArMDMwMAorKysgdmlhLXBhZGxvY2svcGFkbG9jay1nZW5lcmlj
LmMJMjAwNC0xMS0wMSAwOTozMDo0MS4wMDAwMDAwMDAgKzAzMDAKQEAgLTAsMCArMSwxOTEgQEAK
Ky8qIAorICogQ3J5cHRvZ3JhcGhpYyBBUEkuCisgKgorICogU3VwcG9ydCBmb3IgVklBIFBhZExv
Y2sgaGFyZHdhcmUgY3J5cHRvIGVuZ2luZS4KKyAqCisgKiBMaW51eCBkZXZlbG9wZXJzOgorICog
IE1pY2hhbCBMdWR2aWcgPG1sdWR2aWdAc3VzZS5jej4KKyAqCisgKiBUaGlzIHByb2dyYW0gaXMg
ZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICog
aXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBw
dWJsaXNoZWQgYnkKKyAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJz
aW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisgKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2
ZXJzaW9uLgorICovCisKKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxsaW51
eC9pbml0Lmg+CisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlIDxsaW51eC9lcnJu
by5oPgorI2luY2x1ZGUgPGxpbnV4L2NyeXB0by5oPgorI2luY2x1ZGUgPGFzbS9ieXRlb3JkZXIu
aD4KKworI2luY2x1ZGUgInBhZGxvY2suaCIKKyNpbmNsdWRlICIuLi9hY3J5cHRvLmgiCisjaW5j
bHVkZSAiLi4vY3J5cHRvX2RlZi5oIgorCisjZGVmaW5lIFBGWAkicGFkbG9jazogIgorCit0eXBl
ZGVmIHZvaWQgKHhjcnlwdF90KSh1OCAqaW5wdXQsIHU4ICpvdXRwdXQsIHU4ICprZXksIHU4ICpp
diwKKwkJCXZvaWQgKmNvbnRyb2xfd29yZCwgdTMyIGNvdW50KTsKKworc3RhdGljIGlubGluZSB2
b2lkIHBhZGxvY2tfeGNyeXB0X2VjYih1OCAqaW5wdXQsIHU4ICpvdXRwdXQsIHU4ICprZXksCisJ
CQkJICAgICAgdTggKml2LCB2b2lkICpjb250cm9sX3dvcmQsIHUzMiBjb3VudCkKK3sKKwlhc20g
dm9sYXRpbGUgKCJwdXNoZmw7IHBvcGZsIik7CQkvKiBlbmZvcmNlIGtleSByZWxvYWQuICovCisJ
YXNtIHZvbGF0aWxlICgiLmJ5dGUgMHhmMywweDBmLDB4YTcsMHhjOCIJLyogcmVwIHhjcnlwdGVj
YiAqLworCQkgICAgICA6ICI9bSIoKm91dHB1dCksICIrUyIoaW5wdXQpLCAiK0QiKG91dHB1dCkK
KwkJICAgICAgOiAiZCIoY29udHJvbF93b3JkKSwgImIiKGtleSksICJjIihjb3VudCkpOworfQor
CitzdGF0aWMgaW5saW5lIHZvaWQgcGFkbG9ja194Y3J5cHRfY2JjKHU4ICppbnB1dCwgdTggKm91
dHB1dCwgdTggKmtleSwKKwkJCQkgICAgICB1OCAqaXYsIHZvaWQgKmNvbnRyb2xfd29yZCwgdTMy
IGNvdW50KQoreworCWFzbSB2b2xhdGlsZSAoInB1c2hmbDsgcG9wZmwiKTsJCS8qIGVuZm9yY2Ug
a2V5IHJlbG9hZC4gKi8KKwlhc20gdm9sYXRpbGUgKCIuYnl0ZSAweGYzLDB4MGYsMHhhNywweGQw
IgkvKiByZXAgeGNyeXB0Y2JjICovCisJCSAgICAgIDogIj1tIigqb3V0cHV0KSwgIitTIihpbnB1
dCksICIrRCIob3V0cHV0KQorCQkgICAgICA6ICJkIihjb250cm9sX3dvcmQpLCAiYiIoa2V5KSwg
ImMiKGNvdW50KSwgImEiKGl2KSk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBwYWRsb2NrX3hj
cnlwdF9jZmIodTggKmlucHV0LCB1OCAqb3V0cHV0LCB1OCAqa2V5LAorCQkJCSAgICAgIHU4ICpp
diwgdm9pZCAqY29udHJvbF93b3JkLCB1MzIgY291bnQpCit7CisJYXNtIHZvbGF0aWxlICgicHVz
aGZsOyBwb3BmbCIpOwkJLyogZW5mb3JjZSBrZXkgcmVsb2FkLiAqLworCWFzbSB2b2xhdGlsZSAo
Ii5ieXRlIDB4ZjMsMHgwZiwweGE3LDB4ZTAiCS8qIHJlcCB4Y3J5cHRjZmIgKi8KKwkJICAgICAg
OiAiPW0iKCpvdXRwdXQpLCAiK1MiKGlucHV0KSwgIitEIihvdXRwdXQpCisJCSAgICAgIDogImQi
KGNvbnRyb2xfd29yZCksICJiIihrZXkpLCAiYyIoY291bnQpLCAiYSIoaXYpKTsKK30KKworc3Rh
dGljIGlubGluZSB2b2lkIHBhZGxvY2tfeGNyeXB0X29mYih1OCAqaW5wdXQsIHU4ICpvdXRwdXQs
IHU4ICprZXksCisJCQkJICAgICAgdTggKml2LCB2b2lkICpjb250cm9sX3dvcmQsIHUzMiBjb3Vu
dCkKK3sKKwlhc20gdm9sYXRpbGUgKCJwdXNoZmw7IHBvcGZsIik7CQkvKiBlbmZvcmNlIGtleSBy
ZWxvYWQuICovCisJYXNtIHZvbGF0aWxlICgiLmJ5dGUgMHhmMywweDBmLDB4YTcsMHhlOCIJLyog
cmVwIHhjcnlwdG9mYiAqLworCQkgICAgICA6ICI9bSIoKm91dHB1dCksICIrUyIoaW5wdXQpLCAi
K0QiKG91dHB1dCkKKwkJICAgICAgOiAiZCIoY29udHJvbF93b3JkKSwgImIiKGtleSksICJjIihj
b3VudCksICJhIihpdikpOworfQorCit2b2lkICpjcnlwdG9fYWxpZ25lZF9rbWFsbG9jKHNpemVf
dCBzaXplLCBpbnQgbW9kZSwgc2l6ZV90IGFsaWdubWVudCwgdm9pZCAqKmluZGV4KQoreworICAg
ICAgIGNoYXIgKnB0cjsKKworICAgICAgIHB0ciA9IGttYWxsb2Moc2l6ZSArIGFsaWdubWVudCwg
bW9kZSk7CisgICAgICAgKmluZGV4ID0gcHRyOworICAgICAgIGlmIChhbGlnbm1lbnQgPiAxICYm
ICgobG9uZylwdHIgJiAoYWxpZ25tZW50IC0gMSkpKSB7CisgICAgICAgICAgICAgICBwdHIgKz0g
YWxpZ25tZW50IC0gKChsb25nKXB0ciAmIChhbGlnbm1lbnQgLSAxKSk7CisgICAgICAgfQorCisg
ICAgICAgcmV0dXJuIHB0cjsKK30KKwordm9pZCBwYWRsb2NrX2FsaWduZXIodTggKm91dF9hcmcs
IGNvbnN0IHU4ICppbl9hcmcsIGNvbnN0IHU4ICppdl9hcmcsCisJCSAgICAgdm9pZCAqa2V5LCB1
bmlvbiBjd29yZCAqY3dvcmQsCisJCSAgICAgc2l6ZV90IG5ieXRlcywgc2l6ZV90IGJsb2Nrc2l6
ZSwKKwkJICAgICBpbnQgZW5jZGVjLCBpbnQgbW9kZSkKK3sKKwkvKiBEb24ndCBibGluZGx5IG1v
ZGlmeSB0aGlzIHN0cnVjdHVyZSAtIHRoZSBpdGVtcyBtdXN0IAorCSAgIGZpdCBvbiAxNi1CeXRl
cyBib3VuZGFyaWVzISAqLworCXN0cnVjdCBwYWRsb2NrX3hjcnlwdF9kYXRhIHsKKwkJdTggaXZb
YmxvY2tzaXplXTsJCS8qIEluaXRpYWxpemF0aW9uIHZlY3RvciAqLworCX07CisKKwl1OCAqaW4s
ICpvdXQsICppdjsKKwl2b2lkICppbmRleCA9IE5VTEw7CisJY2hhciBiaWdidWZbc2l6ZW9mKHN0
cnVjdCBwYWRsb2NrX3hjcnlwdF9kYXRhKSArIDE2XTsKKwlzdHJ1Y3QgcGFkbG9ja194Y3J5cHRf
ZGF0YSAqZGF0YTsKKworCS8qIFBsYWNlICdkYXRhJyBhdCB0aGUgZmlyc3QgMTYtQnl0ZXMgYWxp
Z25lZCBhZGRyZXNzIGluICdiaWdidWYnLiAqLworCWlmICgoKGxvbmcpYmlnYnVmKSAmIDB4MEYp
CisJCWRhdGEgPSAodm9pZCopKGJpZ2J1ZiArIDE2IC0gKChsb25nKWJpZ2J1ZiAmIDB4MEYpKTsK
KwllbHNlCisJCWRhdGEgPSAodm9pZCopYmlnYnVmOworCisJaWYgKCgobG9uZylpbl9hcmcpICYg
MHgwRikgeworCQlpbiA9IGNyeXB0b19hbGlnbmVkX2ttYWxsb2MobmJ5dGVzLCBHRlBfS0VSTkVM
LCAxNiwgJmluZGV4KTsKKwkJbWVtY3B5KGluLCBpbl9hcmcsIG5ieXRlcyk7CisJfQorCWVsc2UK
KwkJaW4gPSAodTgqKWluX2FyZzsKKwkKKwlpZiAoKChsb25nKW91dF9hcmcpICYgMHgwRikgewor
CQlpZiAoaW5kZXgpCisJCQlvdXQgPSBpbjsgICAgICAgLyogeGNyeXB0IGNhbiB3b3JrICJpbiBw
bGFjZSIgKi8KKwkJZWxzZQorCQkJb3V0ID0gY3J5cHRvX2FsaWduZWRfa21hbGxvYyhuYnl0ZXMs
IEdGUF9LRVJORUwsIDE2LCAmaW5kZXgpOworCX0KKwllbHNlCisJCW91dCA9IG91dF9hcmc7CisK
KwkvKiBBbHdheXMgbWFrZSBhIGxvY2FsIGNvcHkgb2YgSVYgLSB4Y3J5cHQgbWF5IGNoYW5nZSBp
dCEgKi8KKwlpdiA9IGRhdGEtPml2OworCWlmIChpdl9hcmcpCisJCW1lbWNweShpdiwgaXZfYXJn
LCBibG9ja3NpemUpOworCQorCisJZHByaW50aygiZGF0YT0lcFxuIiwgZGF0YSk7CisJZHByaW50
aygiaW49JXBcbiIsIGluKTsKKwlkcHJpbnRrKCJvdXQ9JXBcbiIsIG91dCk7CisJZHByaW50aygi
aXY9JXBcbiIsIGl2KTsKKwlkcHJpbnRrKCJuYnl0ZXM9JWQsIGJsb2Nrc2l6ZT0lZC5cbiIsIG5i
eXRlcywgYmxvY2tzaXplKTsKKworCXN3aXRjaCAobW9kZSkgeworCQljYXNlIENSWVBUT19NT0RF
X0VDQjoKKwkJCXBhZGxvY2tfeGNyeXB0X2VjYihpbiwgb3V0LCBrZXksIGl2LCBjd29yZCwgbmJ5
dGVzL2Jsb2Nrc2l6ZSk7CisJCQlicmVhazsKKworCQljYXNlIENSWVBUT19NT0RFX0NCQzoKKwkJ
CXBhZGxvY2tfeGNyeXB0X2NiYyhpbiwgb3V0LCBrZXksIGl2LCBjd29yZCwgbmJ5dGVzL2Jsb2Nr
c2l6ZSk7CisJCQlicmVhazsKKworCQljYXNlIENSWVBUT19NT0RFX0NGQjoKKwkJCXBhZGxvY2tf
eGNyeXB0X2NmYihpbiwgb3V0LCBrZXksIGl2LCBjd29yZCwgbmJ5dGVzL2Jsb2Nrc2l6ZSk7CisJ
CQlicmVhazsKKworCQljYXNlIENSWVBUT19NT0RFX09GQjoKKwkJCXBhZGxvY2tfeGNyeXB0X29m
Yihpbiwgb3V0LCBrZXksIGl2LCBjd29yZCwgbmJ5dGVzL2Jsb2Nrc2l6ZSk7CisJCQlicmVhazsK
KworCQlkZWZhdWx0OgorCQkJQlVHKCk7CisJfQorCisJLyogQ29weSB0aGUgMTYtQnl0ZSBhbGln
bmVkIG91dHB1dCB0byB0aGUgY2FsbGVyJ3MgYnVmZmVyLiAqLworCWlmIChvdXQgIT0gb3V0X2Fy
ZykKKwkJbWVtY3B5KG91dF9hcmcsIG91dCwgbmJ5dGVzKTsKKworCWlmIChpbmRleCkKKwkJa2Zy
ZWUoaW5kZXgpOworfQorCitzdGF0aWMgaW50IF9faW5pdCBwYWRsb2NrX2luaXQodm9pZCkKK3sK
KwlpbnQgcmV0ID0gLUVOT1NZUzsKKyNpZiAwCQorCWlmICghY3B1X2hhc194Y3J5cHQpIHsKKwkJ
cHJpbnRrKEtFUk5fRVJSIFBGWCAiVklBIFBhZExvY2sgbm90IGRldGVjdGVkLlxuIik7CisJCXJl
dHVybiAtRU5PREVWOworCX0KKworCWlmICghY3B1X2hhc194Y3J5cHRfZW5hYmxlZCkgeworCQlw
cmludGsoS0VSTl9FUlIgUEZYICJWSUEgUGFkTG9jayBkZXRlY3RlZCwgYnV0IG5vdCBlbmFibGVk
LiBIbW0sIHN0cmFuZ2UuLi5cbiIpOworCQlyZXR1cm4gLUVOT0RFVjsKKwl9CisjZW5kaWYKKwlp
ZiAoKHJldCA9IHBhZGxvY2tfaW5pdF9hZXMoKSkpIHsKKwkJcHJpbnRrKEtFUk5fRVJSIFBGWCAi
VklBIFBhZExvY2sgQUVTIGluaXRpYWxpemF0aW9uIGZhaWxlZC5cbiIpOworCQlyZXR1cm4gcmV0
OworCX0KKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyB2b2lkIF9fZXhpdCBwYWRsb2NrX2Zp
bmkodm9pZCkKK3sKKwlwYWRsb2NrX2ZpbmlfYWVzKCk7Cit9CisKK21vZHVsZV9pbml0KHBhZGxv
Y2tfaW5pdCk7Cittb2R1bGVfZXhpdChwYWRsb2NrX2ZpbmkpOworCitNT0RVTEVfREVTQ1JJUFRJ
T04oIlZJQSBQYWRMb2NrIGNyeXB0byBlbmdpbmUgc3VwcG9ydC4iKTsKK01PRFVMRV9MSUNFTlNF
KCJEdWFsIEJTRC9HUEwiKTsKK01PRFVMRV9BVVRIT1IoIk1pY2hhbCBMdWR2aWciKTsKZGlmZiAt
TnJ1IC90bXAvZW1wdHkvcGFkbG9jay5oIHZpYS1wYWRsb2NrL3BhZGxvY2suaAotLS0gL3RtcC9l
bXB0eS9wYWRsb2NrLmgJMTk3MC0wMS0wMSAwMzowMDowMC4wMDAwMDAwMDAgKzAzMDAKKysrIHZp
YS1wYWRsb2NrL3BhZGxvY2suaAkyMDA0LTEwLTI4IDEwOjA1OjUwLjAwMDAwMDAwMCArMDQwMApA
QCAtMCwwICsxLDcxIEBACisvKgorICogQ3J5cHRvZ3JhcGhpYyBBUEkuCisgKgorICogQ29weXJp
Z2h0IChjKSAyMDA0IE1pY2hhbCBMdWR2aWcgPG1sdWR2aWdAc3VzZS5jej4KKyAqCisgKiBUaGlz
IHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29y
IG1vZGlmeSBpdAorICogdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMg
TGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUKKyAqIFNvZnR3YXJlIEZvdW5kYXRpb247
IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgCisg
KiBhbnkgbGF0ZXIgdmVyc2lvbi4KKyAqCisgKi8KKworI2lmbmRlZiBfQ1JZUFRPX1BBRExPQ0tf
SAorI2RlZmluZSBfQ1JZUFRPX1BBRExPQ0tfSAorCisjZGVmaW5lIEFFU19NSU5fS0VZX1NJWkUJ
MTYJLyogaW4gdTggdW5pdHMgKi8KKyNkZWZpbmUgQUVTX01BWF9LRVlfU0laRQkzMgkvKiBkaXR0
byAqLworI2RlZmluZSBBRVNfQkxPQ0tfU0laRQkJMTYJLyogZGl0dG8gKi8KKyNkZWZpbmUgQUVT
X0VYVEVOREVEX0tFWV9TSVpFCTY0CS8qIGluIHUzMiB1bml0cyAqLworI2RlZmluZSBBRVNfRVhU
RU5ERURfS0VZX1NJWkVfQgkoQUVTX0VYVEVOREVEX0tFWV9TSVpFICogc2l6ZW9mKHUzMikpCisK
K3N0cnVjdCBhZXNfY3R4IHsKKwl1MzIgZV9kYXRhW0FFU19FWFRFTkRFRF9LRVlfU0laRSs0XTsK
Kwl1MzIgZF9kYXRhW0FFU19FWFRFTkRFRF9LRVlfU0laRSs0XTsKKwlpbnQga2V5X2xlbmd0aDsK
Kwl1MzIgKkU7CisJdTMyICpEOworfTsKKworI2RlZmluZSBFX0tFWSBjdHgtPkUKKyNkZWZpbmUg
RF9LRVkgY3R4LT5ECisKKworLyogQ29udHJvbCB3b3JkLiAqLworI2lmIDEKK3VuaW9uIGN3b3Jk
IHsKKwl1MzIgY3dvcmRbNF07CisJc3RydWN0IHsKKwkJaW50IHJvdW5kczo0OworCQlpbnQgYWxn
bzozOworCQlpbnQga2V5Z2VuOjE7CisJCWludCBpbnRlcm06MTsKKwkJaW50IGVuY2RlYzoxOwor
CQlpbnQga3NpemU6MjsKKwl9IGI7Cit9OworI2Vsc2UKK3VuaW9uIGN3b3JkIHsKKwl1MzIgY3dv
cmRbNF07CisJc3RydWN0IHsKKwkJdW5zaWduZWQJcm91bmRzOjQsCisJCQkJYWxnbzozLAorCQkJ
CWtleWdlbjoxLAorCQkJCWludGVybToxLAorCQkJCWVuY2RlYzoxLAorCQkJCWtzaXplOjI7CisJ
fSBiOworfTsKKyNlbmRpZgorCisjZGVmaW5lIFBGWAkicGFkbG9jazogIgorCit2b2lkIHBhZGxv
Y2tfYWxpZ25lcih1OCAqb3V0X2FyZywgY29uc3QgdTggKmluX2FyZywgY29uc3QgdTggKml2X2Fy
ZywKKwkJICAgICB2b2lkICprZXksIHVuaW9uIGN3b3JkICpjd29yZCwKKwkJICAgICBzaXplX3Qg
bmJ5dGVzLCBzaXplX3QgYmxvY2tzaXplLAorCQkgICAgIGludCBlbmNkZWMsIGludCBtb2RlKTsK
KworaW50IHBhZGxvY2tfaW5pdF9hZXModm9pZCk7Cit2b2lkIHBhZGxvY2tfZmluaV9hZXModm9p
ZCk7CisKKyNlbmRpZgkvKiBfQ1JZUFRPX1BBRExPQ0tfSCAqLwo=

--Multipart=_Sat__15_Jan_2005_01_34_33_+0300__ip60RHbG7Y9TX42--
