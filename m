Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S263113AbTIAQiY (ORCPT <rfc822;willy@w.ods.org>);
	Mon, 1 Sep 2003 12:38:24 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S263114AbTIAQiY
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Mon, 1 Sep 2003 12:38:24 -0400
Received: from ppp-217-133-42-200.cust-adsl.tiscali.it ([217.133.42.200]:6050
	"EHLO dualathlon.random") by vger.kernel.org with ESMTP
	id S263113AbTIAQiL (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Mon, 1 Sep 2003 12:38:11 -0400
Date: Mon, 1 Sep 2003 18:38:47 +0200
From: Andrea Arcangeli <andrea@suse.de>
To: Alan Cox <alan@lxorguk.ukuu.org.uk>
Cc: Larry McVoy <lm@work.bitmover.com>, Larry McVoy <lm@bitmover.com>,
       Pascal Schmidt <der.eremit@email.de>,
       Linux Kernel Mailing List <linux-kernel@vger.kernel.org>
Subject: Re: bandwidth for bkbits.net (good news)
Message-ID: <20030901163847.GI11503@dualathlon.random>
References: <20030831170633.GA24409@dualathlon.random> <20030831211855.GB12752@work.bitmover.com> <20030831224938.GC24409@dualathlon.random> <1062370358.12058.8.camel@dhcp23.swansea.linux.org.uk> <20030831230219.GD24409@dualathlon.random> <20030831230728.GA4918@work.bitmover.com> <20030831232224.GF24409@dualathlon.random> <1062416635.13372.17.camel@dhcp23.swansea.linux.org.uk> <20030901161316.GH11503@dualathlon.random> <1062433710.14254.7.camel@dhcp23.swansea.linux.org.uk>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <1062433710.14254.7.camel@dhcp23.swansea.linux.org.uk>
User-Agent: Mutt/1.4i
X-GPG-Key: 1024D/68B9CB43 13D9 8355 295F 4823 7C49  C012 DFA1 686E 68B9 CB43
X-PGP-Key: 1024R/CB4660B9 CC A0 71 81 F4 A0 63 AC  C0 4B 81 1D 8C 15 C8 E5
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

On Mon, Sep 01, 2003 at 05:28:31PM +0100, Alan Cox wrote:
> On Llu, 2003-09-01 at 17:13, Andrea Arcangeli wrote:
> > > Each ACK that has caused previous delays generally opens up a 64K window
> > > so you get bursts of data incoming. A sequence of acks can cause the
> > 
> > the congestion avoidance shouldn't allow what you say. It sends a few
> > packets immediatly (cwnd starts > 1 recently), and that's why
> > non-keepalive connections are bad, but after that the congestion window
> > will remain low if we drop the packets.
> 
> You may trigger fast retransmit patterns. Thats why you have to bend the
> window.

fast restransmit are good to trigger, they don't arrive in a flood like
if we had a huge cwnd, if we can send packets out of the network,
they're right to be sent. During congestions the outgoing acks will be
rejected too (it's limiting both ways).

there is no difference between artificial congestion generated by a
shaper and a true congestion. If tcp is correct it has to slowdown
immediatly when it notices congestion.

I also don't see anything specific to a busy http server non support
keepalive in this ack-fast-retransmit matter.

Andrea
