Return-Path: <linux-kernel-owner+willy=40w.ods.org-S261465AbULTSab@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261465AbULTSab (ORCPT <rfc822;willy@w.ods.org>);
	Mon, 20 Dec 2004 13:30:31 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261466AbULTSab
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Mon, 20 Dec 2004 13:30:31 -0500
Received: from ns.suse.de ([195.135.220.2]:54949 "EHLO Cantor.suse.de")
	by vger.kernel.org with ESMTP id S261465AbULTSaZ (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Mon, 20 Dec 2004 13:30:25 -0500
Date: Mon, 20 Dec 2004 19:30:27 +0100
Message-ID: <s5his6wvn3w.wl@alsa2.suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Cc: Linux Kernel list <linux-kernel@vger.kernel.org>
Subject: Re: [BUG] 2.6.10-rc3 snd-powermac crash
In-Reply-To: <1103561717.5301.2.camel@gaston>
References: <1103389648.5967.7.camel@gaston>
	<1103391238.5775.0.camel@gaston>
	<s5hr7lluei7.wl@alsa2.suse.de>
	<1103561717.5301.2.camel@gaston>
User-Agent: Wanderlust/2.10.1 (Watching The Wheels) SEMI/1.14.5 (Awara-Onsen) FLIM/1.14.5 (Demachiyanagi) APEL/10.6 MULE XEmacs/21.4 (patch 15) (Security Through Obscurity) (i386-suse-linux)
MIME-Version: 1.0 (generated by SEMI 1.14.5 - "Awara-Onsen")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

At Mon, 20 Dec 2004 17:55:17 +0100,
Benjamin Herrenschmidt wrote:
> 
> On Mon, 2004-12-20 at 17:21 +0100, Takashi Iwai wrote:
> 
> > Well, the volume and PCM shouldn't be racy.  I'd first suspect another
> > bug in PCM OSS emulation code...
> > 
> > Could you compile with CONFIG_SND_DEBUG=y and see whether it catches
> > anything?
> 
> Didn't catch anything. However, I reproduced it a bit differently this
> time, it didn't try to jump into a NULL pointer in the rate "plugin",
> but rather went into resample and died there on a data access exception
> to some corrupt pointer.

Hmm, we had once a compiler problem about rate.c.  The problem was
fixed when you compiled with frame pointer.
I don't seriously think this is related with your problem, though.

> I don't have a 100% reprocase yet, it seem to be related to playing with
> an OSS mixer while using an OSS app (like xmms), that is basically
> having 2 things opening the OSS emulation, and one of them closing it,
> or something like that, causing the rate plugin (and maybe more) to be
> tore down, while still in use by the other app (looks like a
> use-after-free).

OK, I'll try to reproduce on my system (emulating - currently I have
no powermac systems here).  Is the SRC from 48k to 44.1k Hz?


Takashi
