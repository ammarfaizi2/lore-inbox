Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S265716AbTFSHGL (ORCPT <rfc822;willy@w.ods.org>);
	Thu, 19 Jun 2003 03:06:11 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S265719AbTFSHGL
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Thu, 19 Jun 2003 03:06:11 -0400
Received: from pub237.cambridge.redhat.com ([213.86.99.237]:39643 "EHLO
	warthog.warthog") by vger.kernel.org with ESMTP id S265716AbTFSHGK
	(ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Thu, 19 Jun 2003 03:06:10 -0400
To: "H. Peter Anvin" <hpa@zytor.com>
cc: David Howells <dhowells@cambridge.redhat.com>,
       linux-kernel@vger.kernel.org
Subject: Re: [PATCH] VFS autmounter support 
In-Reply-To: Message from "H. Peter Anvin" <hpa@zytor.com> 
   of "Wed, 18 Jun 2003 10:16:33 PDT." <3EF09E71.8020406@zytor.com> 
User-Agent: EMH/1.14.1 SEMI/1.14.4 (Hosorogi) FLIM/1.14.4
 (=?ISO-8859-4?Q?Kashiharajing=FE-mae?=) APEL/10.4 Emacs/21.2
 (i386-redhat-linux-gnu) MULE/5.0 (SAKAKI)
MIME-Version: 1.0 (generated by SEMI 1.14.4 - "Hosorogi")
Content-Type: text/plain; charset=US-ASCII
Date: Thu, 19 Jun 2003 08:20:06 +0100
Message-ID: <2849.1056007206@warthog.warthog>
From: David Howells <dhowells@warthog.cambridge.redhat.com>
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org


> > That _is_ actually true. Doing "ls -l" in that directory would otherwise
> > cause a mount storm.
> > 
> 
> It's not.  ls -l and all the GUI tools do lstat(), not stat().

Sorry... you're correct. That should have been "ls -F" or "ls --color", both
of which are, I believe, commonly used - _they_ definitely use stat() as well
as lstat().

> > follow_link resolving to itself? Surely that'll cause ELOOP very quickly?
> > And where does this "dummy directory inode" live?
> 
> Nope.  You can follow_link() nonrecursively.  You need a dummy directory 
> inode to mount upon anyway.

You're right about follow_link() not recursing... it would have to recurse
itself, and so can avoid that. However, if it only ever follows to itself, how
does that help? That never actually gets you anywhere... It needs to trigger a
mount at some point.

Or do you mean it should follow to an arbitrary (disconnected, otherwise it
changes the topology from what the AFS admin required) dentry with a dummy
directory inode attached to it?

David
