Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S262442AbSLBKuv>; Mon, 2 Dec 2002 05:50:51 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S262450AbSLBKuv>; Mon, 2 Dec 2002 05:50:51 -0500
Received: from d146.dhcp212-198-27.noos.fr ([212.198.27.146]:11975 "EHLO
	deep-space-9.dsnet") by vger.kernel.org with ESMTP
	id <S262442AbSLBKuu>; Mon, 2 Dec 2002 05:50:50 -0500
Date: Mon, 2 Dec 2002 11:58:10 +0100
From: Stelian Pop <stelian@popies.net>
To: Linux Kernel Mailing List <linux-kernel@vger.kernel.org>
Cc: Linus Torvalds <torvalds@transmeta.com>
Subject: [PATCH 2.5.50+BK] sonypi driver update
Message-ID: <20021202115810.A17187@deep-space-9.dsnet>
Reply-To: Stelian Pop <stelian@popies.net>
Mail-Followup-To: Stelian Pop <stelian@popies.net>,
	Linux Kernel Mailing List <linux-kernel@vger.kernel.org>,
	Linus Torvalds <torvalds@transmeta.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5.1i
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Hi,

This patch corrects a small typo in the previous patch (in the ZOOM 
button definition) and adds events generated by the Memory Stick
reader on VAIO U3 laptops (thanks to Kunihiko IMAI).

Linus, please apply.

Stelian.

===== Documentation/sonypi.txt 1.9 vs edited =====
--- 1.9/Documentation/sonypi.txt	Fri Nov 22 14:48:03 2002
+++ edited/Documentation/sonypi.txt	Mon Dec  2 11:18:17 2002
@@ -95,6 +95,7 @@
 				SONYPI_ZOOM_MASK 		0x0100
 				SONYPI_THUMBPHRASE_MASK 	0x0200
 				SONYPI_MEYE_MASK		0x0400
+				SONYPI_MEMORYSTICK_MASK		0x0800
 
 Module use:
 -----------
===== drivers/char/sonypi.h 1.12 vs edited =====
--- 1.12/drivers/char/sonypi.h	Fri Nov 22 14:56:48 2002
+++ edited/drivers/char/sonypi.h	Mon Dec  2 11:16:40 2002
@@ -37,7 +37,7 @@
 #ifdef __KERNEL__
 
 #define SONYPI_DRIVER_MAJORVERSION	 1
-#define SONYPI_DRIVER_MINORVERSION	15
+#define SONYPI_DRIVER_MINORVERSION	16
 
 #define SONYPI_DEVICE_MODEL_TYPE1	1
 #define SONYPI_DEVICE_MODEL_TYPE2	2
@@ -165,6 +165,7 @@
 #define SONYPI_ZOOM_MASK			0x00000100
 #define SONYPI_THUMBPHRASE_MASK			0x00000200
 #define SONYPI_MEYE_MASK			0x00000400
+#define SONYPI_MEMORYSTICK_MASK			0x00000800
 
 struct sonypi_event {
 	u8	data;
@@ -262,7 +263,7 @@
 
 /* The set of possible zoom events */
 static struct sonypi_event sonypi_zoomev[] = {
-	{ 0x3a, SONYPI_EVENT_ZOOM_PRESSED },
+	{ 0x39, SONYPI_EVENT_ZOOM_PRESSED },
 	{ 0, 0 }
 };
 
@@ -279,6 +280,13 @@
 	{ 0, 0 }
 };
 
+/* The set of possible memorystick events */
+static struct sonypi_event sonypi_memorystickev[] = {
+	{ 0x53, SONYPI_EVENT_MEMORYSTICK_INSERT },
+	{ 0x54, SONYPI_EVENT_MEMORYSTICK_EJECT },
+	{ 0, 0 }
+};
+
 struct sonypi_eventtypes {
 	int			model;
 	u8			data;
@@ -303,6 +311,7 @@
 	{ SONYPI_DEVICE_MODEL_TYPE2, 0x08, SONYPI_HELP_MASK, sonypi_helpev },
 	{ SONYPI_DEVICE_MODEL_TYPE2, 0x08, SONYPI_ZOOM_MASK, sonypi_zoomev },
 	{ SONYPI_DEVICE_MODEL_TYPE2, 0x08, SONYPI_THUMBPHRASE_MASK, sonypi_thumbphraseev },
+	{ SONYPI_DEVICE_MODEL_TYPE2, 0x08, SONYPI_MEMORYSTICK_MASK, sonypi_memorystickev },
 
 	{ 0, 0, 0, 0 }
 };
===== include/linux/sonypi.h 1.6 vs edited =====
--- 1.6/include/linux/sonypi.h	Fri Nov 22 00:45:49 2002
+++ edited/include/linux/sonypi.h	Mon Dec  2 11:14:30 2002
@@ -91,6 +91,9 @@
 #define SONYPI_EVENT_THUMBPHRASE_PRESSED	51
 #define SONYPI_EVENT_MEYE_FACE			52
 #define SONYPI_EVENT_MEYE_OPPOSITE		53
+#define SONYPI_EVENT_MEMORYSTICK_INSERT		54
+#define SONYPI_EVENT_MEMORYSTICK_EJECT		55
+
 
 /* get/set brightness */
 #define SONYPI_IOCGBRT		_IOR('v', 0, __u8)
-- 
Stelian Pop <stelian@popies.net>
