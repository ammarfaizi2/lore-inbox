Return-Path: <linux-kernel-owner@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S266428AbRGTBTX>; Thu, 19 Jul 2001 21:19:23 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S266448AbRGTBTE>; Thu, 19 Jul 2001 21:19:04 -0400
Received: from virgo.cus.cam.ac.uk ([131.111.8.20]:10429 "EHLO
	virgo.cus.cam.ac.uk") by vger.kernel.org with ESMTP
	id <S266428AbRGTBS4>; Thu, 19 Jul 2001 21:18:56 -0400
Date: Fri, 20 Jul 2001 02:19:00 +0100 (BST)
From: Anton Altaparmakov <aia21@cus.cam.ac.uk>
To: Linus Torwalds <torvalds@transmeta.com>
cc: linux-kernel@vger.kernel.org
Subject: [PATCH] Minor cleanup and export three functions
Message-ID: <Pine.SOL.3.96.1010720020154.20239A-200000@virgo.cus.cam.ac.uk>
MIME-Version: 1.0
Content-Type: MULTIPART/MIXED; BOUNDARY="-559023410-1804928587-995591940=:20239"
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org
Original-Recipient: rfc822;linux-kernel-outgoing

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.
  Send mail to mime@docserver.cac.washington.edu for more info.

---559023410-1804928587-995591940=:20239
Content-Type: TEXT/PLAIN; charset=US-ASCII

Linus,

Please consider attached patch. It does three things:

- Adds docbook style comments to a very few functions relating to the page
cache (mm/filemap.c) and does very minor clean up on those to keep within
80 character wide lines (only look affected).

- Minor cleanup making the offset/index parameter "const" in those
functions.

- More importantly, the patch exports the following three functions:

from mm/filemap.c (adding to include/linux/pagemap.h):
	__find_page_nolock()
	__add_to_page_cache()

from fs/buffer.c (adding to include/linux/fs.h):
	create_empty_buffers()

The static keyword is removed, they are added to the indicated header
files as extern or extern inline as appropriate, and they are also added
to kernel/ksyms.c.

These three functions are used by the new NTFS driver which is under
development and in specific in the inode metadata in page cache part. I
have looked at alternatives but they lead to much nastier complications
within the ntfs code. (E.g. due to forcing me to drop the pagecache_lock
if I were to use add_to_page_cache() function instead of
__add_to_page_cache() which would in turn lead to potential race
condition, and anyway dropping the lock to only reacquire it straight
after returning after the function seems very inefficient.)

Any objections to the patch? If not, please apply. Thanks!

Best regards,

	Anton
-- 
Anton Altaparmakov <aia21 at cam.ac.uk> (replace at with @)
Linux NTFS maintainer / WWW: http://linux-ntfs.sf.net/
ICQ: 8561279 / WWW: http://www-stu.christs.cam.ac.uk/~aia21/

---559023410-1804928587-995591940=:20239
Content-Type: TEXT/PLAIN; charset=US-ASCII; name="patch-2.4.7-pre8-aia1"
Content-Transfer-Encoding: BASE64
Content-ID: <Pine.SOL.3.96.1010720021900.20239B@virgo.cus.cam.ac.uk>
Content-Description: 

ZGlmZiAtdXJOIGxpbnV4LTIuNC43LXByZTgtdmFuaWxsYS9mcy9idWZmZXIu
YyBsaW51eC0yLjQuNy1wcmU4LXRuZy1tcnByb3Blci9mcy9idWZmZXIuYw0K
LS0tIGxpbnV4LTIuNC43LXByZTgtdmFuaWxsYS9mcy9idWZmZXIuYwlUaHUg
SnVsIDE5IDE4OjUzOjE3IDIwMDENCisrKyBsaW51eC0yLjQuNy1wcmU4LXRu
Zy1tcnByb3Blci9mcy9idWZmZXIuYwlUaHUgSnVsIDE5IDIwOjQ1OjAwIDIw
MDENCkBAIC0xNDM0LDcgKzE0MzQsOCBAQA0KIAlyZXR1cm4gMTsNCiB9DQog
DQotc3RhdGljIHZvaWQgY3JlYXRlX2VtcHR5X2J1ZmZlcnMoc3RydWN0IHBh
Z2UgKnBhZ2UsIGtkZXZfdCBkZXYsIHVuc2lnbmVkIGxvbmcgYmxvY2tzaXpl
KQ0KK3ZvaWQgY3JlYXRlX2VtcHR5X2J1ZmZlcnMoc3RydWN0IHBhZ2UgKnBh
Z2UsIGtkZXZfdCBkZXYsDQorCQl1bnNpZ25lZCBsb25nIGJsb2Nrc2l6ZSkN
CiB7DQogCXN0cnVjdCBidWZmZXJfaGVhZCAqYmgsICpoZWFkLCAqdGFpbDsN
CiANCmRpZmYgLXVyTiBsaW51eC0yLjQuNy1wcmU4LXZhbmlsbGEvaW5jbHVk
ZS9saW51eC9mcy5oIGxpbnV4LTIuNC43LXByZTgtdG5nLW1ycHJvcGVyL2lu
Y2x1ZGUvbGludXgvZnMuaA0KLS0tIGxpbnV4LTIuNC43LXByZTgtdmFuaWxs
YS9pbmNsdWRlL2xpbnV4L2ZzLmgJVGh1IEp1bCAxOSAxODo1MzoxOSAyMDAx
DQorKysgbGludXgtMi40LjctcHJlOC10bmctbXJwcm9wZXIvaW5jbHVkZS9s
aW51eC9mcy5oCVRodSBKdWwgMTkgMjM6MDI6MTAgMjAwMQ0KQEAgLTEzMjAs
NiArMTMyMCw4IEBADQogDQogdHlwZWRlZiBpbnQgKGdldF9ibG9ja190KShz
dHJ1Y3QgaW5vZGUqLGxvbmcsc3RydWN0IGJ1ZmZlcl9oZWFkKixpbnQpOw0K
IA0KK2V4dGVybiB2b2lkIGNyZWF0ZV9lbXB0eV9idWZmZXJzKHN0cnVjdCBw
YWdlICosIGtkZXZfdCwgdW5zaWduZWQgbG9uZyk7DQorDQogLyogR2VuZXJp
YyBidWZmZXIgaGFuZGxpbmcgZm9yIGJsb2NrIGZpbGVzeXN0ZW1zLi4gKi8N
CiBleHRlcm4gaW50IGJsb2NrX2ZsdXNocGFnZShzdHJ1Y3QgcGFnZSAqLCB1
bnNpZ25lZCBsb25nKTsNCiBleHRlcm4gaW50IGJsb2NrX3N5bWxpbmsoc3Ry
dWN0IGlub2RlICosIGNvbnN0IGNoYXIgKiwgaW50KTsNCmRpZmYgLXVyTiBs
aW51eC0yLjQuNy1wcmU4LXZhbmlsbGEvaW5jbHVkZS9saW51eC9wYWdlbWFw
LmggbGludXgtMi40LjctcHJlOC10bmctbXJwcm9wZXIvaW5jbHVkZS9saW51
eC9wYWdlbWFwLmgNCi0tLSBsaW51eC0yLjQuNy1wcmU4LXZhbmlsbGEvaW5j
bHVkZS9saW51eC9wYWdlbWFwLmgJVHVlIEp1bCAgMyAyMzo0Mjo1NyAyMDAx
DQorKysgbGludXgtMi40LjctcHJlOC10bmctbXJwcm9wZXIvaW5jbHVkZS9s
aW51eC9wYWdlbWFwLmgJVGh1IEp1bCAxOSAyMTowODozMyAyMDAxDQpAQCAt
NjAsNyArNjAsOCBAQA0KICAqIEZvciB0aGUgdGltZSBiZWluZyBpdCB3aWxs
IHdvcmsgZm9yIHN0cnVjdCBhZGRyZXNzX3NwYWNlIHRvbyAobW9zdCBvZg0K
ICAqIHRoZW0gc2l0dGluZyBpbnNpZGUgdGhlIGlub2RlcykuIFdlIG1pZ2h0
IHdhbnQgdG8gY2hhbmdlIGl0IGxhdGVyLg0KICAqLw0KLWV4dGVybiBpbmxp
bmUgdW5zaWduZWQgbG9uZyBfcGFnZV9oYXNoZm4oc3RydWN0IGFkZHJlc3Nf
c3BhY2UgKiBtYXBwaW5nLCB1bnNpZ25lZCBsb25nIGluZGV4KQ0KK2V4dGVy
biBpbmxpbmUgdW5zaWduZWQgbG9uZyBfcGFnZV9oYXNoZm4oc3RydWN0IGFk
ZHJlc3Nfc3BhY2UgKm1hcHBpbmcsDQorCQljb25zdCB1bnNpZ25lZCBsb25n
IGluZGV4KQ0KIHsNCiAjZGVmaW5lIGkgKCgodW5zaWduZWQgbG9uZykgbWFw
cGluZykvKHNpemVvZihzdHJ1Y3QgaW5vZGUpICYgfiAoc2l6ZW9mKHN0cnVj
dCBpbm9kZSkgLSAxKSkpDQogI2RlZmluZSBzKHgpICgoeCkrKCh4KT4+UEFH
RV9IQVNIX0JJVFMpKQ0KQEAgLTc1LDYgKzc2LDggQEANCiAJCQkJICAgICB1
bnNpZ25lZCBsb25nIG9mZnNldCwgc3RydWN0IHBhZ2UgKipoYXNoKTsNCiBl
eHRlcm4gc3RydWN0IHBhZ2UgKiBfX2ZpbmRfbG9ja19wYWdlIChzdHJ1Y3Qg
YWRkcmVzc19zcGFjZSAqIG1hcHBpbmcsDQogCQkJCXVuc2lnbmVkIGxvbmcg
aW5kZXgsIHN0cnVjdCBwYWdlICoqaGFzaCk7DQorZXh0ZXJuIGlubGluZSBz
dHJ1Y3QgcGFnZSAqX19maW5kX3BhZ2Vfbm9sb2NrKHN0cnVjdCBhZGRyZXNz
X3NwYWNlICptYXBwaW5nLA0KKwkJY29uc3QgdW5zaWduZWQgbG9uZyBvZmZz
ZXQsIHN0cnVjdCBwYWdlICpwYWdlKTsNCiBleHRlcm4gdm9pZCBsb2NrX3Bh
Z2Uoc3RydWN0IHBhZ2UgKnBhZ2UpOw0KICNkZWZpbmUgZmluZF9sb2NrX3Bh
Z2UobWFwcGluZywgaW5kZXgpIFwNCiAJX19maW5kX2xvY2tfcGFnZShtYXBw
aW5nLCBpbmRleCwgcGFnZV9oYXNoKG1hcHBpbmcsIGluZGV4KSkNCkBAIC04
Niw4ICs4OSwxMyBAQA0KIA0KIGV4dGVybiB2b2lkIF9fYWRkX3BhZ2VfdG9f
aGFzaF9xdWV1ZShzdHJ1Y3QgcGFnZSAqIHBhZ2UsIHN0cnVjdCBwYWdlICoq
cCk7DQogDQotZXh0ZXJuIHZvaWQgYWRkX3RvX3BhZ2VfY2FjaGUoc3RydWN0
IHBhZ2UgKiBwYWdlLCBzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywg
dW5zaWduZWQgbG9uZyBpbmRleCk7DQotZXh0ZXJuIHZvaWQgYWRkX3RvX3Bh
Z2VfY2FjaGVfbG9ja2VkKHN0cnVjdCBwYWdlICogcGFnZSwgc3RydWN0IGFk
ZHJlc3Nfc3BhY2UgKm1hcHBpbmcsIHVuc2lnbmVkIGxvbmcgaW5kZXgpOw0K
K2V4dGVybiBpbmxpbmUgdm9pZCBfX2FkZF90b19wYWdlX2NhY2hlKHN0cnVj
dCBwYWdlICpwYWdlLA0KKwkJc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBp
bmcsIGNvbnN0IHVuc2lnbmVkIGxvbmcgb2Zmc2V0LA0KKwkJc3RydWN0IHBh
Z2UgKipoYXNoKTsNCitleHRlcm4gdm9pZCBhZGRfdG9fcGFnZV9jYWNoZShz
dHJ1Y3QgcGFnZSAqcGFnZSwgc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBp
bmcsDQorCQljb25zdCB1bnNpZ25lZCBsb25nIGluZGV4KTsNCitleHRlcm4g
dm9pZCBhZGRfdG9fcGFnZV9jYWNoZV9sb2NrZWQoc3RydWN0IHBhZ2UgKnBh
Z2UsDQorCQlzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywgY29uc3Qg
dW5zaWduZWQgbG9uZyBpbmRleCk7DQogDQogZXh0ZXJuIHZvaWQgX19fd2Fp
dF9vbl9wYWdlKHN0cnVjdCBwYWdlICopOw0KIA0KZGlmZiAtdXJOIGxpbnV4
LTIuNC43LXByZTgtdmFuaWxsYS9rZXJuZWwva3N5bXMuYyBsaW51eC0yLjQu
Ny1wcmU4LXRuZy1tcnByb3Blci9rZXJuZWwva3N5bXMuYw0KLS0tIGxpbnV4
LTIuNC43LXByZTgtdmFuaWxsYS9rZXJuZWwva3N5bXMuYwlUaHUgSnVsIDE5
IDE4OjUzOjIwIDIwMDENCisrKyBsaW51eC0yLjQuNy1wcmU4LXRuZy1tcnBy
b3Blci9rZXJuZWwva3N5bXMuYwlUaHUgSnVsIDE5IDIzOjM1OjAzIDIwMDEN
CkBAIC0xOTUsNiArMTk1LDcgQEANCiBFWFBPUlRfU1lNQk9MKHVubG9ja19i
dWZmZXIpOw0KIEVYUE9SVF9TWU1CT0woX193YWl0X29uX2J1ZmZlcik7DQog
RVhQT1JUX1NZTUJPTChfX193YWl0X29uX3BhZ2UpOw0KK0VYUE9SVF9TWU1C
T0woY3JlYXRlX2VtcHR5X2J1ZmZlcnMpOw0KIEVYUE9SVF9TWU1CT0woYmxv
Y2tfd3JpdGVfZnVsbF9wYWdlKTsNCiBFWFBPUlRfU1lNQk9MKGJsb2NrX3Jl
YWRfZnVsbF9wYWdlKTsNCiBFWFBPUlRfU1lNQk9MKGJsb2NrX3ByZXBhcmVf
d3JpdGUpOw0KQEAgLTI0NCw2ICsyNDUsOCBAQA0KIEVYUE9SVF9TWU1CT0wo
cG9sbF9mcmVld2FpdCk7DQogRVhQT1JUX1NZTUJPTChST09UX0RFVik7DQog
RVhQT1JUX1NZTUJPTChfX2ZpbmRfbG9ja19wYWdlKTsNCitFWFBPUlRfU1lN
Qk9MKF9fZmluZF9wYWdlX25vbG9jayk7DQorRVhQT1JUX1NZTUJPTChfX2Fk
ZF90b19wYWdlX2NhY2hlKTsNCiBFWFBPUlRfU1lNQk9MKGdyYWJfY2FjaGVf
cGFnZSk7DQogRVhQT1JUX1NZTUJPTChyZWFkX2NhY2hlX3BhZ2UpOw0KIEVY
UE9SVF9TWU1CT0wodmZzX3JlYWRsaW5rKTsNCmRpZmYgLXVyTiBsaW51eC0y
LjQuNy1wcmU4LXZhbmlsbGEvbW0vZmlsZW1hcC5jIGxpbnV4LTIuNC43LXBy
ZTgtdG5nLW1ycHJvcGVyL21tL2ZpbGVtYXAuYw0KLS0tIGxpbnV4LTIuNC43
LXByZTgtdmFuaWxsYS9tbS9maWxlbWFwLmMJVGh1IEp1bCAxOSAxODo1Mzoy
MCAyMDAxDQorKysgbGludXgtMi40LjctcHJlOC10bmctbXJwcm9wZXIvbW0v
ZmlsZW1hcC5jCVRodSBKdWwgMTkgMjA6MzM6MTggMjAwMQ0KQEAgLTMyMSw3
ICszMjEsMTkgQEANCiAJcmV0dXJuIE5VTEw7DQogfQ0KIA0KLXN0YXRpYyBp
bmxpbmUgc3RydWN0IHBhZ2UgKiBfX2ZpbmRfcGFnZV9ub2xvY2soc3RydWN0
IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsIHVuc2lnbmVkIGxvbmcgb2Zmc2V0
LCBzdHJ1Y3QgcGFnZSAqcGFnZSkNCisvKioNCisgKiBfX2ZpbmRfcGFnZV9u
b2xvY2sgLSBmaW5kIGEgcGFnZSBnaXZlbiBpdHMgaGFzaCB3aXRob3V0IGxv
Y2tpbmcgaXQNCisgKiBAbWFwcGluZzoJYWRkcmVzcyBzcGFjZSBtYXBwaW5n
IG9mIHRoZSBwYWdlIHdlIGFyZSBsb29raW5nIGZvcg0KKyAqIEBvZmZzZXQ6
CW9mZnNldCBpbnRvIHRoZSBwYWdlIGNhY2hlIG9mIEBtYXBwaW5nIHRvIGZp
bmQgDQorICogQHBhZ2U6CXRoZSBmaXJzdCBwYWdlIGluIHRoZSBoYXNoDQor
ICoNCisgKiBUaGlzIGZpbmRzIGEgcGFnZSBnaXZlbiBpdCdzIGhhc2ggd2l0
aG91dCB0YWtpbmcgYW55IGxvY2tzLCB0aHVzIHRoZSBjYWxsZXINCisgKiBu
ZWVkcyB0byBob2xkIHRoZSBwYWdlY2FjaGVfbG9jayBzcGlubG9jay4NCisg
Kg0KKyAqIFJldHVybiB0aGUgZm91bmQgcGFnZSBvciBOVUxMLCBpZiB0aGUg
cGFnZSBpcyBub3QgcHJlc2VudC4NCisgKi8NCitpbmxpbmUgc3RydWN0IHBh
Z2UgKl9fZmluZF9wYWdlX25vbG9jayhzdHJ1Y3QgYWRkcmVzc19zcGFjZSAq
bWFwcGluZywNCisJCWNvbnN0IHVuc2lnbmVkIGxvbmcgb2Zmc2V0LCBzdHJ1
Y3QgcGFnZSAqcGFnZSkNCiB7DQogCWdvdG8gaW5zaWRlOw0KIA0KQEAgLTUw
NCwxMyArNTE2LDE5IEBADQogCXNwaW5fdW5sb2NrKCZwYWdlY2FjaGVfbG9j
ayk7DQogfQ0KIA0KLS8qDQotICogQWRkIGEgcGFnZSB0byB0aGUgaW5vZGUg
cGFnZSBjYWNoZS4NCisvKioNCisgKiBhZGRfdG9fcGFnZV9jYWNoZV9sb2Nr
ZWQgLSBhZGQgYSBsb2NrZWQgcGFnZSB0byB0aGUgcGFnZSBjYWNoZQ0KKyAq
IEBwYWdlOgl0aGUgcGFnZSB0byBhZGQNCisgKiBAbWFwcGluZzoJYWRkcmVz
cyBzcGFjZSBtYXBwaW5nIGludG8gd2hpY2ggdG8gaW5zZXJ0IHRoZSBAcGFn
ZQ0KKyAqIEBpbmRleDoJb2Zmc2V0IGludG8gdGhlIHBhZ2UgY2FjaGUgb2Yg
QG1hcHBpbmcgYXQgd2hpY2ggdG8gaW5zZXJ0IEBwYWdlDQogICoNCi0gKiBU
aGUgY2FsbGVyIG11c3QgaGF2ZSBsb2NrZWQgdGhlIHBhZ2UgYW5kIA0KLSAq
IHNldCBhbGwgdGhlIHBhZ2UgZmxhZ3MgY29ycmVjdGx5Li4NCisgKiBUaGlz
IGFkZHMgYSBwYWdlIHRvIHRoZSBpbm9kZSBwYWdlIGNhY2hlLg0KKyAqDQor
ICogVGhlIGNhbGxlciBtdXN0IGhhdmUgbG9ja2VkIHRoZSBwYWdlIGFuZCBz
ZXQgYWxsIHRoZSBwYWdlIGZsYWdzIGNvcnJlY3RseSwNCisgKiBidXQgbXVz
dCBub3QgaG9sZCB0aGUgcGFnZWNhY2hlX2xvY2sgc3BpbmxvY2sgYXMgdGhp
cyBmdW5jdGlvbiBhY3F1aXJlcyBpdC4NCiAgKi8NCi12b2lkIGFkZF90b19w
YWdlX2NhY2hlX2xvY2tlZChzdHJ1Y3QgcGFnZSAqIHBhZ2UsIHN0cnVjdCBh
ZGRyZXNzX3NwYWNlICptYXBwaW5nLCB1bnNpZ25lZCBsb25nIGluZGV4KQ0K
K3ZvaWQgYWRkX3RvX3BhZ2VfY2FjaGVfbG9ja2VkKHN0cnVjdCBwYWdlICpw
YWdlLCBzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywNCisJCWNvbnN0
IHVuc2lnbmVkIGxvbmcgaW5kZXgpDQogew0KIAlpZiAoIVBhZ2VMb2NrZWQo
cGFnZSkpDQogCQlCVUcoKTsNCkBAIC01MjQsMjAgKzU0MiwzMCBAQA0KIAlz
cGluX3VubG9jaygmcGFnZWNhY2hlX2xvY2spOw0KIH0NCiANCi0vKg0KLSAq
IFRoaXMgYWRkcyBhIHBhZ2UgdG8gdGhlIHBhZ2UgY2FjaGUsIHN0YXJ0aW5n
IG91dCBhcyBsb2NrZWQsDQotICogb3duZWQgYnkgdXMsIGJ1dCB1bnJlZmVy
ZW5jZWQsIG5vdCB1cHRvZGF0ZSBhbmQgd2l0aCBubyBlcnJvcnMuDQorLyoq
DQorICogX19hZGRfdG9fcGFnZV9jYWNoZSAtIGFkZCBhIHBhZ2UgdG8gdGhl
IHBhZ2UgY2FjaGUNCisgKiBAcGFnZToJdGhlIHBhZ2UgdG8gYWRkDQorICog
QG1hcHBpbmc6CWFkZHJlc3Mgc3BhY2UgbWFwcGluZyBpbnRvIHdoaWNoIHRv
IGluc2VydCB0aGUgQHBhZ2UNCisgKiBAb2Zmc2V0OglvZmZzZXQgaW50byB0
aGUgcGFnZSBjYWNoZSBvZiBAbWFwcGluZyBhdCB3aGljaCB0byBpbnNlcnQg
QHBhZ2UNCisgKiBAaGFzaDoJaGFzaCBmb3IgdGhlIEBwYWdlLCBvYnRhaW5l
ZCB3aXRoIHBhZ2VfaGFzaChAbWFwcGluZywgQG9mZnNldCkNCisgKg0KKyAq
IFRoaXMgYWRkcyBhIHBhZ2UgdG8gdGhlIHBhZ2UgY2FjaGUsIHN0YXJ0aW5n
IG91dCBhcyBsb2NrZWQsIG93bmVkIGJ5IHVzLA0KKyAqIGJ1dCB1bnJlZmVy
ZW5jZWQsIG5vdCB1cHRvZGF0ZSBhbmQgd2l0aCBubyBlcnJvcnMuDQorICoN
CisgKiBDYWxsZXIgbmVlZHMgdG8gaG9sZCB0aGUgcGFnZWNhY2hlX2xvY2sg
c3BpbmxvY2suDQogICovDQotc3RhdGljIGlubGluZSB2b2lkIF9fYWRkX3Rv
X3BhZ2VfY2FjaGUoc3RydWN0IHBhZ2UgKiBwYWdlLA0KLQlzdHJ1Y3QgYWRk
cmVzc19zcGFjZSAqbWFwcGluZywgdW5zaWduZWQgbG9uZyBvZmZzZXQsDQot
CXN0cnVjdCBwYWdlICoqaGFzaCkNCitpbmxpbmUgdm9pZCBfX2FkZF90b19w
YWdlX2NhY2hlKHN0cnVjdCBwYWdlICpwYWdlLA0KKwkJc3RydWN0IGFkZHJl
c3Nfc3BhY2UgKm1hcHBpbmcsIGNvbnN0IHVuc2lnbmVkIGxvbmcgb2Zmc2V0
LA0KKwkJc3RydWN0IHBhZ2UgKipoYXNoKQ0KIHsNCiAJdW5zaWduZWQgbG9u
ZyBmbGFnczsNCiANCiAJaWYgKFBhZ2VMb2NrZWQocGFnZSkpDQogCQlCVUco
KTsNCiANCi0JZmxhZ3MgPSBwYWdlLT5mbGFncyAmIH4oKDEgPDwgUEdfdXB0
b2RhdGUpIHwgKDEgPDwgUEdfZXJyb3IpIHwgKDEgPDwgUEdfZGlydHkpIHwg
KDEgPDwgUEdfcmVmZXJlbmNlZCkgfCAoMSA8PCBQR19hcmNoXzEpIHwgKDEg
PDwgUEdfY2hlY2tlZCkpOw0KKwlmbGFncyA9IHBhZ2UtPmZsYWdzICYgfigo
MSA8PCBQR191cHRvZGF0ZSkgfCAoMSA8PCBQR19lcnJvcikgfA0KKwkJCSgx
IDw8IFBHX2RpcnR5KSB8ICgxIDw8IFBHX3JlZmVyZW5jZWQpIHwNCisJCQko
MSA8PCBQR19hcmNoXzEpIHwgKDEgPDwgUEdfY2hlY2tlZCkpOw0KIAlwYWdl
LT5mbGFncyA9IGZsYWdzIHwgKDEgPDwgUEdfbG9ja2VkKTsNCiAJcGFnZV9j
YWNoZV9nZXQocGFnZSk7DQogCXBhZ2UtPmluZGV4ID0gb2Zmc2V0Ow0KQEAg
LTU0Niw3ICs1NzQsMjEgQEANCiAJbHJ1X2NhY2hlX2FkZChwYWdlKTsNCiB9
DQogDQotdm9pZCBhZGRfdG9fcGFnZV9jYWNoZShzdHJ1Y3QgcGFnZSAqIHBh
Z2UsIHN0cnVjdCBhZGRyZXNzX3NwYWNlICogbWFwcGluZywgdW5zaWduZWQg
bG9uZyBvZmZzZXQpDQorLyoqDQorICogYWRkX3RvX3BhZ2VfY2FjaGUgLSBh
ZGQgYSBwYWdlIHRvIHRoZSBwYWdlIGNhY2hlDQorICogQHBhZ2U6CXRoZSBw
YWdlIHRvIGFkZA0KKyAqIEBtYXBwaW5nOglhZGRyZXNzIHNwYWNlIG1hcHBp
bmcgaW50byB3aGljaCB0byBpbnNlcnQgdGhlIEBwYWdlDQorICogQG9mZnNl
dDoJb2Zmc2V0IGludG8gdGhlIHBhZ2UgY2FjaGUgb2YgQG1hcHBpbmcgYXQg
d2hpY2ggdG8gaW5zZXJ0IEBwYWdlDQorICoNCisgKiBUaGlzIGFkZHMgYSBw
YWdlIHRvIHRoZSBwYWdlIGNhY2hlLCBzdGFydGluZyBvdXQgYXMgbG9ja2Vk
LCBvd25lZCBieSB1cywNCisgKiBidXQgdW5yZWZlcmVuY2VkLCBub3QgdXB0
b2RhdGUgYW5kIHdpdGggbm8gZXJyb3JzLg0KKyAqDQorICogQ2FsbGVyIG11
c3Qgbm90IGhvbGQgdGhlIHBhZ2VjYWNoZV9sb2NrIHNwaW5sb2NrIGFzIHRo
aXMgZnVuY3Rpb24gYWNxdWlyZXMNCisgKiBpdC4gSWYgeW91IGFscmVhZHkg
b3duIHRoZSBwYWdlY2FjaGVfbG9jaywgdXNlIHRoZSBpbmxpbmVkDQorICog
X19hZGRfdG9fcGFnZV9jYWNoZSgpIGZ1bmN0aW9uIGluc3RlYWQuDQorICov
DQordm9pZCBhZGRfdG9fcGFnZV9jYWNoZShzdHJ1Y3QgcGFnZSAqcGFnZSwg
c3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsDQorCQljb25zdCB1bnNp
Z25lZCBsb25nIG9mZnNldCkNCiB7DQogCXNwaW5fbG9jaygmcGFnZWNhY2hl
X2xvY2spOw0KIAlfX2FkZF90b19wYWdlX2NhY2hlKHBhZ2UsIG1hcHBpbmcs
IG9mZnNldCwgcGFnZV9oYXNoKG1hcHBpbmcsIG9mZnNldCkpOw0K
---559023410-1804928587-995591940=:20239--
