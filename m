Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S264334AbTLVGa0 (ORCPT <rfc822;willy@w.ods.org>);
	Mon, 22 Dec 2003 01:30:26 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S264347AbTLVGYg
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Mon, 22 Dec 2003 01:24:36 -0500
Received: from zero.voxel.net ([209.123.232.253]:31378 "EHLO zero.voxel.net")
	by vger.kernel.org with ESMTP id S264334AbTLVGWd (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Mon, 22 Dec 2003 01:22:33 -0500
Subject: [PATCH 7/10] CardServices() removal from pcmcia net drivers
From: Andres Salomon <dilinger@voxel.net>
To: linux-kernel@vger.kernel.org
Cc: dahinds@users.sourceforge.net, akpm@osdl.org
Content-Type: multipart/signed; micalg=pgp-sha1; protocol="application/pgp-signature"; boundary="=-WfrAOh9i0bMPCN+lb1i0"
Message-Id: <1072073138.27831.37.camel@spiral.internal>
Mime-Version: 1.0
X-Mailer: Ximian Evolution 1.4.5 
Date: Mon, 22 Dec 2003 01:17:21 -0500
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org


--=-WfrAOh9i0bMPCN+lb1i0
Content-Type: multipart/mixed; boundary="=-YJkjJ161gSRj1QisD2dI"


--=-YJkjJ161gSRj1QisD2dI
Content-Type: text/plain
Content-Transfer-Encoding: quoted-printable

Part 7 of 10.

--=-YJkjJ161gSRj1QisD2dI
Content-Disposition: attachment; filename=007-cs_remove.patch
Content-Type: text/x-patch; name=007-cs_remove.patch; charset=us-ascii
Content-Transfer-Encoding: base64

UmV2aXNpb246IGxpbnV4LS1tYWlubGluZS0tMi42LS1wYXRjaC0yMA0KQXJjaGl2ZTogZGlsaW5n
ZXJAdm94ZWwubmV0LS0yMDAzLXNwaXJhbA0KQ3JlYXRvcjogQW5kcmVzIFNhbG9tb24gPGRpbGlu
Z2VyQHZveGVsLm5ldD4NCkRhdGU6IFN1biBEZWMgMjEgMjE6NDQ6MTMgRVNUIDIwMDMNClN0YW5k
YXJkLWRhdGU6IDIwMDMtMTItMjIgMDI6NDQ6MTMgR01UDQpNb2RpZmllZC1maWxlczogZHJpdmVy
cy9uZXQvcGNtY2lhL2F4bmV0X2NzLmMNCk5ldy1wYXRjaGVzOiBkaWxpbmdlckB2b3hlbC5uZXQt
LTIwMDMtc3BpcmFsL2xpbnV4LS1tYWlubGluZS0tMi42LS1wYXRjaC0yMA0KU3VtbWFyeTogQ2Fy
ZFNlcnZpY2VzKCkgcmVtb3ZhbCwgcHQuIDcNCktleXdvcmRzOiANCg0KUmVtb3ZlIGNhbGxzIHRv
IENhcmRTZXJ2aWNlcygpLCBwYXJ0IDc7IGF4bmV0X2NzLmMuDQoNCiogYWRkZWQgZmlsZXMNCg0K
ICAgIHthcmNofS9saW51eC9saW51eC0tbWFpbmxpbmUvbGludXgtLW1haW5saW5lLS0yLjYvZGls
aW5nZXJAdm94ZWwubmV0LS0yMDAzLXNwaXJhbC9wYXRjaC1sb2cvcGF0Y2gtMjANCg0KKiBtb2Rp
ZmllZCBmaWxlcw0KDQotLS0gb3JpZy9kcml2ZXJzL25ldC9wY21jaWEvYXhuZXRfY3MuYw0KKysr
IG1vZC9kcml2ZXJzL25ldC9wY21jaWEvYXhuZXRfY3MuYw0KQEAgLTIwNSw3ICsyMDUsNyBAQA0K
ICAgICBjbGllbnRfcmVnLmV2ZW50X2hhbmRsZXIgPSAmYXhuZXRfZXZlbnQ7DQogICAgIGNsaWVu
dF9yZWcuVmVyc2lvbiA9IDB4MDIxMDsNCiAgICAgY2xpZW50X3JlZy5ldmVudF9jYWxsYmFja19h
cmdzLmNsaWVudF9kYXRhID0gbGluazsNCi0gICAgcmV0ID0gQ2FyZFNlcnZpY2VzKFJlZ2lzdGVy
Q2xpZW50LCAmbGluay0+aGFuZGxlLCAmY2xpZW50X3JlZyk7DQorICAgIHJldCA9IHBjbWNpYV9y
ZWdpc3Rlcl9jbGllbnQoJmxpbmstPmhhbmRsZSwgJmNsaWVudF9yZWcpOw0KICAgICBpZiAocmV0
ICE9IENTX1NVQ0NFU1MpIHsNCiAJY3NfZXJyb3IobGluay0+aGFuZGxlLCBSZWdpc3RlckNsaWVu
dCwgcmV0KTsNCiAJYXhuZXRfZGV0YWNoKGxpbmspOw0KQEAgLTI0NCw3ICsyNDQsNyBAQA0KICAg
ICB9DQogDQogICAgIGlmIChsaW5rLT5oYW5kbGUpDQotCUNhcmRTZXJ2aWNlcyhEZXJlZ2lzdGVy
Q2xpZW50LCBsaW5rLT5oYW5kbGUpOw0KKwlwY21jaWFfZGVyZWdpc3Rlcl9jbGllbnQobGluay0+
aGFuZGxlKTsNCiANCiAgICAgLyogVW5saW5rIGRldmljZSBzdHJ1Y3R1cmUsIGZyZWUgYml0cyAq
Lw0KICAgICAqbGlua3AgPSBsaW5rLT5uZXh0Ow0KQEAgLTMxMywxMSArMzEzLDggQEANCiANCiA9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09Ki8NCiANCi0jZGVmaW5lIENTX0NIRUNLKGZuLCBhcmdzLi4uKSBcDQotd2hp
bGUgKChsYXN0X3JldD1DYXJkU2VydmljZXMobGFzdF9mbj0oZm4pLCBhcmdzKSkhPTApIGdvdG8g
Y3NfZmFpbGVkDQotDQotI2RlZmluZSBDRkdfQ0hFQ0soZm4sIGFyZ3MuLi4pIFwNCi1pZiAoQ2Fy
ZFNlcnZpY2VzKGZuLCBhcmdzKSAhPSAwKSBnb3RvIG5leHRfZW50cnkNCisjZGVmaW5lIENTX0NI
RUNLKGZuLCByZXQpIFwNCitkbyB7IGxhc3RfZm4gPSAoZm4pOyBpZiAoKGxhc3RfcmV0ID0gKHJl
dCkpICE9IDApIGdvdG8gY3NfZmFpbGVkOyB9IHdoaWxlICgwKQ0KIA0KIHN0YXRpYyBpbnQgdHJ5
X2lvX3BvcnQoZGV2X2xpbmtfdCAqbGluaykNCiB7DQpAQCAtMzQwLDEyICszMzcsMTIgQEANCiAJ
Zm9yIChqID0gMDsgaiA8IDB4NDAwOyBqICs9IDB4MjApIHsNCiAJICAgIGxpbmstPmlvLkJhc2VQ
b3J0MSA9IGogXiAweDMwMDsNCiAJICAgIGxpbmstPmlvLkJhc2VQb3J0MiA9IChqIF4gMHgzMDAp
ICsgMHgxMDsNCi0JICAgIHJldCA9IENhcmRTZXJ2aWNlcyhSZXF1ZXN0SU8sIGxpbmstPmhhbmRs
ZSwgJmxpbmstPmlvKTsNCisJICAgIHJldCA9IHBjbWNpYV9yZXF1ZXN0X2lvKGxpbmstPmhhbmRs
ZSwgJmxpbmstPmlvKTsNCiAJICAgIGlmIChyZXQgPT0gQ1NfU1VDQ0VTUykgcmV0dXJuIHJldDsN
CiAJfQ0KIAlyZXR1cm4gcmV0Ow0KICAgICB9IGVsc2Ugew0KLQlyZXR1cm4gQ2FyZFNlcnZpY2Vz
KFJlcXVlc3RJTywgbGluay0+aGFuZGxlLCAmbGluay0+aW8pOw0KKwlyZXR1cm4gcGNtY2lhX3Jl
cXVlc3RfaW8obGluay0+aGFuZGxlLCAmbGluay0+aW8pOw0KICAgICB9DQogfQ0KIA0KQEAgLTM2
Nyw5ICszNjQsOSBAQA0KICAgICB0dXBsZS5UdXBsZURhdGFNYXggPSBzaXplb2YoYnVmKTsNCiAg
ICAgdHVwbGUuVHVwbGVPZmZzZXQgPSAwOw0KICAgICB0dXBsZS5EZXNpcmVkVHVwbGUgPSBDSVNU
UExfQ09ORklHOw0KLSAgICBDU19DSEVDSyhHZXRGaXJzdFR1cGxlLCBoYW5kbGUsICZ0dXBsZSk7
DQotICAgIENTX0NIRUNLKEdldFR1cGxlRGF0YSwgaGFuZGxlLCAmdHVwbGUpOw0KLSAgICBDU19D
SEVDSyhQYXJzZVR1cGxlLCBoYW5kbGUsICZ0dXBsZSwgJnBhcnNlKTsNCisgICAgQ1NfQ0hFQ0so
R2V0Rmlyc3RUdXBsZSwgcGNtY2lhX2dldF9maXJzdF90dXBsZShoYW5kbGUsICZ0dXBsZSkpOw0K
KyAgICBDU19DSEVDSyhHZXRUdXBsZURhdGEsIHBjbWNpYV9nZXRfdHVwbGVfZGF0YShoYW5kbGUs
ICZ0dXBsZSkpOw0KKyAgICBDU19DSEVDSyhQYXJzZVR1cGxlLCBwY21jaWFfcGFyc2VfdHVwbGUo
aGFuZGxlLCAmdHVwbGUsICZwYXJzZSkpOw0KICAgICBsaW5rLT5jb25mLkNvbmZpZ0Jhc2UgPSBw
YXJzZS5jb25maWcuYmFzZTsNCiAgICAgLyogZG9uJ3QgdHJ1c3QgdGhlIENJUyBvbiB0aGlzOyBM
aW5rc3lzIGdvdCBpdCB3cm9uZyAqLw0KICAgICBsaW5rLT5jb25mLlByZXNlbnQgPSAweDYzOw0K
QEAgLTM3OCwxOSArMzc1LDE5IEBADQogICAgIGxpbmstPnN0YXRlIHw9IERFVl9DT05GSUc7DQog
DQogICAgIC8qIExvb2sgdXAgY3VycmVudCBWY2MgKi8NCi0gICAgQ1NfQ0hFQ0soR2V0Q29uZmln
dXJhdGlvbkluZm8sIGhhbmRsZSwgJmNvbmYpOw0KKyAgICBDU19DSEVDSyhHZXRDb25maWd1cmF0
aW9uSW5mbywgcGNtY2lhX2dldF9jb25maWd1cmF0aW9uX2luZm8oaGFuZGxlLCAmY29uZikpOw0K
ICAgICBsaW5rLT5jb25mLlZjYyA9IGNvbmYuVmNjOw0KIA0KICAgICB0dXBsZS5EZXNpcmVkVHVw
bGUgPSBDSVNUUExfQ0ZUQUJMRV9FTlRSWTsNCiAgICAgdHVwbGUuQXR0cmlidXRlcyA9IDA7DQot
ICAgIENTX0NIRUNLKEdldEZpcnN0VHVwbGUsIGhhbmRsZSwgJnR1cGxlKTsNCisgICAgQ1NfQ0hF
Q0soR2V0Rmlyc3RUdXBsZSwgcGNtY2lhX2dldF9maXJzdF90dXBsZShoYW5kbGUsICZ0dXBsZSkp
Ow0KICAgICB3aGlsZSAobGFzdF9yZXQgPT0gQ1NfU1VDQ0VTUykgew0KIAljaXN0cGxfY2Z0YWJs
ZV9lbnRyeV90ICpjZmcgPSAmKHBhcnNlLmNmdGFibGVfZW50cnkpOw0KIAljaXN0cGxfaW9fdCAq
aW8gPSAmKHBhcnNlLmNmdGFibGVfZW50cnkuaW8pOw0KIAkNCi0JQ0ZHX0NIRUNLKEdldFR1cGxl
RGF0YSwgaGFuZGxlLCAmdHVwbGUpOw0KLQlDRkdfQ0hFQ0soUGFyc2VUdXBsZSwgaGFuZGxlLCAm
dHVwbGUsICZwYXJzZSk7DQotCWlmICgoY2ZnLT5pbmRleCA9PSAwKSB8fCAoY2ZnLT5pby5ud2lu
ID09IDApKQ0KKwlpZiAocGNtY2lhX2dldF90dXBsZV9kYXRhKGhhbmRsZSwgJnR1cGxlKSAhPSAw
IHx8DQorCQlwY21jaWFfcGFyc2VfdHVwbGUoaGFuZGxlLCAmdHVwbGUsICZwYXJzZSkgIT0gMCB8
fA0KKwkJY2ZnLT5pbmRleCA9PSAwIHx8IGNmZy0+aW8ubndpbiA9PSAwKQ0KIAkgICAgZ290byBu
ZXh0X2VudHJ5Ow0KIAkNCiAJbGluay0+Y29uZi5Db25maWdJbmRleCA9IDB4MDU7DQpAQCAtNDEx
LDIxICs0MDgsMjEgQEANCiAJICAgIGlmIChsYXN0X3JldCA9PSBDU19TVUNDRVNTKSBicmVhazsN
CiAJfQ0KICAgICBuZXh0X2VudHJ5Og0KLQlsYXN0X3JldCA9IENhcmRTZXJ2aWNlcyhHZXROZXh0
VHVwbGUsIGhhbmRsZSwgJnR1cGxlKTsNCisJbGFzdF9yZXQgPSBwY21jaWFfZ2V0X25leHRfdHVw
bGUoaGFuZGxlLCAmdHVwbGUpOw0KICAgICB9DQogICAgIGlmIChsYXN0X3JldCAhPSBDU19TVUND
RVNTKSB7DQogCWNzX2Vycm9yKGhhbmRsZSwgUmVxdWVzdElPLCBsYXN0X3JldCk7DQogCWdvdG8g
ZmFpbGVkOw0KICAgICB9DQogDQotICAgIENTX0NIRUNLKFJlcXVlc3RJUlEsIGhhbmRsZSwgJmxp
bmstPmlycSk7DQorICAgIENTX0NIRUNLKFJlcXVlc3RJUlEsIHBjbWNpYV9yZXF1ZXN0X2lycSho
YW5kbGUsICZsaW5rLT5pcnEpKTsNCiAgICAgDQogICAgIGlmIChsaW5rLT5pby5OdW1Qb3J0czIg
PT0gOCkgew0KIAlsaW5rLT5jb25mLkF0dHJpYnV0ZXMgfD0gQ09ORl9FTkFCTEVfU1BLUjsNCiAJ
bGluay0+Y29uZi5TdGF0dXMgPSBDQ1NSX0FVRElPX0VOQTsNCiAgICAgfQ0KICAgICANCi0gICAg
Q1NfQ0hFQ0soUmVxdWVzdENvbmZpZ3VyYXRpb24sIGhhbmRsZSwgJmxpbmstPmNvbmYpOw0KKyAg
ICBDU19DSEVDSyhSZXF1ZXN0Q29uZmlndXJhdGlvbiwgcGNtY2lhX3JlcXVlc3RfY29uZmlndXJh
dGlvbihoYW5kbGUsICZsaW5rLT5jb25mKSk7DQogICAgIGRldi0+aXJxID0gbGluay0+aXJxLkFz
c2lnbmVkSVJROw0KICAgICBkZXYtPmJhc2VfYWRkciA9IGxpbmstPmlvLkJhc2VQb3J0MTsNCiAg
ICAgaWYgKHJlZ2lzdGVyX25ldGRldihkZXYpICE9IDApIHsNCkBAIC00NzYsNyArNDczLDcgQEAN
CiAgICAgICAgQml0IDIgb2YgQ0NTUiBpcyBhY3RpdmUgbG93LiAqLyANCiAgICAgaWYgKGkgPT0g
MzIpIHsNCiAJY29uZl9yZWdfdCByZWcgPSB7IDAsIENTX1dSSVRFLCBDSVNSRUdfQ0NTUiwgMHgw
NCB9Ow0KLSAJQ2FyZFNlcnZpY2VzKEFjY2Vzc0NvbmZpZ3VyYXRpb25SZWdpc3RlciwgbGluay0+
aGFuZGxlLCAmcmVnKTsNCisgCXBjbWNpYV9hY2Nlc3NfY29uZmlndXJhdGlvbl9yZWdpc3Rlcihs
aW5rLT5oYW5kbGUsICZyZWcpOw0KIAlmb3IgKGkgPSAwOyBpIDwgMzI7IGkrKykgew0KIAkgICAg
aiA9IG1kaW9fcmVhZChkZXYtPmJhc2VfYWRkciArIEFYTkVUX01JSV9FRVAsIGksIDEpOw0KIAkg
ICAgaWYgKChqICE9IDApICYmIChqICE9IDB4ZmZmZikpIGJyZWFrOw0KQEAgLTUyMCw5ICs1MTcs
OSBAQA0KIAlyZXR1cm47DQogICAgIH0NCiANCi0gICAgQ2FyZFNlcnZpY2VzKFJlbGVhc2VDb25m
aWd1cmF0aW9uLCBsaW5rLT5oYW5kbGUpOw0KLSAgICBDYXJkU2VydmljZXMoUmVsZWFzZUlPLCBs
aW5rLT5oYW5kbGUsICZsaW5rLT5pbyk7DQotICAgIENhcmRTZXJ2aWNlcyhSZWxlYXNlSVJRLCBs
aW5rLT5oYW5kbGUsICZsaW5rLT5pcnEpOw0KKyAgICBwY21jaWFfcmVsZWFzZV9jb25maWd1cmF0
aW9uKGxpbmstPmhhbmRsZSk7DQorICAgIHBjbWNpYV9yZWxlYXNlX2lvKGxpbmstPmhhbmRsZSwg
JmxpbmstPmlvKTsNCisgICAgcGNtY2lhX3JlbGVhc2VfaXJxKGxpbmstPmhhbmRsZSwgJmxpbmst
PmlycSk7DQogDQogICAgIGxpbmstPnN0YXRlICY9IH5ERVZfQ09ORklHOw0KIA0KQEAgLTU2Niw3
ICs1NjMsNyBAQA0KIAlpZiAobGluay0+c3RhdGUgJiBERVZfQ09ORklHKSB7DQogCSAgICBpZiAo
bGluay0+b3BlbikNCiAJCW5ldGlmX2RldmljZV9kZXRhY2goJmluZm8tPmRldik7DQotCSAgICBD
YXJkU2VydmljZXMoUmVsZWFzZUNvbmZpZ3VyYXRpb24sIGxpbmstPmhhbmRsZSk7DQorCSAgICBw
Y21jaWFfcmVsZWFzZV9jb25maWd1cmF0aW9uKGxpbmstPmhhbmRsZSk7DQogCX0NCiAJYnJlYWs7
DQogICAgIGNhc2UgQ1NfRVZFTlRfUE1fUkVTVU1FOg0KQEAgLTU3NCw3ICs1NzEsNyBAQA0KIAkv
KiBGYWxsIHRocm91Z2guLi4gKi8NCiAgICAgY2FzZSBDU19FVkVOVF9DQVJEX1JFU0VUOg0KIAlp
ZiAobGluay0+c3RhdGUgJiBERVZfQ09ORklHKSB7DQotCSAgICBDYXJkU2VydmljZXMoUmVxdWVz
dENvbmZpZ3VyYXRpb24sIGxpbmstPmhhbmRsZSwgJmxpbmstPmNvbmYpOw0KKwkgICAgcGNtY2lh
X3JlcXVlc3RfY29uZmlndXJhdGlvbihsaW5rLT5oYW5kbGUsICZsaW5rLT5jb25mKTsNCiAJICAg
IGlmIChsaW5rLT5vcGVuKSB7DQogCQlheG5ldF9yZXNldF84MzkwKCZpbmZvLT5kZXYpOw0KIAkJ
QVg4ODE5MF9pbml0KCZpbmZvLT5kZXYsIDEpOw0KDQoNCg0K

--=-YJkjJ161gSRj1QisD2dI--

--=-WfrAOh9i0bMPCN+lb1i0
Content-Type: application/pgp-signature; name=signature.asc
Content-Description: This is a digitally signed message part

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)

iD8DBQA/5omy78o9R9NraMQRAnoBAJ9CXcSxmfJKIo64PCQ9dUE/DWfi8wCffsVc
Sz0nhS03EIJVjzUDrkF7vVs=
=Zy3a
-----END PGP SIGNATURE-----

--=-WfrAOh9i0bMPCN+lb1i0--

