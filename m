Return-Path: <linux-kernel-owner+willy=40w.ods.org-S271466AbUJVRCG@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S271466AbUJVRCG (ORCPT <rfc822;willy@w.ods.org>);
	Fri, 22 Oct 2004 13:02:06 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S271429AbUJVQ7T
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Fri, 22 Oct 2004 12:59:19 -0400
Received: from mx1.redhat.com ([66.187.233.31]:49888 "EHLO mx1.redhat.com")
	by vger.kernel.org with ESMTP id S271452AbUJVQ5t (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Fri, 22 Oct 2004 12:57:49 -0400
From: David Howells <dhowells@redhat.com>
To: torvalds@osdl.org, akpm@osdl.org, jakub@redhat.com
cc: linux-kernel@vger.kernel.org
Subject: [PATCH] Shift key-related error codes up and insert ECANCELED
User-Agent: EMH/1.14.1 SEMI/1.14.5 (Awara-Onsen) FLIM/1.14.5 (Demachiyanagi) APEL/10.6 Emacs/21.3 (i386-redhat-linux-gnu) MULE/5.0 (SAKAKI)
MIME-Version: 1.0 (generated by SEMI 1.14.5 - "Awara-Onsen")
Content-Type: multipart/mixed;
 boundary="Multipart_Fri_Oct_22_17:57:42_2004-1"
Date: Fri, 22 Oct 2004 17:57:42 +0100
Message-ID: <20498.1098464262@redhat.com>
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

--Multipart_Fri_Oct_22_17:57:42_2004-1
Content-Type: text/plain; charset=US-ASCII


This patch shifts the key-related error codes up by one and inserts an
ECANCELED error code where not already defined. It seems that has been defined
in glibc without passing it back to the kernel:-/

Who arbitrates error number allocations anyway?

Signed-Off-By: David Howells <dhowells@redhat.com>
---
warthog>diffstat errno-269bk5.diff 
 asm-alpha/errno.h   |    9 +++++----
 asm-generic/errno.h |    9 +++++----
 asm-sparc/errno.h   |    9 +++++----
 asm-sparc64/errno.h |    9 +++++----
 4 files changed, 20 insertions(+), 16 deletions(-)


--Multipart_Fri_Oct_22_17:57:42_2004-1
Content-Type: application/octet-stream; type=patch
Content-Disposition: attachment; filename="errno-269bk5.diff"
Content-Transfer-Encoding: 7bit

diff -uNrp linux-2.6.9-bk5/include/asm-alpha/errno.h linux-2.6.9-bk5-keys/include/asm-alpha/errno.h
--- linux-2.6.9-bk5/include/asm-alpha/errno.h	2004-10-21 11:22:06.000000000 +0100
+++ linux-2.6.9-bk5-keys/include/asm-alpha/errno.h	2004-10-22 10:56:53.694968904 +0100
@@ -110,9 +110,10 @@
 
 #define ENOMEDIUM	129	/* No medium found */
 #define EMEDIUMTYPE	130	/* Wrong medium type */
-#define	ENOKEY		131	/* Required key not available */
-#define	EKEYEXPIRED	132	/* Key has expired */
-#define	EKEYREVOKED	133	/* Key has been revoked */
-#define	EKEYREJECTED	134	/* Key was rejected by service */
+#define	ECANCELED	131	/* Operation Cancelled */
+#define	ENOKEY		132	/* Required key not available */
+#define	EKEYEXPIRED	133	/* Key has expired */
+#define	EKEYREVOKED	134	/* Key has been revoked */
+#define	EKEYREJECTED	135	/* Key was rejected by service */
 
 #endif
diff -uNrp linux-2.6.9-bk5/include/asm-generic/errno.h linux-2.6.9-bk5-keys/include/asm-generic/errno.h
--- linux-2.6.9-bk5/include/asm-generic/errno.h	2004-10-21 11:22:06.000000000 +0100
+++ linux-2.6.9-bk5-keys/include/asm-generic/errno.h	2004-10-22 10:53:41.000000000 +0100
@@ -96,9 +96,10 @@
 
 #define	ENOMEDIUM	123	/* No medium found */
 #define	EMEDIUMTYPE	124	/* Wrong medium type */
-#define	ENOKEY		125	/* Required key not available */
-#define	EKEYEXPIRED	126	/* Key has expired */
-#define	EKEYREVOKED	127	/* Key has been revoked */
-#define	EKEYREJECTED	128	/* Key was rejected by service */
+#define	ECANCELED	125	/* Operation Canceled */
+#define	ENOKEY		126	/* Required key not available */
+#define	EKEYEXPIRED	127	/* Key has expired */
+#define	EKEYREVOKED	128	/* Key has been revoked */
+#define	EKEYREJECTED	129	/* Key was rejected by service */
 
 #endif
diff -uNrp linux-2.6.9-bk5/include/asm-sparc/errno.h linux-2.6.9-bk5-keys/include/asm-sparc/errno.h
--- linux-2.6.9-bk5/include/asm-sparc/errno.h	2004-10-21 11:22:08.000000000 +0100
+++ linux-2.6.9-bk5-keys/include/asm-sparc/errno.h	2004-10-22 10:56:37.393313534 +0100
@@ -101,9 +101,10 @@
 
 #define	ENOMEDIUM	125	/* No medium found */
 #define	EMEDIUMTYPE	126	/* Wrong medium type */
-#define	ENOKEY		127	/* Required key not available */
-#define	EKEYEXPIRED	128	/* Key has expired */
-#define	EKEYREVOKED	129	/* Key has been revoked */
-#define	EKEYREJECTED	130	/* Key was rejected by service */
+#define	ECANCELED	127	/* Operation Cancelled */
+#define	ENOKEY		128	/* Required key not available */
+#define	EKEYEXPIRED	129	/* Key has expired */
+#define	EKEYREVOKED	130	/* Key has been revoked */
+#define	EKEYREJECTED	131	/* Key was rejected by service */
 
 #endif
diff -uNrp linux-2.6.9-bk5/include/asm-sparc64/errno.h linux-2.6.9-bk5-keys/include/asm-sparc64/errno.h
--- linux-2.6.9-bk5/include/asm-sparc64/errno.h	2004-10-21 11:22:08.000000000 +0100
+++ linux-2.6.9-bk5-keys/include/asm-sparc64/errno.h	2004-10-22 10:57:10.858553145 +0100
@@ -101,9 +101,10 @@
 
 #define ENOMEDIUM       125     /* No medium found */
 #define EMEDIUMTYPE     126     /* Wrong medium type */
-#define	ENOKEY		127	/* Required key not available */
-#define	EKEYEXPIRED	128	/* Key has expired */
-#define	EKEYREVOKED	129	/* Key has been revoked */
-#define	EKEYREJECTED	130	/* Key was rejected by service */
+#define	ECANCELED	127	/* Operation Cancelled */
+#define	ENOKEY		128	/* Required key not available */
+#define	EKEYEXPIRED	129	/* Key has expired */
+#define	EKEYREVOKED	130	/* Key has been revoked */
+#define	EKEYREJECTED	131	/* Key was rejected by service */
 
 #endif /* !(_SPARC64_ERRNO_H) */

--Multipart_Fri_Oct_22_17:57:42_2004-1--
