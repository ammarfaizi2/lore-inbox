Return-Path: <linux-kernel-owner@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S129772AbRBYB6U>; Sat, 24 Feb 2001 20:58:20 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S129773AbRBYB6K>; Sat, 24 Feb 2001 20:58:10 -0500
Received: from lox.sandelman.ottawa.on.ca ([209.151.24.2]:1511 "EHLO
	lox.sandelman.ottawa.on.ca") by vger.kernel.org with ESMTP
	id <S129772AbRBYB54>; Sat, 24 Feb 2001 20:57:56 -0500
Message-Id: <200102250155.f1P1t8H26784@marajade.sandelman.ottawa.on.ca>
To: Linux Knernel Mailing List <linux-kernel@vger.kernel.org>
Subject: Re: New net features for added performance 
In-Reply-To: Your message of "Sat, 24 Feb 2001 18:25:16 EST."
             <3A9842DC.B42ECD7A@mandrakesoft.com> 
Mime-Version: 1.0 (generated by tm-edit 7.108)
Content-Type: text/plain; charset=US-ASCII
Date: Sat, 24 Feb 2001 20:55:08 -0500
From: Michael Richardson <mcr@sandelman.ottawa.on.ca>
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org


>>>>> "Jeff" == Jeff Garzik <jgarzik@mandrakesoft.com> writes:
    Jeff> 1) Rx Skb recycling.  It would be nice to have skbs returned to the
    Jeff> driver after the net core is done with them, rather than have netif_rx
    Jeff> free the skb.  Many drivers pre-allocate a number of maximum-sized skbs
    Jeff> into which the net card DMA's data.  If netif_rx returned the SKB
    Jeff> instead of freeing it, the driver could simply flip the DescriptorOwned
    Jeff> bit for that buffer, giving it immediately back to the net card.

    Jeff> Disadvantages?

  netif_rx() would have to copy the buffer.

  Right now, it just puts it on the queue towards the BH. For it to return
the skb would require that all processing occur inside of netif_rx() (a la BSD),
or that it copy the buffer.
 
    Jeff> 3) Slabbier packet allocation.  Even though skb allocation is decently
    Jeff> fast, you are still looking at an skb buffer head grab and a
 
  I think that if you had this, and you also returned skb's to this list on
a per device basis (change skb->free, I think) instead of to the general
pool, you probably eliminate your request #1.

] Train travel features AC outlets with no take-off restrictions|gigabit is no[
]   Michael Richardson, Solidum Systems   Oh where, oh where has|problem  with[
]     mcr@solidum.com   www.solidum.com   the little fishy gone?|PAX.port 1100[
] panic("Just another NetBSD/notebook using, kernel hacking, security guy");  [
