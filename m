Return-Path: <linux-kernel-owner+willy=40w.ods.org-S262419AbVAENlx@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S262419AbVAENlx (ORCPT <rfc822;willy@w.ods.org>);
	Wed, 5 Jan 2005 08:41:53 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S262423AbVAENlw
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Wed, 5 Jan 2005 08:41:52 -0500
Received: from news.suse.de ([195.135.220.2]:8927 "EHLO Cantor.suse.de")
	by vger.kernel.org with ESMTP id S262419AbVAENln (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Wed, 5 Jan 2005 08:41:43 -0500
Date: Wed, 05 Jan 2005 14:41:41 +0100
Message-ID: <s5his6cm1re.wl@alsa2.suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Mark_H_Johnson@raytheon.com
Cc: Adrian Bunk <bunk@stusta.de>, Andrew Morton <akpm@osdl.org>,
       alsa-devel@alsa-project.org, lkml <linux-kernel@vger.kernel.org>,
       perex@suse.cz
Subject: Re: [Alsa-devel] Re: 2.6.10-mm1: ALSA ac97 compile error with CONFIG_PM=n
In-Reply-To: <OF5A3BD386.A1A4C579-ON86256F7F.00688E0E@raytheon.com>
References: <OF5A3BD386.A1A4C579-ON86256F7F.00688E0E@raytheon.com>
User-Agent: Wanderlust/2.10.1 (Watching The Wheels) SEMI/1.14.5 (Awara-Onsen) FLIM/1.14.5 (Demachiyanagi) APEL/10.6 MULE XEmacs/21.4 (patch 15) (Security Through Obscurity) (i386-suse-linux)
MIME-Version: 1.0 (generated by SEMI 1.14.5 - "Awara-Onsen")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

At Tue, 4 Jan 2005 13:25:40 -0600,
Mark_H_Johnson@raytheon.com wrote:
> 
> A follow up on this patch. This fixed my build / module load problem when
> using CONFIG_PM=N on my system. The audio worked OK (except as noted
> below). Do you want Andrew Morton to pick this up (or will you incorporate
> the fix into another ALSA patch)?

It was already fixed in the recent ALSA tree.
So, just syncing bk-alsa patch would suffice.

> I did have some other minor problems during my testing but I have seen
> these before. Perhaps one of the ALSA developers could comment on the
> correct / incorrect behavior of the audio system. The testing is done on a
> Fedora Core 2 system with the 2.6.10-mm1 kernel (with the patch below). Let
> me know if you need more information on the system configuration, and
> .config.
> 
> [1] After system start up & log in, I do the sequence:
>   su -
>   (password entered)
>   system-config-soundcard
>   Simple mixer control 'PCM',0
>     Capabilities: pvolume pswitch pswitch-joined
>     Playback channels: Front Left - Front Right
>     Limits: Playback 0 - 31
>     Front Left: Playback 23 [74%] [on]
>     Front Right: Playback 23 [74%] [on]
>   sox: Can't open output file '/dev/dsp': Device or resource busy
> 
> At this point, I get the window asking if I heard the sound (I did not). If
> I repeat the test after waiting a short period, it eventually succeeds.

The default blocking behavior of OSS devices was changed recently.
When the device is in use, open returns -EBUSY immediately in the
latest version while it was blocked until released in the former
version.


> [2] When running latencytest (from
> http://www.gardena.net/benno/linux/audio/) the sound is not consistent
> (like it was on 2.4 with OSS) and occasionally I hear "rapid playback"
> where the repeating audio pattern is much faster than it should be.

It's hard to tell.  The cause could be in the general interrupt
handling, the difference of HZ, the driver's interrupt setting, or
whatever.  This must depend on the hardware, anyway.


Takashi
