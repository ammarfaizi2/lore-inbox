Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S264083AbTKSOIY (ORCPT <rfc822;willy@w.ods.org>);
	Wed, 19 Nov 2003 09:08:24 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S264084AbTKSOIY
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Wed, 19 Nov 2003 09:08:24 -0500
Received: from relay1.miee.ru ([213.171.53.133]:43269 "EHLO gulipin.miee.ru")
	by vger.kernel.org with ESMTP id S264083AbTKSOIV (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Wed, 19 Nov 2003 09:08:21 -0500
Date: Wed, 19 Nov 2003 16:15:25 +0300
Message-ID: <87fzgkwlci.wl@drakkar.ibe.miee.ru>
From: Samium Gromoff <deepfire@ibe.miee.ru>
To: pavel@suse.cz
CC: linux-kernel@vger.kernel.org, rob@landley.net
Subject: Re: Patrick's Test9 suspend code.
User-Agent: Wanderlust/2.10.1 (Watching The Wheels) SEMI/1.14.5 (Awara-Onsen) FLIM/1.14.5 (Demachiyanagi) APEL/10.6 Emacs/21.3 (i386-pc-linux-gnu) MULE/5.0 (SAKAKI)
MIME-Version: 1.0 (generated by SEMI 1.14.5 - "Awara-Onsen")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org


> > > > :-), Okay, we could make grub read /etc/fstab... But again user can do
> > > >
> > > > swapoff and swapon manually etc.
> > >
> > > During resume?
> >
> > No, imagine /dev/hda3 being set as swap in /etc/fstab, but user doing
> > swapoff /dev/hda3, swapon /dev/usb_zip_drive, then suspend.
> 
> A) Any scheme we come up with there will be a way the user can do something 
> stupid enough to break it.  (Put the swap partition on a ramdisk living on 
> the video card, or on a device require an initrd to load the driver to 
> access...)
> 
> B) A heuristic that looks at the mounted block devices for things that smell 
> like a resume partition would actually be more robust in that case.

Really, what i think here is appropriate is a more fundamental approach.

We should reserve a new partition type in addition to three already
existing, namely "linux"==0x83, "linux swap"==0x82 and "linux lvm"==0x8e.

And call it something like "linux suspend".
And initialize it, if needed (i presume to write a signature etc), with
something like "mksusp".

regards, Samium Gromoff
