Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261971AbTIXHIt (ORCPT <rfc822;willy@w.ods.org>);
	Wed, 24 Sep 2003 03:08:49 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261984AbTIXHIt
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Wed, 24 Sep 2003 03:08:49 -0400
Received: from pub237.cambridge.redhat.com ([213.86.99.237]:22247 "EHLO
	warthog.warthog") by vger.kernel.org with ESMTP id S261971AbTIXHIs
	(ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Wed, 24 Sep 2003 03:08:48 -0400
From: David Howells <dhowells@redhat.com>
In-Reply-To: <20030923131414.E20572@osdlab.pdx.osdl.net> 
References: <20030923131414.E20572@osdlab.pdx.osdl.net>  <200309160435.h8G4ZkQM009953@elaine4.Stanford.EDU> 
To: Chris Wright <chrisw@osdl.org>
Cc: David Yu Chen <dychen@stanford.edu>, linux-kernel@vger.kernel.org,
       mc@cs.stanford.edu
Subject: Re: [CHECKER] 32 Memory Leaks on Error Paths 
User-Agent: EMH/1.14.1 SEMI/1.14.4 (Hosorogi) FLIM/1.14.4
 (=?ISO-8859-4?Q?Kashiharajing=FE-mae?=) APEL/10.4 Emacs/21.2
 (i386-redhat-linux-gnu) MULE/5.0 (SAKAKI)
MIME-Version: 1.0 (generated by SEMI 1.14.4 - "Hosorogi")
Content-Type: text/plain; charset=US-ASCII
Date: Wed, 24 Sep 2003 08:08:29 +0100
Message-ID: <22607.1064387309@redhat.com>
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org


> * David Yu Chen (dychen@stanford.edu) wrote:
> > [FILE:  2.6.0-test5/fs/afs/cell.c]
> > START -->
> >   58:	cell = kmalloc(sizeof(afs_cell_t) + strlen(name) + 1,GFP_KERNEL);
> >   59:	if (!cell) {
> <snip>
> >  126: error:
> >  127:	up_write(&afs_cells_sem);
> >  128:	kfree(afs_cell_root);
> > END -->
> 
> Yes, this looks like a bug/typo.  Patch below.  David, this look ok?

Yes. I've applied it to my local development version.

Thanks,
David
