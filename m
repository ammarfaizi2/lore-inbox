Return-Path: <linux-kernel-owner+willy=40w.ods.org-S262003AbVBAMcL@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S262003AbVBAMcL (ORCPT <rfc822;willy@w.ods.org>);
	Tue, 1 Feb 2005 07:32:11 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S262004AbVBAMcL
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Tue, 1 Feb 2005 07:32:11 -0500
Received: from cantor.suse.de ([195.135.220.2]:10956 "EHLO Cantor.suse.de")
	by vger.kernel.org with ESMTP id S262003AbVBAMcG (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Tue, 1 Feb 2005 07:32:06 -0500
Date: Tue, 01 Feb 2005 13:32:05 +0100
Message-ID: <s5hy8e8fol6.wl@alsa2.suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Paulo Marques <pmarques@grupopie.com>
Cc: Andrew Morton <akpm@osdl.org>, linux-kernel@vger.kernel.org,
       alsa-devel@alsa-project.org
Subject: Re: [PATCH 2.6] 7/7 replace snd_kmalloc_strdup by kstrdup
In-Reply-To: <41FF75C0.6040602@grupopie.com>
References: <1107228526.41fef76e4c9be@webmail.grupopie.com>
	<s5h651ch6lc.wl@alsa2.suse.de>
	<41FF75C0.6040602@grupopie.com>
User-Agent: Wanderlust/2.10.1 (Watching The Wheels) SEMI/1.14.5 (Awara-Onsen) FLIM/1.14.5 (Demachiyanagi) APEL/10.6 MULE XEmacs/21.4 (patch 15) (Security Through Obscurity) (i386-suse-linux)
MIME-Version: 1.0 (generated by SEMI 1.14.5 - "Awara-Onsen")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

At Tue, 01 Feb 2005 12:27:44 +0000,
Paulo Marques wrote:
> 
> Takashi Iwai wrote:
> > At Tue,  1 Feb 2005 03:28:46 +0000,
> > "" <pmarques@grupopie.com> wrote:
> > 
> >>[1  <text/plain; iso-8859-1 (quoted-printable)>]
> >>
> >>This patch removes the strdup implementation from the sound core
> >>(snd_kmalloc_strdup), and updates it to use the kstrdup library function.
> >>
> >>Signed-off-by: Paulo Marques <pmarques@grupopie.com>
> > 
> > 
> > This patch won't work properly if CONFIG_SND_DEBUG_MEMORY is set...
> 
> Humm.. compiles ok here.
> 
> I just rebuilt a vanilla 2.6.11-rc2-bk9 tree, applied the patches, 
> selected CONFIG_SND_DEBUG and CONFIG_SND_DEBUG_MEMORY, and it compiled 
> just fine.
> 
> I had already tested the patches with an allyesconfig, but tested it 
> anyway just to be sure.
> 
> Are you sure you also applied the first patch in the series that creates 
> the kstrdup library function? If you are, can you send me your .config 
> so that I can test it here?

The compile should be fine but it may result in memory corruption
since kmalloc/kfree become wrappers when CONFIG_SND_DEBUG_MEMORY is
set.  See include/sound/core.h.


Takashi
