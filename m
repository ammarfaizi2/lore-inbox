Return-Path: <linux-kernel-owner+willy=40w.ods.org-S261528AbULIPUi@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261528AbULIPUi (ORCPT <rfc822;willy@w.ods.org>);
	Thu, 9 Dec 2004 10:20:38 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261521AbULIPT5
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Thu, 9 Dec 2004 10:19:57 -0500
Received: from gwout.thalesgroup.com ([195.101.39.227]:1290 "EHLO
	GWOUT.thalesgroup.com") by vger.kernel.org with ESMTP
	id S261529AbULIPLG (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Thu, 9 Dec 2004 10:11:06 -0500
Message-ID: <51BF576D5A02CC4CB2591F50994FD76698B139@nts013.uk.trt.thales>
From: "Nisbet, David " <David.Nisbet@thalesgroup.com>
To: "'linux-kernel@vger.kernel.org'" <linux-kernel@vger.kernel.org>
Subject: Local multicast source not routing
Date: Thu, 9 Dec 2004 15:02:19 -0000 
MIME-Version: 1.0
X-Mailer: Internet Mail Service (5.5.2656.59)
Content-Type: text/plain;
	charset="iso-8859-1"
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Hi,

I have been experiencing problems with multicast traffic generated locally
on a 2.4.17 machine configured for multicast routing. Traffic generated by
my multicast source (vic) is correctly sent to the local ethernet but it is
never sent to either of my two gre tunnels. I believe I should see at least
some packets on all interfaces before the routes are pruned but I see
nothing.
This seems to parallel a problem that was originally fixed in the 2.0 kernel
where multicast packets were not passed to the routing function. I know that
the tunnels can handle multicast traffic because I am receiving packets from
a remote machine. Similarly, multicast traffic received from the local
ethernet is correctly routed over the tunnels. It is only the traffic
generated on the router that is having problems. Using vic, I have set the
source ip address to the ethernet port to ensure the data comes from a valid
address and I have forced the ttl to 16 but neither has fixed the problem.

So my question is: Are locally generated multicast packets passed throught
the kernel routing functions? If not, were they previously?

The kernel is 2.4.17 (although the same problem appears to occur on a 2.4.22
machine) and I am running mrouted-3.9-beta-3 for route transfer.

Thanks

David
