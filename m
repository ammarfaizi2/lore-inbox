Return-Path: <linux-kernel-owner@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S129156AbRCELBV>; Mon, 5 Mar 2001 06:01:21 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S129159AbRCELBL>; Mon, 5 Mar 2001 06:01:11 -0500
Received: from mumm.ibr.cs.tu-bs.de ([134.169.34.190]:24972 "EHLO
	mumm.ibr.cs.tu-bs.de") by vger.kernel.org with ESMTP
	id <S129156AbRCELA5>; Mon, 5 Mar 2001 06:00:57 -0500
To: linux-kernel@vger.kernel.org
Subject: 2.4.3-pre2: Can't build md.o as module: unresolved symbol
Mime-Version: 1.0 (generated by tm-edit 7.106)
Content-Type: text/plain; charset=US-ASCII
From: Urs Thuermann <thuerman@ibr.cs.tu-bs.de>
Date: 05 Mar 2001 12:00:54 +0100
Message-ID: <ysdn1b0lbtl.fsf@tuborg.ibr.cs.tu-bs.de>
X-Mailer: Gnus v5.7/Emacs 20.7
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

When building md.o as module, make modules_install fails, because of
an unresolved symbol:

$ make modules_install
...
if [ -r System.map ]; then /sbin/depmod -ae -F System.map  2.4.3-pre2-ut1; fi
depmod: *** Unresolved symbols in /lib/modules/2.4.3-pre2-ut1/kernel/drivers/md/md.o
depmod:         md_autodetect_dev


This is because the defintion of md_autodetect_dev() is in

    #ifndef MODULE
    ...
    void md_autodetect_dev (kdev_t dev)
    {
	...
    }
    ...
    #endif

while this function is called from export_rdev() which is always
compiled, i.e. also when building as module.


urs
