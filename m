Return-Path: <linux-kernel-owner+willy=40w.ods.org-S261199AbVEKOXt@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261199AbVEKOXt (ORCPT <rfc822;willy@w.ods.org>);
	Wed, 11 May 2005 10:23:49 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261217AbVEKOXt
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Wed, 11 May 2005 10:23:49 -0400
Received: from mx2.suse.de ([195.135.220.15]:32904 "EHLO mx2.suse.de")
	by vger.kernel.org with ESMTP id S261199AbVEKOXo (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Wed, 11 May 2005 10:23:44 -0400
Date: Wed, 11 May 2005 16:23:33 +0200
Message-ID: <s5hd5rx2656.wl@alsa2.suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: "J.A. Magallon" <jamagallon@able.es>
Cc: linux-kernel@vger.kernel.org
Subject: Re: 2.6.12-rc3-mm3: ALSA broken ?
In-Reply-To: <1115594680l.7540l.0l@werewolf.able.es>
References: <20050504221057.1e02a402.akpm@osdl.org>
	<1115510869l.7472l.0l@werewolf.able.es>
	<1115594680l.7540l.0l@werewolf.able.es>
User-Agent: Wanderlust/2.10.1 (Watching The Wheels) SEMI/1.14.5 (Awara-Onsen) FLIM/1.14.5 (Demachiyanagi) APEL/10.6 MULE XEmacs/21.4 (patch 15) (Security Through Obscurity) (i386-suse-linux)
MIME-Version: 1.0 (generated by SEMI 1.14.5 - "Awara-Onsen")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

At Sun, 08 May 2005 23:24:40 +0000,
J.A. Magallon wrote:
> 
> 
> On 05.08, J.A. Magallon wrote:
> > 
> > On 05.05, Andrew Morton wrote:
> > > 
> > > ftp://ftp.kernel.org/pub/linux/kernel/people/akpm/patches/2.6/2.6.12-rc3/2.6.12-rc3-mm3/
> > > 
> > > - device mapper updates
> > > 
> > > - more UML updates
> > > 
> > > - -mm seems unusually stable at present.
> > > 
> > 
> > Ehem, is ALSA broken ?
> > 
> > I can't spread stereo output to 4 channel. More specific, I can't switch
> > one of my female jacks between in and out.
> > 
> > Long explanation: I have an
> > 
> > 00:1f.5 Multimedia audio controller: Intel Corporation 82801EB/ER (ICH5/ICH5R) AC'97 Audio Controller (rev 02)
> > 
> > It has three outputs. One is always output, for normal stereo or front in 4
> > channel. One other is LineIn/Back-for-4-channel. And the third is
> > Mic/Bass-Center.
> > 
> > In 2.6.11 I have two
> > toggles in ALSA: 'Spread front to center...' and 'surround jack as input'
> > Adjusting both I could get to duplicate the output in the Back jack.
> > In 2.6.12-rc3-mm3 there is no way to get this working.
> > 
> 
> I have just tested in 2.6.12-rc4 and works fine. I even feed the stereo
> signal to the 6 channels, so 4 go to my desktop speaker system and one
> other pair to may home stereo.
> 
> Something is broken in -mm wrt ALSA. If you need me to test some specific
> version, pleas just ask.
> 
> Side note: trying to load settings from rc4 in -mm says:
> 
> alsactl: set_control:930: warning: name mismatch (Surround Jack as Input/Surround Jack Mode) for control #42
> alsactl: set_control:932: warning: index mismatch (0/0) for control #42
> alsactl: set_control:1030: bad control.42.value type

The mixer controls for the surround jacks are changed in the recent
version.  Instead of "Line-In As Surround" or "Surround Jack As
Input" switches, now there are two enum controls:

- "Channel Mode"  (2ch/4ch/6ch)
   controls the surround output channels, i.e. toggles the I/O
   direction of the shared line-in/mic jacks.

- "Surround Jack Mode" (Shared/Independent)
   controls the line and mic jacks are shared for surround output and
   inputs.  "Independent" is for the recent mobos which have separate
   input and output jacks.  When Independent is chosen, the setting in
   "Channel Mode" has no influence.


In your case, set "Channel Mode" to 4ch and "Surround Jack Mode" to 
Shared so that the line-in jack is used as surround output.
Then turn on "Duplicate Front" switch.

I'll prepare a better documentation later...


Takashi
