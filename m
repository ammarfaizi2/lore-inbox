Return-Path: <linux-kernel-owner+willy=40w.ods.org-S261880AbUKJEz5@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261880AbUKJEz5 (ORCPT <rfc822;willy@w.ods.org>);
	Tue, 9 Nov 2004 23:55:57 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261883AbUKJEzi
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Tue, 9 Nov 2004 23:55:38 -0500
Received: from l247150.ppp.asahi-net.or.jp ([218.219.247.150]:55719 "EHLO
	mitou.ysato.dip.jp") by vger.kernel.org with ESMTP id S261880AbUKJEzS
	(ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Tue, 9 Nov 2004 23:55:18 -0500
Date: Wed, 10 Nov 2004 13:55:16 +0900
Message-ID: <m21xf2qp57.wl%ysato@users.sourceforge.jp>
From: Yoshinori Sato <ysato@users.sourceforge.jp>
To: Linus Torvalds <torvalds@osdl.org>, Andrew Morton <akpm@osdl.org>
Cc: linux-kernel@vger.kernel.org
Subject: [PATCH] H8/300 inline cleanup
User-Agent: Wanderlust/2.11.30 (Wonderwall) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.6 (Marutamachi) APEL/10.6 Emacs/21.3 (i386-pc-linux-gnu)
 MULE/5.0 (SAKAKI)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Eliminate useless clobber.

Signed-off-by: Yoshinori Sato <ysato@users.sourceforge.jp>

diff -Nru a/include/asm-h8300/delay.h b/include/asm-h8300/delay.h
--- a/include/asm-h8300/delay.h	2004-11-10 01:06:35 +09:00
+++ b/include/asm-h8300/delay.h	2004-11-10 01:06:35 +09:00
@@ -11,11 +11,10 @@
 
 extern __inline__ void __delay(unsigned long loops)
 {
-	__asm__ __volatile__ ("mov.l %0,er0\n\t"
-			      "1:\n\t"
-			      "dec.l #1,er0\n\t"
+	__asm__ __volatile__ ("1:\n\t"
+			      "dec.l #1,%0\n\t"
 			      "bne 1b"
-			      ::"r" (loops):"er0");
+			      :"=r" (loops):"0"(loops));
 }
 
 /*
diff -Nru a/include/asm-h8300/system.h b/include/asm-h8300/system.h
--- a/include/asm-h8300/system.h	2004-11-10 01:06:35 +09:00
+++ b/include/asm-h8300/system.h	2004-11-10 01:06:35 +09:00
@@ -2,7 +2,6 @@
 #define _H8300_SYSTEM_H
 
 #include <linux/config.h> /* get configuration macros */
-#include <linux/kernel.h>
 #include <linux/linkage.h>
 
 #define prepare_to_switch()	do { } while(0)
@@ -119,7 +118,7 @@
     __asm__ __volatile__
     ("mov.b %2,%0\n\t"
      "mov.b %1,%2"
-    : "=&r" (tmp) : "r" (x), "m" (*__xg(ptr)) : "er0","memory");
+    : "=&r" (tmp) : "r" (x), "m" (*__xg(ptr)) : "memory");
     break;
   case 2:
     __asm__ __volatile__

-- 
Yoshinori Sato
<ysato@users.sourceforge.jp>
