Return-Path: <linux-kernel-owner@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S136036AbREBWfz>; Wed, 2 May 2001 18:35:55 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S136044AbREBWfq>; Wed, 2 May 2001 18:35:46 -0400
Received: from e21.nc.us.ibm.com ([32.97.136.227]:50831 "EHLO
	e21.nc.us.ibm.com") by vger.kernel.org with ESMTP
	id <S136036AbREBWfb>; Wed, 2 May 2001 18:35:31 -0400
Importance: Normal
To: torvalds@transmeta.com, castortz@nmu.edu,
        "Bill Hartner" <bhartner@us.ibm.com>, staelin@hpl.hp.com,
        Larry McVoy <lm@bitmover.com>
Cc: lse-tech@lists.sourceforge.net, linux-kernel@vger.kernel.org,
        lmbench-users@bitmover.com
X-Mailer: Lotus Notes Release 5.0.7  March 21, 2001
Message-ID: <OF8F1A4043.9087C91A-ON85256A40.0079DA30@raleigh.ibm.com>
From: "Duc Vianney" <dvianney@us.ibm.com>
Date: Wed, 2 May 2001 17:34:55 -0500
X-MIMETrack: Serialize by Router on D04NM201/04/M/IBM(Release 5.0.6 |December 14, 2000) at
 05/02/2001 06:34:58 PM
MIME-Version: 1.0
Content-type: text/plain; charset=us-ascii
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Has anyone seen performance degradations between 2.2.19 and 2.4.x
when running lmbench? I ran the lmbench benchmark on Linux kernels
2.2.19, 2.4.0, and 2.4.1 and observed performance degradation to be
most noticed in signal handling, pipe latency, file deletion, and
process creation. Are you aware of any kernel changes introduced in
2.4.x that might cause this performance degradation?

The following data are in microseconds, lower is better. Each data point
represents the average of at least four runs.

Tests                     Linux 2.2.19   Linux 2.4.0   Linux 2.4.1
Signal handler overhead      1.64           3.77          3.82
Pipe latency                 4.58           5.28          5.55
File deletion - 10K         11.48          15.30         15.71
Process fork               114.76         140.45        141.98
Process fork+execve        763.57         834.40        840.39

Notes:
1. The benchmark is lmbench-2beta1.
2. The hardware under test is a 700MHz PIII Xeon.
3. The operating system under test is Red Hat 6.2, running Linux kernels 2.2.19,
2.4.0 and 2.4.1, with 4GB memory support.


The following is the summary report generated by the lmbench benchmark.


                 L M B E N C H  2 . 0   S U M M A R Y
                 ------------------------------------
           (Alpha software, do not distribute)

Basic system parameters
----------------------------------------------------
Host                 OS Description              Mhz

--------- ------------- ----------------------- ----
biglinux-  Linux 2.2.19       i686-pc-linux-gnu  700
biglinux-  Linux 2.2.19       i686-pc-linux-gnu  700
biglinux-  Linux 2.2.19       i686-pc-linux-gnu  700
biglinux-  Linux 2.2.19       i686-pc-linux-gnu  700
biglinux-   Linux 2.4.0       i686-pc-linux-gnu  700
biglinux-   Linux 2.4.0       i686-pc-linux-gnu  700
biglinux-   Linux 2.4.0       i686-pc-linux-gnu  700
biglinux-   Linux 2.4.0       i686-pc-linux-gnu  700
biglinux-   Linux 2.4.0       i686-pc-linux-gnu  700
biglinux-   Linux 2.4.1       i686-pc-linux-gnu  700
biglinux-   Linux 2.4.1       i686-pc-linux-gnu  700
biglinux-   Linux 2.4.1       i686-pc-linux-gnu  700
biglinux-   Linux 2.4.1       i686-pc-linux-gnu  700

Processor, Processes - times in microseconds - smaller is better
----------------------------------------------------------------
Host                 OS  Mhz null null      open selct sig  sig  fork exec sh
                             call  I/O stat clos TCP   inst hndl proc proc proc
--------- ------------- ---- ---- ---- ---- ---- ----- ---- ---- ---- ---- ----
biglinux-  Linux 2.2.19  700 0.43 0.61 3.89 4.84    20 1.27 1.64  109  761 2988
biglinux-  Linux 2.2.19  700 0.43 0.62 3.91 4.89    20 1.27 1.64  108  760 2981
biglinux-  Linux 2.2.19  700 0.43 0.62 3.88 4.93    20 1.27 1.64  108  764 2986
biglinux-  Linux 2.2.19  700 0.43 0.62 3.79 4.73    22 1.27 1.64  132  767 3011
biglinux-   Linux 2.4.0  700 0.40 0.63 3.37 4.45    19 1.21 3.75  139  831 3219
biglinux-   Linux 2.4.0  700 0.40 0.60 3.39 4.46    19 1.24 3.75  139  831 3269
biglinux-   Linux 2.4.0  700 0.43 0.63 3.39 4.46    21 1.24 3.82  142  841 3255
biglinux-   Linux 2.4.0  700 0.43 0.62 3.37 4.49    21 1.24 3.75  140  835 3244
biglinux-   Linux 2.4.0  700 0.43 0.62 3.37 4.47    19 1.24 3.75  140  832 3263
biglinux-   Linux 2.4.1  700 0.40 0.61 3.37 4.35    19 1.21 3.80  141  836 3262
biglinux-   Linux 2.4.1  700 0.40 0.61 3.39 4.42    21 1.21 3.85  142  841 3316
biglinux-   Linux 2.4.1  700 0.40 0.59 3.42 4.38    21 1.21 3.81  141  841 3306
biglinux-   Linux 2.4.1  700 0.40 0.61 3.39 4.39    20 1.21 3.81  142  841 3225

Context switching - times in microseconds - smaller is better
-------------------------------------------------------------
Host                 OS 2p/0K 2p/16K 2p/64K 8p/16K 8p/64K 16p/16K 16p/64K
                        ctxsw  ctxsw  ctxsw ctxsw  ctxsw   ctxsw   ctxsw
--------- ------------- ----- ------ ------ ------ ------ ------- -------
biglinux-  Linux 2.2.19 0.850 5.0800     21 6.7500     23 8.98000      97
biglinux-  Linux 2.2.19 0.860 7.1700     21 6.9200     22      10     138
biglinux-  Linux 2.2.19 0.890 6.5100     21 6.5600    136      14     155
biglinux-  Linux 2.2.19 0.960 6.4200     21 6.7000     22 7.16000      88
biglinux-   Linux 2.4.0 1.040 6.5300     21 6.5800     29      19     185
biglinux-   Linux 2.4.0 1.170 6.6200     21 6.7000     22 6.72000     102
biglinux-   Linux 2.4.0 1.050 6.6100     21 6.5900     22 6.68000     101
biglinux-   Linux 2.4.0 1.070 6.5700     21 6.7200     22 6.79000     102
biglinux-   Linux 2.4.0 1.100 6.5300     21 6.5900     22      13     107
biglinux-   Linux 2.4.1 1.050 6.4400     21 7.2000     23 6.88000     102
biglinux-   Linux 2.4.1 1.140 6.6900     21 6.7100     22 6.92000     103
biglinux-   Linux 2.4.1 1.130 6.7200     22 6.9300     22 6.85000     110
biglinux-   Linux 2.4.1 1.180 6.5000     21 7.1000     22 7.11000     109

*Local* Communication latencies in microseconds - smaller is better
-------------------------------------------------------------------
Host                 OS 2p/0K  Pipe AF     UDP  RPC/   TCP  RPC/ TCP
                        ctxsw       UNIX         UDP         TCP conn
--------- ------------- ----- ----- ---- ----- ----- ----- ----- ----
biglinux-  Linux 2.2.19 0.850 4.583 8.55    15          25         83
biglinux-  Linux 2.2.19 0.860 4.605 8.96    15          25         85
biglinux-  Linux 2.2.19 0.890 4.545 8.79    15          25         83
biglinux-  Linux 2.2.19 0.960 4.581 8.85    15          25         86
biglinux-   Linux 2.4.0 1.040 5.193 8.74    15          22       9.0M
biglinux-   Linux 2.4.0 1.170 5.274 8.80    15          22       9.0M
biglinux-   Linux 2.4.0 1.050 5.378 9.02    15          23        23M
biglinux-   Linux 2.4.0 1.070 5.288 8.99    15          22       3.0M
biglinux-   Linux 2.4.0 1.100 5.273 8.81    15          23        29M
biglinux-   Linux 2.4.1 1.050 5.291 8.41    15          23       3.0M
biglinux-   Linux 2.4.1 1.140 5.419 8.56    15          23       9.0M
biglinux-   Linux 2.4.1 1.130 5.574 8.81    15          23        29M
biglinux-   Linux 2.4.1 1.180 5.646 9.01    15          24       9.0M

File & VM system latencies in microseconds - smaller is better
--------------------------------------------------------------
Host                 OS   0K File      10K File      Mmap    Prot    Page
                        Create Delete Create Delete  Latency Fault   Fault
--------- ------------- ------ ------ ------ ------  ------- -----   -----
biglinux-  Linux 2.2.19 8.8928 0.5667     17 1.1416 24.57400 0.887     528
biglinux-  Linux 2.2.19 8.8976 0.5710     17 1.1458 23.76700 0.887     518
biglinux-  Linux 2.2.19 8.9103 0.5625     17 1.1297 23.83100 0.887     518
biglinux-  Linux 2.2.19 8.8881 0.5617     17 1.1739 23.80700 0.888     519
biglinux-   Linux 2.4.0 9.4500 0.5682     19 1.5225     1097 0.847 3.00000
biglinux-   Linux 2.4.0 9.4589 0.5707     19 1.5247     1129 0.850 3.00000
biglinux-   Linux 2.4.0 9.4545 0.5724     19 1.5279     1108 0.887 3.00000
biglinux-   Linux 2.4.0 9.4661 0.5762     19 1.5340     1104 0.854 3.00000
biglinux-   Linux 2.4.0 9.4563 0.5781     19 1.5398     1140 0.850 3.00000
biglinux-   Linux 2.4.1 9.5905 0.5969     17 1.5588     1138 0.837 3.00000
biglinux-   Linux 2.4.1 9.6089 0.6082     17 1.5774     1140 0.862 3.00000
biglinux-   Linux 2.4.1 9.5914 0.5986     17 1.5677     1156 0.835 3.00000
biglinux-   Linux 2.4.1 9.6015 0.6109     17 1.5816     1151 0.861 3.00000

*Local* Communication bandwidths in MB/s - bigger is better
-----------------------------------------------------------
Host                OS  Pipe AF    TCP  File   Mmap  Bcopy  Bcopy  Mem   Mem
                             UNIX      reread reread (libc) (hand) read write
--------- ------------- ---- ---- ---- ------ ------ ------ ------ ---- -----
biglinux-  Linux 2.2.19  684  458  256    219    258    131    129  258   199
biglinux-  Linux 2.2.19  684  458  254    191    258    133    130  258   198
biglinux-  Linux 2.2.19  685  457  195    219    258    135    129  258   199
biglinux-  Linux 2.2.19  694  454  248    219    258    133    129  258   198
biglinux-   Linux 2.4.0  651  369  470    146    257    128    129  257   197
biglinux-   Linux 2.4.0  641  371  478    209    257    119    129  257   197
biglinux-   Linux 2.4.0  647  372  481    209    257    127    128  257   197
biglinux-   Linux 2.4.0  634  369  479    209    257    130    129  257   197
biglinux-   Linux 2.4.0  641  351  483    210    257    127    129  257   197
biglinux-   Linux 2.4.1  650  379  476    209    257    128    129  257   197
biglinux-   Linux 2.4.1  622  367  472    209    257    120    128  257   197
biglinux-   Linux 2.4.1  615  367  471    209    257    129    129  257   197
biglinux-   Linux 2.4.1  624  384  463    209    257    126    129  257   197

Memory latencies in nanoseconds - smaller is better
    (WARNING - may not be correct, check graphs)
---------------------------------------------------
Host                 OS   Mhz  L1 $   L2 $    Main mem    Guesses
--------- -------------  ---- ----- ------    --------    -------
biglinux-  Linux 2.2.19   700 4.286     24    201
biglinux-  Linux 2.2.19   700 4.286     12    201
biglinux-  Linux 2.2.19   700 4.286     12    201
biglinux-  Linux 2.2.19   700 4.286     12    201
biglinux-   Linux 2.4.0   700 4.286     12    201
biglinux-   Linux 2.4.0   700 4.287     12    201
biglinux-   Linux 2.4.0   700 4.286     12    201
biglinux-   Linux 2.4.0   700 4.287     12    201
biglinux-   Linux 2.4.0   700 4.286     12    201
biglinux-   Linux 2.4.1   700 4.286     12    201
biglinux-   Linux 2.4.1   700 4.287     12    201
biglinux-   Linux 2.4.1   700 4.286     12    201
biglinux-   Linux 2.4.1   700 4.287     12    201


Cheers .... Duc.

