Return-Path: <linux-kernel-owner@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S129172AbRAYXRf>; Thu, 25 Jan 2001 18:17:35 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S129274AbRAYXRZ>; Thu, 25 Jan 2001 18:17:25 -0500
Received: from finch-post-10.mail.demon.net ([194.217.242.38]:61712 "EHLO
	finch-post-10.mail.demon.net") by vger.kernel.org with ESMTP
	id <S129172AbRAYXRK>; Thu, 25 Jan 2001 18:17:10 -0500
Date: Thu, 25 Jan 2001 23:16:59 +0000
To: linux-kernel@vger.kernel.org
Subject: 2.4.1-pre8 losing pages
Message-ID: <20010125231659.A2128@colonel-panic.com>
Mail-Followup-To: pdh, linux-kernel@vger.kernel.org
Mime-Version: 1.0
Content-Type: multipart/mixed; boundary="bg08WKrSYDhXBjb5"
Content-Disposition: inline
User-Agent: Mutt/1.2.5i
From: Peter Horton <pdh@colonel-panic.com>
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org


--bg08WKrSYDhXBjb5
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline

I'm experiencing repeatable corruption whilst writing large volumes of
data to disk. Kernel version is 2.4.1-pre8, on an 850MHz AMD Athlon on an
ASUS A7V (VIA KT133 chipset) motherboard 128M RAM (tested with 'memtest86'
for 10 hours).

First, I realised that the fsck was noticing small corruptions on my ext2
volume. My first suspect was the much discussed VIA IDE controller. As a
test I created a 128M file from "urandom" and copied it to twenty six
files. When I MD5 the files one or two of them are usually corrupt. The
damage usually occurs in the 24th copy (thought not always). Inspecting
the files shows a single 4K block (aligned on a 4K boundary) that is
completely different from what it should be. The kernel logs no errors
whilst writing the corrupt files.

I've repeated the test on the other on-board IDE controller (Promise), a
different hard disk, and on reiserfs. I see the corruption in all cases.

I tried building the kernel for "Pentium-Classic", and I tried a few older
kernels (2.4.0-test5 and 2.4.0-test12), still bad (all kernels built with
GCC 2.95.2 - Debian potato).

I really could do with some help as where to look next :-). I did try and
come up with a test to see whether bad data is written or whether the
damaged piece is just not written, but if I alter the testing procedure
too much the problem seems to go away. It seems to just lose a single page
under one very specific circumstance.

P.

( configs attached )


--bg08WKrSYDhXBjb5
Content-Type: application/octet-stream
Content-Disposition: attachment; filename="info.tar.gz"
Content-Transfer-Encoding: base64

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

--bg08WKrSYDhXBjb5--
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at http://www.tux.org/lkml/
