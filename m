Return-Path: <linux-kernel-owner@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S129156AbRB0G6U>; Tue, 27 Feb 2001 01:58:20 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S129197AbRB0G6K>; Tue, 27 Feb 2001 01:58:10 -0500
Received: from mons.uio.no ([129.240.130.14]:7841 "EHLO mons.uio.no")
	by vger.kernel.org with ESMTP id <S129156AbRB0G55>;
	Tue, 27 Feb 2001 01:57:57 -0500
Message-ID: <15003.20448.999929.948597@charged.uio.no>
Date: Tue, 27 Feb 2001 07:57:36 +0100 (CET)
To: "H . J . Lu" <hjl@valinux.com>
Cc: NFS maillist <nfs@lists.sourceforge.net>,
        Linux Kernel <linux-kernel@vger.kernel.org>
Subject: Re: [NFS] Updated patch for the [2.4.x] NFS 'missing directory entry a.k.a. IRIX server' problem...
In-Reply-To: <20010226152826.A20653@valinux.com>
In-Reply-To: <14997.9938.106305.635202@charged.uio.no>
	<20010226152826.A20653@valinux.com>
X-Mailer: VM 6.75 under 21.1 (patch 14) "Cuyahoga Valley" XEmacs Lucid
Reply-To: trond.myklebust@fys.uio.no
From: Trond Myklebust <trond.myklebust@fys.uio.no>
Mime-Version: 1.0 (generated by tm-edit 1.7)
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

>>>>> " " == H J Lu <hjl@valinux.com> writes:

     > I don't know how it will work with real 64bit cookies on a
     > 32bit host for NFS V3 since you truncate it into 32bit during
     > sign extension.

It won't for the moment, but that's a problem with the readdir() API
which uses the 32-bit off_t rather than loff_t for the filldir()
interface. The reason I added an extra truncation for the value of
file->f_pos (which is used to fill the d_off field only for the last
dirent) was for consistency with this interface.

I do have a patch to change the format of filldir too, but it'll
probably have to wait until Linux 2.5.

Cheers,
  Trond
