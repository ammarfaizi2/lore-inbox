Return-Path: <linux-kernel-owner@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S130050AbRCHW3U>; Thu, 8 Mar 2001 17:29:20 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S130051AbRCHW3L>; Thu, 8 Mar 2001 17:29:11 -0500
Received: from enhanced.ppp.eticomm.net ([206.228.183.5]:38652 "EHLO
	intech19.enhanced.com") by vger.kernel.org with ESMTP
	id <S130050AbRCHW3C>; Thu, 8 Mar 2001 17:29:02 -0500
From: Camm Maguire <camm@enhanced.com>
To: linux-kernel@vger.kernel.org
Subject: 2.2.x kernels not filling in siginfo_t.si_addr on SEGV?
User-Agent: WEMI/1.13.7 (Shimada) FLIM/1.13.2 (Kasanui) Emacs/20.7 (i386-debian-linux-gnu) MULE/4.0 (HANANOEN)
MIME-Version: 1.0 (generated by WEMI 1.13.7 - "Shimada")
Content-Type: text/plain; charset=US-ASCII
Message-Id: <E14b8sw-0007A2-00@intech19.enhanced.com>
Date: Thu, 08 Mar 2001 17:27:50 -0500
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Greetings!  Shouldn't a SIGSEGV fill in th si_addr member of the
siginfo_t structure passed to a signal handler?  Here is what I see
(on several archs):
=============================================================================
q.c
=============================================================================
#include <stdio.h>
#include <signal.h>

void
nh(int s,siginfo_t *si,void *sc) {
  printf("%p\n",si->si_addr);
  exit(0);
}

int
main() {

  struct sigaction sa;
  char c[3];

  memset(&sa,0,sizeof(sa));
  sa.sa_sigaction=nh;
  sa.sa_flags=SA_RESTART|SA_SIGINFO;
  sigaction(SIGSEGV,&sa,0);
  c[4096]=0;

/*    raise(SIGSEGV); */

  return 0;

}
=============================================================================
camm@kullervo:~$ cc -g q.c -o q 
cc -g q.c -o q 
camm@kullervo:~$ ./q
./q
(nil)
=============================================================================
Take care,

-- 
Camm Maguire			     			camm@enhanced.com
==========================================================================
"The earth is but one country, and mankind its citizens."  --  Baha'u'llah
