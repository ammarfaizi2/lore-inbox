Return-Path: <linux-kernel-owner@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S312465AbSDCXG7>; Wed, 3 Apr 2002 18:06:59 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S312466AbSDCXGt>; Wed, 3 Apr 2002 18:06:49 -0500
Received: from mail.ocs.com.au ([203.34.97.2]:57874 "HELO mail.ocs.com.au")
	by vger.kernel.org with SMTP id <S312465AbSDCXGk>;
	Wed, 3 Apr 2002 18:06:40 -0500
X-Mailer: exmh version 2.2 06/23/2000 with nmh-1.0.4
From: Keith Owens <kaos@ocs.com.au>
To: Hiroyuki Toda <might@might.dyn.to>
Cc: linux-kernel@vger.kernel.org
Subject: Re: [PATCH] cleanup KERNEL_VERSION definition and linux/version.h 
In-Reply-To: Your message of "Wed, 03 Apr 2002 23:49:00 +0900."
             <20020403144917Z311782-616+5144@vger.kernel.org> 
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Date: Thu, 04 Apr 2002 09:06:28 +1000
Message-ID: <15585.1017875188@ocs3.intra.ocs.com.au>
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

On Wed, 03 Apr 2002 23:49:00 +0900, 
Hiroyuki Toda <might@might.dyn.to> wrote:
>Hi Marcelo,
>
>I send you a patch to clean up KERNEL_VERSION definition and linux/version.h 
>generated by linux/Makefile.
>
>Main part of the patch is as follows:
>
>diff -ur linux-2.4.18.org/Makefile linux/Makefile
>--- linux-2.4.18.org/Makefile   Wed Feb 27 00:15:58 2002
>+++ linux/Makefile      Wed Mar 20 00:46:23 2002
>@@ -325,9 +325,16 @@
>        @mv -f .ver $@
>
> include/linux/version.h: ./Makefile
>-       @echo \#define UTS_RELEASE \"$(KERNELRELEASE)\" > .ver
>-       @echo \#define LINUX_VERSION_CODE `expr $(VERSION) \\* 65536 + $(PATCHLEVEL) \\* 256 + $(SUBLEVEL)` >> .ver
>-       @echo '#define KERNEL_VERSION(a,b,c) (((a) << 16) + ((b) << 8) + (c))' >>.ver
>+       @echo "/* this file is generate automaticaly. don\'t edit */" > .ver
>+       @echo '' >> .ver
>+       @echo '#if !defined(_LINUX_VERSION_H_INCLUDED)' >> .ver
>+       @echo '#define _LINUX_VERSION_H_INCLUDED' >> .ver
>+       @echo '' >> .ver
>+       @echo \#define UTS_RELEASE \"$(KERNELRELEASE)\" >> .ver
>+       @echo '#define KERNEL_VERSION(a, b, c) (((a) << 16) | ((b) << 8) | (c))' >>.ver
>+       @echo \#define LINUX_VERSION_CODE KERNEL_VERSION\($(VERSION), $(PATCHLEVEL), $(SUBLEVEL)\) >> .ver
>+       @echo '' >> .ver
>+       @echo '#endif' >> .ver
>        @mv -f .ver $@
>
> comma  := ,
>

This file will change completely in 2.5 when kbuild 2.5 goes in.  Why
does it need to be rearranged in 2.4?

