Return-Path: <linux-kernel-owner+willy=40w.ods.org-S263733AbUGACKG@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S263733AbUGACKG (ORCPT <rfc822;willy@w.ods.org>);
	Wed, 30 Jun 2004 22:10:06 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S263735AbUGACKG
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Wed, 30 Jun 2004 22:10:06 -0400
Received: from sv1.valinux.co.jp ([210.128.90.2]:14220 "EHLO sv1.valinux.co.jp")
	by vger.kernel.org with ESMTP id S263733AbUGACKB (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Wed, 30 Jun 2004 22:10:01 -0400
Date: Thu, 01 Jul 2004 11:10:00 +0900
From: IWAMOTO Toshihiro <iwamoto@valinux.co.jp>
To: Dave Hansen <haveblue@us.ibm.com>
Cc: IWAMOTO Toshihiro <iwamoto@valinux.co.jp>,
       Linux Kernel Mailing List <linux-kernel@vger.kernel.org>,
       lhms <lhms-devel@lists.sourceforge.net>, linux-mm <linux-mm@kvack.org>
Subject: Re: [Lhms-devel] new memory hotremoval patch
In-Reply-To: <1088638272.5265.931.camel@nighthawk>
References: <20040630111719.EBACF70A92@sv1.valinux.co.jp>
	<1088638272.5265.931.camel@nighthawk>
User-Agent: Wanderlust/2.10.1 (Watching The Wheels) SEMI/1.14.6 (Maruoka) FLIM/1.14.6 (Marutamachi) APEL/10.6 Emacs/21.3 (i386-pc-linux-gnu) MULE/5.0 (SAKAKI)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Message-Id: <20040701021000.1022070A92@sv1.valinux.co.jp>
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

At Wed, 30 Jun 2004 16:31:12 -0700,
Dave Hansen wrote:
> 
> On Wed, 2004-06-30 at 04:17, IWAMOTO Toshihiro wrote:
> > Hi,
> > 
> > this is an updated version of my memory hotremoval patch.
> > I'll only include the main patch which contains page remapping code.
> > The other two files, which haven't changed much from April, can be
> > found at http://people.valinux.co.jp/~iwamoto/mh.html .
> 
> I tried your code and it oopsed pretty fast:

This is because I forgot to update rotate.sh in my web page last night.
I've updated the file, please download and try again.

It is also necessary to issue several "plug" commands before running
rotate.sh.

	# echo plug 1 > /proc/memhotplug
	# echo plug 2 > /proc/memhotplug
	...


> physnode_map 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14
> Warning only 1920MB will be used.
> Use a HIGHMEM enabled kernel.
> 1892MB LOWMEM available.

Did you use 2G/2G split? That config should work too, but I usually
test with CONFIG_HIGHMEM4G and CONFIG_MEMHOTPLUG_BLKSIZE=512.

--
IWAMOTO Toshihiro
