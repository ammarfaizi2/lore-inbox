Return-Path: <linux-kernel-owner@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S271855AbRICXH3>; Mon, 3 Sep 2001 19:07:29 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S271856AbRICXHK>; Mon, 3 Sep 2001 19:07:10 -0400
Received: from vindaloo.ras.ucalgary.ca ([136.159.55.21]:11195 "EHLO
	vindaloo.ras.ucalgary.ca") by vger.kernel.org with ESMTP
	id <S271855AbRICXGx>; Mon, 3 Sep 2001 19:06:53 -0400
Date: Mon, 3 Sep 2001 17:07:09 -0600
Message-Id: <200109032307.f83N79j29982@vindaloo.ras.ucalgary.ca>
From: Richard Gooch <rgooch@ras.ucalgary.ca>
To: Taylor Carpenter <taylorcc@codecafe.com>
Cc: linux-kernel@vger.kernel.org
Subject: Re: Oops when accessing /dev/fd0 (kernel 2.4.7 and devfsd 1.3.11)
In-Reply-To: <20010825112812.A31755@pioneer.oftheInter.net>
In-Reply-To: <20010816222811.A1672@pioneer.oftheInter.net>
	<200108170419.f7H4J7c20693@vindaloo.ras.ucalgary.ca>
	<20010821223042.A30478@pioneer.oftheInter.net>
	<200108220507.f7M576q25412@vindaloo.ras.ucalgary.ca>
	<20010822191227.A11226@pioneer.oftheInter.net>
	<200108230505.f7N55sr05856@vindaloo.ras.ucalgary.ca>
	<20010825112812.A31755@pioneer.oftheInter.net>
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Taylor Carpenter writes:
> On Wed, Aug 22, 2001 at 11:05:54PM -0600, Richard Gooch wrote:
> > Taylor Carpenter writes:
> > >
> > You mean the floppy module gets loaded as a result of the mountall
> > script being run?
> 
> As far as I can tell, when it runs mount -avt, the floppy module
> is loaded if there is an entry in /etc/fstab for /dev/fd0 (even w/the noauto
> option).
>  
> > Is the /etc/modules.devfs the one that ships with devfsd?
> > Specifically, you need the following line:
> > alias     /dev/floppy		floppy
> 
> I do not have a modules.devfs.  I do have a /etc/modutils/devfsd,
> but it does not have an alias entry for the floppy.

What the hell is /etc/modutils/devfsd? More Debian tricks?

[...]
> > You must have a bogus /etc/devfsd.conf or /etc/modules.devfs file for
> > module autoloading not to work.
> 
> I had commented out the .* MODLOAD, it worked before that.  I uncommented the
> .* and it still does not work, something else must have changed.
> 
> > I don't know what a "perms" file is. I know Debian uses some
> > convoluted directory tree for devfsd configuration, but frankly, I
> > don't want to know about that. If you have one of these monstrosities,
> > please collapse them all into a single /etc/devfsd.conf file a report
> > based on that.
> 
> OK.  I have nothing but REGISTER PERMISSIONS for floppy in devfsd.conf.

Argh! Let me spell it out: I want you to collapse all devfsd
configuration files into a single file, and throw the stuff in
directories away. And I also want you to do the same for modutils
configuration files. I don't want you to edit out stuff that you think
isn't relevant. I want the whole bloody lot so I can see the context.

Once you've stripped down the configuration to something simple, check
if the Oops still happens. If so, decode it with ksymoops and send it.
Hm. And also send the complete output of dmesg. No editing.

> > Hm. Please try a virgin 2.4.9 kernel with CONFIG_DEVFS_FS=n and try
> > again. I have this feeling that I'm chasing someone else's bug...
> 
> OK, done.  I did not get the oops with DEVFS turned off (in 2.4.9).

Interesting. But I need those collapsed files. I have no desire to
figure out the subtle effects that can be generated by Debian's
configuration system.

				Regards,

					Richard....
Permanent: rgooch@atnf.csiro.au
Current:   rgooch@ras.ucalgary.ca
