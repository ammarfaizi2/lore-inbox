Return-Path: <linux-kernel-owner+willy=40w.ods.org-S1030209AbWHRBng@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1030209AbWHRBng (ORCPT <rfc822;willy@w.ods.org>);
	Thu, 17 Aug 2006 21:43:36 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1030264AbWHRBng
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Thu, 17 Aug 2006 21:43:36 -0400
Received: from py-out-1112.google.com ([64.233.166.179]:50470 "EHLO
	py-out-1112.google.com") by vger.kernel.org with ESMTP
	id S1030209AbWHRBnf (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Thu, 17 Aug 2006 21:43:35 -0400
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:to:subject:cc:mime-version:content-type;
        b=FtKLI5NZsSdKEnKy1lC6RBca/hlrI6ifrDamCv2aCXGXT6wo0TxddTQynKSggWqne1xzFdJZeciN5DZMYZaWSv4WlbmhHVECbi5uIRJEBjlnp2qrC2JV5ewqTyENF+fijv6ts/tsRDQV7oH12xXn7M/tOwItkpjEBKu+uPBuvws=
Message-ID: <4745278c0608171843j5b3d28bbx16ddf472e1bdb329@mail.gmail.com>
Date: Thu, 17 Aug 2006 21:43:33 -0400
From: "Vishal Patil" <vishpat@gmail.com>
To: "Linux Kernel Mailing List" <linux-kernel@vger.kernel.org>
Subject: Page cache using B-trees benchmark results
Cc: "Andrea Arcangeli" <andrea@suse.de>
MIME-Version: 1.0
Content-Type: multipart/mixed; 
	boundary="----=_Part_17202_32626162.1155865413814"
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

------=_Part_17202_32626162.1155865413814
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Folks

I am attaching the benchmark results for Page Cache Implementation
using B-trees. I basically ran the tio (threaded i/o) benchmark
against my kernel (with the B-tree implementation) and the Linux
kernel shipped with FC5. Radix tree implementation is definately
better however the B-tree implementation did not suck that bad :)

Also I attaching a new patch which was used for measuring the
benchmarks. Also henceforth changes to the page will be tracked using
the projected hosted at http://code.google.com/p/btreepc

Thanks

- Vishal

-- 
Motivation will almost always beat mere talent.

------=_Part_17202_32626162.1155865413814
Content-Type: text/x-patch; name=btree.linux2.6.16.2.patch; 
	charset=ANSI_X3.4-1968
Content-Transfer-Encoding: base64
X-Attachment-Id: f_eqzw92kb
Content-Disposition: attachment; filename="btree.linux2.6.16.2.patch"

ZGlmZiAtdXJOIGxpbnV4LTIuNi4xNi4yL21tL2ZpbGVtYXAuYyBsaW51eC0yLjYuMTYuMi1idHJl
ZS9tbS9maWxlbWFwLmMKLS0tIGxpbnV4LTIuNi4xNi4yL21tL2ZpbGVtYXAuYwkyMDA2LTA0LTA3
IDEyOjU2OjQ3LjAwMDAwMDAwMCAtMDQwMAorKysgbGludXgtMi42LjE2LjItYnRyZWUvbW0vZmls
ZW1hcC5jCTIwMDYtMDgtMTcgMjE6MTE6MjEuMDAwMDAwMDAwIC0wNDAwCkBAIC0xMTIsMTAgKzEx
MiwxNiBAQAogICovCiB2b2lkIF9fcmVtb3ZlX2Zyb21fcGFnZV9jYWNoZShzdHJ1Y3QgcGFnZSAq
cGFnZSkKIHsKKwlzdHJ1Y3QgcGFnZSAqIGJwYWdlOwogCXN0cnVjdCBhZGRyZXNzX3NwYWNlICpt
YXBwaW5nID0gcGFnZS0+bWFwcGluZzsKKwl1bnNpZ25lZCBsb25nIGluZGV4ID0gcGFnZS0+aW5k
ZXg7CQogCi0JcmFkaXhfdHJlZV9kZWxldGUoJm1hcHBpbmctPnBhZ2VfdHJlZSwgcGFnZS0+aW5k
ZXgpOwotCXBhZ2UtPm1hcHBpbmcgPSBOVUxMOworCWJwYWdlID0gYnRyZWVfZGVsZXRlKCZtYXBw
aW5nLT5idHJlZSxtYXBwaW5nLT5idHJlZS5yb290LGluZGV4KS52YWw7CisJaWYgKCBicGFnZSAh
PSBwYWdlKSB7CisJCXBhbmljKCJERUJVRzogRGVsZXRpbmcgd3JvbmcgcGFnZSBpbiByZW1vdmUg
ZnJvbSBwYWdlIiAKKwkJCSJjYWNoZSAlZCwweCV4XG4iLGluZGV4LGJwYWdlKTsKKwl9IAorICAg
ICAJcGFnZS0+bWFwcGluZyA9IE5VTEw7CiAJbWFwcGluZy0+bnJwYWdlcy0tOwogCXBhZ2VjYWNo
ZV9hY2N0KC0xKTsKIH0KQEAgLTM5NSwxMiArNDAxLDE0IEBACiBpbnQgYWRkX3RvX3BhZ2VfY2Fj
aGUoc3RydWN0IHBhZ2UgKnBhZ2UsIHN0cnVjdCBhZGRyZXNzX3NwYWNlICptYXBwaW5nLAogCQlw
Z29mZl90IG9mZnNldCwgZ2ZwX3QgZ2ZwX21hc2spCiB7Ci0JaW50IGVycm9yID0gcmFkaXhfdHJl
ZV9wcmVsb2FkKGdmcF9tYXNrICYgfl9fR0ZQX0hJR0hNRU0pOwotCi0JaWYgKGVycm9yID09IDAp
IHsKKyAgICAgICAgaW50IGJ0cmVlX2Vycm9yID0gYnRyZWVfcHJlbG9hZChnZnBfbWFzayAmIH5f
X0dGUF9ISUdITUVNKTsKKyAgICAgICAgCisJaWYgKGJ0cmVlX2Vycm9yID09IDApIHsKIAkJd3Jp
dGVfbG9ja19pcnEoJm1hcHBpbmctPnRyZWVfbG9jayk7Ci0JCWVycm9yID0gcmFkaXhfdHJlZV9p
bnNlcnQoJm1hcHBpbmctPnBhZ2VfdHJlZSwgb2Zmc2V0LCBwYWdlKTsKLQkJaWYgKCFlcnJvcikg
eworICAgICAgICAgICAgICAgIGJ0cmVlX2Vycm9yID0gCisJCQlidHJlZV9pbnNlcnQoJm1hcHBp
bmctPmJ0cmVlLG9mZnNldCxwYWdlKTsKKyAgICAgICAgICAgICAgICAKKwkJaWYgKCFidHJlZV9l
cnJvcikgewogCQkJcGFnZV9jYWNoZV9nZXQocGFnZSk7CiAJCQlTZXRQYWdlTG9ja2VkKHBhZ2Up
OwogCQkJcGFnZS0+bWFwcGluZyA9IG1hcHBpbmc7CkBAIC00MDksOSArNDE3LDExIEBACiAJCQlw
YWdlY2FjaGVfYWNjdCgxKTsKIAkJfQogCQl3cml0ZV91bmxvY2tfaXJxKCZtYXBwaW5nLT50cmVl
X2xvY2spOwotCQlyYWRpeF90cmVlX3ByZWxvYWRfZW5kKCk7CisgICAgICAgICAgICAgICAgaWYo
YnRyZWVfZXJyb3IgPT0gMCkgeworICAgICAgICAgICAgICAgICAgICAgICAgYnRyZWVfcHJlbG9h
ZF9lbmQoKTsKKyAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgCiAJfQot
CXJldHVybiBlcnJvcjsKKwlyZXR1cm4gYnRyZWVfZXJyb3I7CiB9CiAKIEVYUE9SVF9TWU1CT0wo
YWRkX3RvX3BhZ2VfY2FjaGUpOwpAQCAtNTIyLDcgKzUzMiw3IEBACiAJc3RydWN0IHBhZ2UgKnBh
Z2U7CiAKIAlyZWFkX2xvY2tfaXJxKCZtYXBwaW5nLT50cmVlX2xvY2spOwotCXBhZ2UgPSByYWRp
eF90cmVlX2xvb2t1cCgmbWFwcGluZy0+cGFnZV90cmVlLCBvZmZzZXQpOworCXBhZ2UgPSBidHJl
ZV9sb29rdXAoJm1hcHBpbmctPmJ0cmVlLG9mZnNldCk7CiAJaWYgKHBhZ2UpCiAJCXBhZ2VfY2Fj
aGVfZ2V0KHBhZ2UpOwogCXJlYWRfdW5sb2NrX2lycSgmbWFwcGluZy0+dHJlZV9sb2NrKTsKQEAg
LTUzOSw3ICs1NDksNyBAQAogCXN0cnVjdCBwYWdlICpwYWdlOwogCiAJcmVhZF9sb2NrX2lycSgm
bWFwcGluZy0+dHJlZV9sb2NrKTsKLQlwYWdlID0gcmFkaXhfdHJlZV9sb29rdXAoJm1hcHBpbmct
PnBhZ2VfdHJlZSwgb2Zmc2V0KTsKKwlwYWdlID0gYnRyZWVfbG9va3VwKCZtYXBwaW5nLT5idHJl
ZSxvZmZzZXQpOwogCWlmIChwYWdlICYmIFRlc3RTZXRQYWdlTG9ja2VkKHBhZ2UpKQogCQlwYWdl
ID0gTlVMTDsKIAlyZWFkX3VubG9ja19pcnEoJm1hcHBpbmctPnRyZWVfbG9jayk7CkBAIC01NjMs
MTAgKzU3Myw5IEBACiAJCQkJdW5zaWduZWQgbG9uZyBvZmZzZXQpCiB7CiAJc3RydWN0IHBhZ2Ug
KnBhZ2U7Ci0KIAlyZWFkX2xvY2tfaXJxKCZtYXBwaW5nLT50cmVlX2xvY2spOwogcmVwZWF0Ogot
CXBhZ2UgPSByYWRpeF90cmVlX2xvb2t1cCgmbWFwcGluZy0+cGFnZV90cmVlLCBvZmZzZXQpOwor
CXBhZ2UgPSBidHJlZV9sb29rdXAoJm1hcHBpbmctPmJ0cmVlLG9mZnNldCk7CiAJaWYgKHBhZ2Up
IHsKIAkJcGFnZV9jYWNoZV9nZXQocGFnZSk7CiAJCWlmIChUZXN0U2V0UGFnZUxvY2tlZChwYWdl
KSkgewpAQCAtNjU4LDggKzY2NywxMCBAQAogCXVuc2lnbmVkIGludCByZXQ7CiAKIAlyZWFkX2xv
Y2tfaXJxKCZtYXBwaW5nLT50cmVlX2xvY2spOwotCXJldCA9IHJhZGl4X3RyZWVfZ2FuZ19sb29r
dXAoJm1hcHBpbmctPnBhZ2VfdHJlZSwKLQkJCQkodm9pZCAqKilwYWdlcywgc3RhcnQsIG5yX3Bh
Z2VzKTsKKworCXJldCA9IGJ0cmVlX2dhbmdfbG9va3VwKCZtYXBwaW5nLT5idHJlZSwodm9pZCAq
KilwYWdlcywKKwkJCQlzdGFydCxucl9wYWdlcyk7CisKIAlmb3IgKGkgPSAwOyBpIDwgcmV0OyBp
KyspCiAJCXBhZ2VfY2FjaGVfZ2V0KHBhZ2VzW2ldKTsKIAlyZWFkX3VubG9ja19pcnEoJm1hcHBp
bmctPnRyZWVfbG9jayk7CkBAIC02NzcsOCArNjg4LDkgQEAKIAl1bnNpZ25lZCBpbnQgcmV0Owog
CiAJcmVhZF9sb2NrX2lycSgmbWFwcGluZy0+dHJlZV9sb2NrKTsKLQlyZXQgPSByYWRpeF90cmVl
X2dhbmdfbG9va3VwX3RhZygmbWFwcGluZy0+cGFnZV90cmVlLAorCXJldCA9IGJ0cmVlX2dhbmdf
bG9va3VwX3RhZygmbWFwcGluZy0+YnRyZWUsCiAJCQkJKHZvaWQgKiopcGFnZXMsICppbmRleCwg
bnJfcGFnZXMsIHRhZyk7CisJCQogCWZvciAoaSA9IDA7IGkgPCByZXQ7IGkrKykKIAkJcGFnZV9j
YWNoZV9nZXQocGFnZXNbaV0pOwogCWlmIChyZXQpCmRpZmYgLXVyTiBsaW51eC0yLjYuMTYuMi9t
bS9wYWdlLXdyaXRlYmFjay5jIGxpbnV4LTIuNi4xNi4yLWJ0cmVlL21tL3BhZ2Utd3JpdGViYWNr
LmMKLS0tIGxpbnV4LTIuNi4xNi4yL21tL3BhZ2Utd3JpdGViYWNrLmMJMjAwNi0wNC0wNyAxMjo1
Njo0Ny4wMDAwMDAwMDAgLTA0MDAKKysrIGxpbnV4LTIuNi4xNi4yLWJ0cmVlL21tL3BhZ2Utd3Jp
dGViYWNrLmMJMjAwNi0wOC0xNyAyMToxMToyMS4wMDAwMDAwMDAgLTA0MDAKQEAgLTYzNCw4ICs2
MzQsMTYgQEAKIAkJCQlCVUdfT04obWFwcGluZzIgIT0gbWFwcGluZyk7CiAJCQkJaWYgKG1hcHBp
bmdfY2FwX2FjY291bnRfZGlydHkobWFwcGluZykpCiAJCQkJCWluY19wYWdlX3N0YXRlKG5yX2Rp
cnR5KTsKLQkJCQlyYWRpeF90cmVlX3RhZ19zZXQoJm1hcHBpbmctPnBhZ2VfdHJlZSwKLQkJCQkJ
cGFnZV9pbmRleChwYWdlKSwgUEFHRUNBQ0hFX1RBR19ESVJUWSk7CisJCQkJYnRyZWVfdGFnX3Nl
dCgmbWFwcGluZy0+YnRyZWUsCisJCQkJcGFnZV9pbmRleChwYWdlKSwgUEFHRUNBQ0hFX1RBR19E
SVJUWSk7CisKKwkJCQlpZiAoYnRyZWVfdGFnX2dldCgmbWFwcGluZy0+YnRyZWUsCisJCQkJcGFn
ZV9pbmRleChwYWdlKSwgUEFHRUNBQ0hFX1RBR19ESVJUWSkgIT0gMSApIHsKKwkJCQkJcGFuaWMo
Il9fc2V0X3BhZ2VfZGlydHlfbm9idWZmZXJzICIKKwkJCQkJIiBQcm9ibGVtIHNldHRpbmcgdGhl
IHRhZ1xuIik7CisJCQkJfQkJCQkJCisKKwkJCQkKIAkJCX0KIAkJCXdyaXRlX3VubG9ja19pcnEo
Jm1hcHBpbmctPnRyZWVfbG9jayk7CiAJCQlpZiAobWFwcGluZy0+aG9zdCkgewpAQCAtNzE0LDkg
KzcyMiwxNiBAQAogCWlmIChtYXBwaW5nKSB7CiAJCXdyaXRlX2xvY2tfaXJxc2F2ZSgmbWFwcGlu
Zy0+dHJlZV9sb2NrLCBmbGFncyk7CiAJCWlmIChUZXN0Q2xlYXJQYWdlRGlydHkocGFnZSkpIHsK
LQkJCXJhZGl4X3RyZWVfdGFnX2NsZWFyKCZtYXBwaW5nLT5wYWdlX3RyZWUsCisJCQlidHJlZV90
YWdfY2xlYXIoJm1hcHBpbmctPmJ0cmVlLAogCQkJCQkJcGFnZV9pbmRleChwYWdlKSwKIAkJCQkJ
CVBBR0VDQUNIRV9UQUdfRElSVFkpOworCisJCQlpZiAoYnRyZWVfdGFnX2dldCgmbWFwcGluZy0+
YnRyZWUsCisJCQkJCXBhZ2VfaW5kZXgocGFnZSksCisJCQkJCVBBR0VDQUNIRV9UQUdfRElSVFkp
ICA9PSAxKSB7CisJCQkJcGFuaWMoIlByb2JsZW0gY2xlYXJpbmcgdGhlIHRhZ1xuIik7CisJCQl9
CQkJCQorCiAJCQl3cml0ZV91bmxvY2tfaXJxcmVzdG9yZSgmbWFwcGluZy0+dHJlZV9sb2NrLCBm
bGFncyk7CiAJCQlpZiAobWFwcGluZ19jYXBfYWNjb3VudF9kaXJ0eShtYXBwaW5nKSkKIAkJCQlk
ZWNfcGFnZV9zdGF0ZShucl9kaXJ0eSk7CkBAIC03NjksMTAgKzc4NCwxNyBAQAogCiAJCXdyaXRl
X2xvY2tfaXJxc2F2ZSgmbWFwcGluZy0+dHJlZV9sb2NrLCBmbGFncyk7CiAJCXJldCA9IFRlc3RD
bGVhclBhZ2VXcml0ZWJhY2socGFnZSk7Ci0JCWlmIChyZXQpCi0JCQlyYWRpeF90cmVlX3RhZ19j
bGVhcigmbWFwcGluZy0+cGFnZV90cmVlLAorCQlpZiAocmV0KSB7CisJCQlidHJlZV90YWdfY2xl
YXIoJm1hcHBpbmctPmJ0cmVlLAogCQkJCQkJcGFnZV9pbmRleChwYWdlKSwKIAkJCQkJCVBBR0VD
QUNIRV9UQUdfV1JJVEVCQUNLKTsKKwkJCWlmIChidHJlZV90YWdfZ2V0KCZtYXBwaW5nLT5idHJl
ZSwKKwkJCQlwYWdlX2luZGV4KHBhZ2UpLAorCQkJCVBBR0VDQUNIRV9UQUdfV1JJVEVCQUNLKSA9
PSAxKSB7CisJCQkJcGFuaWMoIlByb2JsZW0gY2xlYXJpbmcgdGhlIHRhZ1xuIik7CisJCQl9CQkJ
CQorCisJCX0JCQkKIAkJd3JpdGVfdW5sb2NrX2lycXJlc3RvcmUoJm1hcHBpbmctPnRyZWVfbG9j
aywgZmxhZ3MpOwogCX0gZWxzZSB7CiAJCXJldCA9IFRlc3RDbGVhclBhZ2VXcml0ZWJhY2socGFn
ZSk7CkBAIC03OTAsMTQgKzgxMiwyOSBAQAogCiAJCXdyaXRlX2xvY2tfaXJxc2F2ZSgmbWFwcGlu
Zy0+dHJlZV9sb2NrLCBmbGFncyk7CiAJCXJldCA9IFRlc3RTZXRQYWdlV3JpdGViYWNrKHBhZ2Up
OwotCQlpZiAoIXJldCkKLQkJCXJhZGl4X3RyZWVfdGFnX3NldCgmbWFwcGluZy0+cGFnZV90cmVl
LAorCQlpZiAoIXJldCkgeworCQkJYnRyZWVfdGFnX3NldCgmbWFwcGluZy0+YnRyZWUsCiAJCQkJ
CQlwYWdlX2luZGV4KHBhZ2UpLAogCQkJCQkJUEFHRUNBQ0hFX1RBR19XUklURUJBQ0spOwotCQlp
ZiAoIVBhZ2VEaXJ0eShwYWdlKSkKLQkJCXJhZGl4X3RyZWVfdGFnX2NsZWFyKCZtYXBwaW5nLT5w
YWdlX3RyZWUsCisJCQlpZiAoYnRyZWVfdGFnX2dldCgmbWFwcGluZy0+YnRyZWUsCisJCQkJcGFn
ZV9pbmRleChwYWdlKSwKKwkJCQlQQUdFQ0FDSEVfVEFHX1dSSVRFQkFDSykgIT0gMSkgeworCQkJ
CXBhbmljKCJ0ZXN0X3NldF9wYWdlX3dyaXRlYmFjayIKKwkJCQkJIlByb2JsZW0gc2V0dGluZyB0
aGUgdGFnXG4iKTsKKwkJCX0JCQkJCisKKwkJfQkJCQorCQlpZiAoIVBhZ2VEaXJ0eShwYWdlKSkg
eworCQkJYnRyZWVfdGFnX2NsZWFyKCZtYXBwaW5nLT5idHJlZSwKIAkJCQkJCXBhZ2VfaW5kZXgo
cGFnZSksCiAJCQkJCQlQQUdFQ0FDSEVfVEFHX0RJUlRZKTsKKwkJCWlmIChidHJlZV90YWdfZ2V0
KCZtYXBwaW5nLT5idHJlZSwKKwkJCQlwYWdlX2luZGV4KHBhZ2UpLAorCQkJCVBBR0VDQUNIRV9U
QUdfRElSVFkpID09IDEpIHsKKwkJCQlwYW5pYygiUHJvYmxlbSBjbGVhcmluZyB0aGUgdGFnIik7
CisJCQl9CQkJCQorCisJCX0JCQkKIAkJd3JpdGVfdW5sb2NrX2lycXJlc3RvcmUoJm1hcHBpbmct
PnRyZWVfbG9jaywgZmxhZ3MpOwogCX0gZWxzZSB7CiAJCXJldCA9IFRlc3RTZXRQYWdlV3JpdGVi
YWNrKHBhZ2UpOwpAQCAtODE3LDcgKzg1NCw3IEBACiAJaW50IHJldDsKIAogCXJlYWRfbG9ja19p
cnFzYXZlKCZtYXBwaW5nLT50cmVlX2xvY2ssIGZsYWdzKTsKLQlyZXQgPSByYWRpeF90cmVlX3Rh
Z2dlZCgmbWFwcGluZy0+cGFnZV90cmVlLCB0YWcpOworCXJldCA9IGJ0cmVlX3RhZ2dlZCgmbWFw
cGluZy0+YnRyZWUsdGFnKTsKIAlyZWFkX3VubG9ja19pcnFyZXN0b3JlKCZtYXBwaW5nLT50cmVl
X2xvY2ssIGZsYWdzKTsKIAlyZXR1cm4gcmV0OwogfQpkaWZmIC11ck4gbGludXgtMi42LjE2LjIv
bW0vcmVhZGFoZWFkLmMgbGludXgtMi42LjE2LjItYnRyZWUvbW0vcmVhZGFoZWFkLmMKLS0tIGxp
bnV4LTIuNi4xNi4yL21tL3JlYWRhaGVhZC5jCTIwMDYtMDQtMDcgMTI6NTY6NDcuMDAwMDAwMDAw
IC0wNDAwCisrKyBsaW51eC0yLjYuMTYuMi1idHJlZS9tbS9yZWFkYWhlYWQuYwkyMDA2LTA4LTE3
IDIxOjExOjIxLjAwMDAwMDAwMCAtMDQwMApAQCAtMjgyLDcgKzI4Miw4IEBACiAJCWlmIChwYWdl
X29mZnNldCA+IGVuZF9pbmRleCkKIAkJCWJyZWFrOwogCi0JCXBhZ2UgPSByYWRpeF90cmVlX2xv
b2t1cCgmbWFwcGluZy0+cGFnZV90cmVlLCBwYWdlX29mZnNldCk7CisJCXBhZ2UgPSBidHJlZV9s
b29rdXAoJm1hcHBpbmctPmJ0cmVlLHBhZ2Vfb2Zmc2V0KTsKKwkKIAkJaWYgKHBhZ2UpCiAJCQlj
b250aW51ZTsKIApkaWZmIC11ck4gbGludXgtMi42LjE2LjIvbW0vc3dhcF9zdGF0ZS5jIGxpbnV4
LTIuNi4xNi4yLWJ0cmVlL21tL3N3YXBfc3RhdGUuYwotLS0gbGludXgtMi42LjE2LjIvbW0vc3dh
cF9zdGF0ZS5jCTIwMDYtMDQtMDcgMTI6NTY6NDcuMDAwMDAwMDAwIC0wNDAwCisrKyBsaW51eC0y
LjYuMTYuMi1idHJlZS9tbS9zd2FwX3N0YXRlLmMJMjAwNi0wOC0xNyAyMToxMToyMS4wMDAwMDAw
MDAgLTA0MDAKQEAgLTM3LDYgKzM3LDcgQEAKIAogc3RydWN0IGFkZHJlc3Nfc3BhY2Ugc3dhcHBl
cl9zcGFjZSA9IHsKIAkucGFnZV90cmVlCT0gUkFESVhfVFJFRV9JTklUKEdGUF9BVE9NSUN8X19H
RlBfTk9XQVJOKSwKKyAgICAgICAgLmJ0cmVlICAgICAgICAgID0gQlRSRUVfSU5JVChHRlBfQVRP
TUlDfF9fR0ZQX05PV0FSTiksIAogCS50cmVlX2xvY2sJPSBSV19MT0NLX1VOTE9DS0VELAogCS5h
X29wcwkJPSAmc3dhcF9hb3BzLAogCS5pX21tYXBfbm9ubGluZWFyID0gTElTVF9IRUFEX0lOSVQo
c3dhcHBlcl9zcGFjZS5pX21tYXBfbm9ubGluZWFyKSwKQEAgLTcxLDE2ICs3MiwyMSBAQAogc3Rh
dGljIGludCBfX2FkZF90b19zd2FwX2NhY2hlKHN0cnVjdCBwYWdlICpwYWdlLCBzd3BfZW50cnlf
dCBlbnRyeSwKIAkJCSAgICAgICBnZnBfdCBnZnBfbWFzaykKIHsKLQlpbnQgZXJyb3I7CisJaW50
IGJ0cmVlX2Vycm9yOwogCiAJQlVHX09OKFBhZ2VTd2FwQ2FjaGUocGFnZSkpOwogCUJVR19PTihQ
YWdlUHJpdmF0ZShwYWdlKSk7Ci0JZXJyb3IgPSByYWRpeF90cmVlX3ByZWxvYWQoZ2ZwX21hc2sp
OwotCWlmICghZXJyb3IpIHsKKworICAgICAgICBidHJlZV9lcnJvciA9IGJ0cmVlX3ByZWxvYWQo
Z2ZwX21hc2spOworCQorCWlmICghYnRyZWVfZXJyb3IpIHsKIAkJd3JpdGVfbG9ja19pcnEoJnN3
YXBwZXJfc3BhY2UudHJlZV9sb2NrKTsKLQkJZXJyb3IgPSByYWRpeF90cmVlX2luc2VydCgmc3dh
cHBlcl9zcGFjZS5wYWdlX3RyZWUsCisgICAgICAgICAgICAgICAgaWYgKCFidHJlZV9lcnJvcikg
eworICAgICAgICAgICAgICAgICAgICAgICBidHJlZV9lcnJvciA9IGJ0cmVlX2luc2VydCgmc3dh
cHBlcl9zcGFjZS5idHJlZSwKIAkJCQkJCWVudHJ5LnZhbCwgcGFnZSk7Ci0JCWlmICghZXJyb3Ip
IHsKKyAgICAgICAgICAgICAgICB9CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIAorCQlpZiAoIWJ0cmVlX2Vycm9yKSB7CiAJCQlwYWdlX2NhY2hlX2dldChw
YWdlKTsKIAkJCVNldFBhZ2VMb2NrZWQocGFnZSk7CiAJCQlTZXRQYWdlU3dhcENhY2hlKHBhZ2Up
OwpAQCAtODksOSArOTUsMTIgQEAKIAkJCXBhZ2VjYWNoZV9hY2N0KDEpOwogCQl9CiAJCXdyaXRl
X3VubG9ja19pcnEoJnN3YXBwZXJfc3BhY2UudHJlZV9sb2NrKTsKLQkJcmFkaXhfdHJlZV9wcmVs
b2FkX2VuZCgpOworCisgICAgICAgICAgICAgICAgaWYgKCFidHJlZV9lcnJvcikgeworICAgICAg
ICAgICAgICAgICAgICAgICAgYnRyZWVfcHJlbG9hZF9lbmQoKTsKKyAgICAgICAgICAgICAgICB9
CiAJfQotCXJldHVybiBlcnJvcjsKKwlyZXR1cm4gYnRyZWVfZXJyb3I7CiB9CiAKIHN0YXRpYyBp
bnQgYWRkX3RvX3N3YXBfY2FjaGUoc3RydWN0IHBhZ2UgKnBhZ2UsIHN3cF9lbnRyeV90IGVudHJ5
KQpAQCAtMTI3LDcgKzEzNiwxMCBAQAogCUJVR19PTihQYWdlV3JpdGViYWNrKHBhZ2UpKTsKIAlC
VUdfT04oUGFnZVByaXZhdGUocGFnZSkpOwogCi0JcmFkaXhfdHJlZV9kZWxldGUoJnN3YXBwZXJf
c3BhY2UucGFnZV90cmVlLCBwYWdlX3ByaXZhdGUocGFnZSkpOworICAgICAgICBpZiAoYnRyZWVf
ZGVsZXRlKCZzd2FwcGVyX3NwYWNlLmJ0cmVlLHN3YXBwZXJfc3BhY2UuYnRyZWUucm9vdCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZV9wcml2YXRlKHBhZ2UpKS52YWwgIT0g
cGFnZSkgeworCQlwYW5pYygiREVCVUc6IERlbGV0aW5nIHdyb25nIHBhZ2UgZnJvbSBzd2FwIGNh
Y2hlXG4iKTsJCQkKKwl9CiAJc2V0X3BhZ2VfcHJpdmF0ZShwYWdlLCAwKTsKIAlDbGVhclBhZ2VT
d2FwQ2FjaGUocGFnZSk7CiAJdG90YWxfc3dhcGNhY2hlX3BhZ2VzLS07CmRpZmYgLXVyTiBsaW51
eC0yLjYuMTYuMi9tbS92bXNjYW4uYyBsaW51eC0yLjYuMTYuMi1idHJlZS9tbS92bXNjYW4uYwot
LS0gbGludXgtMi42LjE2LjIvbW0vdm1zY2FuLmMJMjAwNi0wNC0wNyAxMjo1Njo0Ny4wMDAwMDAw
MDAgLTA0MDAKKysrIGxpbnV4LTIuNi4xNi4yLWJ0cmVlL21tL3Ztc2Nhbi5jCTIwMDYtMDgtMTcg
MjE6MTE6MjEuMDAwMDAwMDAwIC0wNDAwCkBAIC02OTIsNyArNjkyLDcgQEAKIAkJCQlzdHJ1Y3Qg
cGFnZSAqcGFnZSwgaW50IG5yX3JlZnMpCiB7CiAJc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBp
bmcgPSBwYWdlX21hcHBpbmcocGFnZSk7Ci0Jc3RydWN0IHBhZ2UgKipyYWRpeF9wb2ludGVyOwor
CXN0cnVjdCBwYWdlICogYnRyZWVfcG9pbnRlcjsKIAogCS8qCiAJICogQXZvaWQgZG9pbmcgYW55
IG9mIHRoZSBmb2xsb3dpbmcgd29yayBpZiB0aGUgcGFnZSBjb3VudApAQCAtNzMzLDEyICs3MzMs
MTIgQEAKIAogCXdyaXRlX2xvY2tfaXJxKCZtYXBwaW5nLT50cmVlX2xvY2spOwogCi0JcmFkaXhf
cG9pbnRlciA9IChzdHJ1Y3QgcGFnZSAqKilyYWRpeF90cmVlX2xvb2t1cF9zbG90KAotCQkJCQkJ
Jm1hcHBpbmctPnBhZ2VfdHJlZSwKKwlidHJlZV9wb2ludGVyID0gKHN0cnVjdCBwYWdlICopYnRy
ZWVfbG9va3VwX3Nsb3QoCisJCQkJCQkmbWFwcGluZy0+YnRyZWUsCiAJCQkJCQlwYWdlX2luZGV4
KHBhZ2UpKTsKIAogCWlmICghcGFnZV9tYXBwaW5nKHBhZ2UpIHx8IHBhZ2VfY291bnQocGFnZSkg
IT0gbnJfcmVmcyB8fAotCQkJKnJhZGl4X3BvaW50ZXIgIT0gcGFnZSkgeworCQkJYnRyZWVfcG9p
bnRlciAhPSBwYWdlKSB7CiAJCXdyaXRlX3VubG9ja19pcnEoJm1hcHBpbmctPnRyZWVfbG9jayk7
CiAJCXJldHVybiAtRUFHQUlOOwogCX0KQEAgLTc1OSw3ICs3NTksNyBAQAogCQlzZXRfcGFnZV9w
cml2YXRlKG5ld3BhZ2UsIHBhZ2VfcHJpdmF0ZShwYWdlKSk7CiAJfQogCi0JKnJhZGl4X3BvaW50
ZXIgPSBuZXdwYWdlOworCWJ0cmVlX3BvaW50ZXIgPSBuZXdwYWdlOwogCV9fcHV0X3BhZ2UocGFn
ZSk7CiAJd3JpdGVfdW5sb2NrX2lycSgmbWFwcGluZy0+dHJlZV9sb2NrKTsKIApkaWZmIC11ck4g
bGludXgtMi42LjE2LjIvbGliL2J0cmVlLmMgbGludXgtMi42LjE2LjItYnRyZWUvbGliL2J0cmVl
LmMKLS0tIGxpbnV4LTIuNi4xNi4yL2xpYi9idHJlZS5jCTE5NjktMTItMzEgMTk6MDA6MDAuMDAw
MDAwMDAwIC0wNTAwCisrKyBsaW51eC0yLjYuMTYuMi1idHJlZS9saWIvYnRyZWUuYwkyMDA2LTA4
LTE3IDIxOjExOjM2LjAwMDAwMDAwMCAtMDQwMApAQCAtMCwwICsxLDEyOTEgQEAKKy8qCisgKiAg
YnRyZWUuYworICoKKyAqICBDb3B5cmlnaHQgKEMpIDIwMDYgVmlzaGFsIFBhdGlsICh2aXNocGF0
IEFUIGdtYWlsIERPVCBjb20pIAorICoKKyovCisKKyNpbmNsdWRlIDxsaW51eC9idHJlZS5oPgor
I2luY2x1ZGUgPGxpbnV4L2Vycm5vLmg+CisjaW5jbHVkZSA8bGludXgvaW5pdC5oPgorI2luY2x1
ZGUgPGxpbnV4L2tlcm5lbC5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUg
PGxpbnV4L3JhZGl4LXRyZWUuaD4KKyNpbmNsdWRlIDxsaW51eC9wZXJjcHUuaD4KKyNpbmNsdWRl
IDxsaW51eC9zbGFiLmg+CisjaW5jbHVkZSA8bGludXgvbm90aWZpZXIuaD4KKyNpbmNsdWRlIDxs
aW51eC9jcHUuaD4gIAorI2luY2x1ZGUgPGxpbnV4L2dmcC5oPgorI2luY2x1ZGUgPGxpbnV4L3N0
cmluZy5oPgorI2luY2x1ZGUgPGxpbnV4L2JpdG9wcy5oPgorI2luY2x1ZGUgPGxpbnV4L21tLmg+
CisKK3R5cGVkZWYgZW51bSB7bGVmdCA9IC0xLHJpZ2h0ID0gMX0gcG9zaXRpb25fdDsKKwordHlw
ZWRlZiBzdHJ1Y3QgeworCWJ0cmVlX25vZGUgKiBub2RlOworCXVuc2lnbmVkIGludCBpbmRleDsK
K31ub2RlX3BvczsKKworc3RydWN0IGJ0cmVlX25vZGUgeworCXN0cnVjdCBidHJlZV9ub2RlICog
bmV4dDsJCSAgICAgICAgLy8gUG9pbnRlciB1c2VkIGZvciBsaW5rZWQgbGlzdCAKKwlib29sIGxl
YWY7CQkJICAgICAgICAvLyBVc2VkIHRvIGluZGljYXRlIHdoZXRoZXIgbGVhZiBvciBub3QKKyAg
ICAgICAgdW5zaWduZWQgaW50IG5yX2FjdGl2ZTsJCSAgICAgICAgLy8gTnVtYmVyIG9mIGFjdGl2
ZSBrZXlzCisJdW5zaWduZWQgaW50IGxldmVsOwkJICAgICAgICAvLyBMZXZlbCBpbiB0aGUgQi1U
cmVlCisgICAgICAgIGJ0X2tleV92YWwga2V5X3ZhbHNbMipCVFJFRV9PUkRFUiAtIDFdOwkvLyBB
cnJheSBvZiBrZXlzIGFuZCB2YWx1ZXMKKyAgICAgICAgc3RydWN0IGJ0cmVlX25vZGUgKiBjaGls
ZHJlblsyKkJUUkVFX09SREVSXTsJLy8gQXJyYXkgb2YgcG9pbnRlcnMgdG8gY2hpbGQgbm9kZXMK
KyAgICAgICAgdW5zaWduZWQgbG9uZyB0YWdzW0JUUkVFX1RBR1NdW0JUUkVFX1RBR19MT05HU107
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBCaXRt
YXAgcmVxdWlyZWQgYnkgcGFnZQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgLy8gY2FjaGUKKwl1bnNpZ25lZCBsb25nIHBhZGRpbmdbNl07Cit9IDsKKwor
LyoKKyogICAgICAgQi1UcmVlIG5vZGUgYW5kIGtleSB2YWwgY2FjaGUKKyovCitzdGF0aWMga21l
bV9jYWNoZV90ICpidHJlZV9ub2RlX2NhY2hlcDsKKworLyoKKyAqIFBlci1jcHUgcG9vbCBvZiBw
cmVsb2FkZWQgbm9kZXMKKyAqLworc3RydWN0IGJ0cmVlX3ByZWxvYWQgeworICAgICAgICBpbnQg
bnI7CisgICAgICAgIHN0cnVjdCBidHJlZV9ub2RlICpub2Rlc1tCVFJFRV9NQVhfUEFUSF07Cit9
OworREVGSU5FX1BFUl9DUFUoc3RydWN0IGJ0cmVlX3ByZWxvYWQsIGJ0cmVlX3ByZWxvYWRzKSA9
IHsgMCwgfTsKKworc3RhdGljIGJ0cmVlX25vZGUgKiBhbGxvY2F0ZV9idHJlZV9ub2RlIChidHJl
ZSAqIGJ0cmVlLHVuc2lnbmVkIGludCBvcmRlcik7CitzdGF0aWMgbm9kZV9wb3MgZ2V0X2J0cmVl
X25vZGUoYnRyZWUgKiBidHJlZSx1bnNpZ25lZCBsb25nIGtleSk7CitzdGF0aWMgYnRfa2V5X3Zh
bCByZW1vdmVfa2V5X2Zyb21fbGVhZihidHJlZSAqIGJ0cmVlLCBub2RlX3BvcyAqIG5vZGVfcG9z
KTsKK3N0YXRpYyBidHJlZV9ub2RlICogbWVyZ2Vfbm9kZXMoYnRyZWUgKiBidHJlZSwgYnRyZWVf
bm9kZSAqIG4xLCBidF9rZXlfdmFsIGt2ICwKKyAgICAgICAgYnRyZWVfbm9kZSAqIG4yKTsKK3N0
YXRpYyB2b2lkIG1vdmVfa2V5KGJ0cmVlICogYnRyZWUsIGJ0cmVlX25vZGUgKiBub2RlLCB1bnNp
Z25lZCBpbnQgaW5kZXgsIAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHBvc2l0aW9uX3QgcG9zKTsKK3N0YXRpYyBub2RlX3BvcyBnZXRfbWF4X2tleV9wb3MoYnRyZWUg
KiBidHJlZSwgYnRyZWVfbm9kZSAqIHN1YnRyZWUpOworc3RhdGljIG5vZGVfcG9zIGdldF9taW5f
a2V5X3BvcyhidHJlZSAqIGJ0cmVlLCBidHJlZV9ub2RlICogc3VidHJlZSk7CitzdGF0aWMgYnRy
ZWVfbm9kZSAqIG1lcmdlX3NpYmxpbmdzKGJ0cmVlICogYnRyZWUsIGJ0cmVlX25vZGUgKiBwYXJl
bnQsCisgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IGluZGV4LHBvc2l0aW9uX3Qg
cG9zKTsKK3N0YXRpYyB1bnNpZ25lZCBpbnQgX19sb29rdXAoYnRyZWUgKiBidHJlZSwgdm9pZCAq
KiByZXN1bHRzLAorICAgICAgICB1bnNpZ25lZCBsb25nIGZpcnN0X2luZGV4LHVuc2lnbmVkIGlu
dCBtYXhfaXRlbXMsIGludCB0YWcpOworc3RhdGljIHZvaWQgcHJpbnRfc2luZ2xlX25vZGUoYnRy
ZWUgKmJ0cmVlLCBidHJlZV9ub2RlICogbm9kZSk7IAorc3RhdGljIHZvaWQgdHJhbnNmZXJfdGFn
cyhidHJlZV9ub2RlICogc291cmNlX25vZGUsIGludCBzb3VyY2VfaW5kZXgsCisgICAgICAgICAg
ICAgICAgYnRyZWVfbm9kZSAqIGRlc3Rfbm9kZSxpbnQgZGVzdF9pbmRleCk7CitzdGF0aWMgdm9p
ZCBjbGVhcl90YWdzKGJ0cmVlX25vZGUgKiBub2RlLCBpbnQgaW5kZXgpOworCitzdGF0aWMgdm9p
ZAorYnRyZWVfbm9kZV9jdG9yKHZvaWQgKm5vZGUsIGttZW1fY2FjaGVfdCAqY2FjaGVwLCB1bnNp
Z25lZCBsb25nIGZsYWdzKSB7CisgICAgICAgIG1lbXNldChub2RlLCAwLCBzaXplb2Yoc3RydWN0
IGJ0cmVlX25vZGUpKTsKK30KKwordm9pZCBfX2luaXQgYnRyZWVfaW5pdCh2b2lkKSB7CisgICAg
ICAgIGJ0cmVlX25vZGVfY2FjaGVwID0ga21lbV9jYWNoZV9jcmVhdGUoImJ0cmVlX25vZGUiLAor
ICAgICAgICAgICAgICAgIHNpemVvZihidHJlZV9ub2RlKSwgMCwKKyAgICAgICAgICAgICAgICBT
TEFCX1BBTklDLCBidHJlZV9ub2RlX2N0b3IsIE5VTEwpOworfQorCit1bnNpZ25lZCBsb25nIGJ0
cmVlX2tleV9mbiAodm9pZCAqIHBhZ2UpIHsKKyAgICAgICAgcmV0dXJuICgoKHN0cnVjdCBwYWdl
KilwYWdlKS0+aW5kZXgpOworfQorCit1bnNpZ25lZCBsb25nIGJ0cmVlX3ZhbHVlX2ZuICh1bnNp
Z25lZCBsb25nIGtleSkgeworICAgICAgICByZXR1cm4gKigodW5zaWduZWQgbG9uZyopa2V5KTsK
K30KKwordm9pZCBidHJlZV9wcmludF9mbiAodW5zaWduZWQgbG9uZyBrZXkpIHsKKyAgICAgICAg
cHJpbnRrKCIlbHUgIiwgKigodW5zaWduZWQgbG9uZyopa2V5KSk7Cit9CisKK3N0YXRpYyBpbmxp
bmUgdm9pZCB0YWdfc2V0KHN0cnVjdCBidHJlZV9ub2RlICpub2RlLCBpbnQgdGFnLCBpbnQgb2Zm
c2V0KQoreworICAgICAgICBfX3NldF9iaXQob2Zmc2V0LCBub2RlLT50YWdzW3RhZ10pOworfQor
CitzdGF0aWMgaW5saW5lIHZvaWQgdGFnX2NsZWFyKHN0cnVjdCBidHJlZV9ub2RlICpub2RlLCBp
bnQgdGFnLCBpbnQgb2Zmc2V0KQoreworICAgICAgICBfX2NsZWFyX2JpdChvZmZzZXQsIG5vZGUt
PnRhZ3NbdGFnXSk7Cit9CisKK3N0YXRpYyBpbmxpbmUgaW50IHRhZ19nZXQoc3RydWN0IGJ0cmVl
X25vZGUgKm5vZGUsIGludCB0YWcsIGludCBvZmZzZXQpCit7CisgICAgICAgIHJldHVybiB0ZXN0
X2JpdChvZmZzZXQsIG5vZGUtPnRhZ3NbdGFnXSk7Cit9CisKKy8qCisgKiBBIG1vZGlmaWVkIGZv
cm0gb2YgYmluYXJ5IHNlYXJjaCB0aGF0IHNlYXJjaGVzIGZvciBpbmRleCBwb3NpdGlvbiBvZiB0
aGUga2V5CisgKiBJbiBjYXNlIHRoZSBrZXkgaXMgbm90IGZvdW5kIHRoZSBpbmRleCBvZiB0aGUg
a2V5IGxlc3NlciB0aGFuIHRoZSBzZWFyY2gga2V5CisgKiBpcyByZXR1cm5lZAorICovCitzdGF0
aWMgaW5saW5lIGludCBzZWFyY2hfa2V5KGJ0cmVlX25vZGUgKiBub2RlLCBsb25nIGtleSkgewor
ICAgICAgaW50IGxlZnRfaW5kZXggPSAwOworICAgICAgaW50IHJpZ2h0X2luZGV4ID0gbm9kZS0+
bnJfYWN0aXZlIC0gMTsKKyAgICAgIGludCBtaWRfaW5kZXggPSAtMTsKKworICAgICAgaWYgKGtl
eSA+IG5vZGUtPmtleV92YWxzW3JpZ2h0X2luZGV4XS5rZXkpIHsKKyAgICAgICAgICAgICAgIHJl
dHVybiByaWdodF9pbmRleCArIDE7CisgICAgICB9CisKKyAgICAgIHdoaWxlIChsZWZ0X2luZGV4
IDw9IHJpZ2h0X2luZGV4KSB7CisgICAgICAgICAgICAgIG1pZF9pbmRleCA9IGxlZnRfaW5kZXgg
KyAocmlnaHRfaW5kZXggLSBsZWZ0X2luZGV4KS8yOworCisgICAgICAgICAgICAgIGlmIChrZXkg
PCBub2RlLT5rZXlfdmFsc1ttaWRfaW5kZXhdLmtleSkgeworICAgICAgICAgICAgICAgICAgICAg
IHJpZ2h0X2luZGV4ID0gbWlkX2luZGV4IC0gMTsKKyAgICAgICAgICAgICAgfSBlbHNlCisgICAg
ICAgICAgICAgIGlmIChrZXkgPiBub2RlLT5rZXlfdmFsc1ttaWRfaW5kZXhdLmtleSkgeworICAg
ICAgICAgICAgICAgICAgICAgIGxlZnRfaW5kZXggPSBtaWRfaW5kZXggKyAxOworICAgICAgICAg
ICAgICB9IGVsc2UgeworICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtaWRfaW5kZXg7Cisg
ICAgICAgICAgICAgIH0KKyAgICAgIH0KKyAgICAgIHJldHVybiByaWdodF9pbmRleCArIDE7Cit9
CisKKworCisvKgorICogTG9hZCB1cCB0aGlzIENQVSdzIGJ0cmVlX25vZGUgYnVmZmVyIHdpdGgg
c3VmZmljaWVudCBvYmplY3RzIHRvCisgKiBlbnN1cmUgdGhhdCB0aGUgYWRkaXRpb24gb2YgYSBz
aW5nbGUgZWxlbWVudCBpbiB0aGUgdHJlZSBjYW5ub3QgZmFpbC4gIE9uCisgKiBzdWNjZXNzLCBy
ZXR1cm4gemVybywgd2l0aCBwcmVlbXB0aW9uIGRpc2FibGVkLiAgT24gZXJyb3IsIHJldHVybiAt
RU5PTUVNCisgKiB3aXRoIHByZWVtcHRpb24gbm90IGRpc2FibGVkLgorICovCitpbnQgYnRyZWVf
cHJlbG9hZChnZnBfdCBnZnBfbWFzaykgeworICAgICAgICBzdHJ1Y3QgYnRyZWVfcHJlbG9hZCAq
YnRwOworICAgICAgICBzdHJ1Y3QgYnRyZWVfbm9kZSAqbm9kZTsKKyAgICAgICAgaW50IHJldCA9
IC1FTk9NRU07CisKKyAgICAgICAgcHJlZW1wdF9kaXNhYmxlKCk7CisgICAgICAgIGJ0cCA9ICZf
X2dldF9jcHVfdmFyKGJ0cmVlX3ByZWxvYWRzKTsKKyAgICAgICAgd2hpbGUgKGJ0cC0+bnIgPCBB
UlJBWV9TSVpFKGJ0cC0+bm9kZXMpKSB7CisgICAgICAgICAgICAgICAgcHJlZW1wdF9lbmFibGUo
KTsKKyAgICAgICAgICAgICAgICBub2RlID0ga21lbV9jYWNoZV9hbGxvYyhidHJlZV9ub2RlX2Nh
Y2hlcCwgZ2ZwX21hc2spOworICAgICAgICAgICAgICAgIGlmIChub2RlID09IE5VTEwpCisgICAg
ICAgICAgICAgICAgICAgICAgICBnb3RvIG91dDsKKyAgICAgICAgICAgICAgICBwcmVlbXB0X2Rp
c2FibGUoKTsKKyAgICAgICAgICAgICAgICBidHAgPSAmX19nZXRfY3B1X3ZhcihidHJlZV9wcmVs
b2Fkcyk7CisgICAgICAgICAgICAgICAgaWYgKGJ0cC0+bnIgPCBBUlJBWV9TSVpFKGJ0cC0+bm9k
ZXMpKQorICAgICAgICAgICAgICAgICAgICAgICAgYnRwLT5ub2Rlc1tidHAtPm5yKytdID0gbm9k
ZTsKKyAgICAgICAgICAgICAgICBlbHNlCisgICAgICAgICAgICAgICAgICAgICAgICBrbWVtX2Nh
Y2hlX2ZyZWUoYnRyZWVfbm9kZV9jYWNoZXAsIG5vZGUpOworICAgICAgICB9CisgICAgICAgIHJl
dCA9IDA7CitvdXQ6CisgICAgICAgIHJldHVybiByZXQ7Cit9CisKKy8qKgorKiAgICAgICBGdW5j
dGlvbiB1c2VkIHRvIGFsbG9jYXRlIG1lbW9yeSBmb3IgdGhlIGJ0cmVlIG5vZGUKKyogICAgICAg
QHBhcmFtIGJ0cmVlIFRoZSBidHJlZQorKiAgICAgICBAcGFyYW0gb3JkZXIgT3JkZXIgb2YgdGhl
IEItVHJlZQorKiAgICAgICBAcmV0dXJuIFRoZSBhbGxvY2F0ZWQgQi10cmVlIG5vZGUKKyovCitz
dGF0aWMgYnRyZWVfbm9kZSAqIGFsbG9jYXRlX2J0cmVlX25vZGUgKGJ0cmVlICogYnRyZWUsdW5z
aWduZWQgaW50IG9yZGVyKSB7CisgICAgICAgIGJ0cmVlX25vZGUgKiBub2RlOworCisgICAgICAg
IC8vIEFsbG9jYXRlIG1lbW9yeSBmb3IgdGhlIG5vZGUKKyAgICAgICAgbm9kZSA9IGttZW1fY2Fj
aGVfYWxsb2MoYnRyZWVfbm9kZV9jYWNoZXAsYnRyZWUtPmdmcF9tYXNrKTsKKworICAgICAgICAv
LyBJZiB0aGlzIGlzIE5VTEwgZ2V0IHByZWxvYWRlZCBub2RlCisgICAgICAgIGlmIChub2RlICA9
PSBOVUxMICYmICEoYnRyZWUtPmdmcF9tYXNrICYgX19HRlBfV0FJVCkpIHsKKyAgICAgICAgICAg
ICAgICBzdHJ1Y3QgYnRyZWVfcHJlbG9hZCAqYnRwOworCisgICAgICAgICAgICAgICAgYnRwID0g
Jl9fZ2V0X2NwdV92YXIoYnRyZWVfcHJlbG9hZHMpOworICAgICAgICAgICAgICAgIGlmIChidHAt
Pm5yKSB7CisgICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gYnRwLT5ub2Rlc1tidHAtPm5y
IC0gMV07CisgICAgICAgICAgICAgICAgICAgICAgICBidHAtPm5vZGVzW2J0cC0+bnIgLSAxXSA9
IE5VTEw7CisgICAgICAgICAgICAgICAgICAgICAgICBidHAtPm5yLS07CisgICAgICAgICAgICAg
ICAgfQorICAgICAgICB9CisgICAgICAgCisgICAgICAgIC8vIEluaXRpYWxpemUgdGhlIG51bWJl
ciBvZiBhY3RpdmUgbm9kZXMKKyAgICAgICAgbm9kZS0+bnJfYWN0aXZlID0gMDsKKworCS8vIFVz
ZSB0byBkZXRlcm1pbmUgd2hldGhlciBpdCBpcyBhIGxlYWYKKwlub2RlLT5sZWFmID0gdHJ1ZTsK
KworCS8vIFVzZSB0byBkZXRlcm1pbmUgdGhlIGxldmVsIGluIHRoZSB0cmVlCisJbm9kZS0+bGV2
ZWwgPSAwOworCisJLy9Jbml0aWFsaXplIHRoZSBsaW5rZWQgbGlzdCBwb2ludGVyIHRvIE5VTEwK
Kwlub2RlLT5uZXh0ID0gTlVMTDsKKworICAgICAgICByZXR1cm4gbm9kZTsKK30KKworLyoqCisq
ICAgICAgIEZ1bmN0aW9uIHVzZWQgdG8gZnJlZSB0aGUgbWVtb3J5IGFsbG9jYXRlZCB0byB0aGUg
Yi10cmVlIAorKiAgICAgICBAcGFyYW0gbm9kZSBUaGUgbm9kZSB0byBiZSBmcmVlZAorKiAgICAg
ICBAcGFyYW0gb3JkZXIgT3JkZXIgb2YgdGhlIEItVHJlZQorKiAgICAgICBAcmV0dXJuIFRoZSBh
bGxvY2F0ZWQgQi10cmVlIG5vZGUKKyovCitzdGF0aWMgaW50IGZyZWVfYnRyZWVfbm9kZSAoYnRy
ZWVfbm9kZSAqIG5vZGUpIHsKKyAgICAgICAga21lbV9jYWNoZV9mcmVlKGJ0cmVlX25vZGVfY2Fj
aGVwLG5vZGUpOworICAgICAgICByZXR1cm4gMDsKK30KKworLyoqCisqCVVzZWQgdG8gc3BsaXQg
dGhlIGNoaWxkIG5vZGUgYW5kIGFkanVzdCB0aGUgcGFyZW50IHNvIHRoYXQKKyoJaXQgaGFzIHR3
byBjaGlsZHJlbgorKglAcGFyYW0gcGFyZW50IFBhcmVudCBOb2RlCisqCUBwYXJhbSBpbmRleCBJ
bmRleCBvZiB0aGUgY2hpbGQgbm9kZQorKglAcGFyYW0gY2hpbGQgIEZ1bGwgY2hpbGQgbm9kZQor
KgkKKyovCitzdGF0aWMgdm9pZCBidHJlZV9zcGxpdF9jaGlsZChidHJlZSAqIGJ0cmVlLCBidHJl
ZV9ub2RlICogcGFyZW50LCAKKwkJCQl1bnNpZ25lZCBpbnQgaW5kZXgsCisJCQkJYnRyZWVfbm9k
ZSAqIGNoaWxkKSB7CisJaW50IGkgPSAwOwkKKwl1bnNpZ25lZCBpbnQgb3JkZXIgPSBidHJlZS0+
b3JkZXI7CisKKwlidHJlZV9ub2RlICogbmV3X2NoaWxkID0gYWxsb2NhdGVfYnRyZWVfbm9kZShi
dHJlZSxidHJlZS0+b3JkZXIpOyAKKwluZXdfY2hpbGQtPmxlYWYgPSBjaGlsZC0+bGVhZjsKKwlu
ZXdfY2hpbGQtPmxldmVsID0gY2hpbGQtPmxldmVsOworCW5ld19jaGlsZC0+bnJfYWN0aXZlID0g
YnRyZWUtPm9yZGVyIC0gMTsKKworCS8vIENvcHkgdGhlIGhpZ2hlciBvcmRlciBrZXlzIHRvIHRo
ZSBuZXcgY2hpbGQJCisJZm9yKGk9MDtpPG9yZGVyIC0gMTtpKyspIHsKKwkJbmV3X2NoaWxkLT5r
ZXlfdmFsc1tpXSA9IGNoaWxkLT5rZXlfdmFsc1tpICsgb3JkZXJdOworICAgICAgICAgICAgICAg
IHRyYW5zZmVyX3RhZ3MoY2hpbGQsaSArIG9yZGVyLG5ld19jaGlsZCxpKTsgCisgICAgICAgICAg
ICAgICAgCisgICAgICAgICAgICAgICAgaWYoIWNoaWxkLT5sZWFmKSB7CisJCQluZXdfY2hpbGQt
PmNoaWxkcmVuW2ldID0gCisJCQkJY2hpbGQtPmNoaWxkcmVuW2kgKyBvcmRlcl07CisJCX0gCisJ
fQorCQorCS8vIENvcHkgdGhlIGxhc3QgY2hpbGQgcG9pbnRlcgorCWlmKCFjaGlsZC0+bGVhZikg
eworCQluZXdfY2hpbGQtPmNoaWxkcmVuW2ldID0gCisJCWNoaWxkLT5jaGlsZHJlbltpICsgb3Jk
ZXJdOworCX0KKworCWNoaWxkLT5ucl9hY3RpdmUgPSBvcmRlciAtIDE7CisJCisJZm9yKGkgPSBw
YXJlbnQtPm5yX2FjdGl2ZSArIDE7aSA+IGluZGV4ICsgMTtpLS0pIHsKKwkJcGFyZW50LT5jaGls
ZHJlbltpXSA9IHBhcmVudC0+Y2hpbGRyZW5baSAtIDFdOworCX0KKwlwYXJlbnQtPmNoaWxkcmVu
W2luZGV4ICsgMV0gPSBuZXdfY2hpbGQ7CisKKwlmb3IoaSA9IHBhcmVudC0+bnJfYWN0aXZlO2kg
PiBpbmRleDtpLS0pIHsKKwkJcGFyZW50LT5rZXlfdmFsc1tpXSA9IHBhcmVudC0+a2V5X3ZhbHNb
aSAtIDFdOworICAgICAgICAgICAgICAgIHRyYW5zZmVyX3RhZ3MocGFyZW50LGkgLSAxLHBhcmVu
dCxpKTsgICAgICAgICAgICAgICAgCisJfQorCisJcGFyZW50LT5rZXlfdmFsc1tpbmRleF0gPSBj
aGlsZC0+a2V5X3ZhbHNbb3JkZXIgLSAxXTsJCisgICAgICAgIHRyYW5zZmVyX3RhZ3MoY2hpbGQs
b3JkZXIgLSAxLHBhcmVudCxpbmRleCk7CisJcGFyZW50LT5ucl9hY3RpdmUrKzsKKworfQorCisv
KioKKyoJVXNlZCB0byBpbnNlcnQgYSBrZXkgaW4gdGhlIG5vbi1mdWxsIG5vZGUKKyoJQHBhcmFt
IGJ0cmVlIFRoZSBidHJlZQorKglAcGFyYW0gbm9kZSBUaGUgbm9kZSB0byB3aGljaCB0aGUga2V5
IHdpbGwgYmUgYWRkZWQKKyoJQHBhcmFtIHRoZSBrZXkgdmFsdWUgcGFpcgorKglAcmV0dXJuIHZv
aWQKKyovCisKK3N0YXRpYyBpbnQgYnRyZWVfaW5zZXJ0X25vbmZ1bGwgKGJ0cmVlICogYnRyZWUs
IGJ0cmVlX25vZGUgKiBwYXJlbnRfbm9kZSwKKwkJCQlidF9rZXlfdmFsICoga2V5X3ZhbCkgewor
CQorCXVuc2lnbmVkIGxvbmcga2V5ID0ga2V5X3ZhbC0+a2V5OworCWludCBpLGosaW5kZXg7CisJ
YnRyZWVfbm9kZSAqIGNoaWxkOwkKKwlidHJlZV9ub2RlICogbm9kZSA9IHBhcmVudF9ub2RlOwor
CQoraW5zZXJ0OglpID0gbm9kZS0+bnJfYWN0aXZlIC0gMTsKKwlpZihub2RlLT5sZWFmKSB7CisJ
CXdoaWxlKGkgPj0gMCAmJiBrZXkgPCBub2RlLT5rZXlfdmFsc1tpXS5rZXkpIHsKKwkJCW5vZGUt
PmtleV92YWxzW2kgKyAxXSA9IG5vZGUtPmtleV92YWxzW2ldOworICAgICAgICAgICAgICAgICAg
ICAgICAgdHJhbnNmZXJfdGFncyhub2RlLGksbm9kZSxpICsgMSk7CisJCQlpLS07CisJCX0KKwor
CQlub2RlLT5rZXlfdmFsc1tpICsgMV0ua2V5ID0ga2V5OworICAgICAgICAgICAgICAgIG5vZGUt
PmtleV92YWxzW2kgKyAxXS52YWwgPSBrZXlfdmFsLT52YWw7CisKKwkJLy8gSWRlbnRpY2FsIGtl
eSBmb3VuZAorICAgICAgICAgIAlpZiAoaSA+PSAwICYmIAorCQkJa2V5ID09IG5vZGUtPmtleV92
YWxzW2ldLmtleSkgeworICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChqID0gaSArIDE7IGog
PG5vZGUtPm5yX2FjdGl2ZTsgaisrICkgeworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBub2RlLT5rZXlfdmFsc1tqXSA9CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbm9kZS0+a2V5X3ZhbHNbaiArIDFdOworCQkJCXRyYW5zZmVyX3RhZ3Mobm9kZSxqLG5v
ZGUsaiArIDEpOworICAgICAgICAgICAgICAgICAgICAgICAgfQorCQkJcmV0dXJuIC1FRVhJU1Q7
CisgICAgICAgICAgICAgICAgfSBlbHNlCisJCW5vZGUtPm5yX2FjdGl2ZSsrOyAKKwl9IGVsc2Ug
eworCQl3aGlsZSAoaSA+PSAwICYmIGtleSA8IG5vZGUtPmtleV92YWxzW2ldLmtleSkgeworCQkJ
aS0tOworCQl9CisKKyAgICAgICAgICAgICAgICAvLyBJZGVudGljYWwga2V5IGZvdW5kICAKKyAg
ICAgICAgICAgICAgICBpZiAoaSA+PSAwICYmIGtleSA9PSBub2RlLT5rZXlfdmFsc1tpXS5rZXkp
IHsKKyAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtRUVYSVNUOworICAgICAgICAgICAg
ICAgIH0KKworCQlpKys7CisJCWNoaWxkID0gbm9kZS0+Y2hpbGRyZW5baV07IAorCQkKKwkJaWYo
Y2hpbGQtPm5yX2FjdGl2ZSA9PSAyKmJ0cmVlLT5vcmRlciAtIDEpIHsKKworIAkJCS8vIENoZWNr
IGZvciBpZGVudGljYWwga2V5IGhlcmUKKwkJCWluZGV4ID0gc2VhcmNoX2tleShjaGlsZCwga2V5
KTsKKwkJCWlmIChrZXkgPT0gY2hpbGQtPmtleV92YWxzW2luZGV4XS5rZXkpIHsKKwkJCQlyZXR1
cm4gLUVFWElTVDsKKwkJCX0KKworCQkJYnRyZWVfc3BsaXRfY2hpbGQoYnRyZWUsbm9kZSxpLGNo
aWxkKTsKKwkJCWlmKGtleSA+IAorCQkJCW5vZGUtPmtleV92YWxzW2ldLmtleSkgeworCQkJCWkr
KzsJCisJCQl9CQorCQl9CisJCW5vZGUgPSBub2RlLT5jaGlsZHJlbltpXTsKKwkJZ290byBpbnNl
cnQ7CQorCX0KKyAgICAgICByZXR1cm4gMDsJCit9CisKKworLyoqCisqICAgICAgIEZ1bmN0aW9u
IHVzZWQgdG8gaW5zZXJ0IG5vZGUgaW50byBhIEItVHJlZQorKiAgICAgICBAcGFyYW0gcm9vdCBS
b290IG9mIHRoZSBCLVRyZWUKKyogICAgICAgQHBhcmFtIG5vZGUgVGhlIG5vZGUgdG8gYmUgaW5z
ZXJ0ZWQKKyogICAgICAgQHBhcmFtIGNvbXBhcmUgRnVuY3Rpb24gdXNlZCB0byBjb21wYXJlIHRo
ZSB0d28gbm9kZXMgb2YgdGhlIHRyZWUKKyogICAgICAgQHJldHVybiBzdWNjZXNzIG9yIGZhaWx1
cmUKKyovCitpbnQgYnRyZWVfaW5zZXJ0KGJ0cmVlICogYnRyZWUsIHVuc2lnbmVkIGxvbmcga2V5
LCB2b2lkICogdmFsKSB7CisJYnRyZWVfbm9kZSAqIHJub2RlID0gTlVMTDsKKyAgICAgICAgYnRf
a2V5X3ZhbCBrZXlfdmFsOworICAgICAgICBpbnQgcmV0ID0gLTE7CQorICAgICAgIAkKKyAgICAg
ICAga2V5X3ZhbC5rZXkgPSBrZXk7CisgICAgICAgIGtleV92YWwudmFsID0gdmFsOworCisgICAg
ICAgIC8vIER1cmluZyB0aGUgQi10cmVlIGluaXRpYWxpemF0aW9uCisgICAgICAgIGlmKHVubGlr
ZWx5KGJ0cmVlLT5yb290ID09IE5VTEwpKSB7CisgICAgICAgICAgICAgICAgYnRyZWUtPnJvb3Qg
PSBhbGxvY2F0ZV9idHJlZV9ub2RlKGJ0cmVlLGJ0cmVlLT5vcmRlcik7CisgICAgICAgIH0KKyAg
ICAgICAgcm5vZGUgPSBidHJlZS0+cm9vdDsKKworCWlmKHJub2RlLT5ucl9hY3RpdmUgPT0gKDIq
YnRyZWUtPm9yZGVyIC0gMSkpIHsKKwkJYnRyZWVfbm9kZSAqIG5ld19yb290OworCQluZXdfcm9v
dCA9IGFsbG9jYXRlX2J0cmVlX25vZGUoYnRyZWUsYnRyZWUtPm9yZGVyKTsKKwkJbmV3X3Jvb3Qt
PmxldmVsID0gYnRyZWUtPnJvb3QtPmxldmVsICsgMTsKKwkJYnRyZWUtPnJvb3QgPSBuZXdfcm9v
dDsJCisJCW5ld19yb290LT5sZWFmID0gZmFsc2U7CisJCW5ld19yb290LT5ucl9hY3RpdmUgPSAw
OworCQluZXdfcm9vdC0+Y2hpbGRyZW5bMF0gID0gcm5vZGU7CisJCWJ0cmVlX3NwbGl0X2NoaWxk
KGJ0cmVlLG5ld19yb290LDAscm5vZGUpOworCQlyZXQgPSBidHJlZV9pbnNlcnRfbm9uZnVsbChi
dHJlZSxuZXdfcm9vdCwma2V5X3ZhbCk7CQorCX0gZWxzZQorCQlyZXQgPSBidHJlZV9pbnNlcnRf
bm9uZnVsbChidHJlZSxybm9kZSwma2V5X3ZhbCk7CQkKKyAgICAgICAgcmV0dXJuIHJldDsKK30K
K0VYUE9SVF9TWU1CT0woYnRyZWVfaW5zZXJ0KTsgICAgICAgIAorCisvKioKKyoJVXNlZCB0byBn
ZXQgdGhlIHBvc2l0aW9uIG9mIHRoZSBNQVgga2V5IHdpdGhpbiB0aGUgc3VidHJlZQorKglAcGFy
YW0gYnRyZWUgVGhlIGJ0cmVlCisqCUBwYXJhbSBzdWJ0cmVlIFRoZSBzdWJ0cmVlIHRvIGJlIHNl
YXJjaGVkCisqCUByZXR1cm4gVGhlIG5vZGUgY29udGFpbmluZyB0aGUga2V5IGFuZCBwb3NpdGlv
biBvZiB0aGUga2V5CisqLworc3RhdGljIG5vZGVfcG9zIGdldF9tYXhfa2V5X3BvcyhidHJlZSAq
IGJ0cmVlLCBidHJlZV9ub2RlICogc3VidHJlZSkgeworCW5vZGVfcG9zIG5vZGVfcG9zOworCWJ0
cmVlX25vZGUgKiBub2RlID0gc3VidHJlZTsgCisJCisJbm9kZV9wb3Mubm9kZSA9IE5VTEw7CisJ
bm9kZV9wb3MuaW5kZXggPSAwOworCisJd2hpbGUodHJ1ZSkgeworCQlpZihub2RlID09IE5VTEwp
IHsKKwkJCWJyZWFrOworCQl9CisKKwkJaWYobm9kZS0+bGVhZikgeworCQkJbm9kZV9wb3Mubm9k
ZSAJPSBub2RlOworCQkJbm9kZV9wb3MuaW5kZXggCT0gbm9kZS0+bnJfYWN0aXZlIC0gMTsKKwkJ
CXJldHVybiBub2RlX3BvczsJCisJCX0gZWxzZSB7CisJCQlub2RlX3Bvcy5ub2RlIAk9IG5vZGU7
CisJCQlub2RlX3Bvcy5pbmRleCAJPSBub2RlLT5ucl9hY3RpdmUgLSAxOworCQkJbm9kZSA9IG5v
ZGUtPmNoaWxkcmVuW25vZGUtPm5yX2FjdGl2ZV07CQorCQl9CisJfQorCXJldHVybiBub2RlX3Bv
czsKK30KKworLyoqCisqCVVzZWQgdG8gZ2V0IHRoZSBwb3NpdGlvbiBvZiB0aGUgTUFYIGtleSB3
aXRoaW4gdGhlIHN1YnRyZWUKKyoJQHBhcmFtIGJ0cmVlIFRoZSBidHJlZQorKglAcGFyYW0gc3Vi
dHJlZSBUaGUgc3VidHJlZSB0byBiZSBzZWFyY2hlZAorKglAcmV0dXJuIFRoZSBub2RlIGNvbnRh
aW5pbmcgdGhlIGtleSBhbmQgcG9zaXRpb24gb2YgdGhlIGtleQorKi8KK3N0YXRpYyBub2RlX3Bv
cyBnZXRfbWluX2tleV9wb3MoYnRyZWUgKiBidHJlZSwgYnRyZWVfbm9kZSAqIHN1YnRyZWUpIHsK
Kwlub2RlX3BvcyBub2RlX3BvczsKKwlidHJlZV9ub2RlICogbm9kZSA9IHN1YnRyZWU7IAorCisJ
bm9kZV9wb3Mubm9kZSA9IE5VTEw7CisJbm9kZV9wb3MuaW5kZXggPSAwOworCisJd2hpbGUodHJ1
ZSkgeworCQlpZihub2RlID09IE5VTEwpIHsKKwkJCWJyZWFrOworCQl9CisKKwkJaWYobm9kZS0+
bGVhZikgeworCQkJbm9kZV9wb3Mubm9kZSAJPSBub2RlOworCQkJbm9kZV9wb3MuaW5kZXggCT0g
MDsKKwkJCXJldHVybiBub2RlX3BvczsJCisJCX0gZWxzZSB7CisJCQlub2RlX3Bvcy5ub2RlIAk9
IG5vZGU7CisJCQlub2RlX3Bvcy5pbmRleCAJPSAwOworCQkJbm9kZSA9IG5vZGUtPmNoaWxkcmVu
WzBdOwkKKwkJfQorCX0KKwlyZXR1cm4gbm9kZV9wb3M7Cit9CisKKy8qKgorKglNZXJnZSBub2Rl
cyBuMSBhbmQgbjIgKGNhc2UgM2IgZnJvbSBDb3JtZW4pCisqCUBwYXJhbSBidHJlZSBUaGUgYnRy
ZWUgCisqCUBwYXJhbSBub2RlIFRoZSBwYXJlbnQgbm9kZSAKKyoJQHBhcmFtIGluZGV4IG9mIHRo
ZSBjaGlsZAorKglAcGFyYW0gcG9zIGxlZnQgb3IgcmlnaHQKKyoJQHJldHVybiBub25lIAorKi8K
K3N0YXRpYyBidHJlZV9ub2RlICogbWVyZ2Vfc2libGluZ3MoYnRyZWUgKiBidHJlZSwgYnRyZWVf
bm9kZSAqIHBhcmVudCwgdW5zaWduZWQgaW50IGluZGV4ICwgCisJCQkJCXBvc2l0aW9uX3QgcG9z
KSB7CisJdW5zaWduZWQgaW50IGo7CisJYnRyZWVfbm9kZSAqIG5ld19ub2RlOworCWJ0cmVlX25v
ZGUgKiBuMSwgKiBuMjsKKyAgICAgICAgCisgICAgICAgIGlmIChpbmRleCA9PSAocGFyZW50LT5u
cl9hY3RpdmUpKSB7ICAgCisgICAgICAgICAgICAgICBpbmRleC0tOworCSAgICAgICBuMSA9IHBh
cmVudC0+Y2hpbGRyZW5bcGFyZW50LT5ucl9hY3RpdmUgLSAxXTsKKwkgICAgICAgbjIgPSBwYXJl
bnQtPmNoaWxkcmVuW3BhcmVudC0+bnJfYWN0aXZlXTsKKyAgICAgICAgfSBlbHNlIHsKKyAgICAg
ICAgICAgICAgIG4xID0gcGFyZW50LT5jaGlsZHJlbltpbmRleF07CisJICAgICAgIG4yID0gcGFy
ZW50LT5jaGlsZHJlbltpbmRleCArIDFdOworICAgICAgICB9CisKKwkvL01lcmdlIHRoZSBjdXJy
ZW50IG5vZGUgd2l0aCB0aGUgbGVmdCBub2RlCisJbmV3X25vZGUgPSBhbGxvY2F0ZV9idHJlZV9u
b2RlKGJ0cmVlLGJ0cmVlLT5vcmRlcik7CisJbmV3X25vZGUtPmxldmVsID0gbjEtPmxldmVsOwor
CW5ld19ub2RlLT5sZWFmID0gbjEtPmxlYWY7CisKKwlmb3Ioaj0wO2o8YnRyZWUtPm9yZGVyIC0g
MTsgaisrKSB7CisJCW5ld19ub2RlLT5rZXlfdmFsc1tqXSA9CW4xLT5rZXlfdmFsc1tqXTsKKyAg
ICAgICAgICAgICAgICB0cmFuc2Zlcl90YWdzKG4xLGosbmV3X25vZGUsaik7CisJCW5ld19ub2Rl
LT5jaGlsZHJlbltqXSA9CW4xLT5jaGlsZHJlbltqXTsKKwl9CisJCisJbmV3X25vZGUtPmtleV92
YWxzW2J0cmVlLT5vcmRlciAtIDFdID0JcGFyZW50LT5rZXlfdmFsc1tpbmRleF07CisgICAgICAg
IHRyYW5zZmVyX3RhZ3MocGFyZW50LGluZGV4LG5ld19ub2RlLGJ0cmVlLT5vcmRlciAtIDEpOwor
CW5ld19ub2RlLT5jaGlsZHJlbltidHJlZS0+b3JkZXIgLSAxXSA9CW4xLT5jaGlsZHJlbltidHJl
ZS0+b3JkZXIgLSAxXTsKKworCWZvcihqPTA7ajxidHJlZS0+b3JkZXIgLSAxOyBqKyspIHsKKwkJ
bmV3X25vZGUtPmtleV92YWxzW2ogKyBidHJlZS0+b3JkZXJdID0gCW4yLT5rZXlfdmFsc1tqXTsK
KyAgICAgICAgICAgICAgICB0cmFuc2Zlcl90YWdzKG4yLGosbmV3X25vZGUsaiArIGJ0cmVlLT5v
cmRlcik7CisJCW5ld19ub2RlLT5jaGlsZHJlbltqICsgYnRyZWUtPm9yZGVyXSA9IAluMi0+Y2hp
bGRyZW5bal07CisJfQorCW5ld19ub2RlLT5jaGlsZHJlblsyKmJ0cmVlLT5vcmRlciAtIDFdID0g
bjItPmNoaWxkcmVuW2J0cmVlLT5vcmRlciAtIDFdOworCisJcGFyZW50LT5jaGlsZHJlbltpbmRl
eF0gPSBuZXdfbm9kZTsKKworCWZvcihqID0gaW5kZXg7ajxwYXJlbnQtPm5yX2FjdGl2ZTtqKysp
IHsKKwkJcGFyZW50LT5rZXlfdmFsc1tqXSA9IHBhcmVudC0+a2V5X3ZhbHNbaiArIDFdOworICAg
ICAgICAgICAgICAgIHRyYW5zZmVyX3RhZ3MocGFyZW50LGogKyAxLHBhcmVudCxqKTsKKwkJcGFy
ZW50LT5jaGlsZHJlbltqICsgMV0gPSBwYXJlbnQtPmNoaWxkcmVuW2ogKyAyXTsKKwl9CisKKwlu
ZXdfbm9kZS0+bnJfYWN0aXZlID0gbjEtPm5yX2FjdGl2ZSArIG4yLT5ucl9hY3RpdmUgKyAxOwor
CXBhcmVudC0+bnJfYWN0aXZlLS07CisKKwlmcmVlX2J0cmVlX25vZGUobjEpOworCWZyZWVfYnRy
ZWVfbm9kZShuMik7CisKKwlpZiAocGFyZW50LT5ucl9hY3RpdmUgPT0gMCAmJiBidHJlZS0+cm9v
dCA9PSBwYXJlbnQpIHsKKwkJZnJlZV9idHJlZV9ub2RlKHBhcmVudCk7CisJCWJ0cmVlLT5yb290
ID0gbmV3X25vZGU7CisJCWlmKG5ld19ub2RlLT5sZXZlbCkKKwkJCW5ld19ub2RlLT5sZWFmID0g
ZmFsc2U7CisJCWVsc2UKKwkJCW5ld19ub2RlLT5sZWFmID0gdHJ1ZTsgCisJfQorCisJcmV0dXJu
IG5ld19ub2RlOworfQorCisvKioKKyoJTW92ZSB0aGUga2V5IGZyb20gbm9kZSB0byBhbm90aGVy
CQorKglAcGFyYW0gYnRyZWUgVGhlIEItVHJlZQorKglAcGFyYW0gbm9kZSBUaGUgcGFyZW50IG5v
ZGUKKyoJQHBhcmFtIGluZGV4IG9mIHRoZSBrZXkgdG8gYmUgbW92ZWQgZG9uZSAKKyoJQHBhcmFt
IHBvcyB0aGUgcG9zaXRpb24gb2YgdGhlIGNoaWxkIHRvIHJlY2VpdmUgdGhlIGtleSAKKyoJQHJl
dHVybiBub25lCisqLworc3RhdGljIHZvaWQgbW92ZV9rZXkoYnRyZWUgKiBidHJlZSwgYnRyZWVf
bm9kZSAqIG5vZGUsIHVuc2lnbmVkIGludCBpbmRleCwgcG9zaXRpb25fdCBwb3MpIHsKKwlidHJl
ZV9ub2RlICogbGNoaWxkOworCWJ0cmVlX25vZGUgKiByY2hpbGQ7CisJdW5zaWduZWQgaW50IGk7
CisKKwlpZihwb3MgPT0gcmlnaHQpIHsKKwkJaW5kZXgtLTsKKwl9CisJbGNoaWxkID0gbm9kZS0+
Y2hpbGRyZW5baW5kZXhdOworCXJjaGlsZCA9IG5vZGUtPmNoaWxkcmVuW2luZGV4ICsgMV07CisJ
CisJLy8gTW92ZSB0aGUga2V5IGZyb20gdGhlIHBhcmVudCB0byB0aGUgbGVmdCBjaGlsZAorCWlm
KHBvcyA9PSBsZWZ0KSB7CisJCWxjaGlsZC0+a2V5X3ZhbHNbbGNoaWxkLT5ucl9hY3RpdmVdID0g
bm9kZS0+a2V5X3ZhbHNbaW5kZXhdOworICAgICAgICAgICAgICAgIHRyYW5zZmVyX3RhZ3Mobm9k
ZSxpbmRleCxsY2hpbGQsbGNoaWxkLT5ucl9hY3RpdmUpOworCisJCWxjaGlsZC0+Y2hpbGRyZW5b
bGNoaWxkLT5ucl9hY3RpdmUgKyAxXSA9IHJjaGlsZC0+Y2hpbGRyZW5bMF07CisJCXJjaGlsZC0+
Y2hpbGRyZW5bMF0gPSBOVUxMOworCQlsY2hpbGQtPm5yX2FjdGl2ZSsrOworCisJCW5vZGUtPmtl
eV92YWxzW2luZGV4XSA9IHJjaGlsZC0+a2V5X3ZhbHNbMF07CisgICAgICAgICAgICAgICAgdHJh
bnNmZXJfdGFncyhyY2hpbGQsMCxub2RlLGluZGV4KTsKKyAgICAgICAgICAgICAgICAKKwkJZm9y
KGk9MDtpPHJjaGlsZC0+bnJfYWN0aXZlIC0gMTtpKyspIHsKKwkJCXJjaGlsZC0+a2V5X3ZhbHNb
aV0gPSByY2hpbGQtPmtleV92YWxzW2kgKyAxXTsKKyAgICAgICAgICAgICAgICAgICAgICAgIHRy
YW5zZmVyX3RhZ3MocmNoaWxkLGkgKyAxLHJjaGlsZCxpKTsKKwkJCXJjaGlsZC0+Y2hpbGRyZW5b
aV0gPSByY2hpbGQtPmNoaWxkcmVuW2kgKyAxXTsKKwkJfQorCQlyY2hpbGQtPmNoaWxkcmVuW3Jj
aGlsZC0+bnJfYWN0aXZlIC0gMV0gPSAKKwkJCQlyY2hpbGQtPmNoaWxkcmVuW3JjaGlsZC0+bnJf
YWN0aXZlXTsKKwkJcmNoaWxkLT5ucl9hY3RpdmUtLTsKKwl9IGVsc2UgeworCQkvLyBNb3ZlIHRo
ZSBrZXkgZnJvbSB0aGUgcGFyZW50IHRvIHRoZSByaWdodCBjaGlsZAorCQlmb3IoaT1yY2hpbGQt
Pm5yX2FjdGl2ZTtpID4gMCA7IGktLSkgeworCQkJcmNoaWxkLT5rZXlfdmFsc1tpXSA9IHJjaGls
ZC0+a2V5X3ZhbHNbaSAtIDFdOworICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmZXJfdGFn
cyhyY2hpbGQsaSAtIDEscmNoaWxkLGkpOworCQkJcmNoaWxkLT5jaGlsZHJlbltpICsgMV0gPSBy
Y2hpbGQtPmNoaWxkcmVuW2ldOwkJCisJCX0KKwkJcmNoaWxkLT5jaGlsZHJlblsxXSA9IHJjaGls
ZC0+Y2hpbGRyZW5bMF07CQkKKwkJcmNoaWxkLT5jaGlsZHJlblswXSA9IE5VTEw7CisKKwkJcmNo
aWxkLT5rZXlfdmFsc1swXSA9IG5vZGUtPmtleV92YWxzW2luZGV4XTsKKyAgICAgICAgICAgICAg
ICB0cmFuc2Zlcl90YWdzKG5vZGUsaW5kZXgscmNoaWxkLDApOworCisJCXJjaGlsZC0+Y2hpbGRy
ZW5bMF0gPSBsY2hpbGQtPmNoaWxkcmVuW2xjaGlsZC0+bnJfYWN0aXZlXTsJCisJCWxjaGlsZC0+
Y2hpbGRyZW5bbGNoaWxkLT5ucl9hY3RpdmVdID0gTlVMTDsKKworCQlub2RlLT5rZXlfdmFsc1tp
bmRleF0gPSBsY2hpbGQtPmtleV92YWxzW2xjaGlsZC0+bnJfYWN0aXZlIC0gMV07CisJCXRyYW5z
ZmVyX3RhZ3MobGNoaWxkLGxjaGlsZC0+bnJfYWN0aXZlIC0gMSxub2RlLGluZGV4KTsKKyAgICAg
ICAgICAgICAgICAKKwkJbGNoaWxkLT5ucl9hY3RpdmUtLTsKKwkJcmNoaWxkLT5ucl9hY3RpdmUr
KzsJCQorCX0JCQkJCit9CisKKy8qKgorKglNZXJnZSBub2RlcyBuMSBhbmQgbjIKKyoJQHBhcmFt
IG4xIEZpcnN0IG5vZGUKKyoJQHBhcmFtIG4yIFNlY29uZCBub2RlCisqCUByZXR1cm4gY29tYmlu
ZWQgbm9kZQorKi8KK3N0YXRpYyBidHJlZV9ub2RlICogbWVyZ2Vfbm9kZXMoYnRyZWUgKiBidHJl
ZSwgYnRyZWVfbm9kZSAqIG4xLCBidF9rZXlfdmFsIGt2LAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgYnRyZWVfbm9kZSAqIG4yKSB7CisJYnRyZWVfbm9k
ZSAqIG5ld19ub2RlOworCXVuc2lnbmVkIGludCBpOwkKKworCW5ld19ub2RlID0gYWxsb2NhdGVf
YnRyZWVfbm9kZShidHJlZSxidHJlZS0+b3JkZXIpOworCW5ld19ub2RlLT5sZWFmID0gdHJ1ZTsK
KwkKKwlmb3IoaT0wO2k8bjEtPm5yX2FjdGl2ZTtpKyspIHsKKwkJbmV3X25vZGUtPmtleV92YWxz
W2ldICAgPSBuMS0+a2V5X3ZhbHNbaV07CisgICAgICAgICAgICAgICAgdHJhbnNmZXJfdGFncyhu
MSxpLG5ld19ub2RlLGkpOworICAgICAgICAgICAgICAgIG5ld19ub2RlLT5jaGlsZHJlbltpXSAg
ID0gbjEtPmNoaWxkcmVuW2ldOworCX0KKyAgICAgICAgbmV3X25vZGUtPmNoaWxkcmVuW24xLT5u
cl9hY3RpdmVdID0gbjEtPmNoaWxkcmVuW24xLT5ucl9hY3RpdmVdOworICAgICAgICBuZXdfbm9k
ZS0+a2V5X3ZhbHNbbjEtPm5yX2FjdGl2ZV0gPSBrdjsKKworCWZvcihpPTA7aTxuMi0+bnJfYWN0
aXZlO2krKykgeworCQluZXdfbm9kZS0+a2V5X3ZhbHNbaSArIG4xLT5ucl9hY3RpdmUgKyAxXSA9
IG4yLT5rZXlfdmFsc1tpXTsKKyAgICAgICAgICAgICAgICB0cmFuc2Zlcl90YWdzKG4yLGksbmV3
X25vZGUsaSArIG4xLT5ucl9hY3RpdmUgKyAxKTsKKyAgICAgICAgICAgICAgICBuZXdfbm9kZS0+
Y2hpbGRyZW5baSArIG4xLT5ucl9hY3RpdmUgKyAxXSA9IG4yLT5jaGlsZHJlbltpXTsKKwl9Cisg
ICAgICAgIG5ld19ub2RlLT5jaGlsZHJlblsyKmJ0cmVlLT5vcmRlciAtIDFdID0gbjItPmNoaWxk
cmVuW24yLT5ucl9hY3RpdmVdOworCQorICAgICAgICBuZXdfbm9kZS0+bnJfYWN0aXZlID0gbjEt
Pm5yX2FjdGl2ZSArIG4yLT5ucl9hY3RpdmUgKyAxOworICAgICAgICBuZXdfbm9kZS0+bGVhZiA9
IG4xLT5sZWFmOworICAgICAgICBuZXdfbm9kZS0+bGV2ZWwgPSBuMS0+bGV2ZWw7CisKKwlmcmVl
X2J0cmVlX25vZGUobjEpOworCWZyZWVfYnRyZWVfbm9kZShuMik7CisKKwlyZXR1cm4gbmV3X25v
ZGU7Cit9CisKKy8qKgorKglVc2VkIHRvIHJlbW92ZSBhIGtleSBmcm9tIHRoZSBCLXRyZWUgbm9k
ZQorKglAcGFyYW0gYnRyZWUgVGhlIGJ0cmVlCisqCUBwYXJhbSBub2RlIFRoZSBub2RlIGZyb20g
d2hpY2ggdGhlIGtleSBpcyB0byBiZSByZW1vdmVkIAkKKyoJQHBhcmFtIGtleSBUaGUga2V5IHRv
IGJlIHJlbW92ZWQKKyoJQHJldHVybiAwIG9uIHN1Y2Nlc3MgLTEgb24gZXJyb3IgCisqLworCiti
dF9rZXlfdmFsIHJlbW92ZV9rZXlfZnJvbV9sZWFmKGJ0cmVlICogYnRyZWUsIG5vZGVfcG9zICog
bm9kZV9wb3MpIHsKKwl1bnNpZ25lZCBpbnQga2V5c19tYXggPSAyKmJ0cmVlLT5vcmRlciAtIDE7
CisJdW5zaWduZWQgaW50IGk7CisJYnRfa2V5X3ZhbCBrZXlfdmFsOworCWJ0cmVlX25vZGUgKiBu
b2RlID0gbm9kZV9wb3MtPm5vZGU7CisKKyAgICAgICAga2V5X3ZhbC5rZXkgPSAtMTsKKyAgICAg
ICAga2V5X3ZhbC52YWwgPSBOVUxMOworCisJaWYobm9kZS0+bGVhZiA9PSBmYWxzZSkgeworCQly
ZXR1cm4ga2V5X3ZhbDsKKwl9CQorCQorCWtleV92YWwgPSBub2RlLT5rZXlfdmFsc1tub2RlX3Bv
cy0+aW5kZXhdOworCisJZm9yKGk9bm9kZV9wb3MtPmluZGV4O2k8IGtleXNfbWF4IC0gMTtpKysp
IHsKKwkJbm9kZS0+a2V5X3ZhbHNbaV0gPSBub2RlLT5rZXlfdmFsc1tpICsgMV07CisgICAgICAg
ICAgICAgICAgdHJhbnNmZXJfdGFncyhub2RlLGkgKyAxLG5vZGUsaSk7CisJfQorCQorCW5vZGUt
Pm5yX2FjdGl2ZS0tOworCisJaWYobm9kZS0+bnJfYWN0aXZlID09IDAgKSB7CisgICAgICAgICAg
ICAgICAgaWYgKGJ0cmVlLT5yb290ID09IG5vZGUpIHsKKyAgICAgICAgICAgICAgICAgICAgICAg
IGJ0cmVlLT5yb290ID0gTlVMTDsKKyAgICAgICAgICAgICAgICB9CisJCWZyZWVfYnRyZWVfbm9k
ZShub2RlKTsKKwl9CisJcmV0dXJuIGtleV92YWw7Cit9CisKKy8qKgorKiAgICAgICBGdW5jdGlv
biB1c2VkIHRvIHJlbW92ZSBhIG5vZGUgZnJvbSBhICBCLVRyZWUKKyogICAgICAgQHBhcmFtIGJ0
cmVlIFRoZSBCLVRyZWUKKyogICAgICAgQHBhcmFtIGtleSBLZXkgb2YgdGhlIG5vZGUgdG8gYmUg
cmVtb3ZlZAorKiAgICAgICBAcGFyYW0gdmFsdWUgZnVuY3Rpb24gdG8gbWFwIHRoZSBrZXkgdG8g
YW4gdW5pcXVlIGludGVnZXIgdmFsdWUgICAgICAgIAorKiAgICAgICBAcGFyYW0gY29tcGFyZSBG
dW5jdGlvbiB1c2VkIHRvIGNvbXBhcmUgdGhlIHR3byBub2RlcyBvZiB0aGUgdHJlZQorKiAgICAg
ICBAcmV0dXJuIFRoZSByZW1vdmVkIGtleSB2YWx1ZSBwYWlyIAorKi8KKworYnRfa2V5X3ZhbCBi
dHJlZV9kZWxldGUoYnRyZWUgKiBidHJlZSxidHJlZV9ub2RlICogc3VidHJlZSx1bnNpZ25lZCBs
b25nIGtleSkgeworCXVuc2lnbmVkIGludCBpLGluZGV4OworCWJ0cmVlX25vZGUgKiBub2RlID0g
TlVMTCwgKiByc2libGluZywgKmxzaWJsaW5nOworCWJ0cmVlX25vZGUgKiBjb21iX25vZGUsICog
cGFyZW50OworCW5vZGVfcG9zIHN1Yl9ub2RlX3BvczsKKwlub2RlX3BvcyBub2RlX3BvczsKKwli
dF9rZXlfdmFsIGtleV92YWwsIHJlbW92ZWRfa3YsdG9fcmVtb3ZlX2t2OworCXVuc2lnbmVkIGxv
bmcga3YgPSBrZXk7CQorCisJbm9kZSA9IHN1YnRyZWU7CisJcGFyZW50ID0gTlVMTDsKKwlyZW1v
dmVkX2t2LmtleSA9IC0xOworCXJlbW92ZWRfa3YudmFsID0gTlVMTDsJCisKKwkvLyBFbXB0eSBz
dWJ0cmVlCisJaWYgKG5vZGUgPT0gTlVMTCkgeworCQlyZXR1cm4gcmVtb3ZlZF9rdjsKKwl9CisK
K2RlbF9sb29wOmZvciAoaSA9IDA7O2kgPSAwKSB7CisgICAgICAgICAgICAgCisgICAgICAgICAg
ICAvL0lmIHRoZXJlIGFyZSBubyBrZXlzIHNpbXBseSByZXR1cm4KKyAgICAgICAgICAgIGlmKCFu
b2RlLT5ucl9hY3RpdmUpCisgICAgICAgICAgICAgICAgcmV0dXJuIHJlbW92ZWRfa3Y7CisKKwkg
ICAgLy8gRml4IHRoZSBpbmRleCBvZiB0aGUga2V5IGdyZWF0ZXIgdGhhbiBvciBlcXVhbAorCSAg
ICAvLyB0byB0aGUga2V5IHRoYXQgd2Ugd291bGQgbGlrZSB0byBzZWFyY2gKKwkgICAgaSA9IHNl
YXJjaF9rZXkobm9kZSxrdik7CisJICAgIGluZGV4ID0gaTsKKworCSAgICAvLyBJZiB3ZSBmaW5k
IHN1Y2gga2V5IGJyZWFrCQkgICAgCisJICAgIGlmKGkgPCBub2RlLT5ucl9hY3RpdmUgJiYgCisJ
CQlrdiA9PSBub2RlLT5rZXlfdmFsc1tpXS5rZXkpIHsKKwkJCWJyZWFrOworCSAgICB9CisgICAg
ICAgICAgICBpZihub2RlLT5sZWFmKQorICAgICAgICAgICAgICAgIHJldHVybiByZW1vdmVkX2t2
OworICAgICAgICAgICAgICAgIAorICAgIAkgICAgLy9TdG9yZSB0aGUgcGFyZW50IG5vZGUKKwkg
ICAgcGFyZW50ID0gbm9kZTsKKworCSAgICAvLyBUbyBnZXQgYSBjaGlsZCBub2RlIAorCSAgICBu
b2RlID0gbm9kZS0+Y2hpbGRyZW5baV07CisKKyAgICAgICAgICAgIC8vSWYgTlVMTCBub3QgZm91
bmQKKyAgICAgICAgICAgIGlmIChub2RlID09IE5VTEwpCisgICAgICAgICAgICAgICAgcmV0dXJu
IHJlbW92ZWRfa3Y7CisKKyAgICAgICAgICAgIGlmIChpbmRleCA9PSAocGFyZW50LT5ucl9hY3Rp
dmUpKSB7ICAgCisgICAgICAgICAgICAgICAgbHNpYmxpbmcgPSAgcGFyZW50LT5jaGlsZHJlbltw
YXJlbnQtPm5yX2FjdGl2ZSAtIDFdOworCSAgICAJcnNpYmxpbmcgPSBOVUxMOyAKKyAgICAgICAg
ICAgIH0gZWxzZSBpZiAoaW5kZXggPT0gMCkgeworICAgICAgICAgICAgICAgIGxzaWJsaW5nID0g
TlVMTDsKKyAgICAgICAgICAgICAgICByc2libGluZyA9IHBhcmVudC0+Y2hpbGRyZW5bMV07Cisg
ICAgICAgICAgICB9IGVsc2UgeworICAgICAgICAJbHNpYmxpbmcgPSBwYXJlbnQtPmNoaWxkcmVu
W2kgLSAxXTsKKwkgICAgCXJzaWJsaW5nID0gcGFyZW50LT5jaGlsZHJlbltpICsgMV07CisgICAg
ICAgICAgICB9CisKKwkgICAgaWYgKG5vZGUtPm5yX2FjdGl2ZSA9PSBidHJlZS0+b3JkZXIgLSAx
ICYmIHBhcmVudCkgeworCQkvLyBUaGUgY3VycmVudCBub2RlIGhhcyAodCAtIDEpIGtleXMgYnV0
IHRoZSByaWdodCBzaWJsaW5nIGhhcyA+ICh0IC0gMSkKKwkJLy8ga2V5cworCQlpZiAocnNpYmxp
bmcgJiYgKHJzaWJsaW5nLT5ucl9hY3RpdmUgPiBidHJlZS0+b3JkZXIgLSAxKSkgeworCQkJbW92
ZV9rZXkoYnRyZWUscGFyZW50LGksbGVmdCk7CisJCX0gZWxzZQorCQkvLyBUaGUgY3VycmVudCBu
b2RlIGhhcyAodCAtIDEpIGtleXMgYnV0IHRoZSBsZWZ0IHNpYmxpbmcgaGFzICh0IC0gMSkKKwkJ
Ly8ga2V5cworCQlpZiAobHNpYmxpbmcgJiYgKGxzaWJsaW5nLT5ucl9hY3RpdmUgPiBidHJlZS0+
b3JkZXIgLSAxKSkgeworCQkJbW92ZV9rZXkoYnRyZWUscGFyZW50LGkscmlnaHQpOworCQl9IGVs
c2UKKwkJLy8gTGVmdCBzaWJsaW5nIGhhcyAodCAtIDEpIGtleXMKKwkgICAgICAgIGlmKGxzaWJs
aW5nICYmIChsc2libGluZy0+bnJfYWN0aXZlID09IGJ0cmVlLT5vcmRlciAtIDEpKSB7CisJCSAg
ICAgICAgbm9kZSA9IG1lcmdlX3NpYmxpbmdzKGJ0cmVlLHBhcmVudCxpLGxlZnQpOworCQl9IGVs
c2UKKyAgICAgICAgICAgICAgICAvLyBSaWdodCBzaWJsaW5nIGhhcyAodCAtIDEpIGtleXMKKwkg
ICAgICAgIGlmKHJzaWJsaW5nICYmIChyc2libGluZy0+bnJfYWN0aXZlID09IGJ0cmVlLT5vcmRl
ciAtIDEpKSB7CisJCSAgICAgICAgbm9kZSA9IG1lcmdlX3NpYmxpbmdzKGJ0cmVlLHBhcmVudCxp
LHJpZ2h0KTsKKwkJfQorCSAgICB9CisgICAgICAgIH0gICAgICAgICAgICAKKwkKKwkvL0Nhc2Ug
MSA6IFRoZSBub2RlIGNvbnRhaW5pbmcgdGhlIGtleSBpcyBmb3VuZCBhbmQgaXMgdGhlIGxlYWYg
bm9kZS4KKwkvL0Fsc28gdGhlIGxlYWYgbm9kZSBoYXMga2V5cyBncmVhdGVyIHRoYW4gdGhlIG1p
bmltdW0gcmVxdWlyZWQuCisJLy9TaW1wbHkgcmVtb3ZlIHRoZSBrZXkKKwlpZihub2RlLT5sZWFm
ICYmIChub2RlLT5ucl9hY3RpdmUgPiBidHJlZS0+b3JkZXIgLSAxKSkgeworCQlub2RlX3Bvcy5u
b2RlID0gbm9kZTsKKwkJbm9kZV9wb3MuaW5kZXggPSBpbmRleDsKKwkJcmV0dXJuIHJlbW92ZV9r
ZXlfZnJvbV9sZWFmKGJ0cmVlLCZub2RlX3Bvcyk7CisJfQorCisJLy9JZiB0aGUgbGVhZiBub2Rl
IGlzIHRoZSByb290IHBlcm1pdCBkZWxldGlvbiBldmVuIGlmIHRoZSBudW1iZXIgb2Yga2V5cyBp
cworCS8vbGVzcyB0aGFuICh0IC0gMSkKKwlpZihub2RlLT5sZWFmICYmIChub2RlID09IGJ0cmVl
LT5yb290KSkgeworCQlub2RlX3Bvcy5ub2RlID0gbm9kZTsKKwkJbm9kZV9wb3MuaW5kZXggPSBp
bmRleDsKKwkJcmV0dXJuIHJlbW92ZV9rZXlfZnJvbV9sZWFmKGJ0cmVlLCZub2RlX3Bvcyk7CisJ
fQorCisKKwkvL0Nhc2UgMjogVGhlIG5vZGUgY29udGFpbmluZyB0aGUga2V5IGlzIGZvdW5kIGFu
ZCBpcyBhbiBpbnRlcm5hbCBub2RlCisJaWYobm9kZS0+bGVhZiA9PSBmYWxzZSkgeworCQlpZihu
b2RlLT5jaGlsZHJlbltpbmRleF0tPm5yX2FjdGl2ZSA+IGJ0cmVlLT5vcmRlciAtIDEgKSB7CisJ
CQl0b19yZW1vdmVfa3YgPSBub2RlLT5rZXlfdmFsc1tpbmRleF07CisKKwkJCXN1Yl9ub2RlX3Bv
cyA9IAorCQkJCWdldF9tYXhfa2V5X3BvcyhidHJlZSxub2RlLT5jaGlsZHJlbltpbmRleF0pOwor
ICAgICAgICAgICAgICAgICAgICAgICAga2V5X3ZhbCA9IAorCQkJCXN1Yl9ub2RlX3Bvcy5ub2Rl
LT5rZXlfdmFsc1tzdWJfbm9kZV9wb3MuaW5kZXhdOworICAgICAgICAJCW5vZGUtPmtleV92YWxz
W2luZGV4XSA9IGtleV92YWw7CQorICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmZXJfdGFn
cyhub2RlLGluZGV4LHN1Yl9ub2RlX3Bvcy5ub2RlLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdWJfbm9kZV9wb3MuaW5kZXgpOworCisJCQlzdWJfbm9kZV9wb3Mubm9kZS0+a2V5
X3ZhbHNbc3ViX25vZGVfcG9zLmluZGV4XSA9IAorCQkJCXRvX3JlbW92ZV9rdjsKKyAgICAgICAg
ICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLT5jaGlsZHJlbltpbmRleF07CisgICAgICAgICAg
ICAgICAgICAgICAgICBnb3RvIGRlbF9sb29wOworICAgICAgICAgICAgICAgCisJCX0gZWxzZSBp
ZiAoKG5vZGUtPmNoaWxkcmVuW2luZGV4ICsgMV0tPm5yX2FjdGl2ZSA+IGJ0cmVlLT5vcmRlciAt
IDEpICkgeworCQkJdG9fcmVtb3ZlX2t2ID0gbm9kZS0+a2V5X3ZhbHNbaW5kZXhdOworCisJCQlz
dWJfbm9kZV9wb3MgPSAKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0X21pbl9r
ZXlfcG9zKGJ0cmVlLG5vZGUtPmNoaWxkcmVuW2luZGV4ICsgMV0pOworICAgICAgICAgICAgICAg
ICAgICAgICAga2V5X3ZhbCA9IHN1Yl9ub2RlX3Bvcy5ub2RlLT5rZXlfdmFsc1tzdWJfbm9kZV9w
b3MuaW5kZXhdOworICAgICAgICAJCW5vZGUtPmtleV92YWxzW2luZGV4XSA9IGtleV92YWw7CQor
ICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmZXJfdGFncyhub2RlLGluZGV4LHN1Yl9ub2Rl
X3Bvcy5ub2RlLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJfbm9kZV9wb3Mu
aW5kZXgpOworCisJCQlzdWJfbm9kZV9wb3Mubm9kZS0+a2V5X3ZhbHNbc3ViX25vZGVfcG9zLmlu
ZGV4XSA9IAorCQkJCXRvX3JlbW92ZV9rdjsKKworICAgICAgICAgICAgICAgICAgICAgICAgbm9k
ZSA9IG5vZGUtPmNoaWxkcmVuW2luZGV4ICsgMV07CisgICAgICAgICAgICAgICAgICAgICAgICBn
b3RvIGRlbF9sb29wOworICAgICAgICAgICAgICAKKwkJfSBlbHNlIGlmICggCisJCQlub2RlLT5j
aGlsZHJlbltpbmRleF0tPm5yX2FjdGl2ZSA9PSBidHJlZS0+b3JkZXIgLSAxICYmCisJCQlub2Rl
LT5jaGlsZHJlbltpbmRleCArIDFdLT5ucl9hY3RpdmUgPT0gYnRyZWUtPm9yZGVyIC0gMSkgewor
CisJCQljb21iX25vZGUgPSBtZXJnZV9ub2RlcyhidHJlZSxub2RlLT5jaGlsZHJlbltpbmRleF0s
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUtPmtleV92YWxzW2luZGV4XSwK
KwkJCQlub2RlLT5jaGlsZHJlbltpbmRleCArIDFdKTsKKwkJCW5vZGUtPmNoaWxkcmVuW2luZGV4
XSA9IGNvbWJfbm9kZTsKKwkJCQorCQkJZm9yKGk9aW5kZXggKyAxO2k8bm9kZS0+bnJfYWN0aXZl
O2krKykgeworCQkJCW5vZGUtPmNoaWxkcmVuW2ldID0gbm9kZS0+Y2hpbGRyZW5baSArIDFdOwor
CQkJCW5vZGUtPmtleV92YWxzW2kgLSAxXSA9IG5vZGUtPmtleV92YWxzW2ldOworICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zlcl90YWdzKG5vZGUsaSxub2RlLGkgLSAxKTsK
KwkJCX0KKwkJCW5vZGUtPm5yX2FjdGl2ZS0tOworICAgICAgICAgICAgICAgICAgICAgICAgaWYg
KG5vZGUtPm5yX2FjdGl2ZSA9PSAwICYmIGJ0cmVlLT5yb290ID09IG5vZGUpIHsKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgZnJlZV9idHJlZV9ub2RlKG5vZGUpOworICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBidHJlZS0+cm9vdCA9IGNvbWJfbm9kZTsgICAgICAgIAor
ICAgICAgICAgICAgICAgICAgICAgICAgfSAKKyAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUg
PSBjb21iX25vZGU7CisgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGRlbF9sb29wOworCQl9
CQkKKyAgICAgICAgICB9CisJCisJLy8gQ2FzZSAzOgorCS8vIEluIHRoaXMgY2FzZSBzdGFydCBm
cm9tIHRoZSB0b3Agb2YgdGhlIHRyZWUgYW5kIGNvbnRpbnVlCisJLy8gbW92aW5nIHRvIHRoZSBs
ZWFmIG5vZGUgbWFraW5nIHN1cmUgdGhhdCBlYWNoIG5vZGUgdGhhdAorCS8vIHdlIGVuY291bnRl
ciBvbiB0aGUgd2F5IGhhcyBhdGxlYXN0ICd0JyAob3JkZXIgb2YgdGhlIHRyZWUpCisJLy8ga2V5
cyAKKwlpZihub2RlLT5sZWFmICYmIChub2RlLT5ucl9hY3RpdmUgPiBidHJlZS0+b3JkZXIgLSAx
KSkgeworCSAgICAgIG5vZGVfcG9zLm5vZGUgPSBub2RlOworCSAgICAgIG5vZGVfcG9zLmluZGV4
ID0gaW5kZXg7CisJICAgICAgcmV0dXJuIHJlbW92ZV9rZXlfZnJvbV9sZWFmKGJ0cmVlLCZub2Rl
X3Bvcyk7CisJfQorCisgICAgICAgIHJldHVybiByZW1vdmVkX2t2OworfQorCisvKioKKyoJRnVu
Y3Rpb24gdXNlZCB0byBnZXQgdGhlIG5vZGUgY29udGFpbmluZyB0aGUgZ2l2ZW4ga2V5CisqCUBw
YXJhbSBidHJlZSBUaGUgYnRyZWUgdG8gYmUgc2VhcmNoZWQKKyoJQHBhcmFtIGtleSBUaGUgdGhl
IGtleSB0byBiZSBzZWFyY2hlZAorKglAcmV0dXJuIFRoZSBub2RlIGFuZCBwb3NpdGlvbiBvZiB0
aGUga2V5IHdpdGhpbiB0aGUgbm9kZSAKKyovCitub2RlX3BvcyAgZ2V0X2J0cmVlX25vZGUoYnRy
ZWUgKiBidHJlZSx1bnNpZ25lZCBsb25nIGtleSkgeworCW5vZGVfcG9zIGtwOworCXVuc2lnbmVk
IGxvbmcga2V5X3ZhbCA9IGtleTsJCisJYnRyZWVfbm9kZSAqIG5vZGU7CisJdW5zaWduZWQgaW50
IGkgPSAwOworCisJbm9kZSA9IGJ0cmVlLT5yb290OworCWtwLm5vZGUgPSBOVUxMOworCWtwLmlu
ZGV4ID0gMDsKKworCS8vIEVtcHR5IHRyZWUKKwlpZiAobm9kZSA9PSBOVUxMKSB7CisJCXJldHVy
biBrcDsKKwl9CQorCQorCWZvciAoOztpID0gMCkgewkKKworCSAgICAvLyBGaXggdGhlIGluZGV4
IG9mIHRoZSBrZXkgZ3JlYXRlciB0aGFuIG9yIGVxdWFsCisJICAgIC8vIHRvIHRoZSBrZXkgdGhh
dCB3ZSB3b3VsZCBsaWtlIHRvIHNlYXJjaAorCSAgICBpID0gc2VhcmNoX2tleShub2RlLGtleV92
YWwpOwkJCisJICAgIAorCSAgICAvLyBJZiB3ZSBmaW5kIHN1Y2gga2V5IHJldHVybiB0aGUga2V5
LXZhbHVlIHBhaXIJCSAgICAKKwkgICAgaWYoaSA8IG5vZGUtPm5yX2FjdGl2ZSAmJiAKKwkJCWtl
eV92YWwgPT0gbm9kZS0+a2V5X3ZhbHNbaV0ua2V5KSB7CisJCSAgICBrcC5ub2RlID0gbm9kZTsK
KwkJICAgIGtwLmluZGV4ID0gaTsJCisJCSAgICByZXR1cm4ga3A7CisJICAgIH0KKwkKKwkgICAg
Ly8gSWYgdGhlIG5vZGUgaXMgbGVhZiBhbmQgaWYgd2UgZGlkIG5vdCBmaW5kIHRoZSBrZXkgCisJ
ICAgIC8vIHJldHVybiBOVUxMCisJICAgIGlmKG5vZGUtPmxlYWYpIHsKKwkJICAgIHJldHVybiBr
cDsKKwkgICAgfQorCisJICAgIC8vIFRvIGdvdCBhIGNoaWxkIG5vZGUgCisJICAgIG5vZGUgPSBu
b2RlLT5jaGlsZHJlbltpXTsKKwl9CisgICAgICAJcmV0dXJuIGtwOworCit9CisKKy8qKgorKiAg
ICAgICBVc2VkIHRvIGRlc3RvcnkgYnRyZWUKKyogICAgICAgQHBhcmFtIGJ0cmVlIFRoZSBCLXRy
ZWUKKyogICAgICAgQHJldHVybiBub25lCisqLwordm9pZCBidHJlZV9kZXN0cm95KGJ0cmVlICog
YnRyZWUpIHsKKyAgICAgICBpbnQgaSA9IDA7CisgICAgICAgdW5zaWduZWQgaW50IGN1cnJlbnRf
bGV2ZWw7CisKKyAgICAgICBidHJlZV9ub2RlICogaGVhZCwgKiB0YWlsLCAqIG5vZGU7CisgICAg
ICAgYnRyZWVfbm9kZSAqIGNoaWxkLCAqIGRlbF9ub2RlOworCisgICAgICAgbm9kZSA9IGJ0cmVl
LT5yb290OworICAgICAgIGN1cnJlbnRfbGV2ZWwgPSBub2RlLT5sZXZlbDsKKyAgICAgICBoZWFk
ID0gbm9kZTsKKyAgICAgICB0YWlsID0gbm9kZTsKKworICAgICAgIHdoaWxlKHRydWUpIHsKKyAg
ICAgICAgICAgICAgIGlmKGhlYWQgPT0gTlVMTCkgeworICAgICAgICAgICAgICAgICAgICAgICBi
cmVhazsKKyAgICAgICAgICAgICAgIH0KKyAgICAgICAgICAgICAgIGlmIChoZWFkLT5sZXZlbCA8
IGN1cnJlbnRfbGV2ZWwpIHsKKyAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudF9sZXZlbCA9
IGhlYWQtPmxldmVsOworICAgICAgICAgICAgICAgfQorCisgICAgICAgICAgICAgICBpZihoZWFk
LT5sZWFmID09IGZhbHNlKSB7CisgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMCA7IGkg
PCBoZWFkLT5ucl9hY3RpdmUgKyAxOyBpKyspIHsKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBjaGlsZCA9IGhlYWQtPmNoaWxkcmVuW2ldOworICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHRhaWwtPm5leHQgPSBjaGlsZDsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB0YWlsID0gY2hpbGQ7CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQtPm5l
eHQgPSBOVUxMOworICAgICAgICAgICAgICAgICAgICAgICB9CisgICAgICAgICAgICAgICB9Cisg
ICAgICAgICAgICAgICBkZWxfbm9kZSA9IGhlYWQ7CisgICAgICAgICAgICAgICBoZWFkID0gaGVh
ZC0+bmV4dDsKKyAgICAgICAgICAgICAgIGZyZWVfYnRyZWVfbm9kZShkZWxfbm9kZSk7CisgICAg
ICAgfQorCit9CisKK2ludCBidHJlZV90YWdnZWQoYnRyZWUgKiBidHJlZSwgaW50IHRhZykgewor
ICAgICAgICBpbnQgaSA9IDA7CisgICAgICAgIGJ0cmVlX25vZGUgKiBoZWFkLCAqIHRhaWw7Cisg
ICAgICAgIGJ0cmVlX25vZGUgKiBjaGlsZDsKKworICAgICAgICBoZWFkID0gYnRyZWUtPnJvb3Q7
CisgICAgICAgIHRhaWwgPSBidHJlZS0+cm9vdDsKKworICAgICAgICB3aGlsZSh0cnVlKSB7Cisg
ICAgICAgICAgICAgICAgaWYoaGVhZCA9PSBOVUxMKSB7CisgICAgICAgICAgICAgICAgICAgICAg
ICBicmVhazsKKyAgICAgICAgICAgICAgICB9CisKKyAgICAgICAgICAgICAgICBmb3IgKGkgPSAw
OyBpIDwgaGVhZC0+bnJfYWN0aXZlOyBpKysgKSB7CisgICAgICAgICAgICAgICAgICAKKyAgICAg
ICAgICAgICAgICAgIGlmICh0YWcgIT0gLTEgJiYgdGFnX2dldChoZWFkLHRhZyxpKSkgCisgICAg
ICAgICAgICAgICAgICAgICByZXR1cm4gMTsKKyAgICAgICAgICAgICAgICAgIAorICAgICAgICAg
ICAgICAgIH0gICAgIAorCisgICAgICAgICAgICAgICAgaWYoaGVhZC0+bGVhZiA9PSBmYWxzZSkg
eworICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwIDsgaSA8IGhlYWQtPm5yX2FjdGl2
ZSArIDE7IGkrKykgeworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZCA9IGhl
YWQtPmNoaWxkcmVuW2ldOworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWlsLT5u
ZXh0ID0gY2hpbGQ7CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhaWwgPSBjaGls
ZDsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQtPm5leHQgPSBOVUxMOwor
ICAgICAgICAgICAgICAgICAgICAgICAgfQorICAgICAgICAgICAgICAgIH0KKyAgICAgICAgICAg
ICAgICBoZWFkID0gaGVhZC0+bmV4dDsKKyAgICAgICAgfQorICAgICAgICByZXR1cm4gMDsKK30K
K0VYUE9SVF9TWU1CT0woYnRyZWVfdGFnZ2VkKTsKKworLyoKKyAqIFJldHVybnMgMSBpZiBhbnkg
c2xvdCBpbiB0aGUgbm9kZSBoYXMgdGhpcyB0YWcgc2V0LgorICogT3RoZXJ3aXNlIHJldHVybnMg
MC4KKyAqLworc3RhdGljIGlubGluZSBpbnQgYW55X3RhZ19zZXQoc3RydWN0IGJ0cmVlX25vZGUg
Km5vZGUsIGludCB0YWcpCit7CisgICAgICAgIGludCBpZHg7CisgICAgICAgIGZvciAoaWR4ID0g
MDsgaWR4IDwgQlRSRUVfVEFHX0xPTkdTOyBpZHgrKykgeworICAgICAgICAgICAgICAgIGlmIChu
b2RlLT50YWdzW3RhZ11baWR4XSkKKyAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOwor
ICAgICAgICB9CisgICAgICAgIHJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBjbGVhcl90YWdz
KGJ0cmVlX25vZGUgKiBub2RlLCBpbnQgaW5kZXgpIHsKKwkgaW50IHRhZzsKKyAgICAgICAgZm9y
ICh0YWcgPSAwO3RhZzwgQlRSRUVfVEFHUzsgdGFnKyspIHsKKwkJdGFnX2NsZWFyKG5vZGUsdGFn
LGluZGV4KTsKKyAgICAgICAgfQorfQorCitzdGF0aWMgdm9pZCB0cmFuc2Zlcl90YWdzKGJ0cmVl
X25vZGUgKiBzb3VyY2Vfbm9kZSwgaW50IHNvdXJjZV9pbmRleCwKKyAgICAgICAgICAgICAgICBi
dHJlZV9ub2RlICogZGVzdF9ub2RlLGludCBkZXN0X2luZGV4KSB7CisKKyAgICAgICAgaW50IHRh
ZzsKKyAgICAgICAgZm9yICh0YWcgPSAwO3RhZzwgQlRSRUVfVEFHUzsgdGFnKyspIHsKKyAgICAg
ICAgICAgICAgICBpZiAodGFnX2dldChzb3VyY2Vfbm9kZSx0YWcsc291cmNlX2luZGV4KSkgewor
ICAgICAgICAgICAgICAgICAgICAgICAgdGFnX3NldChkZXN0X25vZGUsdGFnLGRlc3RfaW5kZXgp
OworICAgICAgICAgICAgICAgICAgICAgICAgdGFnX2NsZWFyKHNvdXJjZV9ub2RlLHRhZyxzb3Vy
Y2VfaW5kZXgpOworICAgICAgICAgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICAgICAgICAg
ICAgICB0YWdfY2xlYXIoZGVzdF9ub2RlLHRhZyxkZXN0X2luZGV4KTsKKyAgICAgICAgICAgICAg
ICB9CisgICAgICAgIH0KK30KKworc3RhdGljIHVuc2lnbmVkIGludCBfX2xvb2t1cChidHJlZSAq
IGJ0cmVlLCB2b2lkICoqIHJlc3VsdHMsCisgICAgICAgIHVuc2lnbmVkIGxvbmcgZmlyc3RfaW5k
ZXgsdW5zaWduZWQgaW50IG1heF9pdGVtcywgaW50IHRhZykgeworCisgICAgICAgIGludCBpID0g
MCwgaiA9IDA7CisgICAgICAgIGludCByZXQgPSAwOworICAgICAgICB1bnNpZ25lZCBsb25nIGtl
eTsKKyAgICAgICAgYnRyZWVfbm9kZSAqIGhlYWQsICogdGFpbDsKKyAgICAgICAgYnRyZWVfbm9k
ZSAqIGNoaWxkOworCisgICAgICAgIGhlYWQgPSBidHJlZS0+cm9vdDsKKyAgICAgICAgdGFpbCA9
IGJ0cmVlLT5yb290OworCisgICAgICAgIHdoaWxlKHRydWUpIHsKKyAgICAgICAgICAgICAgICBp
ZihoZWFkID09IE5VTEwpIHsKKyAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOworICAgICAg
ICAgICAgICAgIH0KKworICAgICAgICAgICAgICAgIGlmICgoaGVhZC0+a2V5X3ZhbHNbaGVhZC0+
bnJfYWN0aXZlIC0gMV0ua2V5IAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+PSBm
aXJzdF9pbmRleCkgJiYgKHJldCA8IG1heF9pdGVtcykpIHsKKyAgICAgICAgICAgICAgICAgICBm
b3IgKGkgPSAwOyBpIDwgaGVhZC0+bnJfYWN0aXZlOyBpKysgKSB7CisgICAgICAgICAgICAgICAg
ICAgICAKKyAgICAgICAgICAgICAgICAgICAgIGlmICh0YWcgIT0gLTEgJiYgIXRhZ19nZXQoaGVh
ZCx0YWcsaSkpIAorICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CisgICAgICAgICAg
ICAgICAgICAgICAKKyAgICAgICAgICAgICAgICAgICAgIGlmICgoa2V5ID0gaGVhZC0+a2V5X3Zh
bHNbaV0ua2V5KSAKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgID49IGZpcnN0X2luZGV4KSB7CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v
IEluc2VydGlvbiBzb3J0ICAgICAgICAgICAgICAgIAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBmb3IgKGogPSAocmV0IC0gMSk7aj49MDtqLS0pIHsKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKGJ0cmVlLT5rZXkocmVzdWx0c1tqXSkgPiBrZXkpIHsK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHNb
aiArIDFdID0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICByZXN1bHRzW2pdOyAgICAKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgfSBlbHNlIHsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGJyZWFrOworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0c1srK2pdID0gaGVh
ZC0+a2V5X3ZhbHNbaV0udmFsOyAKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0
Kys7CisKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmV0ID09IG1heF9pdGVt
cykgeworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOworICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CisgICAgICAgICAgICAgICAgICAgICB9ICAg
ICAgICAgICAKKyAgICAgICAgICAgICAgICAgICB9ICAgICAKKyAgICAgICAgICAgICAgICB9CisK
KyAgICAgICAgICAgICAgICBpZihoZWFkLT5sZWFmID09IGZhbHNlKSB7CisgICAgICAgICAgICAg
ICAgICAgICAgICBmb3IoaSA9IDAgOyBpIDwgaGVhZC0+bnJfYWN0aXZlICsgMTsgaSsrKSB7Cisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkID0gaGVhZC0+Y2hpbGRyZW5baV07
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhaWwtPm5leHQgPSBjaGlsZDsKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFpbCA9IGNoaWxkOworICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjaGlsZC0+bmV4dCA9IE5VTEw7CisgICAgICAgICAgICAgICAg
ICAgICAgICB9CisgICAgICAgICAgICAgICAgfQorICAgICAgICAgICAgICAgIGhlYWQgPSBoZWFk
LT5uZXh0OworICAgICAgICB9CisgICAgICAgIHJldHVybiByZXQ7Cit9CisKKy8qKgorKiAgICAg
ICBQZXJmb3JtIG11bHRpcGxlIGxvb2t1cCBvbiB0aGUgQi1UcmVlCisqICAgICAgIEBwYXJhbSBi
dHJlZSBUaGUgYnRyZWUKKyogICAgICAgQHBhcmFtIHJlc3VsdHMgd2hlcmUgdGhlIHJlc3VsdHMg
d2lsbCBiZSBwbGFjZWQKKyogICAgICAgQHBhcmFtIGZpcnN0X2luZGV4IHN0YXJ0IHRoZSBsb29r
dXAgZnJvbSB0aGlzIHRyZWUKKyogICAgICAgQHBhcmFtIG1heF9pdGVtcyBQbGFjZSB1cHRvIHRo
ZXNlIG1hbnkgaXRlbXMgaW4gcmVzdWx0cworKiAgICAgICBAcmV0dXJuIFRoZSBudW1iZXIgb2Yg
aXRlbXMgZm91bmQKKyovCit1bnNpZ25lZCBpbnQgYnRyZWVfZ2FuZ19sb29rdXAoYnRyZWUgKiBi
dHJlZSwgdm9pZCAqKiByZXN1bHRzLAorICAgICAgICB1bnNpZ25lZCBsb25nIGZpcnN0X2luZGV4
LHVuc2lnbmVkIGludCBtYXhfaXRlbXMpIHsKKyAgICAgICAgcmV0dXJuIF9fbG9va3VwKGJ0cmVl
LHJlc3VsdHMsZmlyc3RfaW5kZXgsbWF4X2l0ZW1zLCAtMSk7Cit9CisKKworRVhQT1JUX1NZTUJP
TChidHJlZV9nYW5nX2xvb2t1cCk7CisKKy8qKgorKiAgICAgICBQZXJmb3JtIG11bHRpcGxlIGxv
b2t1cCBvbiB0aGUgQi1UcmVlCisqICAgICAgIEBwYXJhbSBidHJlZSBUaGUgYnRyZWUKKyogICAg
ICAgQHBhcmFtIHJlc3VsdHMgd2hlcmUgdGhlIHJlc3VsdHMgd2lsbCBiZSBwbGFjZWQKKyogICAg
ICAgQHBhcmFtIGZpcnN0X2luZGV4IHN0YXJ0IHRoZSBsb29rdXAgZnJvbSB0aGlzIHRyZWUKKyog
ICAgICAgQHBhcmFtIG1heF9pdGVtcyBQbGFjZSB1cHRvIHRoZXNlIG1hbnkgaXRlbXMgaW4gcmVz
dWx0cworKiAgICAgICBAcmV0dXJuIFRoZSBudW1iZXIgb2YgaXRlbXMgZm91bmQKKyovCit1bnNp
Z25lZCBpbnQgYnRyZWVfZ2FuZ19sb29rdXBfdGFnKGJ0cmVlICogYnRyZWUsIHZvaWQgKiogcmVz
dWx0cywKKyAgICAgICAgdW5zaWduZWQgbG9uZyBmaXJzdF9pbmRleCx1bnNpZ25lZCBpbnQgbWF4
X2l0ZW1zLGludCB0YWcpIHsKKyAgICAgICAgcmV0dXJuIF9fbG9va3VwKGJ0cmVlLHJlc3VsdHMs
Zmlyc3RfaW5kZXgsbWF4X2l0ZW1zLCB0YWcpOworfQorCisKK0VYUE9SVF9TWU1CT0woYnRyZWVf
Z2FuZ19sb29rdXBfdGFnKTsKKworCisvKioKKyogICAgICAgRnVuY3Rpb24gdXNlZCB0byBzZWFy
Y2ggYSBub2RlIGluIGEgQi1UcmVlCisqICAgICAgIEBwYXJhbSBidHJlZSBUaGUgQi10cmVlIHRv
IGJlIHNlYXJjaGVkCisqICAgICAgIEBwYXJhbSBrZXkgS2V5IG9mIHRoZSBub2RlIHRvIGJlIHNl
YXJjaAorKiAgICAgICBAcmV0dXJuIFRoZSBrZXktdmFsdWUgcGFpcgorKi8KK3ZvaWQgKiBidHJl
ZV9sb29rdXAoYnRyZWUgKiBidHJlZSx1bnNpZ25lZCBsb25nIGtleSkgeworCisJYnRfa2V5X3Zh
bCBrZXlfdmFsOworCW5vZGVfcG9zIGtwOworCQorCWlmIChidHJlZS0+cm9vdCA9PSBOVUxMKSB7
CisJCXJldHVybiBOVUxMOworCX0KKworCWtwID0gZ2V0X2J0cmVlX25vZGUoYnRyZWUsa2V5KTsK
KwlrZXlfdmFsLnZhbCA9IE5VTEw7CisKKwlpZihrcC5ub2RlKSB7CisJCWtleV92YWwgPSBrcC5u
b2RlLT5rZXlfdmFsc1trcC5pbmRleF07CisJfSAKKwlyZXR1cm4ga2V5X3ZhbC52YWw7IAorfQor
RVhQT1JUX1NZTUJPTChidHJlZV9sb29rdXApOworCisvKioKKyogICAgICAgRnVuY3Rpb24gdXNl
ZCB0byBnZXQgdGhlIHNsb3QgaW4gYSBub2RlIG9mIGEgQi1UcmVlCisqICAgICAgIEBwYXJhbSBi
dHJlZSBUaGUgQi10cmVlIHRvIGJlIHNlYXJjaGVkCisqICAgICAgIEBwYXJhbSBrZXkgS2V5IG9m
IHRoZSBub2RlIHRvIGJlIHNlYXJjaAorKiAgICAgICBAcmV0dXJuIFRoZSBrZXktdmFsdWUgcGFp
cgorKi8KK2J0X2tleV92YWwgKiBidHJlZV9sb29rdXBfc2xvdChidHJlZSAqIGJ0cmVlLHVuc2ln
bmVkIGxvbmcga2V5KSB7CisKKwlidF9rZXlfdmFsICoga2V5X3ZhbCA9IE5VTEw7CisJbm9kZV9w
b3Mga3A7CisKKwlpZiAoYnRyZWUtPnJvb3QgPT0gTlVMTCkgeworCQlyZXR1cm4gTlVMTDsKKwl9
CisKKwlrcCA9IGdldF9idHJlZV9ub2RlKGJ0cmVlLGtleSk7CisKKwlpZihrcC5ub2RlKSB7CisJ
CWtleV92YWwgPSAma3Aubm9kZS0+a2V5X3ZhbHNba3AuaW5kZXhdOworCX0KKwlyZXR1cm4ga2V5
X3ZhbDsgCit9CitFWFBPUlRfU1lNQk9MKGJ0cmVlX2xvb2t1cF9zbG90KTsKKworLyoqCisqICAg
ICAgIFVzZWQgdG8gc2V0IHRoZSB0YWcgZm9yIGEgbm9kZQorKiAgICAgICBAcGFyYW0gYnRyZWUg
VGhlIGJ0cmVlCisqICAgICAgIEBwYXJhbSBrZXkgVGhlIGtleSBvZiB0aGUgcGFnZSBmb3Igd2hp
Y2ggdGhlIHRhZyBpcyB0byBiZSBzZXQKKyogICAgICAgQHBhcmFtIHRhZyBUaGUgdGFnIHRvIGJl
IHNldAorKiAgICAgICBAcmV0dXJuIFRoZSBidHJlZSBrZXkgYW5kIHZhbCBmb3Igd2hpY2ggdGhl
IHRhZyBpcyBzZXQgIAorKi8KKworYnRfa2V5X3ZhbCAqIGJ0cmVlX3RhZ19zZXQoYnRyZWUgKiBi
dHJlZSx1bnNpZ25lZCBsb25nIGtleSwgaW50IHRhZykgeworCWJ0X2tleV92YWwgKiBrZXlfdmFs
ID0gTlVMTDsKKwlub2RlX3BvcyBrcCA9IGdldF9idHJlZV9ub2RlKGJ0cmVlLGtleSk7CisKKwlp
ZihrcC5ub2RlKSB7CisJCWtleV92YWwgPSAma3Aubm9kZS0+a2V5X3ZhbHNba3AuaW5kZXhdOwor
ICAgICAgICAgICAgICAgIGlmKCF0YWdfZ2V0KGtwLm5vZGUsdGFnLGtwLmluZGV4KSkKKyAgICAg
ICAgICAgICAgICAgICAgICAgIHRhZ19zZXQoa3Aubm9kZSx0YWcsa3AuaW5kZXgpOworCX0KKyAg
ICAgICAgQlVHX09OKGtleV92YWwgPT0gTlVMTCk7CisJcmV0dXJuIGtleV92YWw7IAorfQorRVhQ
T1JUX1NZTUJPTChidHJlZV90YWdfc2V0KTsKKworLyoqCisqICAgICAgIFVzZWQgdG8gY2xlYXIg
dGhlIHRhZyBmb3IgYSBub2RlCisqICAgICAgIEBwYXJhbSBidHJlZSBUaGUgYnRyZWUKKyogICAg
ICAgQHBhcmFtIGtleSBUaGUga2V5IG9mIHRoZSBwYWdlIGZvciB3aGljaCB0aGUgdGFnIGlzIHRv
IGJlIHNldAorKiAgICAgICBAcGFyYW0gdGFnIFRoZSB0YWcgdG8gYmUgc2V0CisqICAgICAgIEBy
ZXR1cm4gVGhlIGJ0cmVlIGtleSBhbmQgdmFsIGZvciB3aGljaCB0aGUgdGFnIGlzIGNsZWFyZWQg
IAorKi8KKworYnRfa2V5X3ZhbCAqIGJ0cmVlX3RhZ19jbGVhcihidHJlZSAqIGJ0cmVlLHVuc2ln
bmVkIGxvbmcga2V5LCBpbnQgdGFnKSB7CisgICAgICAgICBidF9rZXlfdmFsICoga2V5X3ZhbCA9
IE5VTEw7CisJbm9kZV9wb3Mga3AgPSBnZXRfYnRyZWVfbm9kZShidHJlZSxrZXkpOworCisJaWYo
a3Aubm9kZSkgeworCQlrZXlfdmFsID0gJmtwLm5vZGUtPmtleV92YWxzW2twLmluZGV4XTsKKyAg
ICAgICAgICAgICAgICBpZih0YWdfZ2V0KGtwLm5vZGUsdGFnLGtwLmluZGV4KSkKKyAgICAgICAg
ICAgICAgICAgICAgICAgIHRhZ19jbGVhcihrcC5ub2RlLHRhZyxrcC5pbmRleCk7CisJfQorICAg
ICAgICBCVUdfT04oa2V5X3ZhbCA9PSBOVUxMKTsKKwlyZXR1cm4ga2V5X3ZhbDsgCit9CitFWFBP
UlRfU1lNQk9MKGJ0cmVlX3RhZ19jbGVhcik7CisKKy8qKgorKiAgICAgICBVc2VkIHRvIHZlcmlm
eSB3aGV0aGVyIGEgdGFnIGlzIHNldAorKiAgICAgICBAcGFyYW0gYnRyZWUgVGhlIGJ0cmVlCisq
ICAgICAgIEBwYXJhbSBrZXkgVGhlIGtleQorKiAgICAgICBAcGFyYW0gdGFnIFRoZSB0YWcKKyog
ICAgICAgQHJldHVybgorKiAgICAgICAwOiB0YWcgbm90IHByZXNlbnQKKyogICAgICAgMTogdGFn
IHByZXNlbnQsIHNldAorKiAgICAgICAtMTogdGFnIHByZXNlbnQsIHVuc2V0IAorKi8KK2ludCBi
dHJlZV90YWdfZ2V0KGJ0cmVlICogYnRyZWUsdW5zaWduZWQgbG9uZyBrZXksIGludCB0YWcpIHsK
KyAgICAgICAgaW50IHJldCA9IDA7CisgICAgICAgIGJ0X2tleV92YWwgKiBrZXlfdmFsID0gTlVM
TDsKKwlub2RlX3BvcyBrcCA9IGdldF9idHJlZV9ub2RlKGJ0cmVlLGtleSk7CisKKwlpZihrcC5u
b2RlKSB7CisJCWtleV92YWwgPSAma3Aubm9kZS0+a2V5X3ZhbHNba3AuaW5kZXhdOworICAgICAg
ICAgICAgICAgIHJldCA9IHRhZ19nZXQoa3Aubm9kZSx0YWcsa3AuaW5kZXgpOworICAgICAgICAg
ICAgICAgIHJldHVybiByZXQ/IDEgOiAtMTsKKwl9CisgICAgICAgIEJVR19PTihrZXlfdmFsID09
IE5VTEwpOworCXJldHVybiByZXQ7IAorfQorRVhQT1JUX1NZTUJPTChidHJlZV90YWdfZ2V0KTsK
KworCisvKioKKyoJR2V0IHRoZSBtYXgga2V5IGluIHRoZSBidHJlZQorKglAcGFyYW0gYnRyZWUg
VGhlIGJ0cmVlCisqCUByZXR1cm4gVGhlIG1heCBrZXkgCisqLwordW5zaWduZWQgbG9uZyBidHJl
ZV9nZXRfbWF4X2tleShidHJlZSAqIGJ0cmVlKSB7CisJbm9kZV9wb3Mgbm9kZV9wb3M7CisJbm9k
ZV9wb3MgPSBnZXRfbWF4X2tleV9wb3MoYnRyZWUsYnRyZWUtPnJvb3QpOworCXJldHVybiBub2Rl
X3Bvcy5ub2RlLT5rZXlfdmFsc1tub2RlX3Bvcy5pbmRleF0ua2V5OworfQorCisvKioKKyoJR2V0
IHRoZSBtaW4ga2V5IGluIHRoZSBidHJlZQorKglAcGFyYW0gYnRyZWUgVGhlIGJ0cmVlCisqCUBy
ZXR1cm4gVGhlIG1heCBrZXkgCisqLwordW5zaWduZWQgbG9uZyBidHJlZV9nZXRfbWluX2tleShi
dHJlZSAqIGJ0cmVlKSB7CisJbm9kZV9wb3Mgbm9kZV9wb3M7CisJbm9kZV9wb3MgPSBnZXRfbWlu
X2tleV9wb3MoYnRyZWUsYnRyZWUtPnJvb3QpOworCXJldHVybiBub2RlX3Bvcy5ub2RlLT5rZXlf
dmFsc1tub2RlX3Bvcy5pbmRleF0ua2V5OworfQorCisvKioKKyoJVXNlZCB0byBwcmludCB0aGUg
a2V5cyBvZiB0aGUgYnRyZWVfbm9kZQorKglAcGFyYW0gbm9kZSBUaGUgbm9kZSB3aG9zZSBrZXlz
IGFyZSB0byBiZSBwcmludGVkCisqCUByZXR1cm4gbm9uZQorKi8KKworc3RhdGljIHZvaWQgcHJp
bnRfc2luZ2xlX25vZGUoYnRyZWUgKmJ0cmVlLCBidHJlZV9ub2RlICogbm9kZSkgeworCQorCWlu
dCBpID0gMDsKKwkKKwlwcmludGsoIiB7ICIpOwkKKwl3aGlsZShpIDwgbm9kZS0+bnJfYWN0aXZl
KSB7CisJCXByaW50aygiJWQoMHgleCkgIiwgbm9kZS0+a2V5X3ZhbHNbaV0ua2V5LAorCQkJbm9k
ZS0+a2V5X3ZhbHNbaV0udmFsKTsKKwkJaSsrOworCX0KKwlwcmludGsoIn0gKDB4JXgsJWQsJWQp
ICIsIG5vZGUsbm9kZS0+bnJfYWN0aXZlLG5vZGUtPmxldmVsKTsJCit9CisKKy8qKgorKiAgICAg
ICBGdW5jdGlvbiB1c2VkIHRvIHByaW50IHRoZSBCLXRyZWUKKyogICAgICAgQHBhcmFtIHJvb3Qg
Um9vdCBvZiB0aGUgQi1UcmVlCisqICAgICAgIEBwYXJhbSBwcmludF9rZXkgRnVuY3Rpb24gdXNl
ZCB0byBwcmludCB0aGUga2V5IHZhbHVlCisqICAgICAgIEByZXR1cm4gbm9uZQorKi8KKwordm9p
ZCBwcmludF9zdWJ0cmVlKGJ0cmVlICpidHJlZSxidHJlZV9ub2RlICogbm9kZSkgeworCQorCWlu
dCBpID0gMDsKKwl1bnNpZ25lZCBpbnQgY3VycmVudF9sZXZlbDsKKworCWJ0cmVlX25vZGUgKiBo
ZWFkLCAqIHRhaWw7CisKKwljdXJyZW50X2xldmVsID0gbm9kZS0+bGV2ZWw7CisJaGVhZCA9IG5v
ZGU7CisJdGFpbCA9IG5vZGU7CisJCisJcHJpbnRrKCJERUJVRzogUHJpbnRpbmcgc3VidHJlZVxu
Iik7CisJd2hpbGUodHJ1ZSkgeworCQlpZihoZWFkID09IE5VTEwpIHsKKwkJCWJyZWFrOworCQl9
CisJCWlmIChoZWFkLT5sZXZlbCA8IGN1cnJlbnRfbGV2ZWwpIHsKKwkJCWN1cnJlbnRfbGV2ZWwg
PSBoZWFkLT5sZXZlbDsKKwkJCXByaW50aygiXG4iKTsKKwkJfQorCQlwcmludF9zaW5nbGVfbm9k
ZShidHJlZSxoZWFkKTsKKworCQlpZihoZWFkLT5sZWFmID09IGZhbHNlKSB7CQorCQkJZm9yKGkg
PSAwIDsgaSA8IGhlYWQtPm5yX2FjdGl2ZSArIDE7IGkrKykgeworCQkJCXRhaWwtPm5leHQgPSBo
ZWFkLT5jaGlsZHJlbltpXTsKKwkJCQl0YWlsID0gaGVhZC0+Y2hpbGRyZW5baV07CisJCQkJaGVh
ZC0+Y2hpbGRyZW5baV0tPm5leHQgPSBOVUxMOworCQkJfQorCQl9CisJCWhlYWQgPSBoZWFkLT5u
ZXh0OwkKKwl9CisJcHJpbnRrKCJcbiIpOworfQorRVhQT1JUX1NZTUJPTChwcmludF9zdWJ0cmVl
KTsKKwpkaWZmIC11ck4gbGludXgtMi42LjE2LjIvbGliL01ha2VmaWxlIGxpbnV4LTIuNi4xNi4y
LWJ0cmVlL2xpYi9NYWtlZmlsZQotLS0gbGludXgtMi42LjE2LjIvbGliL01ha2VmaWxlCTIwMDYt
MDQtMDcgMTI6NTY6NDcuMDAwMDAwMDAwIC0wNDAwCisrKyBsaW51eC0yLjYuMTYuMi1idHJlZS9s
aWIvTWFrZWZpbGUJMjAwNi0wOC0xNyAyMToxMToyMS4wMDAwMDAwMDAgLTA0MDAKQEAgLTMsNyAr
Myw3IEBACiAjCiAKIGxpYi15IDo9IGVycm5vLm8gY3R5cGUubyBzdHJpbmcubyB2c3ByaW50Zi5v
IGNtZGxpbmUubyBcCi0JIGJ1c3Rfc3BpbmxvY2tzLm8gcmJ0cmVlLm8gcmFkaXgtdHJlZS5vIGR1
bXBfc3RhY2subyBcCisJIGJ1c3Rfc3BpbmxvY2tzLm8gcmJ0cmVlLm8gcmFkaXgtdHJlZS5vIGR1
bXBfc3RhY2subyBidHJlZS5vXAogCSBpZHIubyBkaXY2NC5vIGludF9zcXJ0Lm8gYml0bWFwLm8g
ZXh0YWJsZS5vIHByaW9fdHJlZS5vIFwKIAkgc2hhMS5vCiAKZGlmZiAtdXJOIGxpbnV4LTIuNi4x
Ni4yL2luaXQvbWFpbi5jIGxpbnV4LTIuNi4xNi4yLWJ0cmVlL2luaXQvbWFpbi5jCi0tLSBsaW51
eC0yLjYuMTYuMi9pbml0L21haW4uYwkyMDA2LTA0LTA3IDEyOjU2OjQ3LjAwMDAwMDAwMCAtMDQw
MAorKysgbGludXgtMi42LjE2LjItYnRyZWUvaW5pdC9tYWluLmMJMjAwNi0wOC0xNyAyMToxMToy
MS4wMDAwMDAwMDAgLTA0MDAKQEAgLTg0LDYgKzg0LDcgQEAKIGV4dGVybiB2b2lkIHBpZG1hcF9p
bml0KHZvaWQpOwogZXh0ZXJuIHZvaWQgcHJpb190cmVlX2luaXQodm9pZCk7CiBleHRlcm4gdm9p
ZCByYWRpeF90cmVlX2luaXQodm9pZCk7CitleHRlcm4gdm9pZCBidHJlZV9pbml0KHZvaWQpOwog
ZXh0ZXJuIHZvaWQgZnJlZV9pbml0bWVtKHZvaWQpOwogZXh0ZXJuIHZvaWQgcG9wdWxhdGVfcm9v
dGZzKHZvaWQpOwogZXh0ZXJuIHZvaWQgZHJpdmVyX2luaXQodm9pZCk7CkBAIC01MzAsNiArNTMx
LDcgQEAKIAlzZWN1cml0eV9pbml0KCk7CiAJdmZzX2NhY2hlc19pbml0KG51bV9waHlzcGFnZXMp
OwogCXJhZGl4X3RyZWVfaW5pdCgpOworICAgICAgICBidHJlZV9pbml0KCk7CiAJc2lnbmFsc19p
bml0KCk7CiAJLyogcm9vdGZzIHBvcHVsYXRpbmcgbWlnaHQgbmVlZCBwYWdlLXdyaXRlYmFjayAq
LwogCXBhZ2Vfd3JpdGViYWNrX2luaXQoKTsKZGlmZiAtdXJOIGxpbnV4LTIuNi4xNi4yL2ZzL2J1
ZmZlci5jIGxpbnV4LTIuNi4xNi4yLWJ0cmVlL2ZzL2J1ZmZlci5jCi0tLSBsaW51eC0yLjYuMTYu
Mi9mcy9idWZmZXIuYwkyMDA2LTA0LTA3IDEyOjU2OjQ3LjAwMDAwMDAwMCAtMDQwMAorKysgbGlu
dXgtMi42LjE2LjItYnRyZWUvZnMvYnVmZmVyLmMJMjAwNi0wOC0xNyAyMToxMToyMS4wMDAwMDAw
MDAgLTA0MDAKQEAgLTg1OSw5ICs4NTksMTYgQEAKIAkJaWYgKHBhZ2UtPm1hcHBpbmcpIHsJLyog
UmFjZSB3aXRoIHRydW5jYXRlPyAqLwogCQkJaWYgKG1hcHBpbmdfY2FwX2FjY291bnRfZGlydHko
bWFwcGluZykpCiAJCQkJaW5jX3BhZ2Vfc3RhdGUobnJfZGlydHkpOwotCQkJcmFkaXhfdHJlZV90
YWdfc2V0KCZtYXBwaW5nLT5wYWdlX3RyZWUsCisJCQlidHJlZV90YWdfc2V0KCZtYXBwaW5nLT5i
dHJlZSwKIAkJCQkJCXBhZ2VfaW5kZXgocGFnZSksCiAJCQkJCQlQQUdFQ0FDSEVfVEFHX0RJUlRZ
KTsKKworCQkJaWYgKGJ0cmVlX3RhZ19nZXQoJm1hcHBpbmctPmJ0cmVlLAorCQkJICBwYWdlX2lu
ZGV4KHBhZ2UpLFBBR0VDQUNIRV9UQUdfRElSVFkpICE9IDEpIHsKKwkJCQlwYW5pYygiX19zZXRf
cGFnZV9kaXJ0eV9idWZmZXJzIiAKKwkJCQkJIiBQcm9ibGVtIHNldHRpbmcgdGhlIHRhZ1xuIik7
CisJCQl9CQkJCQorCiAJCX0KIAkJd3JpdGVfdW5sb2NrX2lycSgmbWFwcGluZy0+dHJlZV9sb2Nr
KTsKIAkJX19tYXJrX2lub2RlX2RpcnR5KG1hcHBpbmctPmhvc3QsIElfRElSVFlfUEFHRVMpOwpk
aWZmIC11ck4gbGludXgtMi42LjE2LjIvZnMvaW5vZGUuYyBsaW51eC0yLjYuMTYuMi1idHJlZS9m
cy9pbm9kZS5jCi0tLSBsaW51eC0yLjYuMTYuMi9mcy9pbm9kZS5jCTIwMDYtMDQtMDcgMTI6NTY6
NDcuMDAwMDAwMDAwIC0wNDAwCisrKyBsaW51eC0yLjYuMTYuMi1idHJlZS9mcy9pbm9kZS5jCTIw
MDYtMDgtMTcgMjE6MTE6MjEuMDAwMDAwMDAwIC0wNDAwCkBAIC0xNiw2ICsxNiw3IEBACiAjaW5j
bHVkZSA8bGludXgvYmFja2luZy1kZXYuaD4KICNpbmNsdWRlIDxsaW51eC93YWl0Lmg+CiAjaW5j
bHVkZSA8bGludXgvaGFzaC5oPgorI2luY2x1ZGUgPGxpbnV4L2J0cmVlLmg+CiAjaW5jbHVkZSA8
bGludXgvc3dhcC5oPgogI2luY2x1ZGUgPGxpbnV4L3NlY3VyaXR5Lmg+CiAjaW5jbHVkZSA8bGlu
dXgvcGFnZW1hcC5oPgpAQCAtMTk2LDYgKzE5Nyw3IEBACiAJbXV0ZXhfaW5pdCgmaW5vZGUtPmlf
bXV0ZXgpOwogCWluaXRfcndzZW0oJmlub2RlLT5pX2FsbG9jX3NlbSk7CiAJSU5JVF9SQURJWF9U
UkVFKCZpbm9kZS0+aV9kYXRhLnBhZ2VfdHJlZSwgR0ZQX0FUT01JQyk7CisgICAgICAgIElOSVRf
QlRSRUUoJmlub2RlLT5pX2RhdGEuYnRyZWUsIEdGUF9BVE9NSUMpOwogCXJ3bG9ja19pbml0KCZp
bm9kZS0+aV9kYXRhLnRyZWVfbG9jayk7CiAJc3Bpbl9sb2NrX2luaXQoJmlub2RlLT5pX2RhdGEu
aV9tbWFwX2xvY2spOwogCUlOSVRfTElTVF9IRUFEKCZpbm9kZS0+aV9kYXRhLnByaXZhdGVfbGlz
dCk7CmRpZmYgLXVyTiBsaW51eC0yLjYuMTYuMi9pbmNsdWRlL2xpbnV4L2J0cmVlLmggbGludXgt
Mi42LjE2LjItYnRyZWUvaW5jbHVkZS9saW51eC9idHJlZS5oCi0tLSBsaW51eC0yLjYuMTYuMi9p
bmNsdWRlL2xpbnV4L2J0cmVlLmgJMTk2OS0xMi0zMSAxOTowMDowMC4wMDAwMDAwMDAgLTA1MDAK
KysrIGxpbnV4LTIuNi4xNi4yLWJ0cmVlL2luY2x1ZGUvbGludXgvYnRyZWUuaAkyMDA2LTA4LTE3
IDIxOjExOjIxLjAwMDAwMDAwMCAtMDQwMApAQCAtMCwwICsxLDg5IEBACisvKgorICogIGJ0cmVl
LmgKKyAqCisgKiAgQ29weXJpZ2h0IChDKSAyMDA2IFZpc2hhbCBQYXRpbCAodmlzaHBhdCBBVCBn
bWFpbCBET1QgY29tKSAKKyAqCisqLworCisjaWZuZGVmIF9CVFJFRV9IXworI2RlZmluZSBfQlRS
RUVfSF8KKworI2luY2x1ZGUgPGxpbnV4L3NjaGVkLmg+CisjaW5jbHVkZSA8bGludXgvcHJlZW1w
dC5oPgorI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisKKyNkZWZpbmUgQlRSRUVfT1JERVIgOCAK
KyNkZWZpbmUgQlRSRUVfVEFHUyAyCisjZGVmaW5lIEJUUkVFX1RBR19MT05HUyAgICBcCisgICAg
ICAgICgoQlRSRUVfT1JERVIgKyBCSVRTX1BFUl9MT05HIC0gMSkgLyBCSVRTX1BFUl9MT05HKQor
I2RlZmluZSBCVFJFRV9NQVhfUEFUSCA4CisKKwordHlwZWRlZiBlbnVtICB7ZmFsc2UsdHJ1ZX0g
Ym9vbDsKK3R5cGVkZWYgc3RydWN0IGJ0cmVlX25vZGUgYnRyZWVfbm9kZTsKKwordHlwZWRlZiBz
dHJ1Y3QgeworICAgICAgICB1bnNpZ25lZCBsb25nIGtleTsKKwl2b2lkICogdmFsOworfSBidF9r
ZXlfdmFsOworCisKK3R5cGVkZWYgc3RydWN0IGJ0cmVlIHsKKwl1bnNpZ25lZCBpbnQgb3JkZXI7
CQkJLy8gQi1UcmVlIG9yZGVyCisJYnRyZWVfbm9kZSAqIHJvb3Q7CQkgICAgICAgIC8vIFJvb3Qg
b2YgdGhlIEItVHJlZQorICAgICAgIAl1bnNpZ25lZCBsb25nICgqdmFsdWUpKHVuc2lnbmVkIGxv
bmcga2V5KTsJLy8gR2VuZXJhdGUgdWludCB2YWx1ZSBmb3IgdGhlIGtleQorICAgICAgICB1bnNp
Z25lZCBsb25nICgqa2V5KSh2b2lkICogZGF0YSk7ICAgICAgLy8gR2V0IHRoZSB2YWx1ZSBvZiB0
aGUga2V5IGZyb20KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIC8vIGZyb20gdGhlIGRhdGEKKwl2b2lkICgqcHJpbnRfa2V5KSh1bnNpZ25lZCBsb25nIGtl
eSk7CQkvLyBQcmludCB0aGUga2V5CisgICAgICAgIGdmcF90ICAgICAgICAgICAgICAgICAgIGdm
cF9tYXNrOworfSBidHJlZTsgCisKK2V4dGVybiBpbnQgYnRyZWVfaW5zZXJ0KGJ0cmVlICogYnRy
ZWUsIHVuc2lnbmVkIGxvbmcga2V5LCB2b2lkICogdmFsKTsKK2V4dGVybiBidF9rZXlfdmFsIGJ0
cmVlX2RlbGV0ZShidHJlZSAqIGJ0cmVlLGJ0cmVlX25vZGUgKiBzdWJ0cmVlLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25lZCBsb25nIGtleSk7CitleHRlcm4gdm9pZCAq
IGJ0cmVlX2xvb2t1cChidHJlZSAqIGJ0cmVlLCAgdW5zaWduZWQgbG9uZyBrZXkpOworZXh0ZXJu
IHVuc2lnbmVkIGludCBidHJlZV9nYW5nX2xvb2t1cChidHJlZSAqIGJ0cmVlLCB2b2lkICoqIHJl
c3VsdHMsCisgICAgICAgIHVuc2lnbmVkIGxvbmcgZmlyc3RfaW5kZXgsdW5zaWduZWQgaW50IG1h
eF9pdGVtcyk7CitleHRlcm4gdW5zaWduZWQgaW50IGJ0cmVlX2dhbmdfbG9va3VwX3RhZyhidHJl
ZSAqIGJ0cmVlLCB2b2lkICoqIHJlc3VsdHMsCisgICAgICAgIHVuc2lnbmVkIGxvbmcgZmlyc3Rf
aW5kZXgsdW5zaWduZWQgaW50IG1heF9pdGVtcyxpbnQgdGFnKTsKK2V4dGVybiBidF9rZXlfdmFs
ICogYnRyZWVfbG9va3VwX3Nsb3QoYnRyZWUgKiBidHJlZSwgdW5zaWduZWQgbG9uZyBrZXkpOwor
ZXh0ZXJuIGJ0X2tleV92YWwgKiBidHJlZV90YWdfc2V0KGJ0cmVlICogYnRyZWUsdW5zaWduZWQg
bG9uZyBrZXksIGludCB0YWcpOworZXh0ZXJuIGludCBidHJlZV90YWdfZ2V0KGJ0cmVlICogYnRy
ZWUsdW5zaWduZWQgbG9uZyBrZXksIGludCB0YWcpOworZXh0ZXJuIGJ0X2tleV92YWwgKiBidHJl
ZV90YWdfY2xlYXIoYnRyZWUgKiBidHJlZSx1bnNpZ25lZCBsb25nIGtleSwgaW50IHRhZyk7Citl
eHRlcm4gdm9pZCBidHJlZV9kZXN0cm95KGJ0cmVlICogYnRyZWUpOworZXh0ZXJuIHVuc2lnbmVk
IGxvbmcgYnRyZWVfZ2V0X21heF9rZXkoYnRyZWUgKiBidHJlZSk7CitleHRlcm4gdW5zaWduZWQg
bG9uZyBidHJlZV9nZXRfbWluX2tleShidHJlZSAqIGJ0cmVlKTsKK2V4dGVybiB1bnNpZ25lZCBs
b25nIGJ0cmVlX3ZhbHVlX2ZuKHVuc2lnbmVkIGxvbmcga2V5KTsKK2V4dGVybiB1bnNpZ25lZCBs
b25nIGJ0cmVlX2tleV9mbih2b2lkICogcGFnZSk7CitleHRlcm4gdm9pZCBidHJlZV9wcmludF9m
bih1bnNpZ25lZCBsb25nIGtleSk7CitleHRlcm4gaW50IGJ0cmVlX3ByZWxvYWQoZ2ZwX3QgZ2Zw
X21hc2spOworZXh0ZXJuIGludCBidHJlZV90YWdnZWQoYnRyZWUgKiBidHJlZSwgaW50IHRhZyk7
CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBidHJlZV9wcmVsb2FkX2VuZCh2b2lkKQoreworICAgICAg
ICBwcmVlbXB0X2VuYWJsZSgpOworfQorCisjZGVmaW5lIEJUUkVFX0lOSVQobWFzaykgeyBcCisg
ICAgICAgIC5vcmRlciAgICAgICAgICA9IEJUUkVFX09SREVSLCAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisgICAgICAgIC5yb290ICAgICAgICAgICA9IE5VTEwsICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgIC52YWx1ZSAgICAgICAgICA9IGJ0cmVlX3Zh
bHVlX2ZuLCAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgIC5rZXkgICAgICAgICAg
ICA9IGJ0cmVlX2tleV9mbiwgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgIC5w
cmludF9rZXkgICAgICA9IGJ0cmVlX3ByaW50X2ZuLCAgICAgICAgICAgICAgICAgICAgICAgICBc
CisgICAgICAgIC5nZnBfbWFzayAgICAgICA9IChtYXNrKSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCit9CisKKyNkZWZpbmUgSU5JVF9CVFJFRShidHJlZSxtYXNrKSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCitkbyB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgXAorICAgICAgICAoYnRyZWUpLT5vcmRlciA9IEJUUkVF
X09SREVSOyAgICAgICAgICAgICAgICAgICAgIFwKKyAgICAgICAgKGJ0cmVlKS0+cm9vdCA9IE5V
TEw7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisgICAgICAgIChidHJlZSktPnZhbHVl
ICAgICAgICAgICAgPSBidHJlZV92YWx1ZV9mbjsgICAgICAgXAorICAgICAgICAoYnRyZWUpLT5r
ZXkgICAgICAgICAgICAgID0gYnRyZWVfa2V5X2ZuOyAgICAgICAgIFwKKyAgICAgICAgKGJ0cmVl
KS0+cHJpbnRfa2V5ICAgICAgICA9IGJ0cmVlX3ByaW50X2ZuOyAgICAgICBcCisgICAgICAgIChi
dHJlZSktPmdmcF9tYXNrICAgICAgICAgPSAobWFzayk7ICAgICAgICAgICAgICAgXAorfSB3aGls
ZSAoMCkKKworCitleHRlcm4gdm9pZCBwcmludF9zdWJ0cmVlKGJ0cmVlICogYnRyZWUsYnRyZWVf
bm9kZSAqIG5vZGUpOworCisjZW5kaWYKZGlmZiAtdXJOIGxpbnV4LTIuNi4xNi4yL2luY2x1ZGUv
bGludXgvZnMuaCBsaW51eC0yLjYuMTYuMi1idHJlZS9pbmNsdWRlL2xpbnV4L2ZzLmgKLS0tIGxp
bnV4LTIuNi4xNi4yL2luY2x1ZGUvbGludXgvZnMuaAkyMDA2LTA0LTA3IDEyOjU2OjQ3LjAwMDAw
MDAwMCAtMDQwMAorKysgbGludXgtMi42LjE2LjItYnRyZWUvaW5jbHVkZS9saW51eC9mcy5oCTIw
MDYtMDgtMTcgMjE6MTE6MjEuMDAwMDAwMDAwIC0wNDAwCkBAIC0yMTQsNiArMjE0LDcgQEAKICNp
bmNsdWRlIDxsaW51eC9rb2JqZWN0Lmg+CiAjaW5jbHVkZSA8bGludXgvbGlzdC5oPgogI2luY2x1
ZGUgPGxpbnV4L3JhZGl4LXRyZWUuaD4KKyNpbmNsdWRlIDxsaW51eC9idHJlZS5oPgogI2luY2x1
ZGUgPGxpbnV4L3ByaW9fdHJlZS5oPgogI2luY2x1ZGUgPGxpbnV4L2luaXQuaD4KICNpbmNsdWRl
IDxsaW51eC9zY2hlZC5oPgpAQCAtMzcyLDYgKzM3Myw3IEBACiBzdHJ1Y3QgYWRkcmVzc19zcGFj
ZSB7CiAJc3RydWN0IGlub2RlCQkqaG9zdDsJCS8qIG93bmVyOiBpbm9kZSwgYmxvY2tfZGV2aWNl
ICovCiAJc3RydWN0IHJhZGl4X3RyZWVfcm9vdAlwYWdlX3RyZWU7CS8qIHJhZGl4IHRyZWUgb2Yg
YWxsIHBhZ2VzICovCisgICAgICAgIHN0cnVjdCBidHJlZSAgICAgICAgICAgIGJ0cmVlOyAgICAg
ICAgICAvKiBCVHJlZSBvZiBhbGwgcGFnZXMqLwogCXJ3bG9ja190CQl0cmVlX2xvY2s7CS8qIGFu
ZCByd2xvY2sgcHJvdGVjdGluZyBpdCAqLwogCXVuc2lnbmVkIGludAkJaV9tbWFwX3dyaXRhYmxl
Oy8qIGNvdW50IFZNX1NIQVJFRCBtYXBwaW5ncyAqLwogCXN0cnVjdCBwcmlvX3RyZWVfcm9vdAlp
X21tYXA7CQkvKiB0cmVlIG9mIHByaXZhdGUgYW5kIHNoYXJlZCBtYXBwaW5ncyAqLwo=
------=_Part_17202_32626162.1155865413814
Content-Type: text/plain; name=btree.txt; charset=ANSI_X3.4-1968
Content-Transfer-Encoding: base64
X-Attachment-Id: f_eqzw9zbk
Content-Disposition: attachment; filename="btree.txt"

ICAgICAgICAgICAgICAgICAgICBGaWxlICBCbGsgICBOdW0gICAgICAgICAgICAgICAgICAgQXZn
ICAgICAgTWF4aW11bSAgICAgIExhdCUgICAgIExhdCUgICAgQ1BVCklkZW50aWZpZXIgICAgICAg
ICAgU2l6ZSAgU2l6ZSAgVGhyICAgUmF0ZSAgKENQVSUpICBMYXRlbmN5ICAgIExhdGVuY3kgICAg
ICA+MnMgICAgICA+MTBzICAgIEVmZgotLS0tLS0tLS0tLS0tLS0tLS0tIC0tLS0tLSAtLS0tLSAt
LS0gIC0tLS0tLSAtLS0tLS0gLS0tLS0tLS0tIC0tLS0tLS0tLS0tICAtLS0tLS0tLSAtLS0tLS0t
LSAtLS0tLQpTZXF1ZW50aWFsIFJlYWRzCjIuNi4xNi4yLWJ0cmVlICAgICAgMTAwNCAgNDA5NiAg
ICAxICAgMjMuODkgNS4xOTYlICAgICAwLjE2MyAgICAyOTguNDcgICAwLjAwMDAwICAwLjAwMDAw
ICAgNDYwCjIuNi4xNi4yLWJ0cmVlICAgICAgMTAwNCAgNDA5NiAgICAyICAgNDEuMzcgMjIuNzQl
ICAgICAwLjE4NiAgICAxMzcuOTMgICAwLjAwMDAwICAwLjAwMDAwICAgMTgyCjIuNi4xNi4yLWJ0
cmVlICAgICAgMTAwNCAgNDA5NiAgICA0ICAgMzkuODIgMjkuNDAlICAgICAwLjM1NiAgICAzMzYu
MTAgICAwLjAwMDAwICAwLjAwMDAwICAgMTM1CjIuNi4xNi4yLWJ0cmVlICAgICAgMTAwNCAgNDA5
NiAgICA4ICAgMzYuMjIgNDUuMTklICAgICAwLjc2NyAgICA5NDMuNTUgICAwLjAwMDAwICAwLjAw
MDAwICAgIDgwCgpSYW5kb20gUmVhZHMKMi42LjE2LjItYnRyZWUgICAgICAxMDA0ICA0MDk2ICAg
IDEgICAgMC41MSAwLjY3OSUgICAgIDcuNjQ2ICAgICA0MC4yNCAgIDAuMDAwMDAgIDAuMDAwMDAg
ICAgNzUKMi42LjE2LjItYnRyZWUgICAgICAxMDA0ICA0MDk2ICAgIDIgICAgMC40MyAwLjQ3NSUg
ICAgMTguMDcxICAgIDExMS43NSAgIDAuMDAwMDAgIDAuMDAwMDAgICAgOTEKMi42LjE2LjItYnRy
ZWUgICAgICAxMDA0ICA0MDk2ICAgIDQgICAgMC40NiAxLjIzOSUgICAgMzEuMTM0ICAgIDIyNi4z
MCAgIDAuMDAwMDAgIDAuMDAwMDAgICAgMzcKMi42LjE2LjItYnRyZWUgICAgICAxMDA0ICA0MDk2
ICAgIDggICAgMC40NSAyLjkxNSUgICAgNjAuNDcwICAgIDM3OC4zMyAgIDAuMDAwMDAgIDAuMDAw
MDAgICAgMTUKClNlcXVlbnRpYWwgV3JpdGVzCjIuNi4xNi4yLWJ0cmVlICAgICAgMTAwNCAgNDA5
NiAgICAxICAgMTYuMTQgNjUuNDYlICAgICAwLjIzOSAgIDIxNjMuMzUgICAwLjAwMDM5ICAwLjAw
MDAwICAgIDI1CjIuNi4xNi4yLWJ0cmVlICAgICAgMTAwNCAgNDA5NiAgICAyICAgMTcuMjQgNzUu
NDclICAgICAwLjQzMCAgIDcwOTkuNDIgICAwLjAwMTk1ICAwLjAwMDAwICAgIDIzCjIuNi4xNi4y
LWJ0cmVlICAgICAgMTAwNCAgNDA5NiAgICA0ICAgMTUuNjQgNjYuNzMlICAgICAwLjg1NyAgIDk5
MDQuMzkgICAwLjAwODU2ICAwLjAwMDAwICAgIDIzCjIuNi4xNi4yLWJ0cmVlICAgICAgMTAwNCAg
NDA5NiAgICA4ICAgMTMuNzMgODAuOTElICAgICAxLjg1OCAgMTM2ODIuMjAgICAwLjAzMzk4ICAw
LjAwMDc4ICAgIDE3CgpSYW5kb20gV3JpdGVzCjIuNi4xNi4yLWJ0cmVlICAgICAgMTAwNCAgNDA5
NiAgICAxICAgIDcuNjYgMzUuMjglICAgICAwLjUwMCAgICAzNjEuNDkgICAwLjAwMDAwICAwLjAw
MDAwICAgIDIyCjIuNi4xNi4yLWJ0cmVlICAgICAgMTAwNCAgNDA5NiAgICAyICAgIDAuODYgMS42
NTQlICAgICAwLjY2OCAgICAxMjUuNzggICAwLjAwMDAwICAwLjAwMDAwICAgIDUyCjIuNi4xNi4y
LWJ0cmVlICAgICAgMTAwNCAgNDA5NiAgICA0ICAgIDAuOTYgMi45MDQlICAgICAwLjYyMCAgICAx
MTMuNjYgICAwLjAwMDAwICAwLjAwMDAwICAgIDMzCjIuNi4xNi4yLWJ0cmVlICAgICAgMTAwNCAg
NDA5NiAgICA4ICAgIDEuMDQgNC42MzIlICAgICAwLjQ2MSAgICAxNzUuNDkgICAwLjAwMDAwICAw
LjAwMDAwICAgIDIyCg==
------=_Part_17202_32626162.1155865413814
Content-Type: text/plain; name=radixtree.txt; charset=ANSI_X3.4-1968
Content-Transfer-Encoding: base64
X-Attachment-Id: f_eqzwa6su
Content-Disposition: attachment; filename="radixtree.txt"

ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRmlsZSAgQmxrICAgTnVtICAgICAgICAgICAg
ICAgICAgIEF2ZyAgICAgIE1heGltdW0gICAgICBMYXQlICAgICBMYXQlICAgIENQVQpJZGVudGlm
aWVyICAgICAgICAgICAgICAgICAgICBTaXplICBTaXplICBUaHIgICBSYXRlICAoQ1BVJSkgIExh
dGVuY3kgICAgTGF0ZW5jeSAgICAgID4ycyAgICAgID4xMHMgICAgRWZmCi0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0gLS0tLS0tIC0tLS0tIC0tLSAgLS0tLS0tIC0tLS0tLSAtLS0tLS0tLS0g
LS0tLS0tLS0tLS0gIC0tLS0tLS0tIC0tLS0tLS0tIC0tLS0tClNlcXVlbnRpYWwgUmVhZHMKMi42
LjE1LTEuMjA1NF9GQzVzbXAgICAgICAgICAgMTAwNCAgNDA5NiAgICAxICAgNTQuMzEgOS4zNzAl
ICAgICAwLjA3MSAgICAgMjkuOTggICAwLjAwMDAwICAwLjAwMDAwICAgNTgwCjIuNi4xNS0xLjIw
NTRfRkM1c21wICAgICAgICAgIDEwMDQgIDQwOTYgICAgMiAgIDM5LjY2IDExLjUxJSAgICAgMC4x
OTUgICAgMTU4LjQ5ICAgMC4wMDAwMCAgMC4wMDAwMCAgIDM0NAoyLjYuMTUtMS4yMDU0X0ZDNXNt
cCAgICAgICAgICAxMDA0ICA0MDk2ICAgIDQgICA0Mi4zOSAyNy43OSUgICAgIDAuMzYwICAgIDM3
MS4yMiAgIDAuMDAwMDAgIDAuMDAwMDAgICAxNTIKMi42LjE1LTEuMjA1NF9GQzVzbXAgICAgICAg
ICAgMTAwNCAgNDA5NiAgICA4ICAgMzYuMDIgMzcuMzYlICAgICAwLjc1MCAgICA4NzAuNjIgICAw
LjAwMDAwICAwLjAwMDAwICAgIDk2CgpSYW5kb20gUmVhZHMKMi42LjE1LTEuMjA1NF9GQzVzbXAg
ICAgICAgICAgMTAwNCAgNDA5NiAgICAxICAgIDAuNDYgMC41MTYlICAgICA4LjUyMyAgICAgMzku
MjAgICAwLjAwMDAwICAwLjAwMDAwICAgIDg5CjIuNi4xNS0xLjIwNTRfRkM1c21wICAgICAgICAg
IDEwMDQgIDQwOTYgICAgMiAgICAwLjQxIDAuNTAwJSAgICAxOC45NDYgICAgMTM2LjkyICAgMC4w
MDAwMCAgMC4wMDAwMCAgICA4MQoyLjYuMTUtMS4yMDU0X0ZDNXNtcCAgICAgICAgICAxMDA0ICA0
MDk2ICAgIDQgICAgMC41MCAxLjIzNSUgICAgMzAuOTE2ICAgIDIyNi43OCAgIDAuMDAwMDAgIDAu
MDAwMDAgICAgNDAKMi42LjE1LTEuMjA1NF9GQzVzbXAgICAgICAgICAgMTAwNCAgNDA5NiAgICA4
ICAgIDAuNDYgMi43NTUlICAgIDYxLjA1NCAgICA1OTAuNTMgICAwLjAwMDAwICAwLjAwMDAwICAg
IDE3CgpTZXF1ZW50aWFsIFdyaXRlcwoyLjYuMTUtMS4yMDU0X0ZDNXNtcCAgICAgICAgICAxMDA0
ICA0MDk2ICAgIDEgICA0Ny44MCAyNC4xNyUgICAgIDAuMDcxICAgMTYwOC4wNSAgIDAuMDAwMDAg
IDAuMDAwMDAgICAxOTgKMi42LjE1LTEuMjA1NF9GQzVzbXAgICAgICAgICAgMTAwNCAgNDA5NiAg
ICAyICAgNDUuODIgNTEuNTklICAgICAwLjEzNSAgIDI3NDIuMjcgICAwLjAwMDc4ICAwLjAwMDAw
ICAgIDg5CjIuNi4xNS0xLjIwNTRfRkM1c21wICAgICAgICAgIDEwMDQgIDQwOTYgICAgNCAgIDQ0
LjM0IDk5LjgxJSAgICAgMC4yOTEgICAzMTkwLjY1ICAgMC4wMDI3MiAgMC4wMDAwMCAgICA0NAoy
LjYuMTUtMS4yMDU0X0ZDNXNtcCAgICAgICAgICAxMDA0ICA0MDk2ICAgIDggICA0Mi41NyAxODEu
MSUgICAgIDAuNDU1ICAgNDQ2My44MSAgIDAuMDAyMzQgIDAuMDAwMDAgICAgMjQKClJhbmRvbSBX
cml0ZXMKMi42LjE1LTEuMjA1NF9GQzVzbXAgICAgICAgICAgMTAwNCAgNDA5NiAgICAxICAgIDEu
NDYgMC41NjElICAgICAwLjA4NiAgICAgMjkuMDggICAwLjAwMDAwICAwLjAwMDAwICAgMjYwCjIu
Ni4xNS0xLjIwNTRfRkM1c21wICAgICAgICAgIDEwMDQgIDQwOTYgICAgMiAgICAxLjQ0IDEuNTQ3
JSAgICAgMC4wNzIgICAgIDQyLjg0ICAgMC4wMDAwMCAgMC4wMDAwMCAgICA5MwoyLjYuMTUtMS4y
MDU0X0ZDNXNtcCAgICAgICAgICAxMDA0ICA0MDk2ICAgIDQgICAgMS40NyAyLjcwNyUgICAgIDAu
MDE1ICAgICAgMC41NSAgIDAuMDAwMDAgIDAuMDAwMDAgICAgNTQKMi42LjE1LTEuMjA1NF9GQzVz
bXAgICAgICAgICAgMTAwNCAgNDA5NiAgICA4ICAgIDEuNDMgNy4zMTMlICAgICAwLjAxNSAgICAg
IDAuNjAgICAwLjAwMDAwICAwLjAwMDAwICAgIDIwCg==
------=_Part_17202_32626162.1155865413814--
