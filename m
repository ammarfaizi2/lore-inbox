Return-Path: <linux-kernel-owner+willy=40w.ods.org-S262169AbVATQqg@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S262169AbVATQqg (ORCPT <rfc822;willy@w.ods.org>);
	Thu, 20 Jan 2005 11:46:36 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S262251AbVATQeI
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Thu, 20 Jan 2005 11:34:08 -0500
Received: from l247150.ppp.asahi-net.or.jp ([218.219.247.150]:31447 "EHLO
	mitou.ysato.dip.jp") by vger.kernel.org with ESMTP id S262290AbVATQax
	(ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Thu, 20 Jan 2005 11:30:53 -0500
Date: Fri, 21 Jan 2005 01:30:51 +0900
Message-ID: <m2pt006p1g.wl%ysato@users.sourceforge.jp>
From: Yoshinori Sato <ysato@users.sourceforge.jp>
To: Andrew Morton <akpm@osdl.org>
Cc: linux-kernel@vger.kernel.org
Subject: [PATCH] h8300 makefile update
User-Agent: Wanderlust/2.11.30 (Wonderwall) SEMI/1.14.6 (Maruoka)
 LIMIT/1.14.9 (Domyoji) APEL/10.6 Emacs/21.3 (i386-pc-linux-gnu)
 MULE/5.0 (SAKAKI)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Fix build error when .config does not exist

Signed-off-by: Yoshinori Sato <ysato@users.sourceforge.jp>

===== arch/h8300/Makefile 1.7 vs edited =====
--- 1.7/arch/h8300/Makefile	2004-05-15 11:00:17 +09:00
+++ edited/arch/h8300/Makefile	2005-01-20 23:09:33 +09:00
@@ -7,9 +7,6 @@
 #
 # (C) Copyright 2002,2003 Yoshinori Sato <ysato@users.sourceforge.jp>
 #
-ifndef include-config
--include $(TOPDIR)/.config
-endif
 
 platform-$(CONFIG_CPU_H8300H)	:= h8300h
 platform-$(CONFIG_CPU_H8S)	:= h8s
@@ -47,9 +44,11 @@
 head-y := arch/$(ARCH)/platform/$(platform-y)/$(board-y)/crt0_$(model-y).o
 
 core-y	+= arch/$(ARCH)/kernel/ \
-	   arch/$(ARCH)/mm/ \
-	   arch/$(ARCH)/platform/$(PLATFORM)/ \
+	   arch/$(ARCH)/mm/
+ifdef PLATFORM
+core-y	+= arch/$(ARCH)/platform/$(PLATFORM)/ \
 	   arch/$(ARCH)/platform/$(PLATFORM)/$(BOARD)/
+endif
 
 libs-y	+= arch/$(ARCH)/lib/ $(LIBGCC)
 
-- 
Yoshinori Sato
<ysato@users.sourceforge.jp>
