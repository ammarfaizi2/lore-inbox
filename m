Return-Path: <linux-kernel-owner+willy=40w.ods.org-S264711AbUEJO20@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S264711AbUEJO20 (ORCPT <rfc822;willy@w.ods.org>);
	Mon, 10 May 2004 10:28:26 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S264710AbUEJO20
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Mon, 10 May 2004 10:28:26 -0400
Received: from maxipes.logix.cz ([81.0.234.97]:61313 "EHLO maxipes.logix.cz")
	by vger.kernel.org with ESMTP id S264711AbUEJO2D (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Mon, 10 May 2004 10:28:03 -0400
Date: Mon, 10 May 2004 16:28:02 +0200 (CEST)
From: Michal Ludvig <michal@logix.cz>
To: Andrew Morton <akpm@osdl.org>
Cc: "David S. Miller" <davem@redhat.com>, linux-kernel@vger.kernel.org
Subject: [PATCH 1/2] Support for VIA PadLock crypto engine
Message-ID: <Pine.LNX.4.53.0405101607320.27527@maxipes.logix.cz>
MIME-Version: 1.0
Content-Type: MULTIPART/MIXED; BOUNDARY="336214560-790098580-1084199282=:27527"
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.
  Send mail to mime@docserver.cac.washington.edu for more info.

--336214560-790098580-1084199282=:27527
Content-Type: TEXT/PLAIN; charset=US-ASCII

Hi,

this is the generic part of the patch that enables use of the
hardware cryptography engine in VIA C3 Nehemiah CPUs (so called PadLock
ACE).

The changes here provide a way to encrypt/decrypt the whole buffer of data
(e.g. a disk sector or a network packet), here called multiblock, without
the need to split them to single units and process block-by-block (where
block is e.g. 16 Bytes for AES algorithm). This way PadLock ACE can
encrypt/decrypt in much higher speed.

I also added some support for other modes than ECB and CBC (i.e. new are
CFB, OFB and CTR).

The next mail will contain the changes for crypto/aes.c

 crypto/api.c           |   14 ++
 crypto/cipher.c        |  313 +++++++++++++++++++++++++++++--------------------
 include/linux/crypto.h |   33 +++++
 3 files changed, 236 insertions(+), 124 deletions(-)

Michal Ludvig
-- 
* A mouse is a device used to point at the xterm you want to type in.
* Personal homepage - http://www.logix.cz/michal
--336214560-790098580-1084199282=:27527
Content-Type: TEXT/PLAIN; charset=US-ASCII; name="kernel-crypto-all.diff"
Content-Transfer-Encoding: BASE64
Content-ID: <Pine.LNX.4.53.0405101628020.27527@maxipes.logix.cz>
Content-Description: 
Content-Disposition: attachment; filename="kernel-crypto-all.diff"

ZGlmZiAtdXJwIGxpbnV4LTIuNi41LnBhdGNoZWQvY3J5cHRvL2NpcGhlci5j
IGxpbnV4LTIuNi41L2NyeXB0by9jaXBoZXIuYw0KLS0tIGxpbnV4LTIuNi41
LnBhdGNoZWQvY3J5cHRvL2NpcGhlci5jCTIwMDQtMDQtMjkgMTA6MzM6MDUu
MDAwMDAwMDAwICswMjAwDQorKysgbGludXgtMi42LjUvY3J5cHRvL2NpcGhl
ci5jCTIwMDQtMDUtMTAgMTU6MjE6NTYuMTAxODc5NjMyICswMjAwDQpAQCAt
MjAsNyArMjAsMzEgQEANCiAjaW5jbHVkZSAiaW50ZXJuYWwuaCINCiAjaW5j
bHVkZSAic2NhdHRlcndhbGsuaCINCiANCisjZGVmaW5lIENSQV9DSVBIRVIo
dGZtKQkodGZtKS0+X19jcnRfYWxnLT5jcmFfY2lwaGVyDQorDQorI2RlZmlu
ZSBERUZfVEZNX0ZVTkNUSU9OKG5hbWUsbW9kZSxlbmNkZWMsaXYpCVwNCitz
dGF0aWMgaW50IG5hbWUoc3RydWN0IGNyeXB0b190Zm0gKnRmbSwJCVwNCisg
ICAgICAgICAgICAgICAgc3RydWN0IHNjYXR0ZXJsaXN0ICpkc3QsCVwNCisg
ICAgICAgICAgICAgICAgc3RydWN0IHNjYXR0ZXJsaXN0ICpzcmMsCVwNCisJ
CXVuc2lnbmVkIGludCBuYnl0ZXMpCQlcDQorewkJCQkJCVwNCisJcmV0dXJu
IGNyeXB0KHRmbSwgZHN0LCBzcmMsIG5ieXRlcywJXA0KKwkJICAgICBtb2Rl
LCBlbmNkZWMsIGl2KTsJCVwNCit9DQorDQorI2RlZmluZSBERUZfVEZNX0ZV
TkNUSU9OX0lWKG5hbWUsbW9kZSxlbmNkZWMsaXYpCVwNCitzdGF0aWMgaW50
IG5hbWUoc3RydWN0IGNyeXB0b190Zm0gKnRmbSwJCVwNCisgICAgICAgICAg
ICAgICAgc3RydWN0IHNjYXR0ZXJsaXN0ICpkc3QsCVwNCisgICAgICAgICAg
ICAgICAgc3RydWN0IHNjYXR0ZXJsaXN0ICpzcmMsCVwNCisJCXVuc2lnbmVk
IGludCBuYnl0ZXMsIHU4ICppdikJXA0KK3sJCQkJCQlcDQorCXJldHVybiBj
cnlwdCh0Zm0sIGRzdCwgc3JjLCBuYnl0ZXMsCVwNCisJCSAgICAgbW9kZSwg
ZW5jZGVjLCBpdik7CQlcDQorfQ0KKw0KIHR5cGVkZWYgdm9pZCAoY3J5cHRm
bl90KSh2b2lkICosIHU4ICosIGNvbnN0IHU4ICopOw0KK3R5cGVkZWYgdm9p
ZCAoY3J5cHRibGtmbl90KSh2b2lkICosIHU4ICosIGNvbnN0IHU4ICosIGNv
bnN0IHU4ICosDQorCQkJICAgIHNpemVfdCwgaW50LCBpbnQpOw0KIHR5cGVk
ZWYgdm9pZCAocHJvY2ZuX3QpKHN0cnVjdCBjcnlwdG9fdGZtICosIHU4ICos
DQogICAgICAgICAgICAgICAgICAgICAgICAgdTgqLCBjcnlwdGZuX3QsIGlu
dCBlbmMsIHZvaWQgKiwgaW50KTsNCiANCkBAIC0zOCw2ICs2MiwzNiBAQCBz
dGF0aWMgaW5saW5lIHZvaWQgeG9yXzEyOCh1OCAqYSwgY29uc3QgDQogCSgo
dTMyICopYSlbM10gXj0gKCh1MzIgKiliKVszXTsNCiB9DQogDQorc3RhdGlj
IHZvaWQgY2JjX3Byb2Nlc3Moc3RydWN0IGNyeXB0b190Zm0gKnRmbSwgdTgg
KmRzdCwgdTggKnNyYywNCisJCQljcnlwdGZuX3QgKmZuLCBpbnQgZW5jLCB2
b2lkICppbmZvLCBpbnQgaW5fcGxhY2UpDQorew0KKwl1OCAqaXYgPSBpbmZv
Ow0KKwkNCisJLyogTnVsbCBlbmNyeXB0aW9uICovDQorCWlmICghaXYpDQor
CQlyZXR1cm47DQorCQkNCisJaWYgKGVuYykgew0KKwkJdGZtLT5jcnRfdS5j
aXBoZXIuY2l0X3hvcl9ibG9jayhpdiwgc3JjKTsNCisJCSgqZm4pKGNyeXB0
b190Zm1fY3R4KHRmbSksIGRzdCwgaXYpOw0KKwkJbWVtY3B5KGl2LCBkc3Qs
IGNyeXB0b190Zm1fYWxnX2Jsb2Nrc2l6ZSh0Zm0pKTsNCisJfSBlbHNlIHsN
CisJCXU4IHN0YWNrW2luX3BsYWNlID8gY3J5cHRvX3RmbV9hbGdfYmxvY2tz
aXplKHRmbSkgOiAwXTsNCisJCXU4ICpidWYgPSBpbl9wbGFjZSA/IHN0YWNr
IDogZHN0Ow0KKw0KKwkJKCpmbikoY3J5cHRvX3RmbV9jdHgodGZtKSwgYnVm
LCBzcmMpOw0KKwkJdGZtLT5jcnRfdS5jaXBoZXIuY2l0X3hvcl9ibG9jayhi
dWYsIGl2KTsNCisJCW1lbWNweShpdiwgc3JjLCBjcnlwdG9fdGZtX2FsZ19i
bG9ja3NpemUodGZtKSk7DQorCQlpZiAoYnVmICE9IGRzdCkNCisJCQltZW1j
cHkoZHN0LCBidWYsIGNyeXB0b190Zm1fYWxnX2Jsb2Nrc2l6ZSh0Zm0pKTsN
CisJfQ0KK30NCisNCitzdGF0aWMgdm9pZCBlY2JfcHJvY2VzcyhzdHJ1Y3Qg
Y3J5cHRvX3RmbSAqdGZtLCB1OCAqZHN0LCB1OCAqc3JjLA0KKwkJCWNyeXB0
Zm5fdCBmbiwgaW50IGVuYywgdm9pZCAqaW5mbywgaW50IGluX3BsYWNlKQ0K
K3sNCisJKCpmbikoY3J5cHRvX3RmbV9jdHgodGZtKSwgZHN0LCBzcmMpOw0K
K30NCiANCiAvKiANCiAgKiBHZW5lcmljIGVuY3J5cHQvZGVjcnlwdCB3cmFw
cGVyIGZvciBjaXBoZXJzLCBoYW5kbGVzIG9wZXJhdGlvbnMgYWNyb3NzDQpA
QCAtNDcsMjAgKzEwMSw5MiBAQCBzdGF0aWMgaW5saW5lIHZvaWQgeG9yXzEy
OCh1OCAqYSwgY29uc3QgDQogc3RhdGljIGludCBjcnlwdChzdHJ1Y3QgY3J5
cHRvX3RmbSAqdGZtLA0KIAkJIHN0cnVjdCBzY2F0dGVybGlzdCAqZHN0LA0K
IAkJIHN0cnVjdCBzY2F0dGVybGlzdCAqc3JjLA0KLSAgICAgICAgICAgICAg
ICAgdW5zaWduZWQgaW50IG5ieXRlcywgY3J5cHRmbl90IGNyZm4sDQotICAg
ICAgICAgICAgICAgICBwcm9jZm5fdCBwcmZuLCBpbnQgZW5jLCB2b2lkICpp
bmZvKQ0KKwkJIHVuc2lnbmVkIGludCBuYnl0ZXMsIA0KKwkJIGludCBtb2Rl
LCBpbnQgZW5jLCB2b2lkICppbmZvKQ0KIHsNCisJY3J5cHRmbl90ICpjcnlw
dG9mbiA9IE5VTEw7DQorCXByb2Nmbl90ICpwcm9jZXNzZm4gPSBOVUxMOw0K
KwljcnlwdGJsa2ZuX3QgKmNyeXB0b211bHRpYmxvY2tmbiA9IE5VTEw7DQor
DQogCXN0cnVjdCBzY2F0dGVyX3dhbGsgd2Fsa19pbiwgd2Fsa19vdXQ7DQot
CWNvbnN0IHVuc2lnbmVkIGludCBic2l6ZSA9IGNyeXB0b190Zm1fYWxnX2Js
b2Nrc2l6ZSh0Zm0pOw0KLQl1OCB0bXBfc3JjW25ieXRlcyA+IHNyYy0+bGVu
Z3RoID8gYnNpemUgOiAwXTsNCi0JdTggdG1wX2RzdFtuYnl0ZXMgPiBkc3Qt
Pmxlbmd0aCA/IGJzaXplIDogMF07DQorCXNpemVfdCBtYXhfbmJ5dGVzID0g
Y3J5cHRvX3RmbV9hbGdfbWF4X25ieXRlcyh0Zm0pOw0KKwlzaXplX3QgYnNp
emUgPSBjcnlwdG9fdGZtX2FsZ19ibG9ja3NpemUodGZtKTsNCisJaW50IHJl
cV9hbGlnbiA9IGNyeXB0b190Zm1fYWxnX3JlcV9hbGlnbih0Zm0pOw0KKwlp
bnQgcmV0ID0gMDsNCisJdm9pZCAqaW5kZXhfc3JjID0gTlVMTCwgKmluZGV4
X2RzdCA9IE5VTEw7DQorCXU4ICppdiA9IGluZm87DQorCXU4ICp0bXBfc3Jj
LCAqdG1wX2RzdDsNCiANCiAJaWYgKCFuYnl0ZXMpDQotCQlyZXR1cm4gMDsN
CisJCXJldHVybiByZXQ7DQogDQogCWlmIChuYnl0ZXMgJSBic2l6ZSkgew0K
IAkJdGZtLT5jcnRfZmxhZ3MgfD0gQ1JZUFRPX1RGTV9SRVNfQkFEX0JMT0NL
X0xFTjsNCi0JCXJldHVybiAtRUlOVkFMOw0KKwkJcmV0ID0gLUVJTlZBTDsN
CisJCWdvdG8gb3V0Ow0KKwl9DQorDQorCXN3aXRjaCAobW9kZSkgew0KKwkJ
Y2FzZSBDUllQVE9fVEZNX01PREVfRUNCOg0KKwkJCWlmIChDUkFfQ0lQSEVS
KHRmbSkuY2lhX2VjYikNCisJCQkJY3J5cHRvbXVsdGlibG9ja2ZuID0gQ1JB
X0NJUEhFUih0Zm0pLmNpYV9lY2I7DQorCQkJZWxzZSB7DQorCQkJCWNyeXB0
b2ZuID0gKGVuYyA9PSBDUllQVE9fRElSX0VOQ1JZUFQpID8gQ1JBX0NJUEhF
Uih0Zm0pLmNpYV9lbmNyeXB0IDogQ1JBX0NJUEhFUih0Zm0pLmNpYV9kZWNy
eXB0Ow0KKwkJCQlwcm9jZXNzZm4gPSBlY2JfcHJvY2VzczsNCisJCQl9DQor
CQkJYnJlYWs7DQorDQorCQljYXNlIENSWVBUT19URk1fTU9ERV9DQkM6DQor
CQkJaWYgKENSQV9DSVBIRVIodGZtKS5jaWFfY2JjKQ0KKwkJCQljcnlwdG9t
dWx0aWJsb2NrZm4gPSBDUkFfQ0lQSEVSKHRmbSkuY2lhX2NiYzsNCisJCQll
bHNlIHsNCisJCQkJY3J5cHRvZm4gPSAoZW5jID09IENSWVBUT19ESVJfRU5D
UllQVCkgPyBDUkFfQ0lQSEVSKHRmbSkuY2lhX2VuY3J5cHQgOiBDUkFfQ0lQ
SEVSKHRmbSkuY2lhX2RlY3J5cHQ7DQorCQkJCXByb2Nlc3NmbiA9IGNiY19w
cm9jZXNzOw0KKwkJCX0NCisJCQlicmVhazsNCisNCisJCS8qIFVudGlsIHdl
IGhhdmUgdGhlIGFwcHJvcHJpYXRlIHtvZmIsY2ZiLGN0cn1fcHJvY2Vzcygp
IGZ1bmN0aW9ucywNCisJCSAgIHRoZSBmb2xsb3dpbmcgY2FzZXMgd2lsbCBy
ZXR1cm4gLUVOT1NZUyBpZiB0aGVyZSBpcyBubyBIVyBzdXBwb3J0DQorCQkg
ICBmb3IgdGhlIG1vZGUuICovDQorCQljYXNlIENSWVBUT19URk1fTU9ERV9P
RkI6DQorCQkJaWYgKENSQV9DSVBIRVIodGZtKS5jaWFfb2ZiKQ0KKwkJCQlj
cnlwdG9tdWx0aWJsb2NrZm4gPSBDUkFfQ0lQSEVSKHRmbSkuY2lhX29mYjsN
CisJCQllbHNlDQorCQkJCXJldHVybiAtRU5PU1lTOw0KKwkJCWJyZWFrOw0K
Kw0KKwkJY2FzZSBDUllQVE9fVEZNX01PREVfQ0ZCOg0KKwkJCWlmIChDUkFf
Q0lQSEVSKHRmbSkuY2lhX2NmYikNCisJCQkJY3J5cHRvbXVsdGlibG9ja2Zu
ID0gQ1JBX0NJUEhFUih0Zm0pLmNpYV9jZmI7DQorCQkJZWxzZQ0KKwkJCQly
ZXR1cm4gLUVOT1NZUzsNCisJCQlicmVhazsNCisNCisJCWNhc2UgQ1JZUFRP
X1RGTV9NT0RFX0NUUjoNCisJCQlpZiAoQ1JBX0NJUEhFUih0Zm0pLmNpYV9j
dHIpDQorCQkJCWNyeXB0b211bHRpYmxvY2tmbiA9IENSQV9DSVBIRVIodGZt
KS5jaWFfY3RyOw0KKwkJCWVsc2UNCisJCQkJcmV0dXJuIC1FTk9TWVM7DQor
CQkJYnJlYWs7DQorDQorCQlkZWZhdWx0Og0KKwkJCUJVRygpOw0KKwl9DQor
DQorCWlmIChjcnlwdG9tdWx0aWJsb2NrZm4pDQorCQlic2l6ZSA9IChtYXhf
bmJ5dGVzID4gbmJ5dGVzKSA/IG5ieXRlcyA6IG1heF9uYnl0ZXM7DQorDQor
CS8qIFNvbWUgaGFyZHdhcmUgY3J5cHRvIGVuZ2luZXMgbWF5IHJlcXVpcmUg
YSBzcGVjaWZpYyANCisJICAgYWxpZ25tZW50IG9mIHRoZSBidWZmZXJzLiBX
ZSB3aWxsIGFsaWduIHRoZSBidWZmZXJzDQorCSAgIGFscmVhZHkgaGVyZSB0
byBhdm9pZCB0aGVpciByZWFsbG9jYXRpbmcgbGF0ZXIuICovDQorCXRtcF9z
cmMgPSBjcnlwdG9fYWxpZ25lZF9rbWFsbG9jKGJzaXplLCBHRlBfS0VSTkVM
LA0KKwkJCQkJIHJlcV9hbGlnbiwgJmluZGV4X3NyYyk7DQorCXRtcF9kc3Qg
PSBjcnlwdG9fYWxpZ25lZF9rbWFsbG9jKGJzaXplLCBHRlBfS0VSTkVMLA0K
KwkJCQkJIHJlcV9hbGlnbiwgJmluZGV4X2RzdCk7DQorDQorCWlmICghaW5k
ZXhfc3JjIHx8ICFpbmRleF9kc3QpIHsNCisJCXJldCA9IC1FTk9NRU07DQor
CQlnb3RvIG91dDsNCiAJfQ0KIA0KIAlzY2F0dGVyd2Fsa19zdGFydCgmd2Fs
a19pbiwgc3JjKTsNCkBAIC03MSwxNiArMTk3LDIzIEBAIHN0YXRpYyBpbnQg
Y3J5cHQoc3RydWN0IGNyeXB0b190Zm0gKnRmbSwNCiANCiAJCXNjYXR0ZXJ3
YWxrX21hcCgmd2Fsa19pbiwgMCk7DQogCQlzY2F0dGVyd2Fsa19tYXAoJndh
bGtfb3V0LCAxKTsNCisNCiAJCXNyY19wID0gc2NhdHRlcndhbGtfd2hpY2hi
dWYoJndhbGtfaW4sIGJzaXplLCB0bXBfc3JjKTsNCiAJCWRzdF9wID0gc2Nh
dHRlcndhbGtfd2hpY2hidWYoJndhbGtfb3V0LCBic2l6ZSwgdG1wX2RzdCk7
DQogDQotCQluYnl0ZXMgLT0gYnNpemU7DQotDQogCQlzY2F0dGVyd2Fsa19j
b3B5Y2h1bmtzKHNyY19wLCAmd2Fsa19pbiwgYnNpemUsIDApOw0KIA0KLQkJ
cHJmbih0Zm0sIGRzdF9wLCBzcmNfcCwgY3JmbiwgZW5jLCBpbmZvLA0KLQkJ
ICAgICBzY2F0dGVyd2Fsa19zYW1lYnVmKCZ3YWxrX2luLCAmd2Fsa19vdXQs
DQotCQkJCQkgc3JjX3AsIGRzdF9wKSk7DQorCQluYnl0ZXMgLT0gYnNpemU7
DQorDQorCQlpZiAoY3J5cHRvbXVsdGlibG9ja2ZuKQ0KKwkJCSgqY3J5cHRv
bXVsdGlibG9ja2ZuKShjcnlwdG9fdGZtX2N0eCh0Zm0pLA0KKwkJCQkJICAg
ZHN0X3AsIHNyY19wLCBpdiwgYnNpemUsIGVuYywNCisJCQkJCSAgIHNjYXR0
ZXJ3YWxrX3NhbWVidWYoJndhbGtfaW4sICZ3YWxrX291dCwNCisJCQkJCQkJ
ICAgICAgIHNyY19wLCBkc3RfcCkpOw0KKwkJZWxzZQ0KKwkJCSgqcHJvY2Vz
c2ZuKSh0Zm0sIGRzdF9wLCBzcmNfcCwgY3J5cHRvZm4sIGVuYywgaW5mbywN
CisJCQkJICBzY2F0dGVyd2Fsa19zYW1lYnVmKCZ3YWxrX2luLCAmd2Fsa19v
dXQsDQorCQkJCQkJICAgICAgc3JjX3AsIGRzdF9wKSk7DQogDQogCQlzY2F0
dGVyd2Fsa19kb25lKCZ3YWxrX2luLCAwLCBuYnl0ZXMpOw0KIA0KQEAgLTg4
LDQ2ICsyMjEsMjMgQEAgc3RhdGljIGludCBjcnlwdChzdHJ1Y3QgY3J5cHRv
X3RmbSAqdGZtLA0KIAkJc2NhdHRlcndhbGtfZG9uZSgmd2Fsa19vdXQsIDEs
IG5ieXRlcyk7DQogDQogCQlpZiAoIW5ieXRlcykNCi0JCQlyZXR1cm4gMDsN
CisJCQlnb3RvIG91dDsNCiANCiAJCWNyeXB0b195aWVsZCh0Zm0pOw0KIAl9
DQotfQ0KIA0KLXN0YXRpYyB2b2lkIGNiY19wcm9jZXNzKHN0cnVjdCBjcnlw
dG9fdGZtICp0Zm0sIHU4ICpkc3QsIHU4ICpzcmMsDQotCQkJY3J5cHRmbl90
IGZuLCBpbnQgZW5jLCB2b2lkICppbmZvLCBpbnQgaW5fcGxhY2UpDQotew0K
LQl1OCAqaXYgPSBpbmZvOw0KLQkNCi0JLyogTnVsbCBlbmNyeXB0aW9uICov
DQotCWlmICghaXYpDQotCQlyZXR1cm47DQotCQkNCi0JaWYgKGVuYykgew0K
LQkJdGZtLT5jcnRfdS5jaXBoZXIuY2l0X3hvcl9ibG9jayhpdiwgc3JjKTsN
Ci0JCWZuKGNyeXB0b190Zm1fY3R4KHRmbSksIGRzdCwgaXYpOw0KLQkJbWVt
Y3B5KGl2LCBkc3QsIGNyeXB0b190Zm1fYWxnX2Jsb2Nrc2l6ZSh0Zm0pKTsN
Ci0JfSBlbHNlIHsNCi0JCXU4IHN0YWNrW2luX3BsYWNlID8gY3J5cHRvX3Rm
bV9hbGdfYmxvY2tzaXplKHRmbSkgOiAwXTsNCi0JCXU4ICpidWYgPSBpbl9w
bGFjZSA/IHN0YWNrIDogZHN0Ow0KK291dDoNCisJaWYgKGluZGV4X3NyYykN
CisJCWtmcmVlKGluZGV4X3NyYyk7DQorCWlmIChpbmRleF9kc3QpDQorCQlr
ZnJlZShpbmRleF9kc3QpOw0KIA0KLQkJZm4oY3J5cHRvX3RmbV9jdHgodGZt
KSwgYnVmLCBzcmMpOw0KLQkJdGZtLT5jcnRfdS5jaXBoZXIuY2l0X3hvcl9i
bG9jayhidWYsIGl2KTsNCi0JCW1lbWNweShpdiwgc3JjLCBjcnlwdG9fdGZt
X2FsZ19ibG9ja3NpemUodGZtKSk7DQotCQlpZiAoYnVmICE9IGRzdCkNCi0J
CQltZW1jcHkoZHN0LCBidWYsIGNyeXB0b190Zm1fYWxnX2Jsb2Nrc2l6ZSh0
Zm0pKTsNCi0JfQ0KLX0NCi0NCi1zdGF0aWMgdm9pZCBlY2JfcHJvY2Vzcyhz
dHJ1Y3QgY3J5cHRvX3RmbSAqdGZtLCB1OCAqZHN0LCB1OCAqc3JjLA0KLQkJ
CWNyeXB0Zm5fdCBmbiwgaW50IGVuYywgdm9pZCAqaW5mbywgaW50IGluX3Bs
YWNlKQ0KLXsNCi0JZm4oY3J5cHRvX3RmbV9jdHgodGZtKSwgZHN0LCBzcmMp
Ow0KKwlyZXR1cm4gcmV0Ow0KIH0NCiANCiBzdGF0aWMgaW50IHNldGtleShz
dHJ1Y3QgY3J5cHRvX3RmbSAqdGZtLCBjb25zdCB1OCAqa2V5LCB1bnNpZ25l
ZCBpbnQga2V5bGVuKQ0KIHsNCi0Jc3RydWN0IGNpcGhlcl9hbGcgKmNpYSA9
ICZ0Zm0tPl9fY3J0X2FsZy0+Y3JhX2NpcGhlcjsNCisJc3RydWN0IGNpcGhl
cl9hbGcgKmNpYSA9ICZDUkFfQ0lQSEVSKHRmbSk7DQogCQ0KIAlpZiAoa2V5
bGVuIDwgY2lhLT5jaWFfbWluX2tleXNpemUgfHwga2V5bGVuID4gY2lhLT5j
aWFfbWF4X2tleXNpemUpIHsNCiAJCXRmbS0+Y3J0X2ZsYWdzIHw9IENSWVBU
T19URk1fUkVTX0JBRF9LRVlfTEVOOw0KQEAgLTEzNyw4MCArMjQ3LDI4IEBA
IHN0YXRpYyBpbnQgc2V0a2V5KHN0cnVjdCBjcnlwdG9fdGZtICp0Zm0NCiAJ
CSAgICAgICAgICAgICAgICAgICAgICAgJnRmbS0+Y3J0X2ZsYWdzKTsNCiB9
DQogDQotc3RhdGljIGludCBlY2JfZW5jcnlwdChzdHJ1Y3QgY3J5cHRvX3Rm
bSAqdGZtLA0KLQkJICAgICAgIHN0cnVjdCBzY2F0dGVybGlzdCAqZHN0LA0K
LSAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjYXR0ZXJsaXN0ICpz
cmMsIHVuc2lnbmVkIGludCBuYnl0ZXMpDQotew0KLQlyZXR1cm4gY3J5cHQo
dGZtLCBkc3QsIHNyYywgbmJ5dGVzLA0KLQkgICAgICAgICAgICAgdGZtLT5f
X2NydF9hbGctPmNyYV9jaXBoZXIuY2lhX2VuY3J5cHQsDQotCSAgICAgICAg
ICAgICBlY2JfcHJvY2VzcywgMSwgTlVMTCk7DQotfQ0KLQ0KLXN0YXRpYyBp
bnQgZWNiX2RlY3J5cHQoc3RydWN0IGNyeXB0b190Zm0gKnRmbSwNCi0gICAg
ICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY2F0dGVybGlzdCAqZHN0LA0K
LSAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjYXR0ZXJsaXN0ICpz
cmMsDQotCQkgICAgICAgdW5zaWduZWQgaW50IG5ieXRlcykNCi17DQotCXJl
dHVybiBjcnlwdCh0Zm0sIGRzdCwgc3JjLCBuYnl0ZXMsDQotCSAgICAgICAg
ICAgICB0Zm0tPl9fY3J0X2FsZy0+Y3JhX2NpcGhlci5jaWFfZGVjcnlwdCwN
Ci0JICAgICAgICAgICAgIGVjYl9wcm9jZXNzLCAxLCBOVUxMKTsNCi19DQot
DQotc3RhdGljIGludCBjYmNfZW5jcnlwdChzdHJ1Y3QgY3J5cHRvX3RmbSAq
dGZtLA0KLSAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjYXR0ZXJs
aXN0ICpkc3QsDQotICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2Nh
dHRlcmxpc3QgKnNyYywNCi0JCSAgICAgICB1bnNpZ25lZCBpbnQgbmJ5dGVz
KQ0KLXsNCi0JcmV0dXJuIGNyeXB0KHRmbSwgZHN0LCBzcmMsIG5ieXRlcywN
Ci0JICAgICAgICAgICAgIHRmbS0+X19jcnRfYWxnLT5jcmFfY2lwaGVyLmNp
YV9lbmNyeXB0LA0KLQkgICAgICAgICAgICAgY2JjX3Byb2Nlc3MsIDEsIHRm
bS0+Y3J0X2NpcGhlci5jaXRfaXYpOw0KLX0NCi0NCi1zdGF0aWMgaW50IGNi
Y19lbmNyeXB0X2l2KHN0cnVjdCBjcnlwdG9fdGZtICp0Zm0sDQotICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NhdHRlcmxpc3QgKmRzdCwN
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBzY2F0dGVybGlz
dCAqc3JjLA0KLSAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQg
aW50IG5ieXRlcywgdTggKml2KQ0KLXsNCi0JcmV0dXJuIGNyeXB0KHRmbSwg
ZHN0LCBzcmMsIG5ieXRlcywNCi0JICAgICAgICAgICAgIHRmbS0+X19jcnRf
YWxnLT5jcmFfY2lwaGVyLmNpYV9lbmNyeXB0LA0KLQkgICAgICAgICAgICAg
Y2JjX3Byb2Nlc3MsIDEsIGl2KTsNCi19DQorREVGX1RGTV9GVU5DVElPTihl
Y2JfZW5jcnlwdCwgQ1JZUFRPX1RGTV9NT0RFX0VDQiwgQ1JZUFRPX0RJUl9F
TkNSWVBULCBOVUxMKTsNCitERUZfVEZNX0ZVTkNUSU9OKGVjYl9kZWNyeXB0
LCBDUllQVE9fVEZNX01PREVfRUNCLCBDUllQVE9fRElSX0RFQ1JZUFQsIE5V
TEwpOw0KIA0KLXN0YXRpYyBpbnQgY2JjX2RlY3J5cHQoc3RydWN0IGNyeXB0
b190Zm0gKnRmbSwNCi0gICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBz
Y2F0dGVybGlzdCAqZHN0LA0KLSAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IHNjYXR0ZXJsaXN0ICpzcmMsDQotCQkgICAgICAgdW5zaWduZWQgaW50
IG5ieXRlcykNCi17DQotCXJldHVybiBjcnlwdCh0Zm0sIGRzdCwgc3JjLCBu
Ynl0ZXMsDQotCSAgICAgICAgICAgICB0Zm0tPl9fY3J0X2FsZy0+Y3JhX2Np
cGhlci5jaWFfZGVjcnlwdCwNCi0JICAgICAgICAgICAgIGNiY19wcm9jZXNz
LCAwLCB0Zm0tPmNydF9jaXBoZXIuY2l0X2l2KTsNCi19DQotDQotc3RhdGlj
IGludCBjYmNfZGVjcnlwdF9pdihzdHJ1Y3QgY3J5cHRvX3RmbSAqdGZtLA0K
LSAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNjYXR0ZXJsaXN0
ICpkc3QsDQotICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2Nh
dHRlcmxpc3QgKnNyYywNCi0gICAgICAgICAgICAgICAgICAgICAgICAgIHVu
c2lnbmVkIGludCBuYnl0ZXMsIHU4ICppdikNCi17DQotCXJldHVybiBjcnlw
dCh0Zm0sIGRzdCwgc3JjLCBuYnl0ZXMsDQotCSAgICAgICAgICAgICB0Zm0t
Pl9fY3J0X2FsZy0+Y3JhX2NpcGhlci5jaWFfZGVjcnlwdCwNCi0JICAgICAg
ICAgICAgIGNiY19wcm9jZXNzLCAwLCBpdik7DQotfQ0KLQ0KLXN0YXRpYyBp
bnQgbm9jcnlwdChzdHJ1Y3QgY3J5cHRvX3RmbSAqdGZtLA0KLSAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3Qgc2NhdHRlcmxpc3QgKmRzdCwNCi0gICAgICAg
ICAgICAgICAgICAgc3RydWN0IHNjYXR0ZXJsaXN0ICpzcmMsDQotCQkgICB1
bnNpZ25lZCBpbnQgbmJ5dGVzKQ0KLXsNCi0JcmV0dXJuIC1FTk9TWVM7DQot
fQ0KLQ0KLXN0YXRpYyBpbnQgbm9jcnlwdF9pdihzdHJ1Y3QgY3J5cHRvX3Rm
bSAqdGZtLA0KLSAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgc2NhdHRl
cmxpc3QgKmRzdCwNCi0gICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHNj
YXR0ZXJsaXN0ICpzcmMsDQotICAgICAgICAgICAgICAgICAgICAgIHVuc2ln
bmVkIGludCBuYnl0ZXMsIHU4ICppdikNCi17DQotCXJldHVybiAtRU5PU1lT
Ow0KLX0NCitERUZfVEZNX0ZVTkNUSU9OKGNiY19lbmNyeXB0LCBDUllQVE9f
VEZNX01PREVfQ0JDLCBDUllQVE9fRElSX0VOQ1JZUFQsIHRmbS0+Y3J0X2Np
cGhlci5jaXRfaXYpOw0KK0RFRl9URk1fRlVOQ1RJT05fSVYoY2JjX2VuY3J5
cHRfaXYsIENSWVBUT19URk1fTU9ERV9DQkMsIENSWVBUT19ESVJfRU5DUllQ
VCwgaXYpOw0KK0RFRl9URk1fRlVOQ1RJT04oY2JjX2RlY3J5cHQsIENSWVBU
T19URk1fTU9ERV9DQkMsIENSWVBUT19ESVJfREVDUllQVCwgdGZtLT5jcnRf
Y2lwaGVyLmNpdF9pdik7DQorREVGX1RGTV9GVU5DVElPTl9JVihjYmNfZGVj
cnlwdF9pdiwgQ1JZUFRPX1RGTV9NT0RFX0NCQywgQ1JZUFRPX0RJUl9ERUNS
WVBULCBpdik7DQorDQorREVGX1RGTV9GVU5DVElPTihjZmJfZW5jcnlwdCwg
Q1JZUFRPX1RGTV9NT0RFX0NGQiwgQ1JZUFRPX0RJUl9FTkNSWVBULCB0Zm0t
PmNydF9jaXBoZXIuY2l0X2l2KTsNCitERUZfVEZNX0ZVTkNUSU9OX0lWKGNm
Yl9lbmNyeXB0X2l2LCBDUllQVE9fVEZNX01PREVfQ0ZCLCBDUllQVE9fRElS
X0VOQ1JZUFQsIGl2KTsNCitERUZfVEZNX0ZVTkNUSU9OKGNmYl9kZWNyeXB0
LCBDUllQVE9fVEZNX01PREVfQ0ZCLCBDUllQVE9fRElSX0RFQ1JZUFQsIHRm
bS0+Y3J0X2NpcGhlci5jaXRfaXYpOw0KK0RFRl9URk1fRlVOQ1RJT05fSVYo
Y2ZiX2RlY3J5cHRfaXYsIENSWVBUT19URk1fTU9ERV9DRkIsIENSWVBUT19E
SVJfREVDUllQVCwgaXYpOw0KKw0KK0RFRl9URk1fRlVOQ1RJT04ob2ZiX2Vu
Y3J5cHQsIENSWVBUT19URk1fTU9ERV9PRkIsIENSWVBUT19ESVJfRU5DUllQ
VCwgdGZtLT5jcnRfY2lwaGVyLmNpdF9pdik7DQorREVGX1RGTV9GVU5DVElP
Tl9JVihvZmJfZW5jcnlwdF9pdiwgQ1JZUFRPX1RGTV9NT0RFX09GQiwgQ1JZ
UFRPX0RJUl9FTkNSWVBULCBpdik7DQorREVGX1RGTV9GVU5DVElPTihvZmJf
ZGVjcnlwdCwgQ1JZUFRPX1RGTV9NT0RFX09GQiwgQ1JZUFRPX0RJUl9ERUNS
WVBULCB0Zm0tPmNydF9jaXBoZXIuY2l0X2l2KTsNCitERUZfVEZNX0ZVTkNU
SU9OX0lWKG9mYl9kZWNyeXB0X2l2LCBDUllQVE9fVEZNX01PREVfT0ZCLCBD
UllQVE9fRElSX0RFQ1JZUFQsIGl2KTsNCisNCitERUZfVEZNX0ZVTkNUSU9O
KGN0cl9lbmNyeXB0LCBDUllQVE9fVEZNX01PREVfQ1RSLCBDUllQVE9fRElS
X0VOQ1JZUFQsIHRmbS0+Y3J0X2NpcGhlci5jaXRfaXYpOw0KK0RFRl9URk1f
RlVOQ1RJT05fSVYoY3RyX2VuY3J5cHRfaXYsIENSWVBUT19URk1fTU9ERV9D
VFIsIENSWVBUT19ESVJfRU5DUllQVCwgaXYpOw0KK0RFRl9URk1fRlVOQ1RJ
T04oY3RyX2RlY3J5cHQsIENSWVBUT19URk1fTU9ERV9DVFIsIENSWVBUT19E
SVJfREVDUllQVCwgdGZtLT5jcnRfY2lwaGVyLmNpdF9pdik7DQorREVGX1RG
TV9GVU5DVElPTl9JVihjdHJfZGVjcnlwdF9pdiwgQ1JZUFRPX1RGTV9NT0RF
X0NUUiwgQ1JZUFRPX0RJUl9ERUNSWVBULCBpdik7DQogDQogaW50IGNyeXB0
b19pbml0X2NpcGhlcl9mbGFncyhzdHJ1Y3QgY3J5cHRvX3RmbSAqdGZtLCB1
MzIgZmxhZ3MpDQogew0KQEAgLTI0NCwxNyArMzAyLDI0IEBAIGludCBjcnlw
dG9faW5pdF9jaXBoZXJfb3BzKHN0cnVjdCBjcnlwdG8NCiAJCWJyZWFrOw0K
IAkJDQogCWNhc2UgQ1JZUFRPX1RGTV9NT0RFX0NGQjoNCi0JCW9wcy0+Y2l0
X2VuY3J5cHQgPSBub2NyeXB0Ow0KLQkJb3BzLT5jaXRfZGVjcnlwdCA9IG5v
Y3J5cHQ7DQotCQlvcHMtPmNpdF9lbmNyeXB0X2l2ID0gbm9jcnlwdF9pdjsN
Ci0JCW9wcy0+Y2l0X2RlY3J5cHRfaXYgPSBub2NyeXB0X2l2Ow0KKwkJb3Bz
LT5jaXRfZW5jcnlwdCA9IGNmYl9lbmNyeXB0Ow0KKwkJb3BzLT5jaXRfZGVj
cnlwdCA9IGNmYl9kZWNyeXB0Ow0KKwkJb3BzLT5jaXRfZW5jcnlwdF9pdiA9
IGNmYl9lbmNyeXB0X2l2Ow0KKwkJb3BzLT5jaXRfZGVjcnlwdF9pdiA9IGNm
Yl9kZWNyeXB0X2l2Ow0KKwkJYnJlYWs7DQorCQ0KKwljYXNlIENSWVBUT19U
Rk1fTU9ERV9PRkI6DQorCQlvcHMtPmNpdF9lbmNyeXB0ID0gb2ZiX2VuY3J5
cHQ7DQorCQlvcHMtPmNpdF9kZWNyeXB0ID0gb2ZiX2RlY3J5cHQ7DQorCQlv
cHMtPmNpdF9lbmNyeXB0X2l2ID0gb2ZiX2VuY3J5cHRfaXY7DQorCQlvcHMt
PmNpdF9kZWNyeXB0X2l2ID0gb2ZiX2RlY3J5cHRfaXY7DQogCQlicmVhazsN
CiAJDQogCWNhc2UgQ1JZUFRPX1RGTV9NT0RFX0NUUjoNCi0JCW9wcy0+Y2l0
X2VuY3J5cHQgPSBub2NyeXB0Ow0KLQkJb3BzLT5jaXRfZGVjcnlwdCA9IG5v
Y3J5cHQ7DQotCQlvcHMtPmNpdF9lbmNyeXB0X2l2ID0gbm9jcnlwdF9pdjsN
Ci0JCW9wcy0+Y2l0X2RlY3J5cHRfaXYgPSBub2NyeXB0X2l2Ow0KKwkJb3Bz
LT5jaXRfZW5jcnlwdCA9IGN0cl9lbmNyeXB0Ow0KKwkJb3BzLT5jaXRfZGVj
cnlwdCA9IGN0cl9kZWNyeXB0Ow0KKwkJb3BzLT5jaXRfZW5jcnlwdF9pdiA9
IGN0cl9lbmNyeXB0X2l2Ow0KKwkJb3BzLT5jaXRfZGVjcnlwdF9pdiA9IGN0
cl9kZWNyeXB0X2l2Ow0KIAkJYnJlYWs7DQogDQogCWRlZmF1bHQ6DQpkaWZm
IC11cnAgbGludXgtMi42LjUucGF0Y2hlZC9jcnlwdG8vYXBpLmMgbGludXgt
Mi42LjUvY3J5cHRvL2FwaS5jDQotLS0gbGludXgtMi42LjUucGF0Y2hlZC9j
cnlwdG8vYXBpLmMJMjAwNC0wNC0yOSAxMDozMzowNS4wMDAwMDAwMDAgKzAy
MDANCisrKyBsaW51eC0yLjYuNS9jcnlwdG8vYXBpLmMJMjAwNC0wNS0xMCAx
NToyMDo0MS4wNDAyOTA3MjggKzAyMDANCkBAIC0yMTMsNiArMjEzLDE5IEBA
IGludCBjcnlwdG9fYWxnX2F2YWlsYWJsZShjb25zdCBjaGFyICpuYW0NCiAJ
cmV0dXJuIHJldDsNCiB9DQogDQordm9pZCAqY3J5cHRvX2FsaWduZWRfa21h
bGxvYyAoc2l6ZV90IHNpemUsIGludCBtb2RlLCBzaXplX3QgYWxpZ25tZW50
LCB2b2lkICoqaW5kZXgpDQorew0KKwljaGFyICpwdHI7DQorDQorCXB0ciA9
IGttYWxsb2Moc2l6ZSArIGFsaWdubWVudCwgbW9kZSk7DQorCSppbmRleCA9
IHB0cjsNCisJaWYgKGFsaWdubWVudCA+IDEgJiYgKChsb25nKXB0ciAmIChh
bGlnbm1lbnQgLSAxKSkpIHsNCisJCXB0ciArPSBhbGlnbm1lbnQgLSAoKGxv
bmcpcHRyICYgKGFsaWdubWVudCAtIDEpKTsNCisJfQ0KKw0KKwlyZXR1cm4g
cHRyOw0KK30NCisNCiBzdGF0aWMgaW50IF9faW5pdCBpbml0X2NyeXB0byh2
b2lkKQ0KIHsNCiAJcHJpbnRrKEtFUk5fSU5GTyAiSW5pdGlhbGl6aW5nIENy
eXB0b2dyYXBoaWMgQVBJXG4iKTsNCkBAIC0yMjcsMyArMjQwLDQgQEAgRVhQ
T1JUX1NZTUJPTF9HUEwoY3J5cHRvX3VucmVnaXN0ZXJfYWxnKQ0KIEVYUE9S
VF9TWU1CT0xfR1BMKGNyeXB0b19hbGxvY190Zm0pOw0KIEVYUE9SVF9TWU1C
T0xfR1BMKGNyeXB0b19mcmVlX3RmbSk7DQogRVhQT1JUX1NZTUJPTF9HUEwo
Y3J5cHRvX2FsZ19hdmFpbGFibGUpOw0KK0VYUE9SVF9TWU1CT0xfR1BMKGNy
eXB0b19hbGlnbmVkX2ttYWxsb2MpOw0KZGlmZiAtdXJwIGxpbnV4LTIuNi41
LnBhdGNoZWQvaW5jbHVkZS9saW51eC9jcnlwdG8uaCBsaW51eC0yLjYuNS9p
bmNsdWRlL2xpbnV4L2NyeXB0by5oDQotLS0gbGludXgtMi42LjUucGF0Y2hl
ZC9pbmNsdWRlL2xpbnV4L2NyeXB0by5oCTIwMDQtMDQtMjkgMTA6MzI6MjUu
MDAwMDAwMDAwICswMjAwDQorKysgbGludXgtMi42LjUvaW5jbHVkZS9saW51
eC9jcnlwdG8uaAkyMDA0LTA1LTEwIDEzOjIxOjIyLjAwMDAwMDAwMCArMDIw
MA0KQEAgLTQyLDYgKzQyLDcgQEANCiAjZGVmaW5lIENSWVBUT19URk1fTU9E
RV9DQkMJCTB4MDAwMDAwMDINCiAjZGVmaW5lIENSWVBUT19URk1fTU9ERV9D
RkIJCTB4MDAwMDAwMDQNCiAjZGVmaW5lIENSWVBUT19URk1fTU9ERV9DVFIJ
CTB4MDAwMDAwMDgNCisjZGVmaW5lIENSWVBUT19URk1fTU9ERV9PRkIJCTB4
MDAwMDAwMTANCiANCiAjZGVmaW5lIENSWVBUT19URk1fUkVRX1dFQUtfS0VZ
CQkweDAwMDAwMTAwDQogI2RlZmluZSBDUllQVE9fVEZNX1JFU19XRUFLX0tF
WQkJMHgwMDEwMDAwMA0KQEAgLTU2LDYgKzU3LDkgQEANCiAjZGVmaW5lIENS
WVBUT19VTlNQRUMJCQkwDQogI2RlZmluZSBDUllQVE9fTUFYX0FMR19OQU1F
CQk2NA0KIA0KKyNkZWZpbmUgQ1JZUFRPX0RJUl9FTkNSWVBUCQkxDQorI2Rl
ZmluZSBDUllQVE9fRElSX0RFQ1JZUFQJCTANCisNCiBzdHJ1Y3Qgc2NhdHRl
cmxpc3Q7DQogDQogLyoNCkBAIC02OSw2ICs3MywxOCBAQCBzdHJ1Y3QgY2lw
aGVyX2FsZyB7DQogCSAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBr
ZXlsZW4sIHUzMiAqZmxhZ3MpOw0KIAl2b2lkICgqY2lhX2VuY3J5cHQpKHZv
aWQgKmN0eCwgdTggKmRzdCwgY29uc3QgdTggKnNyYyk7DQogCXZvaWQgKCpj
aWFfZGVjcnlwdCkodm9pZCAqY3R4LCB1OCAqZHN0LCBjb25zdCB1OCAqc3Jj
KTsNCisJc2l6ZV90IGNpYV9tYXhfbmJ5dGVzOw0KKwlzaXplX3QgY2lhX3Jl
cV9hbGlnbjsNCisJdm9pZCAoKmNpYV9lY2IpKHZvaWQgKmN0eCwgdTggKmRz
dCwgY29uc3QgdTggKnNyYywgY29uc3QgdTggKml2LA0KKwkJCXNpemVfdCBu
Ynl0ZXMsIGludCBlbmNkZWMsIGludCBpbnBsYWNlKTsNCisJdm9pZCAoKmNp
YV9jYmMpKHZvaWQgKmN0eCwgdTggKmRzdCwgY29uc3QgdTggKnNyYywgY29u
c3QgdTggKml2LA0KKwkJCXNpemVfdCBuYnl0ZXMsIGludCBlbmNkZWMsIGlu
dCBpbnBsYWNlKTsNCisJdm9pZCAoKmNpYV9jZmIpKHZvaWQgKmN0eCwgdTgg
KmRzdCwgY29uc3QgdTggKnNyYywgY29uc3QgdTggKml2LA0KKwkJCXNpemVf
dCBuYnl0ZXMsIGludCBlbmNkZWMsIGludCBpbnBsYWNlKTsNCisJdm9pZCAo
KmNpYV9vZmIpKHZvaWQgKmN0eCwgdTggKmRzdCwgY29uc3QgdTggKnNyYywg
Y29uc3QgdTggKml2LA0KKwkJCXNpemVfdCBuYnl0ZXMsIGludCBlbmNkZWMs
IGludCBpbnBsYWNlKTsNCisJdm9pZCAoKmNpYV9jdHIpKHZvaWQgKmN0eCwg
dTggKmRzdCwgY29uc3QgdTggKnNyYywgY29uc3QgdTggKml2LA0KKwkJCXNp
emVfdCBuYnl0ZXMsIGludCBlbmNkZWMsIGludCBpbnBsYWNlKTsNCiB9Ow0K
IA0KIHN0cnVjdCBkaWdlc3RfYWxnIHsNCkBAIC0xMjEsNiArMTM3LDExIEBA
IGludCBjcnlwdG9fdW5yZWdpc3Rlcl9hbGcoc3RydWN0IGNyeXB0b18NCiBp
bnQgY3J5cHRvX2FsZ19hdmFpbGFibGUoY29uc3QgY2hhciAqbmFtZSwgdTMy
IGZsYWdzKTsNCiANCiAvKg0KKyAqIEhlbHBlciBmdW5jdGlvbi4NCisgKi8N
Cit2b2lkICpjcnlwdG9fYWxpZ25lZF9rbWFsbG9jIChzaXplX3Qgc2l6ZSwg
aW50IG1vZGUsIHNpemVfdCBhbGlnbm1lbnQsIHZvaWQgKippbmRleCk7DQor
DQorLyoNCiAgKiBUcmFuc2Zvcm1zOiB1c2VyLWluc3RhbnRpYXRlZCBvYmpl
Y3RzIHdoaWNoIGVuY2Fwc3VsYXRlIGFsZ29yaXRobXMNCiAgKiBhbmQgY29y
ZSBwcm9jZXNzaW5nIGxvZ2ljLiAgTWFuYWdlZCB2aWEgY3J5cHRvX2FsbG9j
X3RmbSgpIGFuZA0KICAqIGNyeXB0b19mcmVlX3RmbSgpLCBhcyB3ZWxsIGFz
IHRoZSB2YXJpb3VzIGhlbHBlcnMgYmVsb3cuDQpAQCAtMjU1LDYgKzI3Niwx
OCBAQCBzdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBjcnlwdG9fdGZtX2Fs
DQogCXJldHVybiB0Zm0tPl9fY3J0X2FsZy0+Y3JhX2RpZ2VzdC5kaWFfZGln
ZXN0c2l6ZTsNCiB9DQogDQorc3RhdGljIGlubGluZSB1bnNpZ25lZCBpbnQg
Y3J5cHRvX3RmbV9hbGdfbWF4X25ieXRlcyhzdHJ1Y3QgY3J5cHRvX3RmbSAq
dGZtKQ0KK3sNCisJQlVHX09OKGNyeXB0b190Zm1fYWxnX3R5cGUodGZtKSAh
PSBDUllQVE9fQUxHX1RZUEVfQ0lQSEVSKTsNCisJcmV0dXJuIHRmbS0+X19j
cnRfYWxnLT5jcmFfY2lwaGVyLmNpYV9tYXhfbmJ5dGVzOw0KK30NCisNCitz
dGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBjcnlwdG9fdGZtX2FsZ19yZXFf
YWxpZ24oc3RydWN0IGNyeXB0b190Zm0gKnRmbSkNCit7DQorCUJVR19PTihj
cnlwdG9fdGZtX2FsZ190eXBlKHRmbSkgIT0gQ1JZUFRPX0FMR19UWVBFX0NJ
UEhFUik7DQorCXJldHVybiB0Zm0tPl9fY3J0X2FsZy0+Y3JhX2NpcGhlci5j
aWFfcmVxX2FsaWduOw0KK30NCisNCiAvKg0KICAqIEFQSSB3cmFwcGVycy4N
CiAgKi8NCg0K

--336214560-790098580-1084199282=:27527--
