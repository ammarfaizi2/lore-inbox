Return-Path: <linux-kernel-owner@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S269162AbRGaFZj>; Tue, 31 Jul 2001 01:25:39 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S269178AbRGaFZ3>; Tue, 31 Jul 2001 01:25:29 -0400
Received: from ACAP-DEV.NAS.CMU.EDU ([128.2.6.63]:36356 "EHLO
	acap-dev.nas.cmu.edu") by vger.kernel.org with ESMTP
	id <S269162AbRGaFZR>; Tue, 31 Jul 2001 01:25:17 -0400
Date: Tue, 31 Jul 2001 01:25:06 -0400
Message-Id: <200107310525.f6V5P6HE002271@acap-dev.nas.cmu.edu>
From: Lawrence Greenfield <leg+@andrew.cmu.edu>
X-Mailer: BatIMail version 3.2
To: Matti Aarnio <matti.aarnio@zmailer.org>,
        Rik van Riel <riel@conectiva.com.br>
Cc: linux-kernel@vger.kernel.org, Linus Torvalds <torvalds@transmeta.com>
In-Reply-To: <Pine.LNX.4.33L.0107302219340.5582-100000@duckman.distro.conectiva>
Subject: Re: ext3-2.4-0.9.4
In-Reply-To: <Pine.LNX.4.33L.0107302219340.5582-100000@duckman.distro.conectiva>
Mime-Version: 1.0 (generated by tm-edit 7.106)
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org
Original-Recipient: rfc822;linux-kernel-outgoing

   Date: 	Mon, 30 Jul 2001 22:23:29 -0300 (BRST)
   From: Rik van Riel <riel@conectiva.com.br>
[...]
   > I would definitely prefer:
   >
   >        lsync(dirpath)
[...]
   Nice addition.  Easier to use than fsync() - no need to
   open the file - and probably easier to implement in the
   kernel because this way we'll be handing the whole path
   to the kernel, whereas fsync() would have the dubious
   task of finding out how this file can be traced all the
   way down from the root of the filesystem.

It's not as good as fsync() just doing what it's suppose to do.
You'll force applications that want to issue multiple link()s to issue
multiple lsync()s, forcing the kernel to serialize all of the disk
writes when the application just wants one file (and all of it's
associated filenames) to disk.

Yes, I understand that implementing fsync() so that it syncs all names
to reach the file is difficult.  But if you want the best performance,
you don't want to make applications issue multiple calls each of which
force their own synchronous writes.

Not to mention us whiny application writers won't be happy throwing
lsync()s all over the place.

Larry


