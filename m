Return-Path: <linux-kernel-owner+willy=40w.ods.org-S265162AbUFATgs@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S265162AbUFATgs (ORCPT <rfc822;willy@w.ods.org>);
	Tue, 1 Jun 2004 15:36:48 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S265164AbUFATgs
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Tue, 1 Jun 2004 15:36:48 -0400
Received: from av9-2-sn4.m-sp.skanova.net ([81.228.10.107]:7575 "EHLO
	av9-2-sn4.m-sp.skanova.net") by vger.kernel.org with ESMTP
	id S265162AbUFATge (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Tue, 1 Jun 2004 15:36:34 -0400
Date: Tue, 1 Jun 2004 21:35:45 +0200
From: Peter Lundkvist <p.lundkvist@telia.com>
To: linux-kernel@vger.kernel.org
Subject: Re: 2.6.7-rc2-mm1: compile error in kernel/exit.c
Message-ID: <20040601193545.GA2516@debian>
References: <20040601021539.413a7ad7.akpm@osdl.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20040601021539.413a7ad7.akpm@osdl.org>
User-Agent: Mutt/1.5.5.1+cvs20040105i
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Hello,

When trying to to build with a non-standard setting of HZ
(to get rid of the noise generated by my Dell Inspiron 4000):
--- linux-2.6.7/include/asm-i386/param.h.org    2004-06-01 20:19:03.000000000 +0200
+++ linux-2.6.7/include/asm-i386/param.h        2004-06-01 20:50:45.000000000 +0200
@@ -5 +5 @@
-# define HZ            1000            /* Internal kernel timer frequency */
+# define HZ            100             /* Internal kernel timer frequency */

I get the following error (with current Debian unstable gcc-3.3):

In file included from kernel/exit.c:18:
include/linux/acct.h:168:2: invalid preprocessing directive #elseif
make[2]: *** [kernel/exit.o] Error 1
make[1]: *** [kernel] Error 2

corrected by this patch:

--- linux-2.6.7/include/linux/acct.h.org        2004-06-01 20:19:07.000000000 +0200
+++ linux-2.6.7/include/linux/acct.h    2004-06-01 19:03:43.000000000 +0200
@@ -166,5 +166,6 @@
 #if HZ == AHZ
        /* do nothing */
-#elseif (HZ % AHZ)==0
+#else
+#if (HZ % AHZ)==0
        do_div(x, HZ / AHZ);
 #else
@@ -172,4 +173,5 @@
        do_div(x, HZ);
 #endif
+#endif
        return x;
 }



-- 
Peter Lundkvist
