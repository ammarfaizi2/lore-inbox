Return-Path: <linux-kernel-owner+willy=40w.ods.org-S261853AbVDRHUp@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261853AbVDRHUp (ORCPT <rfc822;willy@w.ods.org>);
	Mon, 18 Apr 2005 03:20:45 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261855AbVDRHUp
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Mon, 18 Apr 2005 03:20:45 -0400
Received: from indonesia.procaptura.com ([193.214.130.21]:47021 "EHLO
	indonesia.procaptura.com") by vger.kernel.org with ESMTP
	id S261853AbVDRHUg (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Mon, 18 Apr 2005 03:20:36 -0400
Message-ID: <42635FB2.8050706@procaptura.com>
Date: Mon, 18 Apr 2005 09:20:18 +0200
From: Toralf Lund <toralf@procaptura.com>
User-Agent: Mozilla Thunderbird 1.0 (X11/20041206)
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: Sam Ravnborg <sam@ravnborg.org>
CC: Arjan van de Ven <arjan@infradead.org>, Greg KH <greg@kroah.com>,
       linux-kernel@vger.kernel.org
Subject: Re: insmod segfault in pci_find_subsys()
References: <423A9B65.1020103@procaptura.com> <20050318170709.GD14952@kroah.com> <42496309.3080007@procaptura.com> <20050413071233.GB25581@kroah.com> <425CFBDA.9040301@procaptura.com> <1113390818.6275.52.camel@laptopd505.fenrus.org> <425D0736.1080105@procaptura.com> <20050413132755.GA8236@mars.ravnborg.org>
In-Reply-To: <20050413132755.GA8236@mars.ravnborg.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Sam Ravnborg wrote:

>On Wed, Apr 13, 2005 at 01:49:10PM +0200, Toralf Lund wrote:
>  
>
>>>      
>>>
>>Yes. As I've (also) already said elsewhere, I knew that, really. The 
>>current build setup fails to do this partly for historical reasons, 
>>partly because the driver also supports different OSes. (And is still 
>>expected to build correctly with Linux 2.4, not just 2.6.)
>>    
>>
>
>  
>
Hmmm. Seems like my original reply to this message got lost...

>Following trick works with both 2.4 and 2.6:
>
>makefile:
>all:
>	$(MAKE) -C Kernel_src_path SUBDIRS=$(PWD) modules
>
>Makefile:
>
>obj-m := mymodule.o
>
>It obtains CFLAGS as expected etc.
>People seems to do their best to avoid such a simple setup :-(
>  
>
What? Write a simple makefile that a normal human being may actually 
understand? Not autogenerate something utterly unreadable from something 
that's autogenerated from something that's ... ???

It's not *quite* that simple with the module I'm talking about, though, 
as the source code is split into several files. Which is a Good Thing, IMO.

Also, I was unsure if this would work with Linux 2.4 (but I was going to 
test it)...

>	Sam
>-
>To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
>the body of a message to majordomo@vger.kernel.org
>More majordomo info at  http://vger.kernel.org/majordomo-info.html
>Please read the FAQ at  http://www.tux.org/lkml/
>  
>

