Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S264325AbTLVGVR (ORCPT <rfc822;willy@w.ods.org>);
	Mon, 22 Dec 2003 01:21:17 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S264329AbTLVGVR
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Mon, 22 Dec 2003 01:21:17 -0500
Received: from zero.voxel.net ([209.123.232.253]:30167 "EHLO zero.voxel.net")
	by vger.kernel.org with ESMTP id S264325AbTLVGUy (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Mon, 22 Dec 2003 01:20:54 -0500
Subject: [PATCH 4/10] CardServices() removal from pcmcia net drivers
From: Andres Salomon <dilinger@voxel.net>
To: linux-kernel@vger.kernel.org
Cc: dahinds@users.sourceforge.net, akpm@osdl.org
Content-Type: multipart/signed; micalg=pgp-sha1; protocol="application/pgp-signature"; boundary="=-6J4KhXwantkaE2T4k0yT"
Message-Id: <1072073038.27831.27.camel@spiral.internal>
Mime-Version: 1.0
X-Mailer: Ximian Evolution 1.4.5 
Date: Mon, 22 Dec 2003 01:12:45 -0500
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org


--=-6J4KhXwantkaE2T4k0yT
Content-Type: multipart/mixed; boundary="=-01AC1FdPOSL9gtj9xP7X"


--=-01AC1FdPOSL9gtj9xP7X
Content-Type: text/plain
Content-Transfer-Encoding: quoted-printable

Part 4 of 10

--=-01AC1FdPOSL9gtj9xP7X
Content-Disposition: attachment; filename=004-cs_remove.patch
Content-Type: text/x-patch; name=004-cs_remove.patch; charset=us-ascii
Content-Transfer-Encoding: base64

UmV2aXNpb246IGxpbnV4LS1tYWlubGluZS0tMi42LS1wYXRjaC0xMw0KQXJjaGl2ZTogZGlsaW5n
ZXJAdm94ZWwubmV0LS0yMDAzLXNwaXJhbA0KQ3JlYXRvcjogQW5kcmVzIFNhbG9tb24gPGRpbGlu
Z2VyQHZveGVsLm5ldD4NCkRhdGU6IFN1biBEZWMgMjEgMTc6NTE6MTkgRVNUIDIwMDMNClN0YW5k
YXJkLWRhdGU6IDIwMDMtMTItMjEgMjI6NTE6MTkgR01UDQpNb2RpZmllZC1maWxlczogZHJpdmVy
cy9uZXQvcGNtY2lhL2libXRyX2NzLmMNCk5ldy1wYXRjaGVzOiBkaWxpbmdlckB2b3hlbC5uZXQt
LTIwMDMtc3BpcmFsL2xpbnV4LS1tYWlubGluZS0tMi42LS1wYXRjaC0xMw0KU3VtbWFyeTogQ2Fy
ZFNlcnZpY2VzIHJlbW92YWwsIHB0LiA0DQpLZXl3b3JkczogDQoNClJlbW92ZSBjYWxscyB0byBD
YXJkU2VydmljZXMoKSwgcGFydCA0OyBpYm10cl9jcy5jLg0KDQoqIGFkZGVkIGZpbGVzDQoNCiAg
ICB7YXJjaH0vbGludXgvbGludXgtLW1haW5saW5lL2xpbnV4LS1tYWlubGluZS0tMi42L2RpbGlu
Z2VyQHZveGVsLm5ldC0tMjAwMy1zcGlyYWwvcGF0Y2gtbG9nL3BhdGNoLTEzDQoNCiogbW9kaWZp
ZWQgZmlsZXMNCg0KLS0tIG9yaWcvZHJpdmVycy9uZXQvcGNtY2lhL2libXRyX2NzLmMNCisrKyBt
b2QvZHJpdmVycy9uZXQvcGNtY2lhL2libXRyX2NzLmMNCkBAIC0yMTQsNyArMjE0LDcgQEANCiAg
ICAgY2xpZW50X3JlZy5ldmVudF9oYW5kbGVyID0gJmlibXRyX2V2ZW50Ow0KICAgICBjbGllbnRf
cmVnLlZlcnNpb24gPSAweDAyMTA7DQogICAgIGNsaWVudF9yZWcuZXZlbnRfY2FsbGJhY2tfYXJn
cy5jbGllbnRfZGF0YSA9IGxpbms7DQotICAgIHJldCA9IENhcmRTZXJ2aWNlcyhSZWdpc3RlckNs
aWVudCwgJmxpbmstPmhhbmRsZSwgJmNsaWVudF9yZWcpOw0KKyAgICByZXQgPSBwY21jaWFfcmVn
aXN0ZXJfY2xpZW50KCZsaW5rLT5oYW5kbGUsICZjbGllbnRfcmVnKTsNCiAgICAgaWYgKHJldCAh
PSAwKSB7DQogICAgICAgICBjc19lcnJvcihsaW5rLT5oYW5kbGUsIFJlZ2lzdGVyQ2xpZW50LCBy
ZXQpOw0KIAlnb3RvIG91dF9kZXRhY2g7DQpAQCAtMjY0LDcgKzI2NCw3IEBADQogICAgIH0NCiAN
CiAgICAgaWYgKGxpbmstPmhhbmRsZSkNCi0gICAgICAgIENhcmRTZXJ2aWNlcyhEZXJlZ2lzdGVy
Q2xpZW50LCBsaW5rLT5oYW5kbGUpOw0KKyAgICAgICAgcGNtY2lhX2RlcmVnaXN0ZXJfY2xpZW50
KGxpbmstPmhhbmRsZSk7DQogDQogICAgIC8qIFVubGluayBkZXZpY2Ugc3RydWN0dXJlLCBmcmVl
IGJpdHMgKi8NCiAgICAgKmxpbmtwID0gbGluay0+bmV4dDsNCkBAIC0yODEsOCArMjgxLDggQEAN
CiANCiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09Ki8NCiANCi0jZGVmaW5lIENTX0NIRUNLKGZuLCBhcmdzLi4uKSBc
DQotd2hpbGUgKChsYXN0X3JldD1DYXJkU2VydmljZXMobGFzdF9mbj0oZm4pLCBhcmdzKSkhPTAp
IGdvdG8gY3NfZmFpbGVkDQorI2RlZmluZSBDU19DSEVDSyhmbiwgcmV0KSBcDQorZG8geyBsYXN0
X2ZuID0gKGZuKTsgaWYgKChsYXN0X3JldCA9IChyZXQpKSAhPSAwKSBnb3RvIGNzX2ZhaWxlZDsg
fSB3aGlsZSAoMCkNCiANCiBzdGF0aWMgdm9pZCBpYm10cl9jb25maWcoZGV2X2xpbmtfdCAqbGlu
aykNCiB7DQpAQCAtMzA0LDkgKzMwNCw5IEBADQogICAgIHR1cGxlLlR1cGxlRGF0YU1heCA9IDY0
Ow0KICAgICB0dXBsZS5UdXBsZU9mZnNldCA9IDA7DQogICAgIHR1cGxlLkRlc2lyZWRUdXBsZSA9
IENJU1RQTF9DT05GSUc7DQotICAgIENTX0NIRUNLKEdldEZpcnN0VHVwbGUsIGhhbmRsZSwgJnR1
cGxlKTsNCi0gICAgQ1NfQ0hFQ0soR2V0VHVwbGVEYXRhLCBoYW5kbGUsICZ0dXBsZSk7DQotICAg
IENTX0NIRUNLKFBhcnNlVHVwbGUsIGhhbmRsZSwgJnR1cGxlLCAmcGFyc2UpOw0KKyAgICBDU19D
SEVDSyhHZXRGaXJzdFR1cGxlLCBwY21jaWFfZ2V0X2ZpcnN0X3R1cGxlKGhhbmRsZSwgJnR1cGxl
KSk7DQorICAgIENTX0NIRUNLKEdldFR1cGxlRGF0YSwgcGNtY2lhX2dldF90dXBsZV9kYXRhKGhh
bmRsZSwgJnR1cGxlKSk7DQorICAgIENTX0NIRUNLKFBhcnNlVHVwbGUsIHBjbWNpYV9wYXJzZV90
dXBsZShoYW5kbGUsICZ0dXBsZSwgJnBhcnNlKSk7DQogICAgIGxpbmstPmNvbmYuQ29uZmlnQmFz
ZSA9IHBhcnNlLmNvbmZpZy5iYXNlOw0KIA0KICAgICAvKiBDb25maWd1cmUgY2FyZCAqLw0KQEAg
LTMxOCwxOCArMzE4LDE4IEBADQogDQogICAgIC8qIFRyeSBQUklNQVJZIGNhcmQgYXQgMHhBMjAt
MHhBMjMgKi8NCiAgICAgbGluay0+aW8uQmFzZVBvcnQxID0gMHhBMjA7DQotICAgIGkgPSBDYXJk
U2VydmljZXMoUmVxdWVzdElPLCBsaW5rLT5oYW5kbGUsICZsaW5rLT5pbyk7DQorICAgIGkgPSBw
Y21jaWFfcmVxdWVzdF9pbyhsaW5rLT5oYW5kbGUsICZsaW5rLT5pbyk7DQogICAgIGlmIChpID09
IENTX1NVQ0NFU1MpIHsNCiAJbWVtY3B5KGluZm8tPm5vZGUuZGV2X25hbWUsICJ0cjBcMCIsIDQp
Ow0KICAgICB9IGVsc2Ugew0KIAkvKiBDb3VsZG4ndCBnZXQgMHhBMjAtMHhBMjMuICBUcnkgQUxU
RVJOQVRFIGF0IDB4QTI0LTB4QTI3LiAqLw0KIAlsaW5rLT5pby5CYXNlUG9ydDEgPSAweEEyNDsN
Ci0JQ1NfQ0hFQ0soUmVxdWVzdElPLCBsaW5rLT5oYW5kbGUsICZsaW5rLT5pbyk7DQorCUNTX0NI
RUNLKFJlcXVlc3RJTywgcGNtY2lhX3JlcXVlc3RfaW8obGluay0+aGFuZGxlLCAmbGluay0+aW8p
KTsNCiAJbWVtY3B5KGluZm8tPm5vZGUuZGV2X25hbWUsICJ0cjFcMCIsIDQpOw0KICAgICB9DQog
ICAgIGRldi0+YmFzZV9hZGRyID0gbGluay0+aW8uQmFzZVBvcnQxOw0KIA0KLSAgICBDU19DSEVD
SyhSZXF1ZXN0SVJRLCBsaW5rLT5oYW5kbGUsICZsaW5rLT5pcnEpOw0KKyAgICBDU19DSEVDSyhS
ZXF1ZXN0SVJRLCBwY21jaWFfcmVxdWVzdF9pcnEobGluay0+aGFuZGxlLCAmbGluay0+aXJxKSk7
DQogICAgIGRldi0+aXJxID0gbGluay0+aXJxLkFzc2lnbmVkSVJROw0KICAgICB0aS0+aXJxID0g
bGluay0+aXJxLkFzc2lnbmVkSVJROw0KICAgICB0aS0+Z2xvYmFsX2ludF9lbmFibGU9R0xPQkFM
X0lOVF9FTkFCTEUrKChkZXYtPmlycT09OSkgPyAyIDogZGV2LT5pcnEpOw0KQEAgLTM0MCwxMiAr
MzQwLDExIEBADQogICAgIHJlcS5CYXNlID0gMDsgDQogICAgIHJlcS5TaXplID0gMHgyMDAwOw0K
ICAgICByZXEuQWNjZXNzU3BlZWQgPSAyNTA7DQotICAgIGxpbmstPndpbiA9ICh3aW5kb3dfaGFu
ZGxlX3QpbGluay0+aGFuZGxlOw0KLSAgICBDU19DSEVDSyhSZXF1ZXN0V2luZG93LCAmbGluay0+
d2luLCAmcmVxKTsNCisgICAgQ1NfQ0hFQ0soUmVxdWVzdFdpbmRvdywgcGNtY2lhX3JlcXVlc3Rf
d2luZG93KCZsaW5rLT5oYW5kbGUsICZyZXEsICZsaW5rLT53aW4pKTsNCiANCiAgICAgbWVtLkNh
cmRPZmZzZXQgPSBtbWlvYmFzZTsNCiAgICAgbWVtLlBhZ2UgPSAwOw0KLSAgICBDU19DSEVDSyhN
YXBNZW1QYWdlLCBsaW5rLT53aW4sICZtZW0pOw0KKyAgICBDU19DSEVDSyhNYXBNZW1QYWdlLCBw
Y21jaWFfbWFwX21lbV9wYWdlKGxpbmstPndpbiwgJm1lbSkpOw0KICAgICB0aS0+bW1pbyA9IGlv
cmVtYXAocmVxLkJhc2UsIHJlcS5TaXplKTsNCiANCiAgICAgLyogQWxsb2NhdGUgdGhlIFNSQU0g
bWVtb3J5IHdpbmRvdyAqLw0KQEAgLTM1NCwxNyArMzUzLDE2IEBADQogICAgIHJlcS5CYXNlID0g
MDsNCiAgICAgcmVxLlNpemUgPSBzcmFtc2l6ZSAqIDEwMjQ7DQogICAgIHJlcS5BY2Nlc3NTcGVl
ZCA9IDI1MDsNCi0gICAgaW5mby0+c3JhbV93aW5faGFuZGxlID0gKHdpbmRvd19oYW5kbGVfdCls
aW5rLT5oYW5kbGU7DQotICAgIENTX0NIRUNLKFJlcXVlc3RXaW5kb3csICZpbmZvLT5zcmFtX3dp
bl9oYW5kbGUsICZyZXEpOw0KKyAgICBDU19DSEVDSyhSZXF1ZXN0V2luZG93LCBwY21jaWFfcmVx
dWVzdF93aW5kb3coJmxpbmstPmhhbmRsZSwgJnJlcSwgJmluZm8tPnNyYW1fd2luX2hhbmRsZSkp
Ow0KIA0KICAgICBtZW0uQ2FyZE9mZnNldCA9IHNyYW1iYXNlOw0KICAgICBtZW0uUGFnZSA9IDA7
DQotICAgIENTX0NIRUNLKE1hcE1lbVBhZ2UsIGluZm8tPnNyYW1fd2luX2hhbmRsZSwgJm1lbSk7
DQorICAgIENTX0NIRUNLKE1hcE1lbVBhZ2UsIHBjbWNpYV9tYXBfbWVtX3BhZ2UoaW5mby0+c3Jh
bV93aW5faGFuZGxlLCAmbWVtKSk7DQogDQogICAgIHRpLT5zcmFtX2Jhc2UgPSBtZW0uQ2FyZE9m
ZnNldCA+PiAxMjsNCiAgICAgdGktPnNyYW1fdmlydCA9ICh1X2xvbmcpaW9yZW1hcChyZXEuQmFz
ZSwgcmVxLlNpemUpOw0KIA0KLSAgICBDU19DSEVDSyhSZXF1ZXN0Q29uZmlndXJhdGlvbiwgbGlu
ay0+aGFuZGxlLCAmbGluay0+Y29uZik7DQorICAgIENTX0NIRUNLKFJlcXVlc3RDb25maWd1cmF0
aW9uLCBwY21jaWFfcmVxdWVzdF9jb25maWd1cmF0aW9uKGxpbmstPmhhbmRsZSwgJmxpbmstPmNv
bmYpKTsNCiANCiAgICAgLyogIFNldCB1cCB0aGUgVG9rZW4tUmluZyBDb250cm9sbGVyIENvbmZp
Z3VyYXRpb24gUmVnaXN0ZXIgYW5kDQogICAgICAgICB0dXJuIG9uIHRoZSBjYXJkLiAgQ2hlY2sg
dGhlICJMb2NhbCBBcmVhIE5ldHdvcmsgQ3JlZGl0IENhcmQNCkBAIC00MTksMTQgKzQxNywxNCBA
QA0KICAgICAgICAgcmV0dXJuOw0KICAgICB9DQogDQotICAgIENhcmRTZXJ2aWNlcyhSZWxlYXNl
Q29uZmlndXJhdGlvbiwgbGluay0+aGFuZGxlKTsNCi0gICAgQ2FyZFNlcnZpY2VzKFJlbGVhc2VJ
TywgbGluay0+aGFuZGxlLCAmbGluay0+aW8pOw0KLSAgICBDYXJkU2VydmljZXMoUmVsZWFzZUlS
USwgbGluay0+aGFuZGxlLCAmbGluay0+aXJxKTsNCisgICAgcGNtY2lhX3JlbGVhc2VfY29uZmln
dXJhdGlvbihsaW5rLT5oYW5kbGUpOw0KKyAgICBwY21jaWFfcmVsZWFzZV9pbyhsaW5rLT5oYW5k
bGUsICZsaW5rLT5pbyk7DQorICAgIHBjbWNpYV9yZWxlYXNlX2lycShsaW5rLT5oYW5kbGUsICZs
aW5rLT5pcnEpOw0KICAgICBpZiAobGluay0+d2luKSB7DQogCXN0cnVjdCB0b2tfaW5mbyAqdGkg
PSBkZXYtPnByaXY7DQogCWlvdW5tYXAoKHZvaWQgKil0aS0+bW1pbyk7DQotCUNhcmRTZXJ2aWNl
cyhSZWxlYXNlV2luZG93LCBsaW5rLT53aW4pOw0KLQlDYXJkU2VydmljZXMoUmVsZWFzZVdpbmRv
dywgaW5mby0+c3JhbV93aW5faGFuZGxlKTsNCisJcGNtY2lhX3JlbGVhc2Vfd2luZG93KGxpbmst
Pndpbik7DQorCXBjbWNpYV9yZWxlYXNlX3dpbmRvdyhpbmZvLT5zcmFtX3dpbl9oYW5kbGUpOw0K
ICAgICB9DQogDQogICAgIGxpbmstPnN0YXRlICY9IH5ERVZfQ09ORklHOw0KQEAgLTQ3NCw3ICs0
NzIsNyBAQA0KICAgICAgICAgaWYgKGxpbmstPnN0YXRlICYgREVWX0NPTkZJRykgew0KICAgICAg
ICAgICAgIGlmIChsaW5rLT5vcGVuKQ0KIAkJbmV0aWZfZGV2aWNlX2RldGFjaChkZXYpOw0KLSAg
ICAgICAgICAgIENhcmRTZXJ2aWNlcyhSZWxlYXNlQ29uZmlndXJhdGlvbiwgbGluay0+aGFuZGxl
KTsNCisgICAgICAgICAgICBwY21jaWFfcmVsZWFzZV9jb25maWd1cmF0aW9uKGxpbmstPmhhbmRs
ZSk7DQogICAgICAgICB9DQogICAgICAgICBicmVhazsNCiAgICAgY2FzZSBDU19FVkVOVF9QTV9S
RVNVTUU6DQpAQCAtNDgyLDcgKzQ4MCw3IEBADQogICAgICAgICAvKiBGYWxsIHRocm91Z2guLi4g
Ki8NCiAgICAgY2FzZSBDU19FVkVOVF9DQVJEX1JFU0VUOg0KICAgICAgICAgaWYgKGxpbmstPnN0
YXRlICYgREVWX0NPTkZJRykgew0KLSAgICAgICAgICAgIENhcmRTZXJ2aWNlcyhSZXF1ZXN0Q29u
ZmlndXJhdGlvbiwgbGluay0+aGFuZGxlLCAmbGluay0+Y29uZik7DQorICAgICAgICAgICAgcGNt
Y2lhX3JlcXVlc3RfY29uZmlndXJhdGlvbihsaW5rLT5oYW5kbGUsICZsaW5rLT5jb25mKTsNCiAg
ICAgICAgICAgICBpZiAobGluay0+b3Blbikgew0KIAkJKGRldi0+aW5pdCkoZGV2KTsNCiAJCW5l
dGlmX2RldmljZV9hdHRhY2goZGV2KTsNCg0KDQoNCi==

--=-01AC1FdPOSL9gtj9xP7X--

--=-6J4KhXwantkaE2T4k0yT
Content-Type: application/pgp-signature; name=signature.asc
Content-Description: This is a digitally signed message part

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)

iD8DBQA/5olO78o9R9NraMQRAiMlAJ9NKlBNP1WTLIKdMPdKyXRfsP1icACgubaa
LcVDVsqeAOe6zyPySJ/gevE=
=1IXE
-----END PGP SIGNATURE-----

--=-6J4KhXwantkaE2T4k0yT--

