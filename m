Return-Path: <linux-kernel-owner@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S129599AbRB0Hlt>; Tue, 27 Feb 2001 02:41:49 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S129602AbRB0Hlj>; Tue, 27 Feb 2001 02:41:39 -0500
Received: from pat.uio.no ([129.240.130.16]:63903 "EHLO pat.uio.no")
	by vger.kernel.org with ESMTP id <S129599AbRB0Hl3>;
	Tue, 27 Feb 2001 02:41:29 -0500
Message-ID: <15003.23067.683600.738764@charged.uio.no>
Date: Tue, 27 Feb 2001 08:41:15 +0100 (CET)
To: "H . J . Lu" <hjl@valinux.com>
Cc: NFS maillist <nfs@lists.sourceforge.net>,
        Linux Kernel <linux-kernel@vger.kernel.org>
Subject: Re: [NFS] Updated patch for the [2.4.x] NFS 'missing directory entry a.k.a. IRIX server' problem...
In-Reply-To: <20010226230647.A14094@valinux.com>
In-Reply-To: <14997.9938.106305.635202@charged.uio.no>
	<20010226152826.A20653@valinux.com>
	<15003.20448.999929.948597@charged.uio.no>
	<20010226230647.A14094@valinux.com>
X-Mailer: VM 6.75 under 21.1 (patch 14) "Cuyahoga Valley" XEmacs Lucid
Reply-To: trond.myklebust@fys.uio.no
From: Trond Myklebust <trond.myklebust@fys.uio.no>
Mime-Version: 1.0 (generated by tm-edit 1.7)
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

>>>>> " " == H J Lu <hjl@valinux.com> writes:

     > I much prefer to have a new getdents system call which will
     > also return d_type so that the 32 bit function in glibc can use
     > this new getdents instead of getdents64.

That could also be done, however it seems odd to be adding a new
32-bit interface after the point when we're supposed to all have moved
to 64 bits.

My concern in presenting that patch is simply that if it is true that
we actually have a well defined interface for passing 32-bit cookies
via getdents64, and if it is true that everybody agrees on this
interface, then NFS has no choice but to try to conform.

Cheers,
   Trond

BTW: does anybody anywhere actually use d_type? Certainly the standard
     utilities such as 'find' or 'ls' don't seem to have been adapted
     yet: I hacked up a version of NFSv3 that actually filled d_type
     (by using readdirplus rather than readdir) but I've yet to find
     any 'off the shelf' software, that uses the extra information.
