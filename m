Return-Path: <linux-kernel-owner+willy=40w.ods.org-S262129AbUEFM65@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S262129AbUEFM65 (ORCPT <rfc822;willy@w.ods.org>);
	Thu, 6 May 2004 08:58:57 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S262109AbUEFM64
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Thu, 6 May 2004 08:58:56 -0400
Received: from mx1.redhat.com ([66.187.233.31]:65409 "EHLO mx1.redhat.com")
	by vger.kernel.org with ESMTP id S262129AbUEFM6b (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Thu, 6 May 2004 08:58:31 -0400
From: David Howells <dhowells@redhat.com>
In-Reply-To: <20040506131846.A29621@flint.arm.linux.org.uk> 
References: <20040506131846.A29621@flint.arm.linux.org.uk>  <4955.1083844733@redhat.com> 
To: Russell King <rmk+lkml@arm.linux.org.uk>
Cc: torvalds@osdl.org, akpm@osdl.org, linux-kernel@vger.kernel.org
Subject: Re: [PATCH] get rid of "+m" constraint in i386 rwsems 
User-Agent: EMH/1.14.1 SEMI/1.14.4 (Hosorogi) FLIM/1.14.5 (Demachiyanagi) APEL/10.6 Emacs/21.3 (i386-redhat-linux-gnu) MULE/5.0 (SAKAKI)
MIME-Version: 1.0 (generated by SEMI 1.14.4 - "Hosorogi")
Content-Type: text/plain; charset=US-ASCII
Date: Thu, 06 May 2004 13:58:16 +0100
Message-ID: <5170.1083848296@redhat.com>
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org


> Can you explain the need for the change?

gcc-3.4 generates warnings about it:

include/asm/rwsem.h: In function `avc_audit':
include/asm/rwsem.h:126: warning: read-write constraint does not allow a register
include/asm/rwsem.h:126: warning: read-write constraint does not allow a register

The gcc people (or at least one of them) seem to think that these warnings are
correct on a "+m" constraint. See:

	http://marc.theaimsgroup.com/?l=linux-kernel&m=107475162200773&w=2

I understood "+m" to be a shorthand way of specifying "=m" and "m" on the same
bit of memory, but apparently it that's not what it means.

David
