Return-Path: <linux-kernel-owner+willy=40w.ods.org-S267702AbUHPQfW@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S267702AbUHPQfW (ORCPT <rfc822;willy@w.ods.org>);
	Mon, 16 Aug 2004 12:35:22 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S267766AbUHPQfW
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Mon, 16 Aug 2004 12:35:22 -0400
Received: from omx1-ext.sgi.com ([192.48.179.11]:45290 "EHLO
	omx1.americas.sgi.com") by vger.kernel.org with ESMTP
	id S267702AbUHPQcx (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Mon, 16 Aug 2004 12:32:53 -0400
Date: Mon, 16 Aug 2004 11:32:49 -0500
From: Erik Jacobson <erikj@subway.americas.sgi.com>
To: linux-kernel@vger.kernel.org
Subject: [PATCH] Process Aggregates for 2.6.8
Message-ID: <Pine.SGI.4.53.0408161127580.663457@subway.americas.sgi.com>
MIME-Version: 1.0
Content-Type: MULTIPART/MIXED; BOUNDARY="-2136806248-603613444-1092673969=:663457"
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.
  Send mail to mime@docserver.cac.washington.edu for more info.

---2136806248-603613444-1092673969=:663457
Content-Type: TEXT/PLAIN; charset=US-ASCII

This is a fresh PAGG patch that applies cleanly to 2.6.8.

There have been no major changes since the last PAGG patch I posted.

--
Erik Jacobson - Linux System Software - Silicon Graphics - Eagan, Minnesota
---2136806248-603613444-1092673969=:663457
Content-Type: TEXT/PLAIN; charset=US-ASCII; name=pagg
Content-Transfer-Encoding: BASE64
Content-ID: <Pine.SGI.4.53.0408161132490.663457@subway.americas.sgi.com>
Content-Description: 
Content-Disposition: attachment; filename=pagg

SW5kZXg6IGxpbnV4L0RvY3VtZW50YXRpb24vcGFnZy50eHQNCj09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0NCi0tLSAvZGV2L251bGwJMTk3MC0wMS0wMSAwMDow
MDowMC4wMDAwMDAwMDAgKzAwMDANCisrKyBsaW51eC9Eb2N1bWVudGF0aW9u
L3BhZ2cudHh0CTIwMDQtMDgtMTYgMTA6NDE6MjMuMDAwMDAwMDAwIC0wNTAw
DQpAQCAtMCwwICsxLDMyIEBADQorTGludXggUHJvY2VzcyBBZ2dyZWdhdGVz
IChQQUdHKQ0KKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCisN
CitUaGUgcHJvY2VzcyBhZ2dyZWdhdGVzIGluZnJhc3RydWN0dXJlLCBvciBQ
QUdHLCBwcm92aWRlcyBhIGdlbmVyYWxpemVkDQorbWVjaGFuaXNtIGZvciBw
cm92aWRpbmcgYXJiaXRyYXJ5IHByb2Nlc3MgZ3JvdXBzIGluIExpbnV4LiAg
UEFHRyBjb25zaXN0cw0KK29mIGEgc2VyaWVzIG9mIGZ1bmN0aW9ucyBmb3Ig
cmVnaXN0ZXJpbmcgYW5kIHVucmVnaXN0ZXJpbmcgc3VwcG9ydA0KK2ZvciBu
ZXcgdHlwZXMgb2YgcHJvY2VzcyBhZ2dyZWdhdGlvbiBjb250YWluZXJzIHdp
dGggdGhlIGtlcm5lbC4NCitUaGlzIGlzIHNpbWlsYXIgdG8gdGhlIHN1cHBv
cnQgY3VycmVudGx5IHByb3ZpZGVkIHdpdGhpbiBMaW51eCB0aGF0DQorYWxs
b3dzIGZvciBkeW5hbWljIHN1cHBvcnQgb2YgZmlsZXN5c3RlbXMsIGJsb2Nr
IGFuZCBjaGFyYWN0ZXIgZGV2aWNlcywNCitzeW1ib2wgdGFibGVzLCBuZXR3
b3JrIGRldmljZXMsIHNlcmlhbCBkZXZpY2VzLCBhbmQgZXhlY3V0aW9uIGRv
bWFpbnMuDQorVGhpcyBpbXBsZW1lbnRhdGlvbiBvZiBQQUdHIHByb3ZpZGVz
IGRldmVsb3BlcnMgdGhlIGJhc2ljIGhvb2tzIG5lY2Vzc2FyeQ0KK3RvIGlt
cGxlbWVudCBrZXJuZWwgbW9kdWxlcyBmb3Igc3BlY2lmaWMgcHJvY2VzcyBj
b250YWluZXJzLCBzdWNoIGFzDQordGhlIGpvYiBjb250YWluZXIuDQorDQor
VGhlIGRvX2ZvcmsgZnVuY3Rpb24gaW4gdGhlIGtlcm5lbCB3YXMgYWx0ZXJl
ZCB0byBzdXBwb3J0IFBBR0cuICBJZiBhDQorcHJvY2VzcyBpcyBhdHRhY2hl
ZCB0byBhbnkgUEFHRyBjb250YWluZXJzIGFuZCBzdWJzZXF1ZW50bHkgZm9y
a3MgYQ0KK2NoaWxkIHByb2Nlc3MsIHRoZSBjaGlsZCBwcm9jZXNzIHdpbGwg
YWxzbyBiZSBhdHRhY2hlZCB0byB0aGUgc2FtZSBQQUdHDQorY29udGFpbmVy
cy4gIFRoZSBQQUdHIGNvbnRhaW5lcnMgaW52b2x2ZWQgZHVyaW5nIHRoZSBm
b3JrIGFyZSBub3RpZmllZA0KK3RoYXQgYSBuZXcgcHJvY2VzcyBoYXMgYmVl
biBhdHRhY2hlZC4gIFRoZSBub3RpZmljYXRpb24gaXMgYWNjb21wbGlzaGVk
DQordmlhIGEgY2FsbGJhY2sgZnVuY3Rpb24gcHJvdmlkZWQgYnkgdGhlIFBB
R0cgbW9kdWxlLg0KKw0KK1RoZSBkb19leGl0IGZ1bmN0aW9uIGluIHRoZSBr
ZXJuZWwgaGFzIGFsc28gYmVlbiBhbHRlcmVkLiAgSWYgYSBwcm9jZXNzDQor
aXMgYXR0YWNoZWQgdG8gYW55IFBBR0cgY29udGFpbmVycyBhbmQgdGhhdCBw
cm9jZXNzIGlzIGV4aXRpbmcsIHRoZSBQQUdHDQorY29udGFpbmVycyBhcmUg
bm90aWZpZWQgdGhhdCBhIHByb2Nlc3MgaGFzIGRldGFjaGVkIGZyb20gdGhl
IGNvbnRhaW5lci4NCitUaGUgbm90aWZpY2F0aW9uIGlzIGFjY29tcGxpc2hl
ZCB2aWEgYSBjYWxsYmFjayBmdW5jdGlvbiBwcm92aWRlZCBieQ0KK3RoZSBQ
QUdHIG1vZHVsZS4NCisNCitUaGUgc3lzX2V4ZWN2ZSBmdW5jdGlvbiBoYXMg
YmVlbiBtb2RpZmllZCB0byBzdXBwb3J0IGFuIG9wdGlvbmFsIGNhbGxvdXQN
Cit0aGF0IGNhbiBiZSBydW4gd2hlbiBhIHByb2Nlc3MgaW4gYSBwYWdnIGxp
c3QgZG9lcyBhbiBleGVjLiAgSXQgY2FuIGJlIA0KK3VzZWQsIGZvciBleGFt
cGxlLCBieSBvdGhlciBrZXJuZWwgbW9kdWxlcyB0aGF0IHdpc2ggdG8gZG8g
YWR2YW5jZWQgQ1BVDQorcGxhY2VtZW50IG9uIG11bHRpLXByb2Nlc3NvciBz
eXN0ZW1zIChqdXN0IG9uZSBleGFtcGxlKS4NCisNCkluZGV4OiBsaW51eC9m
cy9leGVjLmMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCi0tLSBsaW51eC5v
cmlnL2ZzL2V4ZWMuYwkyMDA0LTA4LTE0IDAwOjM2OjU2LjAwMDAwMDAwMCAt
MDUwMA0KKysrIGxpbnV4L2ZzL2V4ZWMuYwkyMDA0LTA4LTE2IDEwOjQxOjIz
LjAwMDAwMDAwMCAtMDUwMA0KQEAgLTQ2LDYgKzQ2LDcgQEANCiAjaW5jbHVk
ZSA8bGludXgvc2VjdXJpdHkuaD4NCiAjaW5jbHVkZSA8bGludXgvc3lzY2Fs
bHMuaD4NCiAjaW5jbHVkZSA8bGludXgvcm1hcC5oPg0KKyNpbmNsdWRlIDxs
aW51eC9wYWdnLmg+DQogDQogI2luY2x1ZGUgPGFzbS91YWNjZXNzLmg+DQog
I2luY2x1ZGUgPGFzbS9tbXVfY29udGV4dC5oPg0KQEAgLTExNDAsNiArMTE0
MSw3IEBADQogCXJldHZhbCA9IHNlYXJjaF9iaW5hcnlfaGFuZGxlcigmYnBy
bSxyZWdzKTsNCiAJaWYgKHJldHZhbCA+PSAwKSB7DQogCQlmcmVlX2FyZ19w
YWdlcygmYnBybSk7DQorCQlwYWdnX2V4ZWMoY3VycmVudCk7DQogDQogCQkv
KiBleGVjdmUgc3VjY2VzcyAqLw0KIAkJc2VjdXJpdHlfYnBybV9mcmVlKCZi
cHJtKTsNCkluZGV4OiBsaW51eC9pbmNsdWRlL2xpbnV4L2luaXRfdGFzay5o
DQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09DQotLS0gbGludXgub3JpZy9pbmNs
dWRlL2xpbnV4L2luaXRfdGFzay5oCTIwMDQtMDgtMTQgMDA6MzY6MTYuMDAw
MDAwMDAwIC0wNTAwDQorKysgbGludXgvaW5jbHVkZS9saW51eC9pbml0X3Rh
c2suaAkyMDA0LTA4LTE2IDEwOjQxOjIzLjAwMDAwMDAwMCAtMDUwMA0KQEAg
LTIsNiArMiw3IEBADQogI2RlZmluZSBfTElOVVhfX0lOSVRfVEFTS19IDQog
DQogI2luY2x1ZGUgPGxpbnV4L2ZpbGUuaD4NCisjaW5jbHVkZSA8bGludXgv
cGFnZy5oPg0KIA0KICNkZWZpbmUgSU5JVF9GSUxFUyBcDQogeyAJCQkJCQkJ
XA0KQEAgLTExMiw2ICsxMTMsNyBAQA0KIAkucHJvY19sb2NrCT0gU1BJTl9M
T0NLX1VOTE9DS0VELAkJCQlcDQogCS5zd2l0Y2hfbG9jawk9IFNQSU5fTE9D
S19VTkxPQ0tFRCwJCQkJXA0KIAkuam91cm5hbF9pbmZvCT0gTlVMTCwJCQkJ
CQlcDQorCUlOSVRfVEFTS19QQUdHKHRzaykJCQkJCQlcDQogfQ0KIA0KIA0K
SW5kZXg6IGxpbnV4L2luY2x1ZGUvbGludXgvcGFnZy5oDQo9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09DQotLS0gL2Rldi9udWxsCTE5NzAtMDEtMDEgMDA6MDA6
MDAuMDAwMDAwMDAwICswMDAwDQorKysgbGludXgvaW5jbHVkZS9saW51eC9w
YWdnLmgJMjAwNC0wOC0xNiAxMDo0MToyMy4wMDAwMDAwMDAgLTA1MDANCkBA
IC0wLDAgKzEsMjAyIEBADQorLyogDQorICogUEFHRyAoUHJvY2VzcyBBZ2dy
ZWdhdGVzKSBpbnRlcmZhY2UNCisgKg0KKyAqIA0KKyAqIENvcHlyaWdodCAo
YykgMjAwMC0yMDAyLCAyMDA0IFNpbGljb24gR3JhcGhpY3MsIEluYy4gIEFs
bCBSaWdodHMgUmVzZXJ2ZWQuDQorICoNCisgKiBUaGlzIHByb2dyYW0gaXMg
ZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29y
IG1vZGlmeQ0KKyAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdl
bmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5DQorICogdGhl
IEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBv
ZiB0aGUgTGljZW5zZSwgb3INCisgKiAoYXQgeW91ciBvcHRpb24pIGFueSBs
YXRlciB2ZXJzaW9uLg0KKyAqDQorICogVGhpcyBwcm9ncmFtIGlzIGRpc3Ry
aWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsDQor
ICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhl
IGltcGxpZWQgd2FycmFudHkgb2YNCisgKiBNRVJDSEFOVEFCSUxJVFkgb3Ig
RklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlDQor
ICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWls
cy4NCisgKg0KKyAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkg
b2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlDQorICogYWxvbmcg
d2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgd3JpdGUgdG8gdGhlIEZyZWUg
U29mdHdhcmUNCisgKiBGb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUgUGxh
Y2UsIFN1aXRlIDMzMCwgQm9zdG9uLCBNQSAwMjExMS0xMzA3IFVTQQ0KKyAq
DQorICoNCisgKiBDb250YWN0IGluZm9ybWF0aW9uOiAgU2lsaWNvbiBHcmFw
aGljcywgSW5jLiwgMTUwMCBDcml0dGVuZGVuIExhbmUsDQorICogTW91bnRh
aW4gVmlldywgQ0EgIDk0MDQzLCBvcjoNCisgKiANCisgKiBodHRwOi8vd3d3
LnNnaS5jb20gDQorICogDQorICogRm9yIGZ1cnRoZXIgaW5mb3JtYXRpb24g
cmVnYXJkaW5nIHRoaXMgbm90aWNlLCBzZWU6IA0KKyAqIA0KKyAqIGh0dHA6
Ly9vc3Muc2dpLmNvbS9wcm9qZWN0cy9HZW5JbmZvL05vdGljZUV4cGxhbg0K
KyAqLw0KKw0KKy8qDQorICogRGF0YSBzdHJ1Y3R1cmUgZGVmaW5pdGlvbnMg
YW5kIGZ1bmN0aW9uIHByb3RvdHlwZXMgdXNlZCB0byBpbXBsZW1lbnQNCisg
KiBwcm9jZXNzIGFnZ3JlZ2F0ZXMgKHBhZ2dzKS4NCisgKg0KKyAqIFBhZ2dz
IHByb3ZpZGVzIGEgZ2VuZXJhbGl6ZWQgd2F5IHRvIGltcGxlbWVudCBwcm9j
ZXNzIGdyb3VwaW5ncyBvcg0KKyAqIGNvbnRhaW5lcnMuICBNb2R1bGVzIHVz
ZSB0aGVzZSBmdW5jdGlvbnMgdG8gcmVnaXN0ZXIgd2l0aCB0aGUga2VybmVs
IGFzDQorICogcHJvdmlkZXJzIG9mIHByb2Nlc3MgYWdncmVnYXRpb24gY29u
dGFpbmVycy4gVGhlIHBhZ2cgZGF0YSBzdHJ1Y3R1cmVzDQorICogZGVmaW5l
IHRoZSBjYWxsYmFjayBmdW5jdGlvbnMgYW5kIGRhdGEgYWNjZXNzIHBvaW50
ZXJzIGJhY2sgaW50byB0aGUNCisgKiBwYWdnIG1vZHVsZXMuDQorICovDQor
DQorI2lmbmRlZiBfTElOVVhfUEFHR19IDQorI2RlZmluZSBfTElOVVhfUEFH
R19IDQorDQorI2luY2x1ZGUgPGxpbnV4L3NjaGVkLmg+DQorDQorI2lmZGVm
IENPTkZJR19QQUdHDQorDQorI2RlZmluZSBQQUdHX05BTUVMTgkzMgkJLyog
TWF4IGNoYXJzIGluIFBBR0cgbW9kdWxlIG5hbWUgKi8NCisNCisNCisvKioN
CisgKiBJTklUX1BBR0dfTElTVCAtIHVzZWQgdG8gaW5pdGlhbGl6ZSBhIHBh
Z2dfbGlzdCBzdHJ1Y3R1cmUgYWZ0ZXIgZGVjbGFyYXRpb24gDQorICogQF9s
OiBUYXNrIHN0cnVjdCB0byBpbml0IHRoZSBwYWdnX2xpc3QgYW5kIHNlbWFw
aG9yZSBpbg0KKyAqIA0KKyAqLw0KKyNkZWZpbmUgSU5JVF9QQUdHX0xJU1Qo
X2wpCQkJCQkJXA0KK2RvIHsJCQkJCQkJCQlcDQorCUlOSVRfTElTVF9IRUFE
KCYoX2wpLT5wYWdnX2xpc3QpOwkJCQkJXA0KKwlpbml0X3J3c2VtKCYoX2wp
LT5wYWdnX3NlbSk7CQkJCQkJXA0KK30gd2hpbGUoMCkNCisJDQorDQorLyoN
CisgKiBVc2VkIGJ5IHRhc2tfc3RydWN0IHRvIG1hbmFnZSBsaXN0IG9mIHBh
Z2cgYXR0YWNobWVudHMgZm9yIHRoZSBwcm9jZXNzLiAgDQorICogRWFjaCBw
YWdnIHByb3ZpZGVzIHRoZSBsaW5rIGJldHdlZW4gdGhlIHByb2Nlc3MgYW5k
IHRoZSANCisgKiBjb3JyZWN0IHBhZ2cgY29udGFpbmVyLg0KKyAqDQorICog
U1RSVUNUIE1FTUJFUlM6DQorICogICAgIGhvb2s6CVJlZmVyZW5jZSB0byBw
YWdnIG1vZHVsZSBzdHJ1Y3R1cmUuICBUaGF0IHN0cnVjdA0KKyAqICAgICAJ
CWhvbGRzIHRoZSBuYW1lIGtleSBhbmQgZnVuY3Rpb24gcG9pbnRlcnMuDQor
ICogICAgIGRhdGE6CU9wYXF1ZSBkYXRhIHBvaW50ZXIgLSBkZWZpbmVkIGJ5
IHBhZ2cgbW9kdWxlcy4NCisgKiAgICAgZW50cnk6CUxpc3QgcG9pbnRlcnMN
CisgKi8NCitzdHJ1Y3QgcGFnZyB7DQorICAgICAgIHN0cnVjdCBwYWdnX2hv
b2sJKmhvb2s7DQorICAgICAgIHZvaWQJCSpkYXRhOw0KKyAgICAgICBzdHJ1
Y3QgbGlzdF9oZWFkCWVudHJ5Ow0KK307DQorDQorLyoNCisgKiBVc2VkIGJ5
IHBhZ2cgbW9kdWxlcyB0byBkZWZpbmUgdGhlIGNhbGxiYWNrIGZ1bmN0aW9u
cyBpbnRvIHRoZSANCisgKiBtb2R1bGUuDQorICoNCisgKiBTVFJVQ1QgTUVN
QkVSUzoNCisgKiAgICAgbmFtZTogICAgICAgICAgIFRoZSBuYW1lIG9mIHRo
ZSBwYWdnIGNvbnRhaW5lciB0eXBlIHByb3ZpZGVkIGJ5DQorICogICAgICAg
ICAgICAgICAgICAgICB0aGUgbW9kdWxlLiBUaGlzIHdpbGwgYmUgc2V0IGJ5
IHRoZSBwYWdnIG1vZHVsZS4NCisgKiAgICAgYXR0YWNoOiAgICAgICAgIEZ1
bmN0aW9uIHBvaW50ZXIgdG8gZnVuY3Rpb24gdXNlZCB3aGVuIGF0dGFjaGlu
Zw0KKyAqICAgICAgICAgICAgICAgICAgICAgYSBwcm9jZXNzIHRvIHRoZSBw
YWdnIGNvbnRhaW5lciByZWZlcmVuY2VkIGJ5IA0KKyAqICAgICAgICAgICAg
ICAgICAgICAgdGhpcyBzdHJ1Y3QuDQorICogICAgIGRldGFjaDogICAgICAg
ICBGdW5jdGlvbiBwb2ludGVyIHRvIGZ1bmN0aW9uIHVzZWQgd2hlbiBkZXRh
Y2hpbmcNCisgKiAgICAgICAgICAgICAgICAgICAgIGEgcHJvY2VzcyB0byB0
aGUgcGFnZyBjb250YWluZXIgcmVmZXJlbmNlZCBieSANCisgKiAgICAgICAg
ICAgICAgICAgICAgIHRoaXMgc3RydWN0Lg0KKyAqICAgICBpbml0OiAgICAg
ICAgICAgRnVuY3Rpb24gcG9pbnRlciB0byBpbml0aWFsaXphdGlvbiBmdW5j
dGlvbi4gIFRoaXMNCisgKiAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9u
IGlzIHVzZWQgd2hlbiB0aGUgbW9kdWxlIGlzIGxvYWRlZCB0byBhdHRhY2gN
CisgKiAgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nIHByb2Nlc3NlcyB0
byBhIGRlZmF1bHQgY29udGFpbmVyIGFzIGRlZmluZWQgYnkNCisgKiAgICAg
ICAgICAgICAgICAgICAgIHRoZSBwYWdnIG1vZHVsZS4gVGhpcyBpcyBvcHRp
b25hbCBhbmQgbWF5IGJlIHNldCB0byANCisgKiAgICAgICAgICAgICAgICAg
ICAgIE5VTEwgaWYgaXQgaXMgbm90IG5lZWRlZCBieSB0aGUgcGFnZyBtb2R1
bGUuDQorICogICAgIGRhdGE6ICAgICAgICAgICBPcGFxdWUgZGF0YSBwb2lu
dGVyIC0gZGVmaW5lZCBieSBwYWdnIG1vZHVsZXMuDQorICogICAgIG1vZHVs
ZTogICAgICAgICBQb2ludGVyIHRvIGtlcm5lbCBtb2R1bGUgc3RydWN0LiAg
VXNlZCB0byBpbmNyZW1lbnQgJiANCisgKiAgICAgICAgICAgICAgICAgICAg
IGRlY3JlbWVudCB0aGUgdXNlIGNvdW50IGZvciB0aGUgbW9kdWxlLg0KKyAq
ICAgICBlbnRyeToJICAgICAgIExpc3QgcG9pbnRlcnMNCisgKiAgICAgZXhl
YzogICAgICAgICAgIEZ1bmN0aW9uIHBvaW50ZXIgdG8gZnVuY3Rpb24gdXNl
ZCB3aGVuIGEgcHJvY2Vzcw0KKyAqICAgICAgICAgICAgICAgICAgICAgaW4g
dGhlIHBhZ2cgY29udGFpbmVyIGV4ZWMncyBhIG5ldyBwcm9jZXNzLiBUaGlz
DQorICogICAgICAgICAgICAgICAgICAgICBpcyBvcHRpb25hbCBhbmQgbWF5
IGJlIHNldCB0byBOVUxMIGlmIGl0IGlzIG5vdCANCisgKiAgICAgICAgICAg
ICAgICAgICAgIG5lZWRlZCBieSB0aGUgcGFnZyBtb2R1bGUuDQorICogICAg
IHJlZmNudDogICAgICAgICBLZWVwIHRyYWNrIG9mIHVzZXIgY291bnQgb2Yg
dGhlIHBhZ2cgaG9vaw0KKyAqLw0KK3N0cnVjdCBwYWdnX2hvb2sgew0KKyAg
ICAgICBzdHJ1Y3QgbW9kdWxlCSptb2R1bGU7DQorICAgICAgIGNoYXIJCSpu
YW1lOwkvKiBOYW1lIEtleSAtIHJlc3RyaWN0ZWQgdG8gMzIgY2hhcmFjdGVy
cyAqLw0KKyAgICAgICB2b2lkCQkqZGF0YTsJLyogT3BhcXVlIG1vZHVsZSBz
cGVjaWZpYyBkYXRhICovDQorICAgICAgIHN0cnVjdCBsaXN0X2hlYWQJZW50
cnk7CS8qIExpc3QgcG9pbnRlcnMgKi8NCisJCSBhdG9taWNfdCByZWZjbnQ7
IC8qIHVzYWdlIGNvdW50ZXIgKi8NCisgICAgICAgaW50CQkoKmluaXQpKHN0
cnVjdCB0YXNrX3N0cnVjdCAqLCBzdHJ1Y3QgcGFnZyAqKTsNCisgICAgICAg
aW50CQkoKmF0dGFjaCkoc3RydWN0IHRhc2tfc3RydWN0ICosIHN0cnVjdCBw
YWdnICosIHZvaWQqKTsNCisgICAgICAgdm9pZAkJKCpkZXRhY2gpKHN0cnVj
dCB0YXNrX3N0cnVjdCAqLCBzdHJ1Y3QgcGFnZyAqKTsNCisgICAgICAgdm9p
ZAkJKCpleGVjKShzdHJ1Y3QgdGFza19zdHJ1Y3QgKiwgc3RydWN0IHBhZ2cg
Kik7DQorfTsNCisNCisNCisvKiBLZXJuZWwgc2VydmljZSBmdW5jdGlvbnMg
Zm9yIHByb3ZpZGluZyBQQUdHIHN1cHBvcnQgKi8NCitleHRlcm4gc3RydWN0
IHBhZ2cgKnBhZ2dfZ2V0KHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFzaywgY2hh
ciAqa2V5KTsNCitleHRlcm4gc3RydWN0IHBhZ2cgKnBhZ2dfYWxsb2Moc3Ry
dWN0IHRhc2tfc3RydWN0ICp0YXNrLCANCisJCQkgICAgICAgc3RydWN0IHBh
Z2dfaG9vayAqcHQpOw0KK2V4dGVybiB2b2lkIHBhZ2dfZnJlZShzdHJ1Y3Qg
cGFnZyAqcGFnZyk7DQorZXh0ZXJuIGludCBwYWdnX2hvb2tfcmVnaXN0ZXIo
c3RydWN0IHBhZ2dfaG9vayAqcHRfbmV3KTsNCitleHRlcm4gaW50IHBhZ2df
aG9va191bnJlZ2lzdGVyKHN0cnVjdCBwYWdnX2hvb2sgKnB0X29sZCk7DQor
ZXh0ZXJuIHZvaWQgX19wYWdnX2F0dGFjaChzdHJ1Y3QgdGFza19zdHJ1Y3Qg
KnRvX3Rhc2ssIA0KKwkJCSBzdHJ1Y3QgdGFza19zdHJ1Y3QgKmZyb21fdGFz
ayk7DQorZXh0ZXJuIHZvaWQgX19wYWdnX2RldGFjaChzdHJ1Y3QgdGFza19z
dHJ1Y3QgKnRhc2spOw0KK2V4dGVybiBpbnQgX19wYWdnX2V4ZWMoc3RydWN0
IHRhc2tfc3RydWN0ICp0YXNrKTsNCisNCisvKioNCisgKiBwYWdnX2F0dGFj
aCAtIGNoaWxkIGluaGVyaXRzIGF0dGFjaG1lbnQgdG8gcGFnZyBjb250YWlu
ZXJzIG9mIGl0cyBwYXJlbnQNCisgKiBAY2hpbGQ6IGNoaWxkIHRhc2sgLSB0
byBpbmhlcml0DQorICogQHBhcmVudDogcGFyZW5ldCB0YXNrIC0gY2hpbGQg
aW5oZXJpdHMgcGFnZyBjb250YWluZXJzIGZyb20gdGhpcyBwYXJlbnQNCisg
KiANCisgKiBmdW5jdGlvbiB1c2VkIHdoZW4gYSBjaGlsZCBwcm9jZXNzIG11
c3QgaW5oZXJpdCBhdHRhY2htZW50IHRvIHBhZ2cNCisgKiBjb250YWluZXJz
IGZyb20gdGhlIHBhcmVudC4NCisgKg0KKyAqLw0KK3N0YXRpYyBpbmxpbmUg
dm9pZCBwYWdnX2F0dGFjaChzdHJ1Y3QgdGFza19zdHJ1Y3QgKmNoaWxkLCAN
CisJCQkgICAgICBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnBhcmVudCkNCit7DQor
CUlOSVRfUEFHR19MSVNUKGNoaWxkKTsNCisJaWYgKCFsaXN0X2VtcHR5KCZw
YXJlbnQtPnBhZ2dfbGlzdCkpDQorCQlfX3BhZ2dfYXR0YWNoKGNoaWxkLCBw
YXJlbnQpOw0KKwlyZXR1cm47DQorfQ0KKw0KKw0KKy8qKg0KKyAqIHBhZ2df
ZGV0YWNoIC0gRGV0YWNoIGEgcHJvY2VzcyBmcm9tIGEgcGFnZyBjb250YWlu
ZXIgaXQgaXMgYSBtZW1iZXIgb2YNCisgKiBAdGFzazogVGhlIHRhc2sgdGhl
IHBhZ2cgd2lsbCBiZSBkZXRhY2hlZCBmcm9tDQorICoNCisgKi8NCitzdGF0
aWMgaW5saW5lIHZvaWQgcGFnZ19kZXRhY2goc3RydWN0IHRhc2tfc3RydWN0
ICp0YXNrKQ0KK3sNCisJaWYgKCFsaXN0X2VtcHR5KCZ0YXNrLT5wYWdnX2xp
c3QpKQ0KKwkJX19wYWdnX2RldGFjaCh0YXNrKTsNCit9DQorDQorLyoqDQor
ICogcGFnZ19leGVjIC0gVXNlZCB3aGVuIGEgcHJvY2VzcyBleGVjJ3MNCisg
KiBAdGFzazogVGhlIHByb2Nlc3MgZG9pbmcgdGhlIGV4ZWMNCisgKg0KKyAq
Lw0KK3N0YXRpYyBpbmxpbmUgdm9pZCBwYWdnX2V4ZWMoc3RydWN0IHRhc2tf
c3RydWN0ICp0YXNrKQ0KK3sNCisJaWYgKCFsaXN0X2VtcHR5KCZ0YXNrLT5w
YWdnX2xpc3QpKQ0KKwkJX19wYWdnX2V4ZWModGFzayk7DQorfQ0KKw0KKy8q
KiANCisgKiBJTklUX1RBU0tfUEFHRyAtIFVzZWQgaW4gSU5JVF9UQVNLIHRv
IHNldCB0aGUgaGVhZCBhbmQgc2VtIG9mIHBhZ2dfbGlzdA0KKyAqIEB0c2s6
IFRoZSB0YXNrIHdvcmsgd2l0aA0KKyAqDQorICogTWFyY28gVXNlZCBpbiBJ
TklUX1RBU0sgdG8gc2V0IHRoZSBoZWFkIGFuZCBzZW0gb2YgcGFnZ19saXN0
Lg0KKyAqIElmIENPTkZJR19QQUdHIGlzIG9mZiwgaXQgaXMgZGVmaW5lZCBh
cyBhbiBlbXB0eSBtYWNybyBiZWxvdy4NCisgKg0KKyAqLw0KKyNkZWZpbmUg
SU5JVF9UQVNLX1BBR0codHNrKSBcDQorCS5wYWdnX2xpc3QgPSBMSVNUX0hF
QURfSU5JVCh0c2sucGFnZ19saXN0KSwgICAgIFwNCisJLnBhZ2dfc2VtICA9
IF9fUldTRU1fSU5JVElBTElaRVIodHNrLnBhZ2dfc2VtKSAgDQorDQorI2Vs
c2UgIC8qIENPTkZJR19QQUdHICovDQorDQorLyogDQorICogUmVwbGFjZW1l
bnQgbWFjcm9zIHVzZWQgd2hlbiBQQUdHIChQcm9jZXNzIEFnZ3JlZ2F0ZXMp
IHN1cHBvcnQgaXMgbm90DQorICogY29tcGlsZWQgaW50byB0aGUga2VybmVs
Lg0KKyAqLw0KKyNkZWZpbmUgSU5JVF9UQVNLX1BBR0codHNrKQ0KKyNkZWZp
bmUgSU5JVF9QQUdHX0xJU1QobCkgZG8geyB9IHdoaWxlKDApDQorI2RlZmlu
ZSBwYWdnX2F0dGFjaChjdCwgcHQpICBkbyB7IH0gd2hpbGUoMCkNCisjZGVm
aW5lIHBhZ2dfZGV0YWNoKHQpICBkbyB7ICB9IHdoaWxlKDApICAgICANCisj
ZGVmaW5lIHBhZ2dfZXhlYyh0KSAgZG8geyAgfSB3aGlsZSgwKSAgICAgDQor
DQorI2VuZGlmIC8qIENPTkZJR19QQUdHICovDQorDQorI2VuZGlmIC8qIF9M
SU5VWF9QQUdHX0ggKi8NCkluZGV4OiBsaW51eC9pbmNsdWRlL2xpbnV4L3Nj
aGVkLmgNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCi0tLSBsaW51eC5vcmln
L2luY2x1ZGUvbGludXgvc2NoZWQuaAkyMDA0LTA4LTE0IDAwOjM2OjE2LjAw
MDAwMDAwMCAtMDUwMA0KKysrIGxpbnV4L2luY2x1ZGUvbGludXgvc2NoZWQu
aAkyMDA0LTA4LTE2IDEwOjQxOjIzLjAwMDAwMDAwMCAtMDUwMA0KQEAgLTUy
Nyw2ICs1MjcsMTMgQEANCiAgIAlzdHJ1Y3QgbWVtcG9saWN5ICptZW1wb2xp
Y3k7DQogICAJc2hvcnQgaWxfbmV4dDsJCS8qIGNvdWxkIGJlIHNoYXJlZCB3
aXRoIHVzZWRfbWF0aCAqLw0KICNlbmRpZg0KKw0KKyNpZmRlZiBDT05GSUdf
UEFHRw0KKy8qIExpc3Qgb2YgcGFnZyAocHJvY2VzcyBhZ2dyZWdhdGUpIGF0
dGFjaG1lbnRzICovDQorCXN0cnVjdCBsaXN0X2hlYWQgcGFnZ19saXN0Ow0K
KwlzdHJ1Y3Qgcndfc2VtYXBob3JlIHBhZ2dfc2VtOw0KKyNlbmRpZg0KKw0K
IH07DQogDQogc3RhdGljIGlubGluZSBwaWRfdCBwcm9jZXNzX2dyb3VwKHN0
cnVjdCB0YXNrX3N0cnVjdCAqdHNrKQ0KSW5kZXg6IGxpbnV4L2luaXQvS2Nv
bmZpZw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KLS0tIGxpbnV4Lm9yaWcv
aW5pdC9LY29uZmlnCTIwMDQtMDgtMTQgMDA6Mzc6MzguMDAwMDAwMDAwIC0w
NTAwDQorKysgbGludXgvaW5pdC9LY29uZmlnCTIwMDQtMDgtMTYgMTA6NDE6
MjMuMDAwMDAwMDAwIC0wNTAwDQpAQCAtMTI1LDYgKzEyNSwxNCBAQA0KIAkg
IGZvciBwcm9jZXNzaW5nIGl0LiBBIHByZWxpbWluYXJ5IHZlcnNpb24gb2Yg
dGhlc2UgdG9vbHMgaXMgYXZhaWxhYmxlDQogCSAgYXQgPGh0dHA6Ly9odHRw
Oi8vd3d3LmRlLmtlcm5lbC5vcmcvcHViL2xpbnV4L3V0aWxzL2FjY3QvPi4N
CiANCitjb25maWcgUEFHRw0KKwlib29sICJTdXBwb3J0IGZvciBwcm9jZXNz
IGFnZ3JlZ2F0ZXMgKFBBR0dzKSINCisJaGVscA0KKyAgICAgU2F5IFkgaGVy
ZSBpZiB5b3Ugd2lsbCBiZSBsb2FkaW5nIG1vZHVsZXMgd2hpY2ggcHJvdmlk
ZSBzdXBwb3J0DQorICAgICBmb3IgcHJvY2VzcyBhZ2dyZWdhdGUgY29udGFp
bmVycy4gIEV4YW1wbGVzIG9mIHN1Y2ggbW9kdWxlcyBpbmNsdWRlIHRoZQ0K
KyAgICAgTGludXggSm9icyBtb2R1bGUgYW5kIHRoZSBMaW51eCBBcnJheSBT
ZXNzaW9ucyBtb2R1bGUuICBJZiB5b3Ugd2lsbCBub3QgDQorICAgICBiZSB1
c2luZyBzdWNoIG1vZHVsZXMsIHNheSBOLg0KKw0KIGNvbmZpZyBTWVNDVEwN
CiAJYm9vbCAiU3lzY3RsIHN1cHBvcnQiDQogCS0tLWhlbHAtLS0NCkluZGV4
OiBsaW51eC9rZXJuZWwvTWFrZWZpbGUNCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0NCi0tLSBsaW51eC5vcmlnL2tlcm5lbC9NYWtlZmlsZQkyMDA0LTA4LTE0
IDAwOjM2OjMyLjAwMDAwMDAwMCAtMDUwMA0KKysrIGxpbnV4L2tlcm5lbC9N
YWtlZmlsZQkyMDA0LTA4LTE2IDEwOjQxOjIzLjAwMDAwMDAwMCAtMDUwMA0K
QEAgLTE4LDYgKzE4LDcgQEANCiBvYmotJChDT05GSUdfUE0pICs9IHBvd2Vy
Lw0KIG9iai0kKENPTkZJR19CU0RfUFJPQ0VTU19BQ0NUKSArPSBhY2N0Lm8N
CiBvYmotJChDT05GSUdfQ09NUEFUKSArPSBjb21wYXQubw0KK29iai0kKENP
TkZJR19QQUdHKSArPSBwYWdnLm8NCiBvYmotJChDT05GSUdfSUtDT05GSUcp
ICs9IGNvbmZpZ3Mubw0KIG9iai0kKENPTkZJR19JS0NPTkZJR19QUk9DKSAr
PSBjb25maWdzLm8NCiBvYmotJChDT05GSUdfU1RPUF9NQUNISU5FKSArPSBz
dG9wX21hY2hpbmUubw0KSW5kZXg6IGxpbnV4L2tlcm5lbC9mb3JrLmMNCj09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0NCi0tLSBsaW51eC5vcmlnL2tlcm5lbC9m
b3JrLmMJMjAwNC0wOC0xNCAwMDozNjoxNi4wMDAwMDAwMDAgLTA1MDANCisr
KyBsaW51eC9rZXJuZWwvZm9yay5jCTIwMDQtMDgtMTYgMTA6NDE6MjMuMDAw
MDAwMDAwIC0wNTAwDQpAQCAtMzYsNiArMzYsNyBAQA0KICNpbmNsdWRlIDxs
aW51eC9tb3VudC5oPg0KICNpbmNsdWRlIDxsaW51eC9hdWRpdC5oPg0KICNp
bmNsdWRlIDxsaW51eC9ybWFwLmg+DQorI2luY2x1ZGUgPGxpbnV4L3BhZ2cu
aD4NCiANCiAjaW5jbHVkZSA8YXNtL3BndGFibGUuaD4NCiAjaW5jbHVkZSA8
YXNtL3BnYWxsb2MuaD4NCkBAIC04Nyw2ICs4OCw4IEBADQogCVdBUk5fT04o
YXRvbWljX3JlYWQoJnRzay0+dXNhZ2UpKTsNCiAJV0FSTl9PTih0c2sgPT0g
Y3VycmVudCk7DQogDQorCXBhZ2dfZGV0YWNoKHRzayk7DQorDQogCWlmICh1
bmxpa2VseSh0c2stPmF1ZGl0X2NvbnRleHQpKQ0KIAkJYXVkaXRfZnJlZSh0
c2spOw0KIAlzZWN1cml0eV90YXNrX2ZyZWUodHNrKTsNCkBAIC0yMzYsNiAr
MjM5LDkgQEANCiANCiAJaW5pdF90YXNrLnJsaW1bUkxJTUlUX05QUk9DXS5y
bGltX2N1ciA9IG1heF90aHJlYWRzLzI7DQogCWluaXRfdGFzay5ybGltW1JM
SU1JVF9OUFJPQ10ucmxpbV9tYXggPSBtYXhfdGhyZWFkcy8yOw0KKw0KKwkv
KiBJbml0aWFsaXplIHRoZSBwYWdnIGxpc3QgaW4gcGlkIDAgYmVmb3JlIGl0
IGNhbiBjbG9uZSBpdHNlbGYuICovDQorCUlOSVRfUEFHR19MSVNUKGN1cnJl
bnQpOw0KIH0NCiANCiBzdGF0aWMgc3RydWN0IHRhc2tfc3RydWN0ICpkdXBf
dGFza19zdHJ1Y3Qoc3RydWN0IHRhc2tfc3RydWN0ICpvcmlnKQ0KQEAgLTEw
MjIsNiArMTAyOCwxMiBAQA0KIAlzY2hlZF9mb3JrKHApOw0KIA0KIAkvKg0K
KwkgKiBjYWxsIHBhZ2cgbW9kdWxlcyB0byBwcm9wZXJseSBhdHRhY2ggbmV3
IHByb2Nlc3MgdG8gdGhlIHNhbWUNCisJICogcHJvY2VzcyBhZ2dyZWdhdGUg
Y29udGFpbmVycyBhcyB0aGUgcGFyZW50IHByb2Nlc3MuDQorCSAqLw0KKwlw
YWdnX2F0dGFjaChwLCBjdXJyZW50KTsNCisNCisJLyoNCiAJICogT2ssIG1h
a2UgaXQgdmlzaWJsZSB0byB0aGUgcmVzdCBvZiB0aGUgc3lzdGVtLg0KIAkg
KiBXZSBkb250IHdha2UgaXQgdXAgeWV0Lg0KIAkgKi8NCkluZGV4OiBsaW51
eC9rZXJuZWwvcGFnZy5jDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQotLS0g
L2Rldi9udWxsCTE5NzAtMDEtMDEgMDA6MDA6MDAuMDAwMDAwMDAwICswMDAw
DQorKysgbGludXgva2VybmVsL3BhZ2cuYwkyMDA0LTA4LTE2IDEwOjQxOjIz
LjAwMDAwMDAwMCAtMDUwMA0KQEAgLTAsMCArMSw0NzcgQEANCisvKiANCisg
KiBQQUdHIChQcm9jZXNzIEFnZ3JlZ2F0ZXMpIGludGVyZmFjZQ0KKyAqDQor
ICogDQorICogQ29weXJpZ2h0IChjKSAyMDAwLTIwMDQgU2lsaWNvbiBHcmFw
aGljcywgSW5jLiAgQWxsIFJpZ2h0cyBSZXNlcnZlZC4NCisgKg0KKyAqIFRo
aXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJp
YnV0ZSBpdCBhbmQvb3IgbW9kaWZ5DQorICogaXQgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNo
ZWQgYnkNCisgKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRo
ZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcg0KKyAqIChhdCB5b3Vy
IG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uDQorICoNCisgKiBUaGlzIHBy
b2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxs
IGJlIHVzZWZ1bCwNCisgKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdp
dGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZg0KKyAqIE1FUkNI
QU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9T
RS4gIFNlZSB0aGUNCisgKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBm
b3IgbW9yZSBkZXRhaWxzLg0KKyAqDQorICogWW91IHNob3VsZCBoYXZlIHJl
Y2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vu
c2UNCisgKiBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCB3cml0
ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZQ0KKyAqIEZvdW5kYXRpb24sIEluYy4s
IDU5IFRlbXBsZSBQbGFjZSwgU3VpdGUgMzMwLCBCb3N0b24sIE1BIDAyMTEx
LTEzMDcgVVNBDQorICoNCisgKiBDb250YWN0IGluZm9ybWF0aW9uOiAgU2ls
aWNvbiBHcmFwaGljcywgSW5jLiwgMTUwMCBDcml0dGVuZGVuIExhbmUsDQor
ICogTW91bnRhaW4gVmlldywgQ0EgIDk0MDQzLCBvcjoNCisgKiANCisgKiBo
dHRwOi8vd3d3LnNnaS5jb20gDQorICovDQorDQorI2luY2x1ZGUgPGxpbnV4
L2NvbmZpZy5oPg0KKyNpbmNsdWRlIDxsaW51eC9zbGFiLmg+DQorI2luY2x1
ZGUgPGxpbnV4L3NjaGVkLmg+DQorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5o
Pg0KKyNpbmNsdWRlIDxsaW51eC9wYWdnLmg+DQorI2luY2x1ZGUgPGFzbS9z
ZW1hcGhvcmUuaD4NCisNCisvKiBsaXN0IG9mIHBhZ2cgaG9vayBlbnRyaWVz
IHRoYXQgcmVmZXJlbmNlIHRoZSAibW9kdWxlIiBpbXBsZW1lbnRhdGlvbnMg
Ki8NCitzdGF0aWMgTElTVF9IRUFEKHBhZ2dfaG9va19saXN0KTsNCitzdGF0
aWMgREVDTEFSRV9SV1NFTShwYWdnX2hvb2tfbGlzdF9zZW0pOw0KKw0KKw0K
Ky8qKg0KKyAqIHBhZ2dfZ2V0IC0gZ2V0IGEgcGFnZyBnaXZlbiBhIHNlYXJj
aCBrZXkNCisgKiBAdGFzazogV2UgZXhhbWluZSB0aGUgcGFnZ19saXN0IGZy
b20gdGhlIGdpdmVuIHRhc2sNCisgKiBAa2V5OiBLZXkgbmFtZSBvZiBwYWdn
IHdlIHdpc2ggdG8gcmV0cmlldmUNCisgKg0KKyAqIEdpdmVuIGEgcGFnZ19s
aXN0IGxpc3Qgc3RydWN0dXJlLCB0aGlzIGZ1bmN0aW9uIHdpbGwgcmV0dXJu
DQorICogYSBwb2ludGVyIHRvIHRoZSBwYWdnIHN0cnVjdCB0aGF0IG1hdGNo
ZXMgdGhlIHNlYXJjaA0KKyAqIGtleS4gIElmIHRoZSBrZXkgaXMgbm90IGZv
dW5kLCB0aGUgZnVuY3Rpb24gd2lsbCByZXR1cm4gTlVMTC4NCisgKg0KKyAq
IFRoZSBjYWxsZXIgc2hvdWxkIGhvbGQgYXQgbGVhc3QgYSByZWFkIGxvY2sg
b24gdGhlIHBhZ2dfbGlzdA0KKyAqIGZvciB0YXNrIHVzaW5nIGRvd25fcmVh
ZCgmdGFzay0+cGFnZ19saXN0LnNlbSkuDQorICoNCisgKi8NCitzdHJ1Y3Qg
cGFnZyAqDQorcGFnZ19nZXQoc3RydWN0IHRhc2tfc3RydWN0ICp0YXNrLCBj
aGFyICprZXkpDQorew0KKwlzdHJ1Y3QgcGFnZyAqcGFnZzsNCisNCisJbGlz
dF9mb3JfZWFjaF9lbnRyeShwYWdnLCAmdGFzay0+cGFnZ19saXN0LCBlbnRy
eSkgew0KKwkJaWYgKCFzdHJjbXAocGFnZy0+aG9vay0+bmFtZSxrZXkpKQ0K
KwkJCXJldHVybiBwYWdnOw0KKwl9DQorCXJldHVybiBOVUxMOw0KK30NCisN
CisNCisvKioNCisgKiBwYWdnX2FsbG9jIC0gSW5zZXJ0IGEgbmV3IHBhZ2cg
aW4gdG8gdGhlIHBhZ2dfbGlzdCBmb3IgYSB0YXNrDQorICogQHRhc2s6IFRh
c2sgd2Ugd2FudCB0byBpbnNlcnQgdGhlIHBhZ2cgaW4gdG8NCisgKiBAcGFn
Z19ob29rOiBQYWdnIGhvb2sgdG8gYXNzb2NpYXRlIHdpdGggdGhlIG5ldyBw
YWdnDQorICoNCisgKiBHaXZlbiBhIHRhc2sgYW5kIGEgcGFnZyBob29rLCB0
aGlzIGZ1bmN0aW9uIHdpbGwgYWxsb2NhdGUNCisgKiBhIG5ldyBwYWdnIHN0
cnVjdHVyZSwgaW5pdGlhbGl6ZSB0aGUgc2V0dGluZ3MsIGFuZCBpbnNlcnQg
dGhlIHBhZ2cgaW50bw0KKyAqIHRoZSBwYWdnX2xpc3QgZm9yIHRoZSB0YXNr
Lg0KKyAqDQorICogVGhlIGNhbGxlciBmb3IgdGhpcyBmdW5jdGlvbiBzaG91
bGQgaG9sZCBhdCBsZWFzdCBhIHJlYWQgbG9jayBvbiB0aGUNCisgKiBwYWdn
X2hvb2tfbGlzdF9zZW0gLSBvciBlbnN1cmUgdGhhdCB0aGUgcGFnZyBob29r
IGVudHJ5IGNhbm5vdCBiZSANCisgKiByZW1vdmVkLiBJZiB0aGlzIGZ1bmN0
aW9uIHdhcyBjYWxsZWQgZnJvbSB0aGUgcGFnZyBtb2R1bGUgKHVzdWFsbHkg
dGhlDQorICogY2FzZSksIHRoZW4gdGhlIGNhbGxlciBuZWVkIG5vdCBob2xk
IHRoaXMgbG9jay4gVGhlIGNhbGxlciBzaG91bGQgaG9sZCANCisgKiBhIHdy
aXRlIGxvY2sgb24gZm9yIHRoZSB0YXNrcyBwYWdnX3NlbS4gIFRoaXMgY2Fu
IGJlIGxvY2tlZCB1c2luZyANCisgKiBkb3duX3dyaXRlKCZ0YXNrLT5wYWdn
X3NlbSkNCisgKiANCisgKi8NCitzdHJ1Y3QgcGFnZyAqDQorcGFnZ19hbGxv
YyhzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhc2ssIHN0cnVjdCBwYWdnX2hvb2sg
KnBhZ2dfaG9vaykNCit7DQorCXN0cnVjdCBwYWdnICpwYWdnOw0KKw0KKwlw
YWdnID0ga21hbGxvYyhzaXplb2Yoc3RydWN0IHBhZ2cpLCBHRlBfS0VSTkVM
KTsNCisJaWYgKCFwYWdnKQ0KKwkJcmV0dXJuIE5VTEw7DQorDQorCXBhZ2ct
Pmhvb2sgPSBwYWdnX2hvb2s7DQorCXBhZ2ctPmRhdGEgPSBOVUxMOw0KKwlh
dG9taWNfaW5jKCZwYWdnX2hvb2stPnJlZmNudCk7ICAvKiBJbmNyZWFzZSBo
b29rJ3MgcmVmZXJlbmNlIGNvdW50ICovDQorCWxpc3RfYWRkX3RhaWwoJnBh
Z2ctPmVudHJ5LCAmdGFzay0+cGFnZ19saXN0KTsNCisJcmV0dXJuIHBhZ2c7
DQorfQ0KKw0KKw0KKy8qKg0KKyAqIHBhZ2dfZnJlZSAtIERlbGV0ZSBwYWdn
IGZyb20gdGhlIGxpc3QgYW5kIGZyZWUgaXRzIG1lbW9yeQ0KKyAqIEBwYWdn
OiBUaGUgcGFnZyB0byBmcmVlDQorICoNCisgKiBUaGlzIGZ1bmN0aW9uIHdp
bGwgZW5zdXJlIHRoZSBwYWdnIGlzIGRlbGV0ZWQgZm9ybSANCisgKiB0aGUg
bGlzdCBvZiBwYWdnIGVudHJpZXMgZm9yIHRoZSB0YXNrLiBGaW5hbGx5LCB0
aGUgbWVtb3J5IGZvciB0aGUgDQorICogcGFnZyBpcyBkaXNjYXJkZWQuDQor
ICoNCisgKiBUaGUgY2FsbGVyIG9mIHRoaXMgZnVuY3Rpb24gc2hvdWxkIGhv
bGQgYSB3cml0ZSBsb2NrIG9uIHRoZSBwYWdnX3NlbQ0KKyAqIGZvciB0aGUg
dGFzay4gVGhpcyBjYW4gYmUgbG9ja2VkIHVzaW5nIGRvd25fd3JpdGUoJnRh
c2stPnBhZ2dfc2VtKS4NCisgKg0KKyAqIFByaW9yIHRvIGNhbGxpbmcgcGFn
Z19mcmVlLCB0aGUgcGFnZyBzaG91bGQgaGF2ZSBiZWVuIGRldGFjaGVkIGZy
b20gdGhlDQorICogcGFnZyBjb250YWluZXIgcmVwcmVzZW50ZWQgYnkgdGhp
cyBwYWdnLiAgVGhhdCBpcyB1c3VhbGx5IGRvbmUgdXNpbmcNCisgKiBwLT5o
b29rLT5kZXRhY2godGFzaywgcGFnZyk7DQorICogDQorICovDQordm9pZA0K
K3BhZ2dfZnJlZShzdHJ1Y3QgcGFnZyAqcGFnZykgDQorew0KKwlhdG9taWNf
ZGVjKCZwYWdnLT5ob29rLT5yZWZjbnQpOyAvKiBkZWNyIHRoZSByZWZlcmVu
Y2UgY291bnQgb24gdGhlIGhvb2sgKi8NCisJbGlzdF9kZWwoJnBhZ2ctPmVu
dHJ5KTsNCisJa2ZyZWUocGFnZyk7DQorfQ0KKw0KKw0KKy8qKg0KKyAqIGdl
dF9wYWdnX2hvb2sgLSBHZXQgdGhlIHBhZ2cgaG9vayBtYXRjaGluZyB0aGUg
cmVxdWVzdGVkIG5hbWUNCisgKiBAa2V5OiBUaGUgbmFtZSBvZiB0aGUgcGFn
ZyBob29rIHRvIGdldA0KKyAqDQorICogR2l2ZW4gYSBwYWdnIGhvb2sgbmFt
ZSBrZXksIHRoaXMgZnVuY3Rpb24gd2lsbCByZXR1cm4gYSBwb2ludGVyDQor
ICogdG8gdGhlIHBhZ2dfaG9vayBzdHJ1Y3QgdGhhdCBtYXRjaGVzIHRoZSBu
YW1lLg0KKyAqIA0KKyAqIFlvdSBzaG91bGQgaG9sZCBlaXRoZXIgdGhlIHdy
aXRlIG9yIHJlYWQgbG9jayBmb3IgcGFnZ19ob29rX2xpc3Rfc2VtDQorICog
YmVmb3JlIHVzaW5nIHRoaXMgZnVuY3Rpb24uICBUaGlzIHdpbGwgZW5zdXJl
IHRoYXQgdGhlIHBhZ2dfaG9va19saXN0DQorICogZG9lcyBub3QgY2hhbmdl
IHdoaWxlIGl0ZXJhdGluZyB0aHJvdWdoIHRoZSBsaXN0IGVudHJpZXMuDQor
ICoNCisgKi8NCitzdGF0aWMgc3RydWN0IHBhZ2dfaG9vayAqDQorZ2V0X3Bh
Z2dfaG9vayhjaGFyICprZXkpDQorew0KKwlzdHJ1Y3QgcGFnZ19ob29rICpw
YWdnX2hvb2s7DQorDQorCWxpc3RfZm9yX2VhY2hfZW50cnkocGFnZ19ob29r
LCAmcGFnZ19ob29rX2xpc3QsIGVudHJ5KSB7DQorCQlpZiAoIXN0cmNtcChw
YWdnX2hvb2stPm5hbWUsIGtleSkpIHsNCisJCQlyZXR1cm4gcGFnZ19ob29r
Ow0KKwkJfQ0KKwl9DQorCXJldHVybiBOVUxMOw0KK30NCisNCisvKioNCisg
KiByZW1vdmVfY2xpZW50X3BhZ2dzX2Zyb21fYWxsX3Rhc2tzIC0gUmVtb3Zl
IGFsbCBwYWdncyBhc3NvY2lhdGVkIHdpdGggaG9vaw0KKyAqIEBwaHA6IFBh
Z2cgaG9vayBhc3NvY2lhdGVkIHdpdGggcGFnZ3MgdG8gcHVyZ2UNCisgKiAN
CisgKiBHaXZlbiBhIHBhZ2cgaG9vaywgdGhpcyBmdW5jdGlvbiB3aWxsIHJl
bW92ZSBhbGwgcGFnZ3MgYXNzb2NpYXRlZCB3aXRoIHRoYXQgDQorICogcGFn
ZyBob29rIGZyb20gYWxsIHRhc2tzIGNhbGxpbmcgdGhlIHByb3ZpZGVkIGZ1
bmN0aW9uIG9uIGVhY2ggcGFnZy4NCisgKiANCisgKiBJZiB0aGVyZSBpcyBh
IGRldGFjaCBmdW5jdGlvbiBhc3NvY2lhdGVkIHdpdGggdGhlIHBhZ2csIGl0
IGlzIGNhbGxlZA0KKyAqIGJlZm9yZSB0aGUgcGFnZyBpcyBmcmVlZC4NCisg
Kg0KKyAqIFRoaXMgaXMgbWVhbnQgdG8gYmUgdXNlZCBieSBwYWdnX2hvb2tf
cmVnaXN0ZXIgYW5kIHBhZ2dfaG9va191bnJlZ2lzdGVyDQorICoNCisgKi8N
CitzdGF0aWMgdm9pZA0KK3JlbW92ZV9jbGllbnRfcGFnZ3NfZnJvbV9hbGxf
dGFza3Moc3RydWN0IHBhZ2dfaG9vayAqcGhwKQ0KK3sNCisJaWYgKHBocCA9
PSBOVUxMKQ0KKwkJcmV0dXJuOw0KKw0KKwkvKiBCZWNhdXNlIG9mIGludGVy
bmFsIHJhY2UgY29uZGl0aW9ucyB3ZSBjYW4ndCBnYXVyYW50ZWUNCisJICog
Z2V0dGluZyBldmVyeSB0YXNrIGluIGp1c3Qgb25lIHBhc3Mgc28gd2UganVz
dCBrZWVwIGdvaW5nDQorCSAqIHVudGlsIHRoZXJlIGFyZSBubyB0YXNrcyB3
aXRoIHBhZ2dzIGZyb20gdGhpcyBob29rIGF0dGFjaGVkLg0KKwkgKiBUaGUg
aW5lZmZpY2llbmN5IG9mIHRoaXMgc2hvdWxkIGJlIHRlbXBlcmVkIGJ5IHRo
ZSBmYWN0IHRoYXQgdGhpcw0KKwkgKiBoYXBwZW5zIGF0IG1vc3Qgb25jZSBm
b3IgZWFjaCByZWdpc3RlcmVkIGNsaWVudC4NCisJICovDQorCXdoaWxlIChh
dG9taWNfcmVhZCgmcGhwLT5yZWZjbnQpICE9IDApIHsNCisJCXN0cnVjdCB0
YXNrX3N0cnVjdCAqcCA9IE5VTEw7DQorDQorCQlyZWFkX2xvY2soJnRhc2ts
aXN0X2xvY2spOw0KKwkJZm9yX2VhY2hfcHJvY2VzcyhwKSB7DQorCQkJc3Ry
dWN0IHBhZ2cgKnBhZ2dwOw0KKw0KKwkJCWdldF90YXNrX3N0cnVjdChwKTsN
CisJCQlyZWFkX3VubG9jaygmdGFza2xpc3RfbG9jayk7DQorCQkJZG93bl93
cml0ZSgmcC0+cGFnZ19zZW0pOw0KKwkJCXBhZ2dwID0gcGFnZ19nZXQocCwg
cGhwLT5uYW1lKTsNCisJCQlpZiAocGFnZ3AgIT0gTlVMTCkgew0KKwkJCQko
dm9pZClwaHAtPmRldGFjaChwLCBwYWdncCk7DQorCQkJCXBhZ2dfZnJlZShw
YWdncCk7DQorCQkJfQ0KKwkJCXVwX3dyaXRlKCZwLT5wYWdnX3NlbSk7DQor
CQkJcmVhZF9sb2NrKCZ0YXNrbGlzdF9sb2NrKTsNCisNCisJCQkvKiBJZiBh
IFBBR0cgZ290IHJlbW92ZWQgZnJvbSB0aGUgbGlzdCB3aGlsZSB3ZSdyZSBn
b2luZyB0aHJvdWdoDQorCQkJICogZWFjaCBwcm9jZXNzLCB0aGUgdGFza3Mg
bGlzdCBmb3IgdGhlIHByb2Nlc3Mgd291bGQgYmUgZW1wdHkuICBJbg0KKwkJ
CSAqIHRoYXQgY2FzZSwgYnJlYWsgb3V0IG9mIHRoaXMgZm9yX2VhY2hfcHJv
Y2VzcyBzbyB3ZSBjYW4gZG8gaXQNCisJCQkgKiBhZ2Fpbi4gKi8NCisJCQlp
ZiAobGlzdF9lbXB0eSgmcC0+dGFza3MpKSB7DQorCQkJCXB1dF90YXNrX3N0
cnVjdChwKTsNCisJCQkJYnJlYWs7DQorCQkJfSBlbHNlDQorCQkJCXB1dF90
YXNrX3N0cnVjdChwKTsNCisNCisJCX0NCisJCXJlYWRfdW5sb2NrKCZ0YXNr
bGlzdF9sb2NrKTsNCisJfQ0KK30NCisNCisvKioNCisgKiBwYWdnX2hvb2tf
cmVnaXN0ZXIgLSBSZWdpc3RlciBhIG5ldyBwYWdnIGhvb2sgYW5kIGVudGVy
IGl0IHRoZSBsaXN0DQorICogQHBhZ2dfaG9va19uZXc6IFRoZSBuZXcgcGFn
ZyBob29rIHRvIHJlZ2lzdGVyDQorICoNCisgKiBVc2VkIHRvIHJlZ2lzdGVy
IGEgbmV3IHBhZ2cgaG9vayBhbmQgZW50ZXIgaXQgaW50byB0aGUgcGFnZ19o
b29rX2xpc3QuDQorICogVGhlIHNlcnZpY2UgbmFtZSBmb3IgYSBwYWdnIGhv
b2sgaXMgcmVzdHJpY3RlZCB0byAzMiBjaGFyYWN0ZXJzLg0KKyAqDQorICog
SWYgYW4gImluaXQoKSIgZnVuY3Rpb24gaXMgc3VwcGxpZWQgaW4gdGhlIGhv
b2sgYmVpbmcgcmVnaXN0ZXJlZCB0aGVuIGENCisgKiBwYWdnIHdpbGwgYmUg
YXR0YWNoZWQgdG8gYWxsIGV4aXN0aW5nIHRhc2tzIGFuZCB0aGUgc3VwcGxp
ZWQgImluaXQoKSINCisgKiBmdW5jdGlvbiB3aWxsIGJlIGFwcGxpZWQgdG8g
aXQuICBJZiBhbnkgY2FsbCB0byB0aGUgc3VwcGxpZWQgImluaXQoKSINCisg
KiBmdW5jdGlvbiByZXR1cm5zIGEgbm9uIHplcm8gcmVzdWx0IHRoZSByZWdp
c3RyYXRpb24gd2lsbCBiZSBhYm9ydGVkLiBBcw0KKyAqIHBhcnQgb2YgdGhl
IGFib3J0IHByb2Nlc3MsIGFsbCBwYWdncyBiZWxvbmdpbmcgdG8gdGhlIG5l
dyBjbGllbnQgd2lsbCBiZQ0KKyAqIHJlbW92ZWQgZnJvbSBhbGwgdGFza3Mg
YW5kIHRoZSBzdXBwbGllZCAiZGV0YWNoKCkiIGZ1bmN0aW9uIHdpbGwgYmUN
CisgKiBjYWxsZWQgb24gdGhlbS4gIA0KKyAqDQorICogSWYgYSBtZW1vcnkg
ZXJyb3IgaXMgZW5jb3VudGVyZWQsIHRoZSBwYWdnIGhvb2sgaXMgdW5yZWdp
c3RlcmVkIGFuZCBhbnkNCisgKiB0YXNrcyB0aGF0IGhhdmUgYmVlbiBhdHRh
Y2hlZCB0byB0aGUgaW5pdGlhbCBwYWdnIGNvbnRhaW5lciBhcmUgZGV0YWNo
ZWQNCisgKiBmcm9tIHRoYXQgY29udGFpbmVyLg0KKyAqDQorICovDQoraW50
DQorcGFnZ19ob29rX3JlZ2lzdGVyKHN0cnVjdCBwYWdnX2hvb2sgKnBhZ2df
aG9va19uZXcpDQorew0KKwlzdHJ1Y3QgcGFnZ19ob29rICpwYWdnX2hvb2sg
PSBOVUxMOw0KKw0KKwkvKiBBZGQgbmV3IHBhZ2cgbW9kdWxlIHRvIGFjY2Vz
cyBsaXN0ICovDQorCWlmICghcGFnZ19ob29rX25ldykNCisJCXJldHVybiAt
RUlOVkFMOwkJCS8qIGVycm9yICovDQorCWlmICghbGlzdF9lbXB0eSgmcGFn
Z19ob29rX25ldy0+ZW50cnkpKQ0KKwkJcmV0dXJuIC1FSU5WQUw7CQkJLyog
ZXJyb3IgKi8NCisJaWYgKHBhZ2dfaG9va19uZXctPm5hbWUgPT0gTlVMTCB8
fCBzdHJsZW4ocGFnZ19ob29rX25ldy0+bmFtZSkgPiBQQUdHX05BTUVMTikN
CisJCXJldHVybiAtRUlOVkFMOwkJCS8qIGVycm9yICovDQorDQorCS8qIFRy
eSB0byBpbnNlcnQgbmV3IGhvb2sgZW50cnkgaW50byB0aGUgcGFnZyBob29r
IGxpc3QgKi8NCisJZG93bl93cml0ZSgmcGFnZ19ob29rX2xpc3Rfc2VtKTsN
CisNCisJcGFnZ19ob29rID0gZ2V0X3BhZ2dfaG9vayhwYWdnX2hvb2tfbmV3
LT5uYW1lKTsNCisNCisJaWYgKHBhZ2dfaG9vaykgew0KKwkJdXBfd3JpdGUo
JnBhZ2dfaG9va19saXN0X3NlbSk7DQorCQlwcmludGsoS0VSTl9XQVJOSU5H
ICJBdHRlbXB0IHRvIHJlZ2lzdGVyIGR1cGxpY2F0ZSINCisJCQkJIiBQQUdH
IHN1cHBvcnQgKG5hbWU9JXMpXG4iLCBwYWdnX2hvb2tfbmV3LT5uYW1lKTsN
CisJCXJldHVybiAtRUJVU1k7DQorCX0NCisNCisJLyogT2theSwgd2UgY2Fu
IGluc2VydCBpbnRvIHRoZSBwYWdnIGhvb2sgbGlzdCAqLw0KKwlsaXN0X2Fk
ZF90YWlsKCZwYWdnX2hvb2tfbmV3LT5lbnRyeSwgJnBhZ2dfaG9va19saXN0
KTsNCisJLyogc2V0IHRoZSByZWYgY291bnQgdG8gemVybyAqLw0KKwlhdG9t
aWNfc2V0KCZwYWdnX2hvb2tfbmV3LT5yZWZjbnQsIDApOw0KKw0KKwkvKiBO
b3cgd2UgY2FuIGNhbGwgdGhlIGluaXRpYWxpemVyIGZ1bmN0aW9uIChpZiBw
cmVzZW50KSBmb3IgZWFjaCB0YXNrICovDQorCWlmIChwYWdnX2hvb2tfbmV3
LT5pbml0ICE9IE5VTEwpIHsNCisJCWludCBpbml0X3Jlc3VsdCA9IDA7DQor
CQlpbnQgdGFza19leGl0ZWQgPSAwOw0KKw0KKwkJLyogQmVjYXVzZSBvZiBp
bnRlcm5hbCByYWNlIGNvbmRpdGlvbnMgd2UgY2FuJ3QgZ2F1cmFudGVlDQor
CQkgKiBnZXR0aW5nIGV2ZXJ5IHRhc2sgaW4ganVzdCBvbmUgcGFzcyBzbyB3
ZSBqdXN0IGtlZXAgZ29pbmcNCisJCSAqIHVudGlsIHdlIGRvbid0IGZpbmQg
YW55IHVuaXRpYWxpemVkIHRhc2tzLiAgVGhlIGluZWZmaWNpZW5jeQ0KKwkJ
ICogb2YgdGhpcyBzaG91bGQgYmUgdGVtcGVyZWQgYnkgdGhlIGZhY3QgdGhh
dCB0aGlzIGhhcHBlbnMNCisJCSAqIGF0IG1vc3Qgb25jZSBmb3IgZWFjaCBy
ZWdpc3RlcmVkIGNsaWVudC4NCisJCSAqLw0KKwkJZG8gew0KKwkJCXN0cnVj
dCB0YXNrX3N0cnVjdCAqcCA9IE5VTEw7DQorDQorCQkJcmVhZF9sb2NrKCZ0
YXNrbGlzdF9sb2NrKTsNCisJCQlmb3JfZWFjaF9wcm9jZXNzKHApIHsNCisJ
CQkJc3RydWN0IHBhZ2cgKnBhZ2dwOw0KKw0KKwkJCQlnZXRfdGFza19zdHJ1
Y3QocCk7DQorCQkJCXJlYWRfdW5sb2NrKCZ0YXNrbGlzdF9sb2NrKTsNCisJ
CQkJZG93bl93cml0ZSgmcC0+cGFnZ19zZW0pOw0KKwkJCQlwYWdncCA9IHBh
Z2dfZ2V0KHAsIHBhZ2dfaG9va19uZXctPm5hbWUpOw0KKwkJCQlpZiAocGFn
Z3AgPT0gTlVMTCkgew0KKwkJCQkJcGFnZ3AgPSBwYWdnX2FsbG9jKHAsIHBh
Z2dfaG9va19uZXcpOw0KKwkJCQkJaWYgKHBhZ2dwICE9IE5VTEwpDQorCQkJ
CQkJaW5pdF9yZXN1bHQgPSBwYWdnX2hvb2tfbmV3LT5pbml0KHAsIHBhZ2dw
KTsNCisJCQkJCWVsc2UNCisJCQkJCQlpbml0X3Jlc3VsdCA9IC1FTk9NRU07
DQorCQkJCX0NCisJCQkJdXBfd3JpdGUoJnAtPnBhZ2dfc2VtKTsNCisJCQkJ
cmVhZF9sb2NrKCZ0YXNrbGlzdF9sb2NrKTsNCisJCQkJLyogTGlrZSBpbiBy
ZW1vdmVfY2xpZW50X3BhZ2dzX2Zyb21fYWxsX3Rhc2tzLCBpZiB0aGUgdGFz
aw0KKwkJCQkgKiBkaXNhcHBlYXJlZCBvbiB1cyB3aGlsZSB3ZSB3ZXJlIGdv
aW5nIHRocm91Z2ggdGhlDQorCQkJCSAqIGZvcl9lYWNoX3Byb2Nlc3MgbG9v
cCwgd2UgbmVlZCB0byBzdGFydCBvdmVyIHdpdGggdGhhdCBsb29wLg0KKwkJ
CQkgKiBUaGF0J3Mgd2h5IHdlIGhhdmUgdGhlIGxpc3RfZW1wdHkgaGVyZSAq
Lw0KKwkJCQl0YXNrX2V4aXRlZCA9IGxpc3RfZW1wdHkoJnAtPnRhc2tzKTsN
CisJCQkJcHV0X3Rhc2tfc3RydWN0KHApOw0KKwkJCQlpZiAoKGluaXRfcmVz
dWx0ICE9IDApIHx8IHRhc2tfZXhpdGVkKSB7DQorCQkJCQlicmVhazsNCisJ
CQkJfQ0KKwkJCX0NCisJCQlyZWFkX3VubG9jaygmdGFza2xpc3RfbG9jayk7
DQorCQl9IHdoaWxlICgoaW5pdF9yZXN1bHQgPT0gMCkgJiYgdGFza19leGl0
ZWQpOw0KKw0KKwkJLyoNCisJCSAqIGlmIGFueXRoaW5nIHdlbnQgd3Jvbmcg
ZHVyaW5nIGluaXRpYWxpc2F0aW9uIGFiYW5kb24gdGhlDQorCQkgKiByZWdp
c3RyYXRpb24gcHJvY2Vzcw0KKwkJICovDQorCQlpZiAoaW5pdF9yZXN1bHQg
IT0gMCkgew0KKwkJCXJlbW92ZV9jbGllbnRfcGFnZ3NfZnJvbV9hbGxfdGFz
a3MocGFnZ19ob29rX25ldyk7DQorCQkJbGlzdF9kZWxfaW5pdCgmcGFnZ19o
b29rX25ldy0+ZW50cnkpOw0KKwkJCXVwX3dyaXRlKCZwYWdnX2hvb2tfbGlz
dF9zZW0pOw0KKw0KKwkJCXByaW50ayhLRVJOX1dBUk5JTkcgIlJlZ2lzdGVy
aW5nIFBBR0cgc3VwcG9ydCBmb3IiDQorCQkJCSIgKG5hbWU9JXMpIGZhaWxl
ZFxuIiwgcGFnZ19ob29rX25ldy0+bmFtZSk7DQorDQorCQkJcmV0dXJuIGlu
aXRfcmVzdWx0OyAvKiBob29rIGluaXQgZnVuY3Rpb24gZXJyb3IgcmVzdWx0
ICovDQorCQl9DQorCX0NCisNCisJdXBfd3JpdGUoJnBhZ2dfaG9va19saXN0
X3NlbSk7DQorDQorCXByaW50ayhLRVJOX0lORk8gIlJlZ2lzdGVyaW5nIFBB
R0cgc3VwcG9ydCBmb3IgKG5hbWU9JXMpXG4iLA0KKwkJCXBhZ2dfaG9va19u
ZXctPm5hbWUpOw0KKw0KKwlyZXR1cm4gMDsJCQkJCS8qIHN1Y2Nlc3MgKi8N
CisNCit9DQorDQorLyoqDQorICogcGFnZ19ob29rX3VucmVnaXN0ZXIgLSBV
bnJlZ2lzdGVyIHBhZ2cgaG9vayBhbmQgcmVtb3ZlIGl0IGZyb20gdGhlIGxp
c3QNCisgKiBAcGFnZ19ob29rX29sZDogVGhlIGhvb2sgdG8gdW5yZWdpc3Rl
ciBhbmQgcmVtb3ZlDQorICoNCisgKiBVc2VkIHRvIHVucmVnaXN0ZXIgcGFn
ZyBob29rcyBhbmQgcmVtb3ZlIHRoZW0gZnJvbSB0aGUgcGFnZ19ob29rX2xp
c3QuDQorICogT25jZSB0aGUgcGFnZyBob29rIGVudHJ5IGluIHRoZSBwYWdn
X2hvb2tfbGlzdCBpcyBmb3VuZCwgcGFnZ3MgYXNzb2NpYXRlZA0KKyAqIHdp
dGggdGhlIGhvb2sgKGlmIGFueSkgd2lsbCBoYXZlIHRoZWlyIGRldGFjaCBm
dW5jdGlvbiBjYWxsZWQgYW5kIHdpbGwNCisgKiBiZSBkZXRhY2hlZC4NCisg
KiANCisgKi8NCitpbnQNCitwYWdnX2hvb2tfdW5yZWdpc3RlcihzdHJ1Y3Qg
cGFnZ19ob29rICpwYWdnX2hvb2tfb2xkKQ0KK3sNCisJc3RydWN0IHBhZ2df
aG9vayAqcGFnZ19ob29rOw0KKw0KKwkvKiBDaGVjayB0aGUgdmFsaWRpdHkg
b2YgdGhlIGFyZ3VtZW50cyAqLw0KKwlpZiAoIXBhZ2dfaG9va19vbGQpDQor
CQlyZXR1cm4gLUVJTlZBTDsJCQkvKiBlcnJvciAqLw0KKwlpZiAobGlzdF9l
bXB0eSgmcGFnZ19ob29rX29sZC0+ZW50cnkpKQ0KKwkJcmV0dXJuIC1FSU5W
QUw7CQkJLyogZXJyb3IgKi8NCisJaWYgKHBhZ2dfaG9va19vbGQtPm5hbWUg
PT0gTlVMTCkNCisJCXJldHVybiAtRUlOVkFMOwkJCS8qIGVycm9yICovDQor
DQorCWRvd25fd3JpdGUoJnBhZ2dfaG9va19saXN0X3NlbSk7DQorDQorCXBh
Z2dfaG9vayA9IGdldF9wYWdnX2hvb2socGFnZ19ob29rX29sZC0+bmFtZSk7
DQorDQorCWlmIChwYWdnX2hvb2sgJiYgcGFnZ19ob29rID09IHBhZ2dfaG9v
a19vbGQpIHsNCisJCXJlbW92ZV9jbGllbnRfcGFnZ3NfZnJvbV9hbGxfdGFz
a3MocGFnZ19ob29rKTsNCisJCWxpc3RfZGVsX2luaXQoJnBhZ2dfaG9vay0+
ZW50cnkpOw0KKwkJdXBfd3JpdGUoJnBhZ2dfaG9va19saXN0X3NlbSk7DQor
DQorCQlwcmludGsoS0VSTl9JTkZPICJVbnJlZ2lzdGVyaW5nIFBBR0cgc3Vw
cG9ydCBmb3IiDQorCQkJCSIgKG5hbWU9JXMpXG4iLCBwYWdnX2hvb2tfb2xk
LT5uYW1lKTsNCisNCisJCXJldHVybiAwOwkJCS8qIHN1Y2Nlc3MgKi8NCisJ
fQ0KKw0KKwl1cF93cml0ZSgmcGFnZ19ob29rX2xpc3Rfc2VtKTsNCisNCisJ
cHJpbnRrKEtFUk5fV0FSTklORyAiQXR0ZW1wdCB0byB1bnJlZ2lzdGVyIFBB
R0cgc3VwcG9ydCAobmFtZT0lcykiDQorCQkJIiBmYWlsZWQgLSBub3QgZm91
bmRcbiIsIHBhZ2dfaG9va19vbGQtPm5hbWUpOw0KKwkNCisJcmV0dXJuIC1F
SU5WQUw7CQkJCS8qIGVycm9yICovDQorfQ0KKw0KKw0KKy8qKg0KKyAqIF9f
cGFnZ19hdHRhY2ggLSBBdHRhY2ggYSBuZXcgdGFzayB0byB0aGUgc2FtZSBj
b250YWluZXJzIG9mIGl0cyBwYXJlbnQNCisgKiBAdG9fdGFzazogVGhlIGNo
aWxkIHRhc2sgdGhhdCB3aWxsIGluaGVyaXQgdGhlIHBhcmVudCdzIGNvbnRh
aW5lcnMNCisgKiBAZnJvbV90YXNrOiBUaGUgcGFyZW50IHRhc2sgDQorICoN
CisgKiBVc2VkIHRvIGF0dGFjaCBhIG5ldyB0YXNrIHRvIHRoZSBzYW1lIHBh
Z2cgY29udGFpbmVycyB0byB3aGljaCBpdCdzIHBhcmVudA0KKyAqIGlzIGF0
dGFjaGVkLg0KKyAqDQorICogVGhlICJmcm9tIiBhcmd1bWVudCBpcyB0aGUg
cGFyZW50IHRhc2suICBUaGUgInRvIiBhcmd1bWVudCBpcyB0aGUgY2hpbGQN
CisgKiB0YXNrLiANCisgKg0KKyAqLw0KK3ZvaWQgDQorX19wYWdnX2F0dGFj
aChzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRvX3Rhc2ssIHN0cnVjdCB0YXNrX3N0
cnVjdCAqZnJvbV90YXNrKQ0KK3sNCisJc3RydWN0IHBhZ2cgKmZyb21fcGFn
ZzsNCisNCisJLyogbG9jayB0aGUgcGFyZW50cyBwYWdnX2xpc3Qgd2UgYXJl
IGNvcHlpbmcgZnJvbSAqLw0KKwlkb3duX3JlYWQoJmZyb21fdGFzay0+cGFn
Z19zZW0pOyAvKiByZWFkIGxvY2sgdGhlIHBhZ2cgbGlzdCAqLw0KKw0KKwls
aXN0X2Zvcl9lYWNoX2VudHJ5KGZyb21fcGFnZywgJmZyb21fdGFzay0+cGFn
Z19saXN0LCBlbnRyeSkgew0KKwkJc3RydWN0IHBhZ2cgKnRvX3BhZ2cgPSBO
VUxMOw0KKw0KKwkJdG9fcGFnZyA9IHBhZ2dfYWxsb2ModG9fdGFzaywgZnJv
bV9wYWdnLT5ob29rKTsNCisJCWlmICghdG9fcGFnZykgew0KKwkJCWdvdG8g
ZXJyb3JfcmV0dXJuOw0KKwkJfQ0KKwkJaWYgKHRvX3BhZ2ctPmhvb2stPmF0
dGFjaCh0b190YXNrLCB0b19wYWdnLCBmcm9tX3BhZ2ctPmRhdGEpICE9IDAg
KSANCisJCQlnb3RvIGVycm9yX3JldHVybjsNCisJfQ0KKw0KKwl1cF9yZWFk
KCZmcm9tX3Rhc2stPnBhZ2dfc2VtKTsgLyogdW5sb2NrIHRoZSBwYWdnIGxp
c3QgKi8NCisNCisJcmV0dXJuOwkJCQkJLyogc3VjY2VzcyAqLw0KKw0KKyAg
ZXJyb3JfcmV0dXJuOg0KKwkvKiANCisJICogQ2xlYW4gdXAgYWxsIHRoZSBw
YWdnIGF0dGFjaG1lbnRzIG1hZGUgb24gYmVoYWxmIG9mIHRoZSBuZXcNCisJ
ICogdGFzay4gIFNldCBuZXcgdGFzayBwYWdnIHB0ciB0byBOVUxMIGZvciBy
ZXR1cm4uDQorCSAqLw0KKwl1cF9yZWFkKCZmcm9tX3Rhc2stPnBhZ2dfc2Vt
KTsgLyogdW5sb2NrIHRoZSBwYWdnIGxpc3QgKi8NCisJX19wYWdnX2RldGFj
aCh0b190YXNrKTsNCisJcmV0dXJuOwkJCQkvKiBmYWlsdXJlICovDQorfQ0K
Kw0KKy8qKg0KKyAqIF9fcGFnZ19kZXRhY2ggLSBEZXRhY2ggYSB0YXNrIGZy
b20gYWxsIHBhZ2cgY29udGFpbmVycyBpdCBpcyBhdHRhY2hlZCB0bw0KKyAq
IEB0YXNrOiBUYXNrIHRvIGRldGFjaCBmcm9tIHBhZ2cgY29udGFpbmVycw0K
KyAqDQorICogVXNlZCB0byBkZXRhY2ggYSB0YXNrIGZyb20gYWxsIHBhZ2cg
Y29udGFpbmVycyB0byB3aGljaCBpdCBpcyBhdHRhY2hlZC4NCisgKiANCisg
Ki8NCit2b2lkIA0KK19fcGFnZ19kZXRhY2goc3RydWN0IHRhc2tfc3RydWN0
ICp0YXNrKQ0KK3sNCisJc3RydWN0IHBhZ2cgKnBhZ2c7DQorCXN0cnVjdCBw
YWdnICpwYWdndG1wOw0KKw0KKwkvKiBSZW1vdmUgcmVmLiB0byBwYWdncyBm
cm9tIHRhc2sgaW1tZWRpYXRlbHkgKi8NCisJZG93bl93cml0ZSgmdGFzay0+
cGFnZ19zZW0pOyAvKiB3cml0ZSBsb2NrIHBhZ2cgbGlzdCAqLw0KKw0KKwls
aXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUocGFnZywgcGFnZ3RtcCwgJnRhc2st
PnBhZ2dfbGlzdCwgZW50cnkpIHsNCisJCXBhZ2ctPmhvb2stPmRldGFjaCh0
YXNrLCBwYWdnKTsNCisJCXBhZ2dfZnJlZShwYWdnKTsNCisJfQ0KKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQorCXVwX3dyaXRlKCZ0
YXNrLT5wYWdnX3NlbSk7IC8qIHdyaXRlIHVubG9jayB0aGUgcGFnZyBsaXN0
ICovDQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCisJ
cmV0dXJuOyAgIC8qIDAgPSBzdWNjZXNzLCBlbHNlIHJldHVybiBsYXN0IGNv
ZGUgZm9yIGZhaWx1cmUgKi8NCit9DQorDQorDQorLyoqDQorICogX19wYWdn
X2V4ZWMgLSBFeGVjdXRlIGNhbGxiYWNrIHdoZW4gYSBwcm9jZXNzIGluIGEg
Y29udGFpbmVyIGV4ZWNzDQorICogQHRhc2s6IFdlIGdvIHRocm91Z2ggdGhl
IHBhZ2cgbGlzdCBpbiB0aGUgZ2l2ZW4gdGFzaw0KKyAqDQorICogVXNlZCB0
byB3aGVuIGEgcHJvY2VzcyB0aGF0IGlzIGluIGEgcGFnZyBjb250YWluZXIg
ZG9lcyBhbiBleGVjLg0KKyAqDQorICogVGhlICJmcm9tIiBhcmd1bWVudCBp
cyB0aGUgdGFzay4gIFRoZSAibmFtZSIgYXJndW1lbnQgaXMgdGhlIG5hbWUN
CisgKiBvZiB0aGUgcHJvY2VzcyBiZWluZyBleGVjJ2VkLg0KKyAqDQorICov
DQoraW50IA0KK19fcGFnZ19leGVjKHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFz
aykgDQorew0KKwlzdHJ1Y3QgcGFnZwkqcGFnZzsNCisNCisJLyogbG9jayB0
aGUgcGFyZW50cyBwYWdnX2xpc3Qgd2UgYXJlIGNvcHlpbmcgZnJvbSAqLw0K
Kwlkb3duX3JlYWQoJnRhc2stPnBhZ2dfc2VtKTsgLyogbG9jayB0aGUgcGFn
ZyBsaXN0ICovDQorDQorCWxpc3RfZm9yX2VhY2hfZW50cnkocGFnZywgJnRh
c2stPnBhZ2dfbGlzdCwgZW50cnkpIHsNCisJCWlmIChwYWdnLT5ob29rLT5l
eGVjKSAvKiBjb25kaXRpb25hbCBiZWNhdXNlIGl0J3Mgb3B0aW9uYWwgKi8N
CisJCQlwYWdnLT5ob29rLT5leGVjKHRhc2ssIHBhZ2cpOw0KKwl9DQorDQor
CXVwX3JlYWQoJnRhc2stPnBhZ2dfc2VtKTsgLyogdW5sb2NrIHRoZSBwYWdn
IGxpc3QgKi8NCisJcmV0dXJuIDA7DQorfQ0KKw0KKw0KK0VYUE9SVF9TWU1C
T0wocGFnZ19nZXQpOw0KK0VYUE9SVF9TWU1CT0wocGFnZ19hbGxvYyk7DQor
RVhQT1JUX1NZTUJPTChwYWdnX2ZyZWUpOw0KK0VYUE9SVF9TWU1CT0wocGFn
Z19ob29rX3JlZ2lzdGVyKTsNCitFWFBPUlRfU1lNQk9MKHBhZ2dfaG9va191
bnJlZ2lzdGVyKTsNCg==

---2136806248-603613444-1092673969=:663457--
