Return-Path: <linux-kernel-owner+willy=40w.ods.org-S263847AbUEDI6e@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S263847AbUEDI6e (ORCPT <rfc822;willy@w.ods.org>);
	Tue, 4 May 2004 04:58:34 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S264261AbUEDI6e
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Tue, 4 May 2004 04:58:34 -0400
Received: from orange.csi.cam.ac.uk ([131.111.8.77]:48872 "EHLO
	orange.csi.cam.ac.uk") by vger.kernel.org with ESMTP
	id S263847AbUEDI6a convert rfc822-to-8bit (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Tue, 4 May 2004 04:58:30 -0400
Subject: Re: [BUG] 2.6.5 ntfs
From: Anton Altaparmakov <aia21@cam.ac.uk>
To: Marcin =?iso-8859-2?Q?Gibu=B3a?= <m.gibula@conecto.pl>
Cc: linux-kernel@vger.kernel.org
In-Reply-To: <200405031407.46408.m.gibula@conecto.pl>
References: <200405031407.46408.m.gibula@conecto.pl>
Content-Type: text/plain; charset=iso-8859-2
Organization: University of Cambridge Computing Service
Message-Id: <1083660979.6490.5.camel@imp.csi.cam.ac.uk>
Mime-Version: 1.0
X-Mailer: Ximian Evolution 1.4.6 
Date: Tue, 04 May 2004 09:56:20 +0100
Content-Transfer-Encoding: 8BIT
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Hi,

On Mon, 2004-05-03 at 13:07, Marcin Gibu³a wrote:
> Hi, I've encountered this bug after using dcgui for about one day. 
> I have one ntfs partition mounted (it is compressed) and there is about 60gb 
> of files.

Could you do the following inside the configured kernel source directory
corresponding to the compiled kernel that produced this oops:

make fs/ntfs/attrib.s

And then please email me the file fs/ntfs/attrib.s that is generated by
the above command.  I need this to find out at which place in the code
the oops actually happened...

Also could you tell me which Windows version the ntfs partition was
created with and which windows version last accessed the files?

Finally is this bug reproducible when you access a particular file or is
it a once off event?  If a particular file, then would you mind running
a utility that I can email you (source or binary or both whichever you
prefer) so I can capture the metadata for the inode of the file?

Thanks a lot in advance.

Best regards,

	Anton

> .config attached.
> 
> lsmod:
> Module                  Size  Used by
> isofs                  31032  0
> ntfs                   78540  1
> tuner                  15244  0
> saa7134                82888  0
> video_buf              19204  1 saa7134
> ir_common               4484  1 saa7134
> eagle_usb              97856  0
> vfat                   13824  1
> fat                    40640  1 vfat
> 
> eagle-usb is a driver from http://www.eagle-usb.org.
> 
> Unable to handle kernel paging request at virtual address e0b12014
>  printing eip:
> e09d7dad
> *pde = 1ff63067
> *pte = 00000000
> Oops: 0000 [#1]
> PREEMPT
> CPU:    0
> EIP:    0060:[<e09d7dad>]    Not tainted
> EFLAGS: 00210292   (2.6.5)
> EIP is at ntfs_merge_run_lists+0x3e9/0x16d4 [ntfs]
> eax: ff807362   ebx: 000060a3   ecx: e0b12010   edx: ff746957
> esi: fff47b77   edi: 00000000   ebp: e0b0f000   esp: da241b34
> ds: 007b   es: 007b   ss: 0068
> Process dcgui-qt (pid: 13236, threadinfo=da240000 task=df0bf3e0)
> Stack: df0bf3e0 c0112440 da241b5c 00000000 00000000 00000000 d56d0ed0 00000000
>        df0bf3e0 c032b308 0000015f c12b1358 00200246 d56d0960 c138eff0 c01261ff
>        dbdf4ae0 00234000 e0a34000 00000000 c01389f4 00236000 dff638d8 00236000
> Call Trace:
>  [<c0112440>] autoremove_wake_function+0x0/0x28
>  [<c01261ff>] unlock_page+0x9/0x34
>  [<c01389f4>] map_vm_area+0x9e/0x1a6
>  [<e09d95bf>] decompress_mapping_pairs+0x527/0x5ec [ntfs]
>  [<e09da141>] map_run_list+0xba/0xf2 [ntfs]
>  [<e09dab8b>] ntfs_read_compressed_block+0x464/0xf81 [ntfs]
>  [<e09d739e>] ntfs_readpage+0x92/0x681 [ntfs]
>  [<c027cc3a>] skb_copy_datagram_iovec+0x3b/0x1c1
>  [<c0297507>] cleanup_rbuf+0xbf/0xdb
>  [<c01979c4>] radix_tree_node_alloc+0x10/0x41
>  [<c0197af5>] radix_tree_insert+0x87/0xe0
>  [<c0125dc8>] add_to_page_cache+0x47/0x11a
>  [<c012b236>] read_pages+0x97/0x156
>  [<c0129b0a>] __alloc_pages+0x8c/0x2a5
>  [<c012b5c1>] do_page_cache_readahead+0x125/0x146
>  [<c012b715>] page_cache_readahead+0x133/0x1a9
>  [<c0126793>] do_generic_mapping_read+0xc5/0x489
>  [<c0126b57>] file_read_actor+0x0/0xce
>  [<c01288fa>] __generic_file_aio_read+0x18e/0x1ac
>  [<c0126b57>] file_read_actor+0x0/0xce
>  [<c01289e9>] generic_file_read+0x66/0x7d
>  [<c014b805>] __pollwait+0x0/0x94
>  [<c014bfd4>] sys_select+0x3ed/0x3f7
>  [<c013d140>] vfs_read+0x9d/0xc9
>  [<c013d2fe>] sys_read+0x2c/0x42
>  [<c0105b05>] sysenter_past_esp+0x52/0x71
> 
> Code: 8b 51 04 8b 01 89 d6 09 c6 75 eb 6b 8c 24 88 00 00 00 18 8b

-- 
Anton Altaparmakov <aia21 at cam.ac.uk> (replace at with @)
Unix Support, Computing Service, University of Cambridge, CB2 3QH, UK
Linux NTFS maintainer / IRC: #ntfs on irc.freenode.net
WWW: http://linux-ntfs.sf.net/ &
http://www-stu.christs.cam.ac.uk/~aia21/


