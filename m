Return-Path: <linux-kernel-owner+willy=40w.ods.org-S1751190AbWERPy2@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1751190AbWERPy2 (ORCPT <rfc822;willy@w.ods.org>);
	Thu, 18 May 2006 11:54:28 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1751035AbWERPy1
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Thu, 18 May 2006 11:54:27 -0400
Received: from mail.suse.de ([195.135.220.2]:46544 "EHLO mx1.suse.de")
	by vger.kernel.org with ESMTP id S1751096AbWERPy0 (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Thu, 18 May 2006 11:54:26 -0400
Date: Thu, 18 May 2006 17:54:19 +0200
Message-ID: <s5h3bf72us4.wl%tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Andreas Mohr <andi@rhlx01.fht-esslingen.de>
Cc: Meelis Roos <mroos@linux.ee>,
       Linux Kernel list <linux-kernel@vger.kernel.org>,
       alsa-devel@lists.sourceforge.net
Subject: Re: [Alsa-devel] Re: How to enable bios-disabled soundcard?
In-Reply-To: <20060518151520.GA32572@rhlx01.fht-esslingen.de>
References: <Pine.SOC.4.61.0605181650080.4469@math.ut.ee>
	<20060518151520.GA32572@rhlx01.fht-esslingen.de>
User-Agent: Wanderlust/2.12.0 (Your Wildest Dreams) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.7 (=?ISO-8859-4?Q?Sanj=F2?=) APEL/10.6 MULE XEmacs/21.5 (beta25)
 (eggplant) (+CVS-20060326) (i386-suse-linux)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

At Thu, 18 May 2006 17:15:20 +0200,
Andreas Mohr wrote:
> 
> Hi,
> 
> [CC'ing ALSA list]
> 
> On Thu, May 18, 2006 at 05:09:47PM +0300, Meelis Roos wrote:
> > Context: IBM X20 laptop with integrated PCI CS4281 soundcard. Loading 
> > snd_cs4281 gives these messages and registers no alsa device:
> > 
> > ACPI: PCI interrupt for device 0000:00:0b.0 disabled
> > CS4281: probe of 0000:00:0b.0 failed with error -5
> > 
> > Error -5 seems to be -EIO.
> > 
> > There is no option ib bios to enable/disable the soundcard and the bios 
> > is almost the latest (2.23, latest 2.25 fixes only unrelated things by 
> > changelog).
> 
> The mail subject most likely is wrong, since the IRQ message above
> doesn't suggest a BIOS issue at all,
> since the message is most likely a result of calling snd_cs4281_free()
> in failure path, which disables this IRQ again.
> 
> > lspci identifies the card as follows (pci ID is the same as in the 
> > driver):
> > 0000:00:0b.0 Multimedia audio controller: Cirrus Logic Crystal CS4281 PCI 
> > Audio (rev 01)
> > 
> > I tried pci=routeirq. It distributed the interrupts differently but this 
> > problem did remain.
> 
> I believe that it's a simple hardware mismatch failure in the main probe
> function of this driver, nothing else.
> 
> > So how can I enable the soundcard?
> 
> The best way to find out is to edit snd_cs4281_probe() and add snd_printk()s
> at all error paths to find the one which actually fails.

The error EIO comes only from snd_cs4281_chip_init(), and you must
have a corresponding error message.

There are some fixes in 2.6.17 tree regarding cs4281.  Give it a try.


Takashi
