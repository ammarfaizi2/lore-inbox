Return-Path: <linux-kernel-owner@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id <S289057AbSBJAoE>; Sat, 9 Feb 2002 19:44:04 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org
	id <S289061AbSBJAnx>; Sat, 9 Feb 2002 19:43:53 -0500
Received: from [63.231.122.81] ([63.231.122.81]:59496 "EHLO lynx.adilger.int")
	by vger.kernel.org with ESMTP id <S289057AbSBJAni>;
	Sat, 9 Feb 2002 19:43:38 -0500
Date: Sat, 9 Feb 2002 17:42:26 -0700
From: Andreas Dilger <adilger@turbolabs.com>
To: Tom Rini <trini@kernel.crashing.org>
Cc: Larry McVoy <lm@work.bitmover.com>, David Lang <dlang@diginsite.com>,
        Larry McVoy <lm@bitmover.com>, Patrick Mochel <mochel@osdl.org>,
        linux-kernel@vger.kernel.org
Subject: Re: [bk patch] Make cardbus compile in -pre4
Message-ID: <20020209174226.E9826@lynx.turbolabs.com>
Mail-Followup-To: Tom Rini <trini@kernel.crashing.org>,
	Larry McVoy <lm@work.bitmover.com>,
	David Lang <dlang@diginsite.com>, Larry McVoy <lm@bitmover.com>,
	Patrick Mochel <mochel@osdl.org>, linux-kernel@vger.kernel.org
In-Reply-To: <20020209090527.B13735@work.bitmover.com> <Pine.LNX.4.44.0202091258110.25220-100000@dlang.diginsite.com> <20020209134132.J13735@work.bitmover.com> <20020209163603.B9826@lynx.turbolabs.com> <20020209234555.GG872@opus.bloom.county>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.2.5.1i
In-Reply-To: <20020209234555.GG872@opus.bloom.county>; from trini@kernel.crashing.org on Sat, Feb 09, 2002 at 04:45:55PM -0700
X-GPG-Key: 1024D/0D35BED6
X-GPG-Fingerprint: 7A37 5D79 BF1B CECA D44F  8A29 A488 39F5 0D35 BED6
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

On Feb 09, 2002  16:45 -0700, Tom Rini wrote:
> On Sat, Feb 09, 2002 at 04:36:03PM -0700, Andreas Dilger wrote:
> > One thing that I've noticed (got my first linux-2.5 clone last night) is
> > that the kernel build process is somewhat broken by the fact that not
> > everything that you need to build is checked out of the repository by
> > make.
> > 
> > It appears to handle .c files ok, but it failed for all of the .h files.
> > I take it this means that gcc doesn't know anything about SCCS, and it
> > would also appear that make is not properly checking dependencies for
> > these files, or it would have checked them out, right?
> 
> It's a 'feature' of the dependancy setup of the kernel.  bk -r get -q
> will checkout all of the files everywhere, and the build _should_ work
> (there's been times autogenerated files were in the kernel and thus
> broke building from a bk repo).

Well, I looked at it some more, and "make dep" was totally broken
until I "bk get" the headers.  All of the .depend files were empty,
probably because "make dep" couldn't find/read any files.  It may
be enough to fix this by having "make dep" do something to "bk get"
each file if it is not there.  It still appears to be a bit of
a problem, because before you do "bk get", "find" does not return any
files for mkdep to look at, a bit of chicken-and-egg problem there.

We could also try to "make" each header file, because make is smart
enough to handle SCCS/BK, CVS, etc so we won't be putting BK-specific
knowledge into the make system (try "make -d include/linux/fs.h").  I
don't know for sure, since I've never worked with the build system much.

> > I would prefer if we only checked out as much as we need (instead of
> > doing something like 'bk -r edit' which will use up a lot of space in
> > each clone for architectures and drivers which I don't need).
> 
> Don't -r edit, -r get.

Well, write bits don't take up any space.  While I can alias vi='bk vim'
to check out a particular file for editing, VIM is not smart enough (or
I don't know how to configure it) to check out files for editing if I
open them from within the editor or use tags to jump to the file.

Cheers, Andreas
--
Andreas Dilger
http://sourceforge.net/projects/ext2resize/
http://www-mddsp.enel.ucalgary.ca/People/adilger/

