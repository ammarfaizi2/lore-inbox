Return-Path: <linux-kernel-owner+willy=40w.ods.org-S1161170AbWHDOFj@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1161170AbWHDOFj (ORCPT <rfc822;willy@w.ods.org>);
	Fri, 4 Aug 2006 10:05:39 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1161188AbWHDOFj
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Fri, 4 Aug 2006 10:05:39 -0400
Received: from rtr.ca ([64.26.128.89]:30622 "EHLO mail.rtr.ca")
	by vger.kernel.org with ESMTP id S1161170AbWHDOFi (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Fri, 4 Aug 2006 10:05:38 -0400
Message-ID: <44D35430.2010600@rtr.ca>
Date: Fri, 04 Aug 2006 10:05:36 -0400
From: Mark Lord <lkml@rtr.ca>
User-Agent: Thunderbird 1.5.0.5 (X11/20060719)
MIME-Version: 1.0
To: Tejun Heo <htejun@gmail.com>
Cc: =?ISO-8859-1?Q?=22J=2EA=2E_Magall=F3n=22?= <jamagallon@ono.com>,
       "Linux-Kernel, " <linux-kernel@vger.kernel.org>,
       Alan Cox <alan@lxorguk.ukuu.org.uk>
Subject: Re: [2.6.18-rc2-mm1] libata cdroms not automounted
References: <20060803011633.13338417@werewolf.auna.net> <44D2F744.70302@gmail.com>
In-Reply-To: <44D2F744.70302@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 8bit
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

Tejun Heo wrote:
> J.A. Magallón wrote:
>> Hi...
>>
>> Following with my switch to libata for everything...
>> After latest patches, my burner and dvd work ok, apart from the fact that
>> they do not get auto-mounted in gnome environment.
>> udevmonitor shows nothing when a CD is inserted.
> 
> Media insertion is not notified to user space via udev, so userspace 
> implement cd automount by polling.  IIRC, back when libata ATAPI support 
> was premature, we had quite a few bug reports regarding error messages 
> generated by those polling activities.  Maybe your distribution disabled 
> polling for SCSI cdroms for that reason.  I seem to recollect the 
> polling was done by some gnome daemon, not sure which though.

The problem at the time was that libata error handling was horribly broken
and would randomly lock up the system from time to time.  Since CD autopolling
triggers a libata error each time it is done (1 or 2 times per second..),
it tended to trip over the libata EH bug and kill the system quite often.

I don't know what the distros did about it, other than patch the kernel
once we identified the issue.

Cheers
