Return-Path: <linux-kernel-owner+willy=40w.ods.org-S1752193AbWAEXHT@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1752193AbWAEXHT (ORCPT <rfc822;willy@w.ods.org>);
	Thu, 5 Jan 2006 18:07:19 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S1752191AbWAEXHR
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Thu, 5 Jan 2006 18:07:17 -0500
Received: from web26909.mail.ukl.yahoo.com ([217.146.176.98]:57745 "HELO
	web26909.mail.ukl.yahoo.com") by vger.kernel.org with SMTP
	id S932254AbWAEXHM (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
	Thu, 5 Jan 2006 18:07:12 -0500
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.fr;
  h=Message-ID:Received:Date:From:Subject:To:Cc:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=5I/2uh9UVrkNPmrzLHesuBgDlRXKURo3EDj0r6PqzsJqaDpzD+++nahU/l7g7xETZHbQz/6dRkN0SAe6Xm6y3L+vFmbmBZvOAQsIBGkMGUsygonpdPzYeQtL5Fikwi380qLbXhniNrX5JtkVeMLeF4+eoanz9OAnBg+XGxWAPcY=  ;
Message-ID: <20060105230710.34764.qmail@web26909.mail.ukl.yahoo.com>
Date: Fri, 6 Jan 2006 00:07:10 +0100 (CET)
From: Etienne Lorrain <etienne_lorrain@yahoo.fr>
Subject: [PATCH 2/3] boot with Gujin: core ia32 realmode files
To: akpm@osdl.org
Cc: linux-kernel@vger.kernel.org
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="0-657460192-1136502430=:32400"
Content-Transfer-Encoding: 8bit
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

--0-657460192-1136502430=:32400
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit
Content-Id: 
Content-Disposition: inline

 That is the core addition to generate /boot/linux-*.kgz file format
for the Gujin bootloader. It contains the realmode.c file and its
include realmode.h - that is a complete rewrite of all the ia16/ia32
assembler code executed at startup, so that directory arch/i386/boot
could be removed completely (then LILO, GRUB and SYSLINUX would no
more work).
 The mapping of the 4 Kbytes parameter page generated by the main
function linux_set_params() is identical to the one generated by
the assembler code in i386/boot/ directory, it is checked by the
inline function test_linux_param_struct() in realmode.h.
 The function linux_set_params() will be called by the Gujin
bootloader _before_ switching to protected mode for any kind
of real work, so that the information extracted is a lot
more reliable than some other bootloaders.
 The linker file arch/i386/kernel/vmlinux.lds.S is also modified
so that only one link is produced (no special real-mode link as
in the vmlinuz file format), the real mode part is linked starting
at address zero and protection is added so that no cross references
can appear in between the real mode link and the protected mode
kernel. The binary code of linux_set_params() is located at the end
of the kernel linux*.kgz file.
 This kernel does not have a lot of knowledge of the Gujin exposed
interface, so that it cannot guess where the kernel file loaded
in memory was located (which disk, which partition, in the root
filesystem or in a /boot directory) and so you have to provide
yourself the "root=" parameter by one of the interface of Gujin
or by the GZIP comment field. See "make help" for details.

Signed-off-by: etienne_lorrain@yahoo.fr



	

	
		
___________________________________________________________________________ 
Nouveau : téléphonez moins cher avec Yahoo! Messenger ! Découvez les tarifs exceptionnels pour appeler la France et l'international.
Téléchargez sur http://fr.messenger.yahoo.com
--0-657460192-1136502430=:32400
Content-Type: application/octet-stream; name="patch-2.6.15-mm1-2"
Content-Transfer-Encoding: base64
Content-Description: 2712597940-patch-2.6.15-mm1-2
Content-Disposition: attachment; filename="patch-2.6.15-mm1-2"

ZGlmZiAtdXByTiAtWCBsaW51eC0yLjYuMTUtbW0xL0RvY3VtZW50YXRpb24v
ZG9udGRpZmYgbGludXgtMi42LjE1LW1tMS0xL2FyY2gvaTM4Ni9LY29uZmln
IGxpbnV4LTIuNi4xNS1tbTEtMi9hcmNoL2kzODYvS2NvbmZpZwotLS0gbGlu
dXgtMi42LjE1LW1tMS0xL2FyY2gvaTM4Ni9LY29uZmlnCTIwMDYtMDEtMDUg
MjA6MzA6MjAuMDAwMDAwMDAwICswMDAwCisrKyBsaW51eC0yLjYuMTUtbW0x
LTIvYXJjaC9pMzg2L0tjb25maWcJMjAwNi0wMS0wNSAyMDo0MzoyNi4wMDAw
MDAwMDAgKzAwMDAKQEAgLTY5NCw2ICs2OTQsMTMgQEAgY29uZmlnIFBIWVNJ
Q0FMX1NUQVJUCiAJICBwYXNzZWQgdG8gdGhlIHBhbmljLWVkIGtlcm5lbC4g
VHlwaWNhbGx5IHRoaXMgcGFyYW1ldGVyIGlzIHNldCBhcwogCSAgY3Jhc2hr
ZXJuZWw9NjRNQDE2TS4gUGxlYXNlIHRha2UgYSBsb29rIGF0CiAJICBEb2N1
bWVudGF0aW9uL2tkdW1wL2tkdW1wLnR4dCBmb3IgbW9yZSBkZXRhaWxzIGFi
b3V0IGNyYXNoIGR1bXBzLgorCSAgWW91IGNhbiBhbHNvIGNoYW5nZSB0aGlz
IHBoeXNpY2FsIGFkZHJlc3Mgd2hlbiB1c2luZyB0aGUgR3VqaW4KKwkgIGJv
b3Rsb2FkZXIgKHNlZSBodHRwOi8vZ3VqaW4ub3JnKSwgZm9yIGluc3RhbmNl
IHRvIG1heGltaXplIHRoZQorCSAgZnJlZSBETUEtYWJsZSBtZW1vcnksIHNl
dCBpdCB0byAweDEwMDAwMDAgKGxvYWQgYW5kIHJ1biB0aGUga2VybmVsCisJ
ICBhdCAxNiBNYnl0ZXMpLiBHdWppbiBkb2VzIG5vdCBpbXBvc2UgYW55IGxp
bWl0IG9uIHRoaXMgYWRkcmVzcy4KKwkgIFRoaXMgY29uZmlndXJhdGlvbiBo
YXMgcmVjZWl2ZWQgYSBsb3QgbGVzcyB0ZXN0aW5nOyB0aGVuIG9ubHkKKwkg
IGdlbmVyYXRlIGxpbnV4Ki5rZ3oga2VybmVsIGZpbGVzIHRvIG5vdCBjb25m
dXNlIG90aGVyIGJvb3Rsb2FkZXJzCisJICAoaS5lLiBtYWtlIC9ib290L2xp
bnV4LTIuNi4xNS0xNk0ua2d6KS4KIAogCSAgRG9uJ3QgY2hhbmdlIHRoaXMg
dW5sZXNzIHlvdSBrbm93IHdoYXQgeW91IGFyZSBkb2luZy4KIApkaWZmIC11
cHJOIC1YIGxpbnV4LTIuNi4xNS1tbTEvRG9jdW1lbnRhdGlvbi9kb250ZGlm
ZiBsaW51eC0yLjYuMTUtbW0xLTEvYXJjaC9pMzg2L2tlcm5lbC9NYWtlZmls
ZSBsaW51eC0yLjYuMTUtbW0xLTIvYXJjaC9pMzg2L2tlcm5lbC9NYWtlZmls
ZQotLS0gbGludXgtMi42LjE1LW1tMS0xL2FyY2gvaTM4Ni9rZXJuZWwvTWFr
ZWZpbGUJMjAwNi0wMS0wNSAyMDozMDoyMC4wMDAwMDAwMDAgKzAwMDAKKysr
IGxpbnV4LTIuNi4xNS1tbTEtMi9hcmNoL2kzODYva2VybmVsL01ha2VmaWxl
CTIwMDYtMDEtMDUgMjA6NDk6NTEuMDAwMDAwMDAwICswMDAwCkBAIC03LDcg
KzcsNyBAQCBleHRyYS15IDo9IGhlYWQubyBpbml0X3Rhc2subyB2bWxpbnV4
LmxkCiBvYmoteQk6PSBwcm9jZXNzLm8gc2VtYXBob3JlLm8gc2lnbmFsLm8g
ZW50cnkubyB0cmFwcy5vIGlycS5vIFwKIAkJcHRyYWNlLm8gdGltZS5vIGlv
cG9ydC5vIGxkdC5vIHNldHVwLm8gaTgyNTkubyBzeXNfaTM4Ni5vIFwKIAkJ
cGNpLWRtYS5vIGkzODZfa3N5bXMubyBpMzg3Lm8gZG1pX3NjYW4ubyBib290
ZmxhZy5vIFwKLQkJcXVpcmtzLm8gaTgyMzcubyBpODI1My5vIHRzYy5vCisJ
CXF1aXJrcy5vIGk4MjM3Lm8gaTgyNTMubyB0c2MubyByZWFsbW9kZS5vCiAK
IG9iai15CQkJCSs9IGNwdS8KIG9iai0kKENPTkZJR19BQ1BJKQkJKz0gYWNw
aS8KZGlmZiAtdXByTiAtWCBsaW51eC0yLjYuMTUtbW0xL0RvY3VtZW50YXRp
b24vZG9udGRpZmYgbGludXgtMi42LjE1LW1tMS0xL2FyY2gvaTM4Ni9rZXJu
ZWwvcmVhbG1vZGUuYyBsaW51eC0yLjYuMTUtbW0xLTIvYXJjaC9pMzg2L2tl
cm5lbC9yZWFsbW9kZS5jCi0tLSBsaW51eC0yLjYuMTUtbW0xLTEvYXJjaC9p
Mzg2L2tlcm5lbC9yZWFsbW9kZS5jCTE5NzAtMDEtMDEgMDE6MDA6MDAuMDAw
MDAwMDAwICswMTAwCisrKyBsaW51eC0yLjYuMTUtbW0xLTIvYXJjaC9pMzg2
L2tlcm5lbC9yZWFsbW9kZS5jCTIwMDYtMDEtMDUgMjA6MzE6NTkuMDAwMDAw
MDAwICswMDAwCkBAIC0wLDAgKzEsMTQxMSBAQAorLyoKKyAqICBUaGlzIGZp
bGUgInJlYWxtb2RlLmMiIGlzIGxpY2Vuc2VkIHdpdGggdGhlIHNhbWUgbGlj
ZW5zZSBhcyB0aGUgTGludXgKKyAqIGtlcm5lbCwgYW5kIGFueXdheSB0aGUg
bWFwcGluZyBvZiB0aGUgZGF0YSBzdHJ1Y3R1cmUgcHJvZHVjZWQgaXMgb3du
ZWQKKyAqIGJ5IExpbnV4IGtlcm5lbCBjb3B5cmlnaHQgb3duZXIocykgLSBm
b3IgYSBsb25nIHRpbWUuCisgKgorICogIFRoZSBtYWluIHVzZSBvZiB0aGlz
IGZpbGUgaXMgdG8gcHJvZHVjZSBhICJHdWppbiBuYXRpdmUgYm9vdGFibGUg
ZmlsZSIKKyAqIGkuZS4gYSBMaW51eCBrZXJuZWwgd2l0aCBhICJrZ3oiIGV4
dGVuc2lvbiwgd2hpY2ggaXMgYSBzdGFuZGFyZCBFTEYKKyAqIGV4ZWN1dGFi
bGUgZmlsZSB0cmFuc2xhdGVkIHRvIGJpbmFyeSBpbWFnZSBieSBPQkpDT1BZ
IGFuZCBjb21wcmVzc2VkCisgKiBieSBHWklQLiBUaGlzIGluaXRpYWwgRUxG
IGZpbGUgbWF5IGNvbnRhaW4gYW4gaWEzMiByZWFsIG1vZGUgc2VjdGlvbgor
ICogYXQgaXRzIGVuZCAoc2l6ZSBpbiAicmVhbGZjdF9zaXplIiBwYXJhbWV0
ZXIpIHRvIGJlIGNvcGllZCBpbiBsb3cgbWVtb3J5CisgKiBieSB0aGUgYm9v
dGxvYWRlciBhbmQgZXhlY3V0ZWQgYmVmb3JlIHN3aXRjaGluZyB0byBpYTMy
IHByb3RlY3RlZCBtb2RlLAorICogc28gdGhhdCB0aGUgTGludXgga2VybmVs
IGNhbiBpbnRlcnJvZ2F0ZSB0aGUgQklPUy4KKyAqIElmIHRoZXJlIGlzIG5v
IHJlYWwgbW9kZSBzZWN0aW9uIGluIHRoZSBFTEYgZmlsZSwgdGhlbiAicmVh
bGZjdF9zaXplIgorICogaXMgc2V0IHRvIHplcm8gb3Igbm90IGdpdmVuIGF0
IGFsbCwgYW5kIGEgZGVmYXVsdCBtYXBwaW5nIGlzIGZpbGxlZCBieQorICog
R3VqaW4gLSB0aGF0IHNoYWxsIGJvb3QgbmVhcmx5IGV2ZXJ5IExpbnV4IGtl
cm5lbCBzaW5jZSB0aGUgb2xkIHRpbWUgKFRNKS4KKyAqCisgKiBHdWppbiBo
b21lcGFnZSBpcyBhdDogaHR0cDovL2d1amluLm9yZy8gOyBpdCBpcyBpdHNl
bGYgbGljZW5zZWQKKyAqIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdl
bmVyYWwgUHVibGljIExpY2Vuc2UsIHZlcnNpb24gMi4KKyAqIEd1amluIGlz
IENvcHlyaWdodCAoQykgMTk5OS0yMDA1IEV0aWVubmUgTG9ycmFpbiwgZmlu
Z2VycHJpbnQgKDJEM0FGM0VBKToKKyAqICAgMjQ3MSBERjY0IDlERUUgNDFE
NCBDOERCIDk2NjcgRTQ0OCBGRjhDIDJEM0EgRjNFQQorICogRS1NYWlsOiBl
dGllbm5lIGRvdCBsb3JyYWluIGF0IGd1amluIGRvdCBvcmcKKyAqCisgKiAg
Rmlyc3QgdmVyc2lvbiBoYXMgYmVlbiB3cml0dGVuIGJ5IEV0aWVubmUgTG9y
cmFpbiBpbiBEZWNlbWJlciAyMDA0LgorICogVGhpcyBwYXRjaCBjYW5ub3Qg
cmVhbGx5IGJlIGFwcGxpZWQgdG8gTGludXgtMi4xMSBhbmQgYmVmb3JlIHdp
dGhvdXQKKyAqIGxvb3NpbmcgdGhlIEVERCBhbmQgRURJRCBpbmZvbWF0aW9u
IHdoaWNoIG1vdmVkIGluIExpbnV4LTIuNi4xMgorICovCisKKy8qCisgKiBE
byBub3QgdG91Y2ggLSB1c2VkIHRvIGdlbmVyYXRlIHJlYWwgbW9kZSBpYTMy
IGNvZGUgYW5kIG1hbmFnZQorICogdGhlIGludGVyLXNlZ21lbnQgY2FsbCB0
cmFuc3BhcmVudGx5LCBhZnRlciBtYXhpbXVtIDQgS2J5dGVzCisgKiBvZiBy
ZWFsIG1vZGUgcm9kYXRhL2RhdGEgaGFzIGJlZW4gY29waWVkIGluICVkcyBz
ZWdtZW50LgorICoKKyAqIEhhdmluZyBjb25zdGFudC9pbml0aWFsaXNlZCB2
YXJpYWJsZSBpbiBoZXJlIGlzIGEgYml0IHRyaWNreSwKKyAqIGl0IHVzZXMg
dGhlIGZhY3QgdGhhdCBzaW5jZSBHdWppbi0xLjAsIHRoZSBzZWdtZW50ICIu
Zm91cktzZWdtZW50IgorICogY29udGFpbm5pbmcgdGhlIG9ubHkgdmFyaWFi
bGUgImZvdXJLYnVmZmVyIiAob2Ygc2l6ZSA0IEtieXRlcykKKyAqIGlzIGxv
Y2F0ZWQgYXQgJWRzOjAgaS5lLiBiZWZvcmUgdGhlICIucm9kYXRhIiBvZiBH
dWppbi4KKyAqIE5vdGUgdGhhdCBoZXJlIHRoZSBjb2RlIHNlZ21lbnQgaXMg
bG9jYWwgYnV0IHRoZSBkYXRhIHNlZ21lbnQKKyAqIChhbmQgdGhlIHN0YWNr
IHNlZ21lbnQpIGlzIHRoZSBvbmUgb2YgR3VqaW4gZm9yIG9idmlvdXMgcmVh
c29ucy4KKyAqIFRoZSBmaXJzdCBwZXJzb24gbW9kaWZ5aW5nIGRhdGEgYXQg
YWRkcmVzcyBvdmVyICVkczoweDEwMDAKKyAqIGdldCBhbGwgdGhlIGJsYW1l
IGZvciBhbnkgYnVnIGhhcHBlbmluZyBpbiBHdWppbiwgaW4gYmV0d2Vlbgor
ICogdGhlIGxhc3QgYW5kIHRoZSBuZXh0IGJpZyBiYW5nLCBhbmQgaXQgaXMg
YSBwcmV0dHkgbG9uZyB0aW1lLgorICogPHNtaWxlPllvdSBkb24ndCBsaWtl
IG15IG1lbW9yeSBwcm90ZWN0aW9uIHN5c3RlbT88L3NtaWxlPgorICovCith
c20oIgkucHNpemUgMAkJCQlcbiIKKyAgICAiCS5jb2RlMTZnY2MJCQkJXG4i
CisgICAgIgkuc2VjdGlvbiAuaW5pdC50ZXh0MTYsXCJheFwiLEBwcm9nYml0
cwlcbiIKKyAgICAiCXB1c2gJJWRpCQkJCVxuIgorICAgICIJcHVzaAklc2kJ
CQkJXG4iCisgICAgIgltb3YJJF9zZGF0YTE2LCVzaQkJCVxuIgorICAgICIJ
bW92CSVzaSwlZGkJCQkJXG4iCisgICAgIgltb3YJJF9lZGF0YTE2LCVjeAkJ
CVxuIgorICAgICIJYW5kCSQweEZGRiwlY3gJCQlcbiIKKyAgICAiCXN1Ygkl
c2ksJWN4CQkJCVxuIgorICAgICIJc2hyCSQyLCVjeAkJCQlcbiIKKyAgICAi
CXJlcCBtb3ZzbCAlY3M6KCVzaSksJWVzOiglZGkpCQlcbiIKKyAgICAiCXBv
cAklc2kJCQkJXG4iCisgICAgIglwb3AJJWRpCQkJCVxuIgorICAgICIJY2Fs
bGwJbGludXhfc2V0X3BhcmFtcwkJXG4iCisgICAgIglscmV0dwkJCQkJXG4i
CisgICAgIgkucHJldmlvdXMJCQkJXG4iCispOworCisjaW5jbHVkZSAiYXNt
L3JlYWxtb2RlLmgiCisKKy8qCisgKiBUaG9zZSBuZWVkIHRvIGJlIHVzZWQg
YmVjYXVzZSB0aGVyZSBpcyBubyB3YXkgdG8gc2V0IHRoZSBkZWZhdWx0Cisg
KiBzZWdtZW50IG5hbWUgdXNlZCBmb3IgIi50ZXh0IiwgIi5kYXRhIiwgIi5y
b2RhdGEqIiBhbmQgIi5ic3MiCisgKiBJdCB3b3VsZCBiZSBuaWNlIHRvIGJl
IGFibGUgdG8gZG86IGFzbSgiLmVxdSAuZGF0YSwgLmRhdGExNiIpOworICog
b3Igc2hhbGwgdGhhdCBiZSBtYW5hZ2VkIGJ5IHRoZSBjb21waWxlciAtIGFu
ZCBieSBjb21waWxhdGlvbgorICogc3dpdGNoIG9yIGJ5IHRoZSBhdHRyaWJ1
dGUgb2YgZnVuY3Rpb25zPworICogVGhpcyBmaWxlIGlzIHByZS1saW5rZWQg
KHNlY3Rpb24gd2l0aCBzYW1lIG5hbWUgZ3JvdXBlZCB0b2dldGhlcikKKyAq
IGluICJhcmNoL2kzODYva2VybmVsL2J1aWx0LWluLm8iIHNvIG5vIGhvcGUg
dG8gbWFuYWdlIGl0IGluCisgKiB0aGUgZmluYWwgbGlua2VyIGZpbGUgaWYg
aXQgdXNlcyB0aGUgc2FtZSBzZWN0aW9uIG5hbWVzLgorICogTWF5YmUgaWYg
ImFyY2gvaTM4Ni9rZXJuZWwvYnVpbHQtaW4ubyIgY291bGQgYmUgYW4gYXJj
aGl2ZT8KKyAqIE1heWJlIGl0IGlzICJ0aGUgcmlnaHQgd2F5IChUTSkiIHRv
IHVzZSBkaWZmZXJlbnQgc2VjdGlvbiBuYW1lcworICogc28gdGhhdCB0aG9z
ZSBmdW5jdGlvbnMgY2FuIGJlIGxvY2F0ZWQgaW4gZGlmZmVyZW50IHNvdXJj
ZSBmaWxlcy4KKyAqIE1heWJlIHRoZSBzZWN0aW9uIG5hbWUgc2hhbGwgYmUg
YXV0b21hdGljYWxseSBjaGFuZ2VkIHVzaW5nCisgKiBvYmpjb3B5IGluIHRo
ZSByZWFsbW9kZS5vIGZpbGUsIGp1c3QgYWZ0ZXIgY29tcGlsYXRpb24uCisg
KiBNYXliZSB0aGUgc2VnbWVudCBuYW1lcyBzaGFsbCBiZSBjaGFuZ2VkIGJ5
IHNlZCBpbiB0aGUKKyAqIGFzc2VtYmxlciBmaWxlLgorICoKKyAqIFVuZm9y
dHVuYXRlbHksIEkgZG8gbm90IGtub3cgaG93IHRvIHVzZSBpbmxpbmUgc3Ry
aW5ncyBoZXJlLAorICogaS5lLiBwdXRzKCJoZWxsbyB3b3JsZCIpOyB3aWxs
IG5vdCB3b3JrIGR1ZSB0byB0aGUgc2VnbWVudAorICogdXNlZCB0byBzdG9y
ZSB0aGUgY29uc3RhbnQgImhlbGxvIHdvcmxkIi4KKyAqIFNhbWUgZm9yIHRo
ZSBpbXBsaWNpdCB0YWJsZSBnZW5lcmF0ZWQgYnkgYSBiaWcgc3dpdGNoKCku
CisgKiBUaGlzIHdvdWxkIGdlbmVyYXRlIGEgcHJvaGliaXRlZCBjcm9zcyBy
ZWZlcmVuY2UgYXQgbGlua2VyIHRpbWUuCisgKgorICogSSBhbHNvIG5lZWQg
dG8gYWRkIHRoYXQgdXNpbmcgR0NDIHRvIGdlbmVyYXRlIHJlYWwtbW9kZSBp
Mzg2CisgKiBleGVjdXRhYmxlIGhhcyBhIG1ham9yIGxpbWl0YXRpb246IG5v
IHVzZSBvZiBsaWJyYXJ5IGNvbXBpbGVkCisgKiBmb3IgcHJvdGVjdGVkIG1v
ZGUuIElmIHlvdXIgc291cmNlIG1ha2UgR0NDIHRvIGNhbGwgbWVtY3B5KCks
CisgKiBtZW1zZXQoKSwgc3RyY3B5KCkuLi4gdGhlbiB5b3UgaGF2ZSB0byBw
cm92aWRlIHRoZW0geW91cnNlbGYuCisgKiBUaGUgc2FtZSB0aGluZyBhcHBs
eSBpZiB5b3UgbXVsdGlwbHkgb3IgZGl2aWRlIDY0IGJpdCBudW1iZXJzCisg
KiBieSBub24gcG93ZXIgb2YgdHdvLiBBZGRpbmcgYW5kIHN1YnN0cmFjdGlu
ZyBvZiBsb25nIGxvbmcgaXMgT0suCisgKi8KKyNkZWZpbmUgQ09OU1QJCV9f
YXR0cmlidXRlX18gKChzZWN0aW9uICgiLnJvZGF0YTE2IikpKSBjb25zdAor
I2RlZmluZSBWQVJJQUJMRQlfX2F0dHJpYnV0ZV9fICgoc2VjdGlvbiAoIi5k
YXRhMTYiKSkpCisjZGVmaW5lIEJTUwkJX19hdHRyaWJ1dGVfXyAoKHNlY3Rp
b24gKCIuYnNzMTYiKSkpCisjZGVmaW5lIENPREUJCV9fYXR0cmlidXRlX18g
KChzZWN0aW9uICgiLnRleHQxNiIpKSkKKworI2lmIDAKKy8qCisgKiBXaGVu
IGNvbXBpbGluZyB0aGlzIGZpbGUsIHNvbWUgY29tYmluYXRpb24gb2YgR0ND
IGFuZCBvcHRpb25zCisgKiB3aWxsIGNhbGwgbWVtc2V0KCkgaW4gdGhlIGFz
c2VtYmx5IGdlbmVyYXRlZC4gWW91IGNhbiBjaGVjayBpdAorICogYnkgdHlw
aW5nICJtYWtlIGFyY2gvaTM4Ni9rZXJuZWwvcmVhbG1vZGUucyIuCisgKiBU
aGV5IGNhbm5vdCBiZSBpbmxpbmUgYmVjYXVzZSB0aGV5IGFyZSBfY2FsbGVk
XyBieSB0aGUgY29tcGlsZXIuCisgKiBJdCBpcyBub3QgcG9zc2libGUgdG8g
YWNjZXNzIHRoZSBzdGFuZGFyZCBvbmUgYmVjYXVzZSBpdHMKKyAqIGhleGFk
ZWNpbWFsIGNvZGluZyBpcyBmb3IgcHJvdGVjdGVkIG1vZGUsIGFuZCBub3Qg
cG9zc2libGUgdG8KKyAqIGNvZGUgaXQgaW4gYXNzZW1ibGVyIGJlY2F1c2Ug
b2Ygd2UgZG8gbm90IGtub3cgdGhlIGNhbGxpbmcKKyAqIGNvbnZlbnNpb24g
KEdDQyBvcHRpbWlzYXRpb25zIGxpa2UgIi1tdHJkIiwgIi1tcmVncGFybT0z
IikuCisgKiBXZSBhbHNvIGNhbm5vdCBoYXZlIHR3byBtZW1jcHkoKSBub3Ig
bWVtc2V0KCkgaW4gdGhlIHNhbWUKKyAqIGZpbmFsIGxpbmssIHNvIHdlIHJl
bmFtZSB0aGVtIGluIGFzc2VtYmxlci4KKyAqIFRoaXMgcGFydCBpcyBjdXJy
ZW50bHkgZGlzYWJsZWQgZHVlIHRvIGEgcHJvYmxlbSBpbiB0aGUgbGlua2Vy
CisgKiBidXQgcmlnaHQgbm93IG5vIEdDQyBzd2l0Y2ggY29tYmluYXRpb24g
cHJvZHVjZXMgbWVtc2V0L21lbWNweSBjYWxscy4KKyAqLworQ09ERSB2b2lk
IGNvZGUxNl9tZW1jcHkgKGNoYXIgKmRlc3QsIGNvbnN0IGNoYXIgKnNyYywg
dW5zaWduZWQgbmIpCit7CisJd2hpbGUgKG5iLS0pCisJCSpkZXN0KysgPSAq
c3JjKys7Cit9CitDT0RFIHZvaWQgY29kZTE2X21lbXNldCAoY2hhciAqZGVz
dCwgdW5zaWduZWQgdmFsLCB1bnNpZ25lZCBuYikKK3sKKwl3aGlsZSAobmIt
LSkKKwkJKmRlc3QrKyA9IHZhbDsKK30KK2FzbSAoCisgICAgIm1lbWNweSA9
IGNvZGUxNl9tZW1jcHkgXG4iCisgICAgIm1lbXNldCA9IGNvZGUxNl9tZW1z
ZXQgXG4iCispOworI2VuZGlmCisKKy8qKgorICoqIEZldyBkZWJ1ZyBmdW5j
dGlvbnMgYW5kIGhvdyB0byB1c2UgdGhlbSwgaW5jbHVkaW5nIGhvdyB0byBk
ZWNsYXJlCisgKiogdmFyaWFibGVzIGFuZCBjb25zdGFudHMuIEZvciBjb21w
bGV4IGRlYnVnLCB5b3UgbWF5IHdhbnQgdG8KKyAqKiBjaGVjayBkYmdsb2Fk
LmV4ZSBvZiBHdWppbi4gVGhlIGZvbGxvd2luZyBkZWJ1ZyB1c2VzIHRoZSBW
SURFTyBCSU9TCisgKiogdG8gZGlzcGxheSBtZXNzYWdlcyBzbyB3aWxsIG5v
dCB3b3JrIGluIFZFU0EgbW9kZXMgd2hlbiB0aGUgVkVTQQorICoqIEJJT1Mg
ZG8gbm90IHN1cHBvcnQgcHJpbnRpbmcgY2hhcmFjdGVycyBpbiBjdXJyZW50
IHZpZGVvIG1vZGUKKyAqKiAoYml0IEJJT1Nfb3V0cHV0X3N1cHBvcnRlZCBv
ZiBWRVNBX21vZGVpbmZvX3QgLyBzdHJ1Y3Qgc2NyZWVuX2luZm8pCisgKiov
CisvLyNkZWZpbmUgVEVTVF9WR0FQUklOVAorCisjaWZkZWYgVEVTVF9WR0FQ
UklOVAorQ09OU1QgY2hhciB0ZXN0X2JlZm9yZVtdID0gInRlc3Q6IDB4IjsK
K1ZBUklBQkxFIHVuc2lnbmVkIHRlc3RfdmFsID0gMHgwODlBQkMwOworQ09O
U1QgY2hhciB0ZXN0X21pZGRsZVtdID0gIiwgdGVzdF92YWwyID0gMHgiOwor
QlNTIHVuc2lnbmVkIHRlc3RfdmFsMjsKK1ZBUklBQkxFIGNoYXIgdGVzdF9h
ZnRlcltdID0gIi5cclxuIjsKKworI2RlZmluZSBQVVNIQUxMICJwdXNodyAl
JWRzOyBwdXNodyAlJWVzOyBwdXNodyAlJWZzOyBwdXNodyAlJWdzOyBwdXNo
YWxcbiIKKyNkZWZpbmUgUE9QQUxMICAicG9wYWw7IHBvcHcgJSVnczsgcG9w
dyAlJWZzOyBwb3B3ICUlZXM7IHBvcHcgJSVkc1xuIgorCitDT0RFIHN0YXRp
YyB2b2lkIHZnYXB1dHMgKGNvbnN0IGNoYXIgKnN0cmluZykKK3sKKwl3aGls
ZSAoKnN0cmluZyAhPSAnXDAnKQorCQlhc20oUFVTSEFMTAorCQkgICAgIglt
b3Z3CSQweDAwMDcsJSVieFxuCWludAkkMHgxMAlcbiIKKwkJICAgIFBPUEFM
TAorCQkgICAgOiA6ICJhIiAoMHgwRTAwIHwgKHVuc2lnbmVkIGNoYXIpKnN0
cmluZysrKSk7Cit9CisKK0NPREUgc3RhdGljIHZvaWQgdmdhcHV0eCAodW5z
aWduZWQgdmFsKQoreworCXVuc2lnbmVkIGRpZ2l0X3NoaWZ0ID0gNyAqIDQ7
CisKKwl3aGlsZSAoZGlnaXRfc2hpZnQgJiYgKHZhbCAmICgweEYgPDwgZGln
aXRfc2hpZnQpKSA9PSAwKQorCQlkaWdpdF9zaGlmdCAtPSA0OworCWZvciAo
OzspIHsKKwkJYXNtKFBVU0hBTEwKKwkJICAgICIJbW92dwkkMHgwMDA3LCUl
YngJXG4iCisJCSAgICAiCXNhaGYJIyBjbGVhciBBRglcbiIKKwkJICAgICIJ
YWFhCQkJXG4iCisJCSAgICAiCWFhZAkkMHgxMQkJXG4iCisJCSAgICAiCWFk
ZAkkMHgwRTMwLCUlYXgJXG4iCisJCSAgICAiCWludAkkMHgxMAkJXG4iCisJ
CSAgICBQT1BBTEwKKwkJICAgIDogOiAiYSIgKCh2YWwgPj4gZGlnaXRfc2hp
ZnQpICYgMHgwRikpOworCQlpZiAoZGlnaXRfc2hpZnQgPT0gMCkKKwkJCWJy
ZWFrOworCQlkaWdpdF9zaGlmdCAtPSA0OworCX0KK30KKworQ09ERSBzdGF0
aWMgaW5saW5lIHZvaWQgdmdhX3dhaXRfc2Vjb25kcyAodW5zaWduZWQgc2Vj
b25kcykKK3sKKwl1bnNpZ25lZCBuYl9taWNyb3NlYyA9IHNlY29uZHMgKiAx
MDAwICogMTAwMDsKKwl1bnNpZ25lZCBzaG9ydCBzdGF0dXM7CisKKwlhc20g
dm9sYXRpbGUgKCIJaW50CSQweDE1CSMgX0JJT1Nfd2FpdCAiCisJICAgICA6
ICI9YSIgKHN0YXR1cykKKwkgICAgIDogImEiICgodW5zaWduZWQgc2hvcnQp
MHg4NjAwKSwgImQiIChuYl9taWNyb3NlYyAmIDB4RkZGRiksCisJCSAiYyIg
KG5iX21pY3Jvc2VjID4+IDE2KSk7Cit9CisKK2V4dGVybiBpbmxpbmUgdm9p
ZCB0ZXN0X3ZnYXByaW50ICh2b2lkKQoreworCXVuc2lnbmVkIHN0YWNrcHRy
OworCXN0YXRpYyBDT05TVCBjaGFyIHN0a21zZ1tdID0gIiwgc3AgPSAweCI7
CisKKwlhc20gKCIgbW92CSUlZXNwLCUwICIgOiAiPXIiIChzdGFja3B0cikp
OworCXRlc3RfdmFsMiA9IDB4MTIzNGZlZGM7CisKKwl2Z2FwdXRzKHRlc3Rf
YmVmb3JlKTsKKwl2Z2FwdXR4KHRlc3RfdmFsKTsKKwl2Z2FwdXRzKHRlc3Rf
bWlkZGxlKTsKKwl2Z2FwdXR4KHRlc3RfdmFsMik7CisJdmdhcHV0cyhzdGtt
c2cpOworCXZnYXB1dHgoc3RhY2twdHIpOworCXZnYXB1dHModGVzdF9hZnRl
cik7CisJdmdhX3dhaXRfc2Vjb25kcyg3KTsKK30KKworI2RlZmluZSBEQkco
c3RhcnRzdHIsIHZhcmlhYmxlLCBlbmRzdHIpIHsgXAorCXN0YXRpYyBDT05T
VCBjaGFyIGJlZm9yZVtdPXN0YXJ0c3RyLCBhZnRlcltdID0gZW5kc3RyOwlc
CisJdmdhcHV0cyhiZWZvcmUpOyB2Z2FwdXR4KHZhcmlhYmxlKTsgdmdhcHV0
cyhhZnRlcik7CVwKKwl9CisjZGVmaW5lIERCR19XQUlUKCkJdmdhX3dhaXRf
c2Vjb25kcyg3KQorI2Vsc2UKKyNkZWZpbmUgdGVzdF92Z2FwcmludCgpCS8q
bm90aGluZyovCisjZGVmaW5lIERCRyhzdGFydHN0ciwgdmFyaWFibGUsIGVu
ZHN0cikJLypub3RoaW5nKi8KKyNkZWZpbmUgREJHX1dBSVQoKQkvKm5vdGhp
bmcqLworI2VuZGlmCisKKy8qKgorICoqIEFsbCB0aGUgbm9uIEJJT1MgcmVs
YXRlZCwgbG93IGxldmVsIGZ1bmN0aW9ucyB3ZSB1c2U6CisgKiovCitleHRl
cm4gaW5saW5lIHVuc2lnbmVkIHBlZWtiIChmYXJwdHIgYWRyKQoreworCXVu
c2lnbmVkIHJldHVybmVkOworCXVuc2lnbmVkIHNob3J0IHNjcmF0Y2g7CisJ
ZXh0ZXJuIGNoYXIgbWVtb3J5W107CisKKyAgICAgIGFzbSgiCXB1c2hsCSUy
CQlcbiIKKwkgICIJcG9wdwkldzAJCVxuIgorCSAgIglwb3B3CSUlZnMJCVxu
IgorCSAgIgltb3Z6YmwJJSVmczooJXcwKSwlMQlcbiIKKwkgIDogIj1iU0RC
IiAoc2NyYXRjaCksICI9ciIgKHJldHVybmVkKQorCSAgOiAiZyIgKGFkciks
ICJtIiAoKm1lbW9yeSkgKTsKKwlyZXR1cm4gcmV0dXJuZWQ7Cit9CisKK2V4
dGVybiBpbmxpbmUgdW5zaWduZWQgcGVla3cgKGZhcnB0ciBhZHIpCit7CisJ
dW5zaWduZWQgcmV0dXJuZWQ7CisJdW5zaWduZWQgc2hvcnQgc2NyYXRjaDsK
KwlleHRlcm4gY2hhciBtZW1vcnlbXTsKKworICAgICAgYXNtKCIJcHVzaGwJ
JTIJCVxuIgorCSAgIglwb3B3CSV3MAkJXG4iCisJICAiCXBvcHcJJSVmcwkJ
XG4iCisJICAiCW1vdnp3bAklJWZzOigldzApLCUxCVxuIgorCSAgOiAiPWJT
REIiIChzY3JhdGNoKSwgIj1yIiAocmV0dXJuZWQpCisJICA6ICJnIiAoYWRy
KSwgIm0iICgqbWVtb3J5KSApOworCXJldHVybiByZXR1cm5lZDsKK30KKwor
ZXh0ZXJuIGlubGluZSB2b2lkIG91dGIgKHVuc2lnbmVkIHNob3J0IHBvcnQs
IHVuc2lnbmVkIGNoYXIgZGF0YSkKK3sKKwlhc20gdm9sYXRpbGUgKCIgb3V0
YiAlMCwlMSAiIDogOiAiYSIgKGRhdGEpLCAiZE4iIChwb3J0KSk7Cit9CisK
K2V4dGVybiBpbmxpbmUgdW5zaWduZWQgY2hhciBpbmIgKHVuc2lnbmVkIHNo
b3J0IHBvcnQpCit7CisJdW5zaWduZWQgY2hhciByZXN1bHQ7CisJYXNtIHZv
bGF0aWxlICgiIGluYiAlMSwlMCAiIDogIj1hIiAocmVzdWx0KSA6ICJkTiIg
KHBvcnQpKTsKKwlyZXR1cm4gcmVzdWx0OworfQorCitleHRlcm4gaW5saW5l
IHZvaWQgc2hvcnRfZGVsYXkgKHVuc2lnbmVkIGNvdW50KQoreworCWFzbSB2
b2xhdGlsZSAoIiBsb29wbCAuIFxuIiA6ICIrYyIgKGNvdW50KSk7Cit9CisK
K2V4dGVybiBpbmxpbmUgdW5zaWduZWQgY2hhciBnZXRudnJhbSAodW5zaWdu
ZWQgY2hhciBhZGRyKQoreworCW91dGIoMHg3MCwgYWRkciAmIH4weDgwKTsJ
LyogYml0IDcgY2xlYXJlZDogTk1JIGVuYWJsZWQgKi8KKwlzaG9ydF9kZWxh
eSgxMDAwKTsJLyogd2FpdCAxMDAwIGFzc2VtYmx5IGluc3RydWN0aW9ucyAq
LworCXJldHVybiBpbmIoMHg3MSk7Cit9CisKK19fYXR0cmlidXRlX18gKChj
b25zdCkpIGV4dGVybiBpbmxpbmUgZmFycHRyCitzdGFja19mYXJwdHIgKGNv
bnN0IHZvaWQgKmRhdGEpCit7CisJdW5zaWduZWQgc3RhY2tzZWdfbWFzazsg
IC8qIHN0YWNrIGlzIG1heCA2NCBLICovCisKKwlhc20gKCIgbW92ICUlc3Ms
JTAgXG4iIDogIj1yIiAoc3RhY2tzZWdfbWFzaykpOworCXJldHVybiAoZmFy
cHRyKSgoc3RhY2tzZWdfbWFzayA8PCAxNikgfCAodW5zaWduZWQpIGRhdGEp
OworfQorCisvKioKKyAqKiBHZW5lcmljIEJJT1MgY2FsbHM6CisgKiovCisK
K2V4dGVybiBpbmxpbmUgc3RydWN0IHNoaWZ0X2ZsYWdzX3N0ciB7CisJdW5z
aWduZWQgY2hhciByaWdodF9zaGlmdF9rZXlfcHJlc3NlZAk6IDE7CisJdW5z
aWduZWQgY2hhciBsZWZ0X3NoaWZ0X2tleV9wcmVzc2VkCTogMTsKKwl1bnNp
Z25lZCBjaGFyIGNvbnRyb2xfa2V5X3ByZXNzZWQJOiAxOworCXVuc2lnbmVk
IGNoYXIgYWx0ZXJuYXRlX2tleV9wcmVzc2VkCTogMTsKKwl1bnNpZ25lZCBj
aGFyIHNjcm9sbF9sb2NrX2FjdGl2ZQk6IDE7CisJdW5zaWduZWQgY2hhciBu
dW1fbG9ja19hY3RpdmUJCTogMTsKKwl1bnNpZ25lZCBjaGFyIGNhcHNfbG9j
a19hY3RpdmUJCTogMTsKKwl1bnNpZ25lZCBjaGFyIGluc2VydF9hY3RpdmUJ
CTogMTsKK30gX0JJT1NfZ2V0X3NoaWZ0X2ZsYWdzICh2b2lkKQoreworCXN0
cnVjdCBzaGlmdF9mbGFnc19zdHIgZmxhZ3M7CisKKwlhc20gKCIgaW50ICQw
eDE2ICMgX0JJT1NfZ2V0X3NoaWZ0X2ZsYWdzIgorCSAgICAgOiAiPWEiIChm
bGFncykKKwkgICAgIDogImEiICgodW5zaWduZWQgc2hvcnQpMHgwMjAwKSAp
OworCXJldHVybiBmbGFnczsKK30KKworZXh0ZXJuIGlubGluZSBmYXJwdHIg
X0JJT1NfZ2V0Q29uZmlndXJhdGlvbiAodm9pZCkKK3sKKwl1bnNpZ25lZCBj
aGFyIGVycm9yOworCWZhcnB0ciBjb25mOworCisJYXNtICgiCXB1c2hsCSUl
ZXMJCQkJCQlcbiIKKwkgICAgICIJc3RjCQkJCQkJCVxuIgorCSAgICAgIglp
bnQJJDB4MTUJCSMgX0JJT1NfZ2V0Q29uZmlndXJhdGlvbglcbiIKKwkgICAg
ICIJc2V0YwklJWFsCQkJCQkJXG4iCisJICAgICAiCXB1c2h3CSUlZXMJCQkJ
CQlcbiIKKwkgICAgICIJcHVzaHcJJSVieAkJCQkJCVxuIgorCSAgICAgIglw
b3BsCSUlZWJ4CQkJCQkJXG4iCisJICAgICAiCXBvcGwJJSVlcwkJCQkJCVxu
IgorCSAgICAgOiAiPWEiIChlcnJvciksICI9YiIgKGNvbmYpCisJICAgICA6
ICJhIiAoKHVuc2lnbmVkIHNob3J0KTB4QzAwMCkgKTsKKwlpZiAoZXJyb3Ip
CisJCXJldHVybiAoZmFycHRyKTA7CisJcmV0dXJuIGNvbmY7Cit9CisKK2V4
dGVybiBpbmxpbmUgdm9pZAorZ2V0X2Jpb3NfY29uZiAoZmFycHRyIGFkciwg
c3RydWN0IHN5c19kZXNjX3RhYmxlX2luZm8gKnN5c19kZXNjX3RhYmxlKQor
eworCXVuc2lnbmVkIG5iYnl0ZSA9IHNpemVvZihzdHJ1Y3Qgc3lzX2Rlc2Nf
dGFibGVfaW5mbyk7CisKKwlhc20gKCIJcHVzaGwJJSVlc2kJCQkJXG4iCisJ
ICAgICAiCXBvcHcJJSVzaQkJCQlcbiIKKwkgICAgICIJcG9wdwklJWZzCQkJ
CVxuIgorCSAgICAgIgljbGQJCQkJCVxuIgorCSAgICAgIglyZXAgbW92c2Ig
JSVmczooJSVzaSksJSVlczooJSVkaSkJXG4iCisJICAgICA6ICIrUyIgKGFk
ciksICIrRCIgKHN5c19kZXNjX3RhYmxlKSwgIitjIiAobmJieXRlKSwgIj1Y
IiAoKnN5c19kZXNjX3RhYmxlKQorCSAgICAgKTsKK30KKworZXh0ZXJuIGlu
bGluZSB1bnNpZ25lZCBjaGFyCitfQklPU19nZXRFeHRlbmRlZE1lbW9yeSAo
dW5zaWduZWQgc2hvcnQgKnNpemVpbktiKQoreworCXVuc2lnbmVkIGNoYXIg
ZXJyb3I7CisKKwlhc20gKCIJaW50CSQweDE1CSMgX0JJT1NfZ2V0RXh0ZW5k
ZWRNZW1vcnkJXG4iCisJICAgICAiCXNldGMJJTAJCQkJCVxuIgorCSAgICAg
OiAiPXFtIiAoZXJyb3IpLCAiPWEiICgqc2l6ZWluS2IpCisJICAgICA6ICJh
IiAoKHVuc2lnbmVkIHNob3J0KTB4ODgwMCkKKwkgICAgICk7CisJcmV0dXJu
IGVycm9yOwkvKiAwIGlmIG5vIGVycm9yICovCit9CisKK3N0cnVjdCBNZW1v
cnlNYXBfc3RyIHsKKwl1bnNpZ25lZCBsb25nIGxvbmcgYmFzZSwgbGVuZ3Ro
OworCWVudW0geyBNZW1BdmFpbGFibGUgPSAxLCBNZW1TcGVjaWFsID0gMiwK
KwkJTWVtX0FDUElfcmVjbGFpbSA9IDMsIE1lbV9BQ1BJX05WUyA9IDQKKwl9
IHR5cGU6MzI7Cit9IF9fYXR0cmlidXRlX18gKChwYWNrZWQpKTsKKworZXh0
ZXJuIGlubGluZSB1bnNpZ25lZAorX0JJT1NfUXVlcnlNZW1vcnlNYXAgKHVu
c2lnbmVkICpjb250X3ZhbCwgdW5zaWduZWQgYnVmc2l6ZSwKKwkJICAgICAg
c3RydWN0IGU4MjBtYXBfaW5mbyAqYnVmZmVyKQoreworCS8qIGlubGluZSAq
LyBjb25zdCB1bnNpZ25lZCBzbWFwc2lnID0gMHg1MzRENDE1MDsJLyogJ1NN
QVAnIGluIGJpZyBlbmRpYW4gKi8KKwl1bnNpZ25lZCBzbWFwX3JlcyA9IDB4
RTgyMFUsIGFjdHVhbF9sZW47CisKKwlhc20gdm9sYXRpbGUgKCIJaW50ICAg
ICAkMHgxNSAgICMgX0JJT1NfUXVlcnlNZW1vcnlNYXAJCVxuIgorCQkgICAg
ICAiCWpuYwkxZgkJCQkJXG4iCisJCSAgICAgICIJeG9ybAklJWVheCwlJWVh
eAkJCQlcbiIKKwkJICAgICAgIgkxOgkJCQkJCVxuIgorCQkgICAgICA6ICIr
YSIgKHNtYXBfcmVzKSwgIitiIiAoKmNvbnRfdmFsKSwKKwkJCSI9YyIgKGFj
dHVhbF9sZW4pLCAiPVgiICgqYnVmZmVyKQorCQkgICAgICA6ICJjIiAoYnVm
c2l6ZSksICJkIiAoc21hcHNpZyksICJEIiAoYnVmZmVyKQkvKiBpbiBmYWN0
ICUlZXM6JSVkaSAqLworCQkgICAgICApOworCWlmIChzbWFwX3JlcyAhPSBz
bWFwc2lnKQorCQlyZXR1cm4gMDsKKwlyZXR1cm4gYWN0dWFsX2xlbjsKK30K
KworZXh0ZXJuIGlubGluZSB1bnNpZ25lZCBjaGFyCitfQVBNX2luc3RhbGxh
dGlvbl9jaGVjayAodW5zaWduZWQgc2hvcnQgKkJDRF92ZXJzaW9uLCB1bnNp
Z25lZCBzaG9ydCAqZmxhZ3MpCit7CisJdW5zaWduZWQgY2hhciBlcnJvcjsK
Kwl1bnNpZ25lZCBzaG9ydCBzaWc7CisKKwlhc20gKCIJaW50ICAgICAkMHgx
NQkjIF9BUE1faW5zdGFsbGF0aW9uX2NoZWNrCVxuIgorCSAgICAgIglzZXRj
ICAgICUwCQkJCQlcbiIKKwkgICAgIDogIj1xbSIgKGVycm9yKSwgIj1hIiAo
KkJDRF92ZXJzaW9uKSwgIj1iIiAoc2lnKSwgIj1jIiAoKmZsYWdzKQorCSAg
ICAgOiAiYSIgKCh1bnNpZ25lZCBzaG9ydCkweDUzMDApLCAiYiIgKDApCisJ
ICAgICApOworCWlmIChlcnJvcikgeworCQkqQkNEX3ZlcnNpb24gJj0gMHhG
RjAwOwkvKiBrZWVwIHRoZXJlIGVycm9yIGNvZGUgKi8KKwkJKmZsYWdzID0g
MDsKKwl9CisJcmV0dXJuIGVycm9yIHx8IHNpZyAhPSAweDUwNEQ7CS8qICJQ
TSIgKi8KK30KKworZXh0ZXJuIGlubGluZSB1bnNpZ25lZCBzaG9ydCBfQVBN
X2Rpc2Nvbm5lY3QgKHZvaWQpCit7CisJdW5zaWduZWQgc2hvcnQgZXJyb3I7
CisKKwlhc20gdm9sYXRpbGUgKCIJaW50ICAgICAkMHgxNQkjIF9BUE1fZGlz
Y29ubmVjdAlcbiIKKwkJICAgICAgIglzZXRjICAgICUlYWwJCQkJXG4iCisJ
CSAgICAgIDogIj1hIiAoZXJyb3IpCisJCSAgICAgIDogImEiICgodW5zaWdu
ZWQgc2hvcnQpMHg1MzA0KSwgImIiICgwKSApOworCWlmICgoZXJyb3IgJiAw
eEZGKSA9PSAwKQorCQlyZXR1cm4gMDsKKwlyZXR1cm4gZXJyb3I7Cit9CisK
K2V4dGVybiBpbmxpbmUgdW5zaWduZWQgY2hhcgorX0FQTV9jb25uZWN0XzMy
Yml0ICh1bnNpZ25lZCBzaG9ydCAqUk1fc2VnYmFzZV8zMiwKKwkJICAgIHVu
c2lnbmVkICplbnRyeV9wb2ludF9vZmZzZXRfMzIsCisJCSAgICB1bnNpZ25l
ZCBzaG9ydCAqUk1fc2VnYmFzZV9jb2RlMTYsCisJCSAgICB1bnNpZ25lZCBz
aG9ydCAqUk1fc2VnYmFzZV9kYXRhMTYsCisJCSAgICAvKiBBUE0gdjEuMTog
Ki8KKwkJICAgIHVuc2lnbmVkIHNob3J0ICpBUE1fQklPU19jb2Rlc2VnX2xl
biwKKwkJICAgIHVuc2lnbmVkIHNob3J0ICpBUE1fQklPU19kYXRhc2VnX2xl
bikKK3sKKwl1bnNpZ25lZCBjaGFyIGVycm9yOworCisJYXNtIHZvbGF0aWxl
ICgiCXhvcmwJJSVlZGksJSVlZGkJCQlcbiIKKwkJICAgICAgIgl4b3JsCSUl
ZXNpLCUlZXNpCQkJXG4iCisJCSAgICAgICIJaW50ICAgICAkMHgxNQkjIF9B
UE1fY29ubmVjdF8zMmJpdAlcbiIKKwkJICAgICAgIglzZXRjICAgICUwCQkJ
CVxuIgorCQkgICAgICA6ICI9cW0iIChlcnJvciksCisJCQkiPWEiICgqUk1f
c2VnYmFzZV8zMiksICI9YiIgKCplbnRyeV9wb2ludF9vZmZzZXRfMzIpLAor
CQkJIj1jIiAoKlJNX3NlZ2Jhc2VfY29kZTE2KSwgIj1kIiAoKlJNX3NlZ2Jh
c2VfZGF0YTE2KSwKKwkJCSI9UyIgKCpBUE1fQklPU19jb2Rlc2VnX2xlbiks
CisJCQkiPUQiICgqQVBNX0JJT1NfZGF0YXNlZ19sZW4pCisJCSAgICAgIDog
ImEiICgodW5zaWduZWQgc2hvcnQpMHg1MzAzKSwgImIiICgwKQorCQkgICAg
ICApOworCXJldHVybiBlcnJvcjsKK30KKworLyoqCisgKiogVmlkZW8gQklP
UzogRUdBLCBWR0EsIFZFU0EgYW5kIEVESUQuCisgKiovCit1bmlvbiBFR0Ff
YnhfdW5pb24geworCXN0cnVjdCB7CisJCWVudW0geyBFR0FfNjRLLCBFR0Ff
MTI4SywgRUdBXzE5MkssIEVHQV8yNTZLIH0gbWVtb3J5Ojg7CisJCWVudW0g
eyBFR0FfQ09MT1JfM0R4LCBFR0FfTU9OT18zQnggfSBJT2FkZHI6ODsKKwl9
IGVudW1zOworCXVuc2lnbmVkIHNob3J0IElPYWRkcl9tZW1vcnk7Cit9IF9f
YXR0cmlidXRlX18gKChwYWNrZWQpKTsKKworc3RydWN0IEVHQV9jeF9zdHIg
eworCXVuc2lnbmVkIHNob3J0IHN3aXRjaDFvZmYJOiAxOworCXVuc2lnbmVk
IHNob3J0IHN3aXRjaDJvZmYJOiAxOworCXVuc2lnbmVkIHNob3J0IHN3aXRj
aDNvZmYJOiAxOworCXVuc2lnbmVkIHNob3J0IHN3aXRjaDRvZmYJOiAxOwor
CXVuc2lnbmVkIHNob3J0IHN3aXRjaF91bnVzZWQJOiA0OworCXVuc2lnbmVk
IHNob3J0IEZFQVQxbGluZV9zdGF0ZTIJOiAxOworCXVuc2lnbmVkIHNob3J0
IEZFQVQwbGluZV9zdGF0ZTIJOiAxOworCXVuc2lnbmVkIHNob3J0IEZFQVQx
bGluZV9zdGF0ZTEJOiAxOworCXVuc2lnbmVkIHNob3J0IEZFQVQwbGluZV9z
dGF0ZTEJOiAxOworCXVuc2lnbmVkIHNob3J0IEZFQVRfdW51c2VkCTogNDsK
K30gX19hdHRyaWJ1dGVfXyAoKHBhY2tlZCkpOworCitleHRlcm4gaW5saW5l
IHZvaWQKK19FR0FfZ2V0ZGlzcGxheSAodW5pb24gRUdBX2J4X3VuaW9uICpF
R0FfYngsIHN0cnVjdCBFR0FfY3hfc3RyICpFR0FfY3gpCit7CisJdW5zaWdu
ZWQgc2hvcnQgZGVzdHJveWVkX3RzZW5nX0VUNDAwMF9WOF8wMDsKKwlhc20g
KCIgaW50ICQweDEwCSMgX0VHQV9nZXRkaXNwbGF5ICIKKwkgICAgIDogIj1i
IiAoKkVHQV9ieCksICI9YyIgKCpFR0FfY3gpLAorCQkiPWEiIChkZXN0cm95
ZWRfdHNlbmdfRVQ0MDAwX1Y4XzAwKQorCSAgICAgOiAiYSIgKCh1bnNpZ25l
ZCBzaG9ydCkweDEyMDApLAorCQkiYiIgKCh1bnNpZ25lZCBzaG9ydCkweEZG
MTApCS8qICViaCA9IDB4RkYgdG8gc2VlIGlmIHN1cHBvcnRlZCAqLworCSAg
ICAgKTsKK30KKworZXh0ZXJuIGlubGluZSB2b2lkCitfVkdBX2dldGN1cnNv
ciAodW5zaWduZWQgY2hhciBwYWdlLCB1bnNpZ25lZCBjaGFyICpyb3csIHVu
c2lnbmVkIGNoYXIgKmNvbCwKKwkgICAgICAgIHVuc2lnbmVkIGNoYXIgKmN1
cnNvcnN0YXJ0LCB1bnNpZ25lZCBjaGFyICpjdXJzb3JzdG9wKQoreworCXVu
c2lnbmVkIHNob3J0IHJvd19jb2wsIGNzdGFydF9jc3RvcDsKKwl1bnNpZ25l
ZCBzaG9ydCBkZXN0cm95ZWRfUGhvZW5peF9CSU9TOworCisJYXNtICgiIGlu
dCAkMHgxMCAjIGdldGN1cnNvciAiCisJICAgICA6ICI9ZCIgKHJvd19jb2wp
LCAiPWMiIChjc3RhcnRfY3N0b3ApLAorCQkiPWEiIChkZXN0cm95ZWRfUGhv
ZW5peF9CSU9TKQorCSAgICAgOiAiYSIgKCh1bnNpZ25lZCBzaG9ydCkweDAz
MDApLCAiYiIgKCh1bnNpZ25lZCBzaG9ydClwYWdlIDw8IDgpCisJICAgICAp
OworCSpjb2wgPSAodW5zaWduZWQgY2hhcilyb3dfY29sOworCSpyb3cgPSBy
b3dfY29sID4+IDg7CisJKmN1cnNvcnN0YXJ0ID0gY3N0YXJ0X2NzdG9wID4+
IDg7CS8qIGJ1ZyByZXBvcnRlZCB3aXRoIG1vbm8gZGlzcGxheXMgKi8KKwkq
Y3Vyc29yc3RvcCA9ICh1bnNpZ25lZCBjaGFyKWNzdGFydF9jc3RvcDsKK30K
KworZXh0ZXJuIGlubGluZSBjaGFyCitfVkdBX2dldG1vZGUgKHVuc2lnbmVk
IGNoYXIgKm5iY29sLCB1bnNpZ25lZCBjaGFyICpwYWdlKQoreworCXVuc2ln
bmVkIHNob3J0IG5iY29sX21vZGU7CisJdW5zaWduZWQgc2hvcnQgdG1wcGFn
ZTsKKworCWFzbSAoIiBpbnQgJDB4MTAgIyBnZXRtb2RlICIKKwkgICAgIDog
Ij1iIiAodG1wcGFnZSksICI9YSIgKG5iY29sX21vZGUpCisJICAgICA6ICJh
IiAoKHVuc2lnbmVkIHNob3J0KTB4MEYwMCkKKwkgICAgICk7CisJKm5iY29s
ID0gbmJjb2xfbW9kZSA+PiA4OworCSpwYWdlID0gdG1wcGFnZSA+PiA4Owor
CisJcmV0dXJuIChjaGFyKW5iY29sX21vZGU7CS8qIGJpdCA3IHNldCBpZiBs
YXN0IHNldG1vZGUgaGFkIGl0ICovCit9CisKK2V4dGVybiBpbmxpbmUgdW5z
aWduZWQKK19WR0FfZ2V0X2Rpc3BsYXlfY29tYmluYXRpb25fY29kZSAodW5z
aWduZWQgY2hhciAqYWN0aXZlX2RjYywKKwkJCQkgICB1bnNpZ25lZCBjaGFy
ICphbHRlcm5hdGVfZGNjKQoreworCXVuc2lnbmVkIGNoYXIgcmVzdWx0Owor
CXVuc2lnbmVkIHNob3J0IGFsdGVybmF0ZV9hY3RpdmU7CisKKwlhc20gKCIg
aW50ICQweDEwICMgZ2V0X2Rpc3BsYXlfY29tYmluYXRpb25fY29kZSAiCisJ
ICAgICA6ICI9YSIgKHJlc3VsdCksICI9YiIgKGFsdGVybmF0ZV9hY3RpdmUp
CisJICAgICA6ICJhIiAoKHVuc2lnbmVkIHNob3J0KTB4MUEwMCkKKwkgICAg
ICk7CisJKmFjdGl2ZV9kY2MgPSAodW5zaWduZWQgY2hhcilhbHRlcm5hdGVf
YWN0aXZlOworCSphbHRlcm5hdGVfZGNjID0gYWx0ZXJuYXRlX2FjdGl2ZSA+
PiA4OworCisJcmV0dXJuIChyZXN1bHQgIT0gMHgxQSk7Cit9CisKK3R5cGVk
ZWYgc3RydWN0IHsKKwljaGFyIFZiZVNpZ25hdHVyZVs0XTsJLyogIlZFU0Ei
IGJ1dCBOT1QgemVybyB0ZXJtaW5hdGVkLiAqLworCXVuc2lnbmVkIHNob3J0
IFZiZVZlcnNpb247CisJZmFycHRyIE9lbVN0cmluZ1B0cjsKKwlzdHJ1Y3Qg
eworCQl1bnNpZ25lZCBEQUM4Yml0X3ByZXNlbnQJOiAxOworCQl1bnNpZ25l
ZCBub25WR0Fjb250cm9sbGVyCTogMTsKKwkJdW5zaWduZWQgREFDX25lZWRz
X3Byb2dyYW1tZWRfd2hpbGVfYmxhbmtpbmcJOiAxOworCQl1bnNpZ25lZCBW
QkVfQUZfZXh0ZW5zaW9uCTogMTsKKwkJdW5zaWduZWQgaGFyZHdhcmVfbW91
c2VfY3Vyc29yCTogMTsKKwkJdW5zaWduZWQgaGFyZHdhcmVfY2xpcHBpbmcJ
OiAxOworCQl1bnNpZ25lZCB0cmFuc3BhcmVudF9iaXRibHQJOiAxOworCQl1
bnNpZ25lZCByZXNlcnZlZAkJOiAyNTsKKwl9IF9fYXR0cmlidXRlX18gKChw
YWNrZWQpKSBDYXBhYmlsaXRpZXM7CisJZmFycHRyIFZpZGVvTW9kZVB0cjsK
Kwl1bnNpZ25lZCBzaG9ydCBUb3RhbE1lbW9yeTsJLyogaW4gNjRLIGJsb2Nr
cyAqLworCS8qIGlmIFZCRSAyLjArIChlbHNlIHN0cnVjdHVyZSBpcyAyNTYg
Ynl0ZXMpIDogKi8KKwl1bnNpZ25lZCBzaG9ydCBPZW1Tb2Z0d2FyZVJldjsK
KwlmYXJwdHIgT2VtVmVuZG9yTmFtZVB0cjsKKwlmYXJwdHIgT2VtUHJvZHVj
dE5hbWVQdHI7CisJZmFycHRyIE9lbVByb2R1Y3RSZXZQdHI7CisKKwl1bnNp
Z25lZCBjaGFyIFJlc2VydmVkWzIyMl07CS8qIE9OTFkgVkVTQSB2ZXJzaW9u
IDEuMi0gaW5mbyAqLworCXVuc2lnbmVkIGNoYXIgT2VtRGF0YVsyNTZdOwkv
KiB3aWxsIG5vdCBraWxsIFZFU0ExLjItICovCit9IF9fYXR0cmlidXRlX18g
KChwYWNrZWQpKSBWRVNBX1ZiZUluZm9CbG9jazsKKwordHlwZWRlZiBzdHJ1
Y3QgeworCXN0cnVjdCB2ZXNhX21vZGVfYXR0cmlidXRlX3N0ciBNb2RlQXR0
cmlidXRlczsKKwlzdHJ1Y3QgeworCQl1bnNpZ25lZCBjaGFyIHdpbl9leGlz
dAkJOiAxOworCQl1bnNpZ25lZCBjaGFyIHdpbl9yZWFkYWJsZQk6IDE7CisJ
CXVuc2lnbmVkIGNoYXIgd2luX3dyaXRhYmxlCTogMTsKKwkJdW5zaWduZWQg
Y2hhciBwYWRkaW5nCQk6IDU7CisJfSBfX2F0dHJpYnV0ZV9fICgocGFja2Vk
KSkgV2luQUF0dHJpYnV0ZXMsIFdpbkJBdHRyaWJ1dGVzOworCXVuc2lnbmVk
IHNob3J0IFdpbkdyYW51bGFyaXR5OwkvKiBpbiBLYiAqLworCXVuc2lnbmVk
IHNob3J0IFdpblNpemU7CS8qIGluIEtiICovCisJdW5zaWduZWQgc2hvcnQg
V2luQVNlZ21lbnQ7CisJdW5zaWduZWQgc2hvcnQgV2luQlNlZ21lbnQ7CisJ
ZmFycHRyIFdpbkZ1bmNQdHI7CisJdW5zaWduZWQgc2hvcnQgQnl0ZXNQZXJT
Y2FuTGluZTsKKwkvKiBvcHRpb25hbCBwYXJ0LCBzZWUgImF0dHJpYnV0ZS5v
cHRpb25hbF9pbmZvX2F2YWlsYWJsZSI6ICovCisJdW5zaWduZWQgc2hvcnQg
WFJlc29sdXRpb247CS8qIGNoYXIgaW4gdGV4dCBtb2RlcywKKwkJCQkJICAg
cGl4ZWwgaW4gZ3JhcGhpYyBtb2RlcyAqLworCXVuc2lnbmVkIHNob3J0IFlS
ZXNvbHV0aW9uOworCXVuc2lnbmVkIGNoYXIgWENoYXJTaXplOworCXVuc2ln
bmVkIGNoYXIgWUNoYXJTaXplOworCXVuc2lnbmVkIGNoYXIgTnVtYmVyT2ZQ
bGFuZXM7CisJdW5zaWduZWQgY2hhciBCaXRzUGVyUGl4ZWw7CisJdW5zaWdu
ZWQgY2hhciBOdW1iZXJPZkJhbmtzOwkvKiB1bnVzZWQgaGVyZSA6IG5vIG11
bHRpcGFnZWQgc2NyZWVuICovCisJZW51bSB7IG1lbV90ZXh0ID0gMCwgbWVt
X0NHQSwgbWVtX0hHQywgbWVtX0VHQSwgbWVtX3BhY2tlZHBpeGVsLAorCQlt
ZW1fc2VxMjU2LCBtZW1fSGlDb2xvcjI0LCBtZW1fWVVWCisJfSBNZW1vcnlN
b2RlbCA6IDg7CisJLyogbWVtX3NlcTI1NiA9IG5vbiBjaGFpbiA0ICovCisJ
dW5zaWduZWQgY2hhciBCYW5rU2l6ZTsJLyogaW4gS2IsIHVudXNlZCBoZXJl
ICovCisJdW5zaWduZWQgY2hhciBOdW1iZXJPZkltYWdlUGFnZXM7CisJdW5z
aWduZWQgY2hhciBSZXNlcnZlZDsKKwkvKiBWQkUgMS4yKzogKi8KKwlzdHJ1
Y3QgdmVzYV9jb2xvcl9sYXlvdXRfc3RyIGxheW91dDsKKwlzdHJ1Y3Qgewor
CQl1bnNpZ25lZCBjaGFyIGNvbG9yX3JhbXBfcHJvZ3JhbW1hYmxlCTogMTsK
KwkJdW5zaWduZWQgY2hhciByZXNlcnZlZF9zcGFjZV91c2FibGUJOiAxOwor
CX0gX19hdHRyaWJ1dGVfXyAoKHBhY2tlZCkpIERpcmVjdENvbG9yTW9kZUlu
Zm87CisJLyogVkJFIDIuMDogKi8KKwl1bnNpZ25lZCBQaHlzQmFzZVB0cjsK
Kwl1bnNpZ25lZCBPZmZTY3JlZW5NZW1PZmZzZXQ7CisJdW5zaWduZWQgc2hv
cnQgT2ZmU2NyZWVuTWVtU2l6ZTsJLyogaW4gS2IgKi8KKwl1bnNpZ25lZCBj
aGFyIFJlc2VydmVkMlsyMDZdOworfSBfX2F0dHJpYnV0ZV9fICgocGFja2Vk
KSkgVkVTQV9tb2RlaW5mb190OworCitleHRlcm4gaW5saW5lIHVuc2lnbmVk
CitfVkVTQV9nZXRpbmZvIChWRVNBX1ZiZUluZm9CbG9jayAqVkVTQV9pbmZv
KQoreworCXVuc2lnbmVkIHNob3J0IGNtZF9zdGF0dXMgPSAweDRGMDA7CisK
KwlpZiAoc2l6ZW9mKFZFU0FfVmJlSW5mb0Jsb2NrKSAhPSA1MTIpCisJCV9f
RVJST1IoKTsKKworCWFzbSAoIiBpbnQgJDB4MTAgIyBfVkVTQV9nZXRpbmZv
ICIKKwkgICAgIDogIithIihjbWRfc3RhdHVzKSwgIj1YIiAoKlZFU0FfaW5m
bykKKwkgICAgIDogIkQiKFZFU0FfaW5mbykJLyogaW4gZmFjdCAlZXM6JWRp
ICovCisJICAgICApOworCXJldHVybiAoY21kX3N0YXR1cyAhPSAweDAwNEYp
OworfQorCitleHRlcm4gaW5saW5lIHVuc2lnbmVkCitfVkVTQV9nZXRtb2Rl
aW5mbyAoVkVTQV9tb2RlaW5mb190ICpWRVNBX21vZGVpbmZvLCB1bnNpZ25l
ZCBzaG9ydCBtb2RlKQoreworCXVuc2lnbmVkIHNob3J0IGNtZF9zdGF0dXMg
PSAweDRGMDE7CisKKwlpZiAoc2l6ZW9mKFZFU0FfbW9kZWluZm9fdCkgIT0g
MjU2KQorCQlfX0VSUk9SKCk7CisKKwlhc20gKCIgaW50ICQweDEwICMgX1ZF
U0FfZ2V0bW9kZWluZm8gIgorCSAgICAgOiAiK2EiIChjbWRfc3RhdHVzKSwg
Ij1YIiAoKlZFU0FfbW9kZWluZm8pCisJICAgICA6ICJjIiAobW9kZSksICJE
IiAoVkVTQV9tb2RlaW5mbykgLyogaW4gZmFjdCAlZXM6JWRpICovCisJICAg
ICk7CisJcmV0dXJuIChjbWRfc3RhdHVzICE9IDB4MDA0Rik7Cit9CisKK2V4
dGVybiBpbmxpbmUgdW5zaWduZWQgX1ZFU0FfZ2V0bW9kZSAodW5zaWduZWQg
c2hvcnQgKm1vZGUpCit7CisJdW5zaWduZWQgc2hvcnQgY21kX3N0YXR1cyA9
IDB4NEYwMzsKKworCWFzbSAoIiBpbnQgJDB4MTAgIyBfVkVTQV9nZXRtb2Rl
ICIKKwkgICAgIDogIithIiAoY21kX3N0YXR1cyksCisJCSI9YiIgKCptb2Rl
KSAvKiAqbW9kZSBjb250YWlucyBiaXRzIDEzLCAxNCAmIDE1ICovCisJICAg
ICApOworCXJldHVybiAoY21kX3N0YXR1cyAhPSAweDAwNEYpOworfQorCitl
eHRlcm4gaW5saW5lIHVuc2lnbmVkIF9WRVNBX3NldERBQ3dpZHRoICh1bnNp
Z25lZCBjaGFyIGRlcHRoKQoreworCXVuc2lnbmVkIHNob3J0IGNtZF9zdGF0
dXMgPSAweDRGMDg7CisJdW5zaWduZWQgc2hvcnQgcmVzdWx0ID0gZGVwdGgg
PDwgODsgLyogJWJsID0gMCAqLworCisJYXNtIHZvbGF0aWxlICgiIGludCAk
MHgxMCAjIF9WRVNBX3NldERBQ3dpZHRoICIgICAgICAgLyogVkVTQSAxLjIr
ICovCisJICAgIDogIithIiAoY21kX3N0YXR1cyksICIrYiIgKHJlc3VsdCkK
KwkgICAgKTsKKwlyZXR1cm4gKGNtZF9zdGF0dXMgIT0gMHgwMDRGIHx8IChy
ZXN1bHQgPj4gOCkgIT0gZGVwdGgpOworfQorCisvKiBWRVNBIDIuMCsgKi8K
K2V4dGVybiBpbmxpbmUgdW5zaWduZWQKK19WRVNBX0dldFBNaW50ZXJmYWNl
IChmYXJwdHIgKmFkZHIsIHVuc2lnbmVkIHNob3J0ICpsZW4pCit7CisJdW5z
aWduZWQgc2hvcnQgY21kX3N0YXR1cyA9IDB4NEYwQTsKKworCWFzbSAoIglw
dXNobAklJWVzCQkJCQkJXG4iCisJICAgICAiCXhvcncJJSVkaSwlJWRpCQkJ
CQlcbiIKKwkgICAgICIJbW92CSUlZGksJSVlcwkJCQkJXG4iCisJICAgICAi
CWludAkkMHgxMAkJIyBfVkVTQV9HZXRQTWludGVyZmFjZQkJXG4iCisJICAg
ICAiCXB1c2h3CSUlZXMJCQkJCQlcbiIKKwkgICAgICIJcHVzaHcJJSVkaQkJ
CQkJCVxuIgorCSAgICAgIglwb3BsCSUlZWRpCQkJCQkJXG4iCisJICAgICAi
CXBvcGwJJSVlcwkJCQkJCVxuIgorCSAgICAgOiAiK2EiIChjbWRfc3RhdHVz
KSwgIj1EIiAoKmFkZHIpLCAiPWMiICgqbGVuKQorCSAgICAgOiAiYiIgKDAp
LCAiYyIgKCh1bnNpZ25lZCBzaG9ydCkwKQorCSAgICAgKTsKKworCXJldHVy
biAoY21kX3N0YXR1cyAhPSAweDAwNEYpOworfQorCitleHRlcm4gaW5saW5l
IHVuc2lnbmVkIF9FRElEX2RldGVjdCAodm9pZCkKK3sKKwl1bnNpZ25lZCBz
aG9ydCBjbWRfc3RhdHVzID0gMHg0RjE1LCB1bmtub3duOworCisJYXNtICgi
IGludCAkMHgxMCAjIF9FRElEX2RldGVjdCIKKwkgICAgIDogIithIiAoY21k
X3N0YXR1cyksICI9YiIgKHVua25vd24pCisJICAgICA6ICJiIigodW5zaWdu
ZWQgY2hhcikwKQorCSAgICAgKTsKKwlyZXR1cm4gKGNtZF9zdGF0dXMgIT0g
MHgwMDRGKTsKK30KKworZXh0ZXJuIGlubGluZSB1bnNpZ25lZCBfRURJRF9y
ZWFkIChWQkVfRURJRF90ICppbmZvKQoreworCXVuc2lnbmVkIHNob3J0IGNt
ZF9zdGF0dXMgPSAweDRGMTU7CisKKwlpZiAoc2l6ZW9mKFZCRV9FRElEX3Qp
ICE9IDB4ODApCisJCV9fRVJST1IoKTsKKworCWFzbSAoIiBpbnQgJDB4MTAg
IyBfRURJRF9yZWFkIgorCSAgICAgOiAiK2EiIChjbWRfc3RhdHVzKSwgIj1Y
IiAoKmluZm8pCisJICAgICA6ICJiIiAoKHVuc2lnbmVkIGNoYXIpIDEpLCAi
RCIgKGluZm8pLAkvKiBpbiBmYWN0ICVlczolZGkgKi8KKwkgICAgICAgImMi
KDApLCAiZCIoMCkKKwkgICAgICk7CisJLyogcmV0dXJucyAweDAxNEYgaWYg
bW9uaXRvciBub24gRURJRCAqLworCXJldHVybiAoY21kX3N0YXR1cyAhPSAw
eDAwNEYpOworfQorCisvKioKKyAqKiBEaXNrIEJJT1M6CisgKiovCitleHRl
cm4gaW5saW5lIHVuc2lnbmVkCitfQklPU0RJU0tfZ2V0cGFyYW0gKHVuc2ln
bmVkIGNoYXIgZGlzaywKKwkgICAgICAgICAgICB1bnNpZ25lZCBzaG9ydCAq
dG1wY3gsIHVuc2lnbmVkIHNob3J0ICp0bXBkeCwKKwkgICAgICAgICAgICBm
YXJwdHIgKkRCVGFkciwgdW5zaWduZWQgY2hhciAqQ21vc0RyaXZlVHlwZSwK
KwkgICAgICAgICAgICB1bnNpZ25lZCBjaGFyICpzdGF0dXMpCit7CisJdW5z
aWduZWQgY2hhciBjYXJyeTsKKworCWFzbSAoIglwdXNobAklJWVzCQlcbiIK
KwkgICAgICIJeG9ydwklJWRpLCUlZGkJXG4iCisJICAgICAiCW1vdgklJWRp
LCUlZXMJXG4iCisJICAgICAiCWludAkkMHgxMwkJIyBfQklPU0RJU0tfZ2V0
cGFyYW0JXG4iCisJICAgICAiCXB1c2h3CSUlZXMJCVxuIgorCSAgICAgIglw
dXNodwklJWRpCQlcbiIKKwkgICAgICIJcG9wbAklJWVkaQkJXG4iCisJICAg
ICAiCXBvcGwJJSVlcwkJXG4iCisJICAgICAiCW1vdgklJWFoLCUxCQlcbiIK
KwkgICAgICIJc2V0YwklMAkJXG4iCisJICAgICA6ICI9cW0iIChjYXJyeSks
ICI9cW0iICgqc3RhdHVzKSwgIj1jIiAoKnRtcGN4KSwgIj1kIiAoKnRtcGR4
KSwKKwkJCSI9YiIgKCpDbW9zRHJpdmVUeXBlKSwgIj1EIiAoKkRCVGFkcikK
KwkgICAgIDogImEiKCh1bnNpZ25lZCBzaG9ydCkweDA4MDApLCAiZCIgKGRp
c2spLCAiYiIgKDApCisJICAgICApOworCisJcmV0dXJuIGNhcnJ5OworfQor
CitleHRlcm4gaW5saW5lIHVuc2lnbmVkIGNoYXIKK19CSU9TRElTS19nZXR0
eXBlICh1bnNpZ25lZCBjaGFyIGRpc2ssIHVuc2lnbmVkICpuYnNlY3QsIHVu
c2lnbmVkIGNoYXIgKnN0YXR1cykKK3sKKwl1bnNpZ25lZCBjaGFyIGNhcnJ5
OworCXVuc2lnbmVkIGR1bW15OworCisJYXNtICgiCXhvcgklJWRoLCUlZGgJ
CQkJXG4iCisJICAgICAiCXhvcgklJWN4LCUlY3gJCQkJXG4iCisJICAgICAi
CWludAkkMHgxMwkJIyBfQklPU0RJU0tfZ2V0dHlwZQlcbiIKKwkgICAgICIJ
c2hsbAkkMTYsJSVlY3gJCQkJXG4iCisJICAgICAiCW1vdncJJSVkeCwlJWN4
CQkJCVxuIgorCSAgICAgIgltb3ZiCSUlYWgsJTEJCQkJCVxuIgorCSAgICAg
IglzZXRjCSUwCQkJCQlcbiIKKwkgICAgIDogIj1xbSIgKGNhcnJ5KSwgIj1x
bSIgKCpzdGF0dXMpLCAiPWMiICgqbmJzZWN0KSwgIj1kIiAoZHVtbXkpCisJ
ICAgICA6ICJhIiAoKHVuc2lnbmVkIHNob3J0KTB4MTUwMCksCisJCSJkIiAo
ZGlzaykJLyogZGlzayA9IDB4ODAuLjB4OEYgZWxzZSBvbGQgQ29tcGFxIGJ1
ZyAqLworCSAgICAgKTsKKworCXJldHVybiBjYXJyeTsKK30KKworZXh0ZXJu
IGlubGluZSB2b2lkCitnZXRfZHJpdmVfaW5mbyAoZmFycHRyIGluZGlyZWN0
X3B0ciwgdW5pb24gZHJpdmVfaW5mbyAqZGlza2luZm8pCit7CisJdW5zaWdu
ZWQgbmJieXRlID0gc2l6ZW9mKCpkaXNraW5mbyk7CisKKwlhc20gKCIJcHVz
aGwJJSVlc2kJCQkJXG4iCisJICAgICAiCXBvcHcJJSVzaQkJCQlcbiIKKwkg
ICAgICIJcG9wdwklJWZzCQkJCVxuIgorCSAgICAgIglwdXNobAklJWZzOigl
JXNpKQkJCVxuIgorCSAgICAgIglwb3B3CSUlc2kJCQkJXG4iCisJICAgICAi
CXBvcHcJJSVmcwkJCQlcbiIKKwkgICAgICIJY2xkCQkJCQlcbiIKKwkgICAg
ICIJcmVwIG1vdnNiICUlZnM6KCUlc2kpLCUlZXM6KCUlZGkpCVxuIgorCSAg
ICAgOiAiK1MiIChpbmRpcmVjdF9wdHIpLCAiK0QiIChkaXNraW5mbyksICIr
YyIgKG5iYnl0ZSksICI9WCIgKCpkaXNraW5mbykKKwkgICAgICk7Cit9CisK
K2V4dGVybiBpbmxpbmUgdW5zaWduZWQgY2hhcgorX0JJT1NESVNLX1JXc2Vj
dG9yICh1bnNpZ25lZCBjaGFyIGRyaXZlLAorCQkgICAgdW5zaWduZWQgc2hv
cnQgY3lsaW5kZXIsIHVuc2lnbmVkIGNoYXIgaGVhZCwKKwkJICAgIHVuc2ln
bmVkIGNoYXIgc2VjdG9yLCB1bnNpZ25lZCBjaGFyIG5ic2VjdG9yLAorCQkg
ICAgZmFycHRyIGJ1ZmZlciwgY29uc3QgdW5zaWduZWQgcmVhZCkKK3sKKwl1
bnNpZ25lZCBzaG9ydCByZXN1bHQsIGJ1Z2d5X2Jpb3M7CisKKwlhc20gdm9s
YXRpbGUgKCIJcHVzaGwJJSVlcwkJCQlcbiIKKwkJICAgICAgIglwdXNobAkl
JWVieAkJCQlcbiIKKwkJICAgICAgIglwb3B3CSUlYngJCQkJXG4iCisJCSAg
ICAgICIJcG9wdwklJWVzCQkJCVxuIgorCQkgICAgICAiCXN0YwkJIyBidWdn
eSBCSU9TZXMJCVxuIgorCQkgICAgICAiCWludAkkMHgxMyAgICMgX0JJT1NE
SVNLX1JXc2VjdG9yCVxuIgorCQkgICAgICAiCXN0aQkJIyBidWdneSBCSU9T
ZXMJCVxuIgorCQkgICAgICAiCXBvcGwJJSVlcwkJCQlcbiIKKwkJICAgICAg
IglzZXRjCSUlYWwJCQkJXG4iCisJCSAgICAgIDogIj1hIiAocmVzdWx0KSwg
Ij1kIiAoYnVnZ3lfYmlvcykKKwkJICAgICAgOiAiYSIgKChyZWFkPyAweDAy
MDAgOiAweDAzMDApIHwgbmJzZWN0b3IpLAorCQkJImIiIChidWZmZXIpLAor
CQkJImMiICgoY3lsaW5kZXIgPDwgOCkgfCAoKGN5bGluZGVyID4+IDIpICYg
MHhDMCkKKwkJCQkJfCAoc2VjdG9yICYgMHgzRikpLAorCQkJImQiICgoKCh1
bnNpZ25lZCBzaG9ydCloZWFkKSA8PCA4KSB8IGRyaXZlKQorCQkgICAgICAp
OworCWlmIChyZXN1bHQgJiAweDAwRkYpCisJCXJldHVybiByZXN1bHQgPj4g
ODsKKwlyZXR1cm4gMDsKK30KKwordHlwZWRlZiBzdHJ1Y3QgeworCXVuc2ln
bmVkIHNob3J0IGJ1ZmZlcnNpemU7CisJdW5zaWduZWQgc2hvcnQgaW5mb2Jp
dDsKKwl1bnNpZ25lZCBuYmN5bGluZGVyOworCXVuc2lnbmVkIG5iaGVhZDsK
Kwl1bnNpZ25lZCBuYnNlY3RvcnBlcnRyYWNrOworCXVuc2lnbmVkIGxvbmcg
bG9uZyBuYnRvdGFsc2VjdG9yOworCXVuc2lnbmVkIHNob3J0IGJ5dGVwZXJz
ZWN0b3I7CisJLyogVjIuMCsgOiAqLworCWZhcnB0ciBjb25maWdwdHI7CS8q
IGZvciBpbnN0YW5jZSBlYmlvc1Bob2VuaXggcmVhbG1vZGUgYWRkcmVzcyAq
LworCS8qIFYzLjArIDogKi8KKwl1bnNpZ25lZCBzaG9ydCBzaWduYXR1cmUw
eEJFREQ7CisJdW5zaWduZWQgY2hhciBsZW5kZXZpY2VwYXRoOwkvKiAweDI0
IGZvciB2My4wICovCisJdW5zaWduZWQgY2hhciByZXNlcnZlZFszXTsKKwl1
bnNpZ25lZCBjaGFyIGJ1c3R5cGVbNF07CS8qIGV4YWN0bHkgIklTQSIgb3Ig
IlBDSSIgKi8KKwl1bnNpZ25lZCBjaGFyIEludGVyZmFjZVs4XTsJLyogZXhh
Y3RseSAiQVRBIiwgIkFUQVBJIiwKKwkJCQkJCSAiU0NTSSIsICJVU0IiLi4u
ICovCisJdW5pb24gaW50ZXJmYWNlX3BhdGhfdSB7CisJCXN0cnVjdCB7CisJ
CQl1bnNpZ25lZCBzaG9ydCBhZGRyOworCQkJdW5zaWduZWQgY2hhciBwYWRb
Nl07CisJCX0gX19hdHRyaWJ1dGVfXyAoKHBhY2tlZCkpIGlzYTsKKwkJc3Ry
dWN0IHsKKwkJCXVuc2lnbmVkIGNoYXIgYnVzbnI7CisJCQl1bnNpZ25lZCBj
aGFyIGRldmljZW5yOworCQkJdW5zaWduZWQgY2hhciBmdW5jdGlvbm5yOwor
CQkJdW5zaWduZWQgY2hhciBwYWRbNV07CisJCX0gX19hdHRyaWJ1dGVfXyAo
KHBhY2tlZCkpIHBjaTsKKwl9IGJ1czsKKwl1bmlvbiBkZXZpY2VfcGF0aF91
IHsKKwkJc3RydWN0IHsKKwkJCXVuc2lnbmVkIGNoYXIgc2xhdmU7CS8qIDAg
aWYgbWFzdGVyLCAxIGlmIHNsYXZlICovCisJCQl1bnNpZ25lZCBjaGFyIHBh
ZFs3XTsKKwkJCXVuc2lnbmVkIGxvbmcgbG9uZyByZXNlcnZlZDsJLyogTm90
IHByZXNlbnQgaW4gc29tZSBkb2NzLi4uICovCisJCX0gX19hdHRyaWJ1dGVf
XyAoKHBhY2tlZCkpIGF0YTsKKwkJc3RydWN0IHsKKwkJCXVuc2lnbmVkIGNo
YXIgc2xhdmU7CS8qIDAgaWYgbWFzdGVyLCAxIGlmIHNsYXZlICovCisJCQl1
bnNpZ25lZCBjaGFyIGxvZ2ljYWxfdW5pdF9ucjsKKwkJCXVuc2lnbmVkIGNo
YXIgcGFkWzZdOworCQl9IF9fYXR0cmlidXRlX18gKChwYWNrZWQpKSBhdGFw
aTsKKwkJc3RydWN0IHsKKwkJCXVuc2lnbmVkIGNoYXIgbG9naWNhbF91bml0
X25yOworCQkJdW5zaWduZWQgY2hhciBwYWRbN107CisJCX0gX19hdHRyaWJ1
dGVfXyAoKHBhY2tlZCkpIHNjc2k7CisJCXN0cnVjdCB7CisJCQl1bnNpZ25l
ZCBjaGFyIHRvYmVkZWZpbmVkOworCQkJdW5zaWduZWQgY2hhciBwYWRbN107
CisJCX0gX19hdHRyaWJ1dGVfXyAoKHBhY2tlZCkpIHVzYjsKKwkJc3RydWN0
IHsKKwkJCXVuc2lnbmVkIGxvbmcgbG9uZyBGaXJlV2lyZUdlbmVyYWxVbmlx
dWVJRDsKKwkJfSBfX2F0dHJpYnV0ZV9fICgocGFja2VkKSkgaWVlZTEzOTQ7
CisJCXN0cnVjdCB7CisJCQl1bnNpZ25lZCBsb25nIGxvbmcgV29ybGRXaWRl
TnVtYmVyOworCQl9IF9fYXR0cmlidXRlX18gKChwYWNrZWQpKSBGaWJyZUNo
YW5uZWw7CisJfSBkZXZpY2U7CisJdW5zaWduZWQgY2hhciB6ZXJvOworCXVu
c2lnbmVkIGNoYXIgYnl0ZWNoZWNrc3VtOwkvKiBieXRlIHN1bSBbMHgxRS4u
MHg0OV0gPSAwICovCit9IF9fYXR0cmlidXRlX18gKChwYWNrZWQpKSBlYmlv
c2luZm9fdDsKKwordHlwZWRlZiBzdHJ1Y3QgeworCXVuc2lnbmVkIHNob3J0
IGV4dGVuZGVkX2ZjdAk6IDE7CisJdW5zaWduZWQgc2hvcnQgcmVtb3ZhYmxl
CTogMTsKKwl1bnNpZ25lZCBzaG9ydCBlbmhhbmNlZAkJOiAxOworCXVuc2ln
bmVkIHNob3J0IHJlc2VydmVkCQk6IDEzOworfSBfX2F0dHJpYnV0ZV9fICgo
cGFja2VkKSkgZWJpb3NfYml0bWFwX3Q7CisKK2V4dGVybiBpbmxpbmUgdW5z
aWduZWQgY2hhcgorX0VCSU9TRElTS19wcm9iZSAodW5zaWduZWQgY2hhciBk
aXNrLCB1bnNpZ25lZCBjaGFyICp2ZXJzaW9uLAorCQkgIHVuc2lnbmVkIGNo
YXIgKmV4dGVuc2lvbiwgZWJpb3NfYml0bWFwX3QgKmJpdG1hcCkKK3sKKwl1
bnNpZ25lZCBjaGFyIGNhcnJ5OworCXVuc2lnbmVkIHNob3J0IHNpZ25hdDB4
QUE1NTsKKworCWFzbSAoIiAgICAgICBpbnQgICAgICQweDEzICAgICAgICAg
ICAjIF9FQklPU0RJU0tfcHJvYmUgICAgICBcbiIKKwkgICAgICIgICAgICAg
bW92ICAgICAlJWFoLCUxICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgXG4iCisJICAgICAiICAgICAgIG1vdiAgICAgJSVkaCwlMiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFxuIgorCSAgICAgIiAgICAgICBz
ZXRjICAgICUwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBcbiIKKwkgICAgIDogIj1xbSIgKGNhcnJ5KSwgIj1xbSIgKCp2ZXJzaW9u
KSwgIj1xbSIgKCpleHRlbnNpb24pLAorCQkiPWIiIChzaWduYXQweEFBNTUp
LCAiPWMiICgqYml0bWFwKQorCSAgICAgOiAiYSIgKCh1bnNpZ25lZCBzaG9y
dCkweDQxMDApLCAiYiIgKCh1bnNpZ25lZCBzaG9ydCkweDU1QUEpLAorCQki
ZCIoZGlzaykKKwkgICAgICk7CisKKwlyZXR1cm4gY2FycnkgfHwgKHNpZ25h
dDB4QUE1NSAhPSAweEFBNTUpOworfQorCitleHRlcm4gaW5saW5lIHVuc2ln
bmVkIGNoYXIKK19FQklPU0RJU0tfZ2V0cGFyYW0gKHVuc2lnbmVkIGNoYXIg
ZGlzaywgZWJpb3NpbmZvX3QgKmViaW9zaW5mbywKKwkJICAgICB1bnNpZ25l
ZCBjaGFyICpzdGF0dXMpCit7CisJdW5zaWduZWQgY2hhciBjYXJyeTsKKwor
CWFzbSAoIiAgICAgICBpbnQgICAgICQweDEzICAgICAgICAgICAjIF9FQklP
U0RJU0tfZ2V0cGFyYW0gICBcbiIKKwkgICAgICIgICAgICAgbW92ICAgICAl
JWFoLCUxICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4iCisJ
ICAgICAiICAgICAgIHNldGMgICAgJTAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIFxuIgorCSAgICAgOiAiPXFtIiAoY2FycnkpLCAi
PXFtIiAoKnN0YXR1cykKKwkgICAgIDogImEiICgodW5zaWduZWQgc2hvcnQp
MHg0ODAwKSwgImQiIChkaXNrKSwgIlMiIChlYmlvc2luZm8pCisJICAgICk7
CisKKwlyZXR1cm4gY2Fycnk7Cit9CisKKy8qCisgKiBXZWxsLCBJIGRvIG5v
dCBrbm93IHdoYXQgdGhhdCBkb2VzLCBidXQgYmVjYXVzZSBpdCBpcyBpbmNs
dWRlZCBpbiBMaW51eAorICoga2VybmVsIGl0IGhhcyB0byBiZSBHUEwgLSBz
b3VyY2UgY29kZSBnaXZlbiBpbiBpdHMgbW9zdCByZWFkYWJsZSBmb3JtLi4u
CisgKi8KK2V4dGVybiBpbmxpbmUgdm9pZAorX1g4NlNwZWVkU3RlcFNtaSAo
c3RydWN0IFg4NlNwZWVkU3RlcFNtaV9zICpkYXRhKQoreworCWFzbSgiIGlu
dCAgJDB4MTUJIyBfWDg2U3BlZWRTdGVwU21pICIKKwkgICAgOiAiPWEiIChk
YXRhLT5kYXRhMSksICI9YiIgKGRhdGEtPmRhdGEyKSwKKwkJIj1jIiAoZGF0
YS0+ZGF0YTMpLCAiPWQiIChkYXRhLT5kYXRhNCkKKwkgICAgOiAiYSIgKDB4
MDAwMEU5ODApLCAiZCIgKDB4NDc1MzQ5NDMpICk7Cit9CisKKy8qKgorICoq
IEZpbGwgaW4gZWFjaCBvZiB0aGUgc3ViLXN0cnVjdHVyZXM6CisgKiovCitD
T0RFIHN0YXRpYyBpbmxpbmUgdm9pZAordm1saW51el9FR0EgKHN0cnVjdCBz
Y3JlZW5faW5mbyAqc2NyZWVuX2luZm8pCit7CisJdW5pb24gRUdBX2J4X3Vu
aW9uIEVHQV9ieDsKKwlzdHJ1Y3QgRUdBX2N4X3N0ciBFR0FfY3g7CisKKwlf
RUdBX2dldGRpc3BsYXkoJkVHQV9ieCwgJkVHQV9jeCk7CisJc2NyZWVuX2lu
Zm8tPm9yaWdfdmlkZW9fZWdhX2J4ID0gRUdBX2J4LklPYWRkcl9tZW1vcnk7
CisJc2NyZWVuX2luZm8tPm9yaWdfdmlkZW9faXNWR0EgPSAwOworCWlmIChF
R0FfYnguZW51bXMuSU9hZGRyID09IEVHQV9DT0xPUl8zRHgKKwkgICAgfHwg
RUdBX2J4LmVudW1zLklPYWRkciA9PSBFR0FfTU9OT18zQngpIHsKKwkJdW5z
aWduZWQgY2hhciBhY3RpdmVfZGNjLCBhbHRlcm5hdGVfZGNjOworCisJCWlm
IChfVkdBX2dldF9kaXNwbGF5X2NvbWJpbmF0aW9uX2NvZGUoJmFjdGl2ZV9k
Y2MsCisJCQkJCQkgICAgICAmYWx0ZXJuYXRlX2RjYykgPT0gMCkKKwkJCXNj
cmVlbl9pbmZvLT5vcmlnX3ZpZGVvX2lzVkdBID0gMTsKKworCQlzY3JlZW5f
aW5mby0+b3JpZ192aWRlb19saW5lcyA9IHBlZWtiKChmYXJwdHIpMHgwMDQw
MDA4NCkgKyAxOworCQlzY3JlZW5faW5mby0+b3JpZ19mb250X2hlaWdodCA9
IHBlZWt3KChmYXJwdHIpMHgwMDQwMDA4NSk7CisJfSBlbHNlIHsJLyogRUdB
X2J4LmVudW1zLklPYWRkciB1bmNoYW5nZWQgPT4gQ0dBL01EQS9IR0EgKi8K
KwkJc2NyZWVuX2luZm8tPm9yaWdfdmlkZW9fbGluZXMgPSAyNTsKKwkJc2Ny
ZWVuX2luZm8tPm9yaWdfZm9udF9oZWlnaHQgPSAwOwkvKiBpLmUuIGludmFs
aWQgKi8KKwl9Cit9CisKK0NPREUgc3RhdGljIGlubGluZSB2b2lkCit2bWxp
bnV6X2dldGN1cnNvciAoc3RydWN0IHNjcmVlbl9pbmZvICpzY3JlZW5faW5m
bykKK3sKKyNpZiAxCQkvKiB3aGF0IGlzIHRoZSBiZXN0ID8gSUhNTyB1c2lu
ZyB0aGUgQklPUyBmdW5jdGlvbnMgKi8KKwl1bnNpZ25lZCBjaGFyIHJvdywg
Y29sOworCXVuc2lnbmVkIGNoYXIgY3Vyc29yc3RhcnQsIGN1cnNvcnN0b3A7
CisKKwlfVkdBX2dldGN1cnNvcihzY3JlZW5faW5mby0+b3JpZ192aWRlb19w
YWdlLAorCQkgICAgICAgJnJvdywgJmNvbCwgJmN1cnNvcnN0YXJ0LCAmY3Vy
c29yc3RvcCk7CisJc2NyZWVuX2luZm8tPm9yaWdfeCA9IGNvbDsKKwlzY3Jl
ZW5faW5mby0+b3JpZ195ID0gcm93OworI2Vsc2UKKwlmYXJwdHIgcHRyID0g
MHgwMDQwMDA1MCArIDIgKiBzY3JlZW5faW5mby0+b3JpZ192aWRlb19wYWdl
OworCisJc2NyZWVuX2luZm8tPm9yaWdfeCA9IHBlZWtiKHB0cik7CisJc2Ny
ZWVuX2luZm8tPm9yaWdfeSA9IHBlZWtiKHB0ciArIDEpOworI2VuZGlmCit9
CisKK0NPREUgc3RhdGljIGlubGluZSB2b2lkCit2bWxpbnV6X1ZHQSAoc3Ry
dWN0IHNjcmVlbl9pbmZvICpzY3JlZW5faW5mbywgaW50IHByb3Bvc2VkX2xp
bmUpCit7CisJdW5zaWduZWQgY2hhciBtb2RlLCBuYmNvbCwgcGFnZTsKKwor
CW1vZGUgPSBfVkdBX2dldG1vZGUoJm5iY29sLCAmcGFnZSk7CisJc2NyZWVu
X2luZm8tPm9yaWdfdmlkZW9fbW9kZSA9IG1vZGUgJiAweDdGOworCXNjcmVl
bl9pbmZvLT5vcmlnX3ZpZGVvX2NvbHMgPSBuYmNvbDsKKwlzY3JlZW5faW5m
by0+b3JpZ192aWRlb19wYWdlID0gcGFnZTsJLyogbm90IHRlc3RlZCBpZiAh
PSAwICovCisJaWYgKHByb3Bvc2VkX2xpbmUgPj0gMCkgeworCQlzY3JlZW5f
aW5mby0+b3JpZ195ID0gcHJvcG9zZWRfbGluZTsKKwkJc2NyZWVuX2luZm8t
Pm9yaWdfeCA9IDA7CisJfSBlbHNlIHsKKwkJdm1saW51el9nZXRjdXJzb3Io
c2NyZWVuX2luZm8pOworCQkvKiBXZSB0cnkgbm90IHRvIGVyYXNlIHRoZSB0
ZXh0IHdyaXR0ZW4gbGF0ZXIgYnkgR3VqaW46ICovCisJCXNjcmVlbl9pbmZv
LT5vcmlnX3ggPSAwOworCQlpZiAoc2NyZWVuX2luZm8tPm9yaWdfeSArIDQg
PCBzY3JlZW5faW5mby0+b3JpZ192aWRlb19saW5lcykKKwkJCXNjcmVlbl9p
bmZvLT5vcmlnX3kgKz0gNDsKKwkJZWxzZQorCQkJc2NyZWVuX2luZm8tPm9y
aWdfeSA9IHNjcmVlbl9pbmZvLT5vcmlnX3ZpZGVvX2xpbmVzIC0gMTsKKwl9
Cit9CisKK0NPREUgc3RhdGljIGlubGluZSB2b2lkCit2bWxpbnV6X1ZFU0Eg
KHN0cnVjdCBzY3JlZW5faW5mbyAqc2NyZWVuX2luZm8sIHVuc2lnbmVkIG1v
ZGUpCit7CisJVkVTQV9tb2RlaW5mb190IG1vZGVpbmZvOworCisJaWYgKF9W
RVNBX2dldG1vZGVpbmZvKCZtb2RlaW5mbywgbW9kZSAmIDB4MDFGRikgPT0g
MCkgeworCQlpZiAobW9kZWluZm8uTWVtb3J5TW9kZWwgPT0gbWVtX3RleHQK
KwkJCSYmIG1vZGVpbmZvLk51bWJlck9mUGxhbmVzID09IDQpIHsKKwkJCS8q
IGNvcnJlY3Qgc29tZSBidWdneSB2aWRlbyBCSU9TOiAqLworCQkJbW9kZWlu
Zm8uQnl0ZXNQZXJTY2FuTGluZSA9IDIgKiBtb2RlaW5mby5YUmVzb2x1dGlv
bjsKKwkJCW1vZGVpbmZvLkJpdHNQZXJQaXhlbCA9IDQ7CisJCX0KKwkJaWYg
KG1vZGVpbmZvLk1lbW9yeU1vZGVsID09IG1lbV90ZXh0KQorCQkJc2NyZWVu
X2luZm8tPmxmYl9iYXNlID0gMHhCODAwMDsKKwkJZWxzZSBpZiAobW9kZWlu
Zm8uTW9kZUF0dHJpYnV0ZXMubGluZWFyX2ZyYW1lYnVmZmVyX3N1cHBvcnRl
ZCkgeworCQkJLyogbm8gdGV4dCBtb2RlcyB3aXRoIGxpbmVhciBmcmFtZWJ1
ZmZlciAqLworCQkJc2NyZWVuX2luZm8tPm9yaWdfdmlkZW9faXNWR0EgPSAw
eDIzOworCQkJc2NyZWVuX2luZm8tPmxmYl9iYXNlID0gbW9kZWluZm8uUGh5
c0Jhc2VQdHI7CisJCX0gZWxzZQorCQkJc2NyZWVuX2luZm8tPmxmYl9iYXNl
ID0gMHhBMDAwMDsKKwkJc2NyZWVuX2luZm8tPmxmYl9saW5lbGVuZ3RoID0g
bW9kZWluZm8uQnl0ZXNQZXJTY2FuTGluZTsKKwkJc2NyZWVuX2luZm8tPmxm
Yl93aWR0aCA9IG1vZGVpbmZvLlhSZXNvbHV0aW9uOworCQlzY3JlZW5faW5m
by0+bGZiX2hlaWdodCA9IG1vZGVpbmZvLllSZXNvbHV0aW9uOworCQlzY3Jl
ZW5faW5mby0+bGZiX2RlcHRoID0gbW9kZWluZm8uQml0c1BlclBpeGVsOwor
CQlzY3JlZW5faW5mby0+bGZiX3BhZ2VzID0gbW9kZWluZm8uTnVtYmVyT2ZJ
bWFnZVBhZ2VzOworCQlzY3JlZW5faW5mby0+dmVzYV9hdHRyaWIgPSBtb2Rl
aW5mby5Nb2RlQXR0cmlidXRlczsKKwkJc2NyZWVuX2luZm8tPmxheW91dCA9
IG1vZGVpbmZvLmxheW91dDsKKwl9IGVsc2UKKwkJc2NyZWVuX2luZm8tPmxm
Yl9iYXNlID0gMDsKK30KKworQ09ERSBzdGF0aWMgdm9pZAordm1saW51el9W
SURFTyAoc3RydWN0IHNjcmVlbl9pbmZvICpzY3JlZW5faW5mbywgdW5zaWdu
ZWQgc2hvcnQgKmFjcGlfdmlkbW9kZSwKKwkgICAgICAgaW50IHByb3Bvc2Vk
X2xpbmUpCit7CisJVkVTQV9WYmVJbmZvQmxvY2sgaW5mb2Jsb2NrOworCisJ
dm1saW51el9FR0Eoc2NyZWVuX2luZm8pOworCXZtbGludXpfVkdBKHNjcmVl
bl9pbmZvLCBwcm9wb3NlZF9saW5lKTsKKwkqYWNwaV92aWRtb2RlID0gc2Ny
ZWVuX2luZm8tPm9yaWdfdmlkZW9fbW9kZTsKKworCS8qIG5vcm1hbHkgb25s
eSBmb3IgZ3JhcGhpYyBtb2RlczogKi8KKwlpZiAoX1ZFU0FfZ2V0aW5mbygm
aW5mb2Jsb2NrKSA9PSAwKSB7CisJCXVuc2lnbmVkIHNob3J0IG1vZGUsIGxl
bjsKKwkJZmFycHRyIGFkZHI7CisKKwkJc2NyZWVuX2luZm8tPmxmYl9zaXpl
ID0gaW5mb2Jsb2NrLlRvdGFsTWVtb3J5OworCQlpZiAoX1ZFU0FfZ2V0bW9k
ZSgmbW9kZSkgPT0gMCkgeworCQkJdm1saW51el9WRVNBKHNjcmVlbl9pbmZv
LCBtb2RlKTsKKwkJCSphY3BpX3ZpZG1vZGUgPSBtb2RlOworI2lmIDAJLyog
QWZ0ZXIgZG9pbmcgdGhhdCwgd2Ugc2hvdWxkIHByb2dyYW0gYWdhaW4gdGhl
IERBQyB3aXRoIHRoZSByaWdodCB2YWx1ZXMuLi4gKi8KKwkJCS8qIExpbnV4
IGRvIG5vdCBtYW5hZ2UgdGV4dCBtb2RlcyBhbmQgREFDIDggYml0czogKi8K
KwkJCWlmIChzY3JlZW5faW5mby0+bGZiX2Jhc2UgIT0gMHhCODAwMAorCQkJ
CSAmJiBzY3JlZW5faW5mby0+bGZiX2RlcHRoIDw9IDgKKwkJCQkgJiYgaW5m
b2Jsb2NrLkNhcGFiaWxpdGllcy5EQUM4Yml0X3ByZXNlbnQpIHsKKwkJCQlp
ZiAoX1ZFU0Ffc2V0REFDd2lkdGggKDgpID09IDApIHsKKwkJCQkJc2NyZWVu
X2luZm8tPmxheW91dCA9IChjb25zdCBzdHJ1Y3QgdmVzYV9jb2xvcl9sYXlv
dXRfc3RyKXsKKwkJCQkJCXs4LCAwfSwgezgsIDB9LCB7OCwgMH0sIHs4LCAw
fX07CisJCQkJfQorCQkJCWVsc2UgeworCQkJCQlzY3JlZW5faW5mby0+bGF5
b3V0ID0gKGNvbnN0IHN0cnVjdCB2ZXNhX2NvbG9yX2xheW91dF9zdHIpewor
CQkJCQkJezYsIDB9LCB7NiwgMH0sIHs2LCAwfSwgezYsIDB9fTsKKwkJCQl9
CisJCQl9CisjZW5kaWYKKwkJfQorCisJCS8qIE5vdGU6IFdlIGNhbiBoYXZl
IGEgUE0gaW50ZXJmYWNlIGV2ZW4gaWYgZ2V0bW9kZWluZm8KKwkJICAgZmFp
bGVkLCBmb3IgaW5zdGFuY2UgaWYgd2UgYXJlIGluIHRleHQgbW9kZSAzICov
CisJCWlmIChfVkVTQV9HZXRQTWludGVyZmFjZSgmYWRkciwgJmxlbikgPT0g
MCkgeworCQkJc2NyZWVuX2luZm8tPnZlc2FwbV9zZWcgPSBhZGRyID4+IDE2
OworCQkJc2NyZWVuX2luZm8tPnZlc2FwbV9vZmYgPSBhZGRyICYgMHhGRkZG
OworCQl9CisJfQorfQorCitDT0RFIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQg
c2hvcnQgdm1saW51el9FWFRfTUVNX0sgKHZvaWQpCit7CisJdW5zaWduZWQg
c2hvcnQgRVhUX01FTV9LOworCisJaWYgKF9CSU9TX2dldEV4dGVuZGVkTWVt
b3J5KCZFWFRfTUVNX0spICE9IDAgfHwgRVhUX01FTV9LID09IDApCisJCUVY
VF9NRU1fSyA9ICgoKHVuc2lnbmVkIHNob3J0KWdldG52cmFtKDB4MTgpKSA8
PCA4KQorCQkJCSsgZ2V0bnZyYW0oMHgxNyk7CisJcmV0dXJuIEVYVF9NRU1f
SzsKK30KKworQ09ERSBzdGF0aWMgaW5saW5lIHZvaWQKK3ZtbGludXpfQVBN
IChzdHJ1Y3QgYXBtX2Jpb3NfaW5mbyAqYXBtX2Jpb3NfaW5mbykKK3sKKwlp
ZiAoX0FQTV9pbnN0YWxsYXRpb25fY2hlY2soJmFwbV9iaW9zX2luZm8tPnZl
cnNpb24sCisJCQkJICAgJmFwbV9iaW9zX2luZm8tPmZsYWdzKSA9PSAwKSB7
CisJCV9BUE1fZGlzY29ubmVjdCgpOwkvKiBpZ25vcmUgcG9zc2libGUgZXJy
b3IgKi8KKwkJaWYgKChhcG1fYmlvc19pbmZvLT5mbGFncyAmIDIpID09IDAp
IHsKKwkJCS8qIG5vIDMyIGJpdHMgc3VwcG9ydCwgaWdub3JlIEFQTSAqLwor
CQl9IGVsc2UgaWYgKF9BUE1fY29ubmVjdF8zMmJpdCgmYXBtX2Jpb3NfaW5m
by0+Y3NlZywKKwkJCQkJICAgICAmYXBtX2Jpb3NfaW5mby0+b2Zmc2V0LAor
CQkJCQkgICAgICZhcG1fYmlvc19pbmZvLT5jc2VnXzE2LAorCQkJCQkgICAg
ICZhcG1fYmlvc19pbmZvLT5kc2VnLAorCQkJCQkgICAgICZhcG1fYmlvc19p
bmZvLT5jc2VnX2xlbiwKKwkJCQkJICAgICAmYXBtX2Jpb3NfaW5mby0+ZHNl
Z19sZW4pICE9IDApIHsKKwkJCWFwbV9iaW9zX2luZm8tPmZsYWdzICY9IH4y
OyAvKiByZW1vdmUgMzJiaXRzIHN1cHBvcnQgKi8KKwkJfSBlbHNlIHsKKwkJ
CS8qIFJlZG8gdGhlIGluc3RhbGxhdGlvbiBjaGVjayBhcyB0aGUgMzIgYml0
IGNvbm5lY3QKKwkJCQltb2RpZmllcyB0aGUgZmxhZ3MgcmV0dXJuZWQgb24g
c29tZSBCSU9TcyA6ICovCisJCQlpZiAoX0FQTV9pbnN0YWxsYXRpb25fY2hl
Y2soJmFwbV9iaW9zX2luZm8tPnZlcnNpb24sCisJCQkJCQkmYXBtX2Jpb3Nf
aW5mby0+ZmxhZ3MpICE9IDApIHsKKwkJCQlhcG1fYmlvc19pbmZvLT5mbGFn
cyAmPSB+MjsKKwkJCQlfQVBNX2Rpc2Nvbm5lY3QoKTsKKwkJCX0KKwkJfQor
CX0KK30KKworQ09ERSBzdGF0aWMgaW5saW5lIHZvaWQKK3ZtbGludXpfQ09O
RklHIChzdHJ1Y3Qgc3lzX2Rlc2NfdGFibGVfaW5mbyAqc3lzX2Rlc2NfdGFi
bGUpCit7CisJZmFycHRyIGFkciA9IF9CSU9TX2dldENvbmZpZ3VyYXRpb24o
KTsKKworCWlmIChhZHIgIT0gMCkKKwkJZ2V0X2Jpb3NfY29uZihhZHIsIHN5
c19kZXNjX3RhYmxlKTsKK30KKworQ09ERSBzdGF0aWMgaW5saW5lIHZvaWQK
K3ZtbGludXpfRURJRCAoVkJFX0VESURfdCAqZWRpZF9kYXRhKQoreworCWlm
IChfRURJRF9kZXRlY3QoKSAhPSAwIHx8IF9FRElEX3JlYWQoZWRpZF9kYXRh
KSAhPSAwKSB7CisJCXVuc2lnbmVkIGNoYXIgKnB0ciA9ICh1bnNpZ25lZCBj
aGFyICopZWRpZF9kYXRhOworCQl1bnNpZ25lZCBjcHQgPSBzaXplb2YoVkJF
X0VESURfdCk7CisJCS8qIGZhaWxlZCwgcmVzZXQgY29tcGxldGUgYXJlYTog
Ki8KKwkJd2hpbGUgKC0tY3B0KQorCQkJKnB0cisrID0gMHgxMzsKKwl9Cit9
CisKK0NPREUgc3RhdGljIGlubGluZSB1bnNpZ25lZAordm1saW51el9FODIw
IChzdHJ1Y3QgZTgyMG1hcF9pbmZvICplODIwbWFwLCB1bnNpZ25lZCBlODIw
bWFwX2J1ZnNpemUpCit7CisJdW5zaWduZWQgYnVmc2l6ZSA9IGU4MjBtYXBf
YnVmc2l6ZSwgY29udF92YWwgPSAwLCBhY3R1YWxfbGVuOworCS8qIFVzZSB0
aGF0IHRvIGF2b2lkIGRhdGEgaW4gLnJvZGF0YSB3aXRoIEdDQy0yLjk1LjM6
ICovCisJdW5zaWduZWQgZWxlbWVudF9zaXplID0gc2l6ZW9mKHN0cnVjdCBl
ODIwbWFwX2luZm8pOworCisJd2hpbGUgKCAgIGJ1ZnNpemUgPj0gZWxlbWVu
dF9zaXplCisJICAgICAgICYmIChhY3R1YWxfbGVuID0gX0JJT1NfUXVlcnlN
ZW1vcnlNYXAoJmNvbnRfdmFsLAorCQkJCQlidWZzaXplLCBlODIwbWFwKSkg
IT0gMAorCSAgICAgICAmJiBjb250X3ZhbCAhPSAwKSB7CisJCWJ1ZnNpemUg
LT0gYWN0dWFsX2xlbjsKKwkJZTgyMG1hcCA9ICh2b2lkICopZTgyMG1hcCAr
IGFjdHVhbF9sZW47CisJfQorCXJldHVybiAoZTgyMG1hcF9idWZzaXplIC0g
YnVmc2l6ZSkgLyBlbGVtZW50X3NpemU7Cit9CisKK0NPREUgc3RhdGljIGlu
bGluZSB1bnNpZ25lZAordm1saW51el9NQlJTSUcgKHVuc2lnbmVkICpNQlJT
SUcsIHVuc2lnbmVkIHRvdGFsX01CUlNJR19lbnRyaWVzKQoreworCXVuc2ln
bmVkIGJ1ZmZlcls1MTIgLyBzaXplb2YodW5zaWduZWQpXSwgY3B0OworI2Rl
ZmluZSBFRERfTUJSX1NJR19PRkZTRVQgMHgxQjggIC8qIG9mZnNldCBvZiBz
aWduYXR1cmUgaW4gdGhlIE1CUiAqLworCisJZm9yIChjcHQgPSAwOyBjcHQg
PCB0b3RhbF9NQlJTSUdfZW50cmllczsgY3B0KyspIHsKKwkJaWYgKF9CSU9T
RElTS19SV3NlY3RvcigweDgwICsgY3B0LCAwLCAwLCAxLCAxLAorCQkJCQkg
c3RhY2tfZmFycHRyKGJ1ZmZlciksIDEpICE9IDApCisJCQlyZXR1cm4gY3B0
OworCQkqTUJSU0lHKysgPSBidWZmZXJbRUREX01CUl9TSUdfT0ZGU0VUIC8g
c2l6ZW9mKHVuc2lnbmVkKV07CisJfQorCXJldHVybiBjcHQ7Cit9CisKK0NP
REUgc3RhdGljIGlubGluZSB1bnNpZ25lZAordm1saW51el9FREQgKHN0cnVj
dCBlZGRfaW5mbyAqZWRkLCB1bnNpZ25lZCB0b3RhbF9FRERfZW50cmllcykK
K3sKKwl1bnNpZ25lZCBjcHQsIGVkZGNwdDsKKworCWZvciAoY3B0ID0gZWRk
Y3B0ID0gMDsgY3B0IDwgMTYgJiYgZWRkY3B0IDwgdG90YWxfRUREX2VudHJp
ZXM7IGNwdCsrKSB7CisJCXVuc2lnbmVkIGNoYXIgZXh0ZW5zaW9uLCBzdGF0
dXM7CisJCXVuc2lnbmVkIHNob3J0IHRtcGN4LCB0bXBkeDsKKwkJZmFycHRy
IERCVGFkcjsKKwkJdW5zaWduZWQgY2hhciBDbW9zRHJpdmVUeXBlLCBzdGF0
OworCQlzdHJ1Y3QgZWRkX2luZm8gKmVkZHB0ciA9ICZlZGRbZWRkY3B0XTsK
KworCQlpZiAoX0VCSU9TRElTS19wcm9iZSgweDgwICsgY3B0LCAmZWRkcHRy
LT52ZXJzaW9uLCAmZXh0ZW5zaW9uLAorCQkJICAgICAoZWJpb3NfYml0bWFw
X3QgKikgJmVkZHB0ci0+aW50ZXJmYWNlX3N1cHBvcnQpKQorCQkJY29udGlu
dWU7CisJCWVkZHB0ci0+ZGV2aWNlID0gMHg4MCArIGNwdDsKKwkJZWRkcHRy
LT5wYXJhbXMubGVuZ3RoID0gc2l6ZW9mKGVkZHB0ci0+cGFyYW1zKTsKKwkJ
ZWRkcHRyLT5wYXJhbXMuaW5mb19mbGFncyA9IDA7CS8qIGJ1Z2d5IEJJT1Mg
PyAqLworCQkvKiBEb24ndCBjaGVjayBmb3IgZmFpbCByZXR1cm4sIGl0IGRv
ZXNuJ3QgbWF0dGVyOiAqLworCQlfRUJJT1NESVNLX2dldHBhcmFtKDB4ODAg
KyBjcHQsCisJCQkJKGViaW9zaW5mb190ICopICZlZGRwdHItPnBhcmFtcywg
JnN0YXR1cyk7CisJCWlmIChfQklPU0RJU0tfZ2V0cGFyYW0oMHg4MCArIGNw
dCwgJnRtcGN4LCAmdG1wZHgsCisJCQkJJkRCVGFkciwgJkNtb3NEcml2ZVR5
cGUsICZzdGF0KSAhPSAwKSB7CisJCQllZGRwdHItPm1heF9jeWwgPSAwOwor
CQkJZWRkcHRyLT5tYXhfc2VjdCA9IGVkZHB0ci0+bWF4X2hlYWQgPSAwOwor
CQl9IGVsc2UgeworCQkJZWRkcHRyLT5tYXhfaGVhZCA9IHRtcGR4ID4+IDg7
CisJCQllZGRwdHItPm1heF9zZWN0ID0gdG1wY3ggJiAweDNGOworCQkJZWRk
cHRyLT5tYXhfY3lsID0gKCh0bXBjeCAmIDB4QzApIDw8IDIpIHwgKHRtcGN4
ID4+IDgpOworCQl9CisJCWVkZGNwdCsrOworCX0KKwlyZXR1cm4gZWRkY3B0
OworfQorCisKKy8qKgorICoqIENvbW1hbmQgbGluZSBzdHVmZjoKKyAqKi8K
K0NPREUgc3RhdGljIGlubGluZSB2b2lkCit2bWxpbnV6X0NNRExJTkUgKGNo
YXIgKmNvbW1hbmRfbGluZSwgY29uc3QgdW5zaWduZWQgY2hhciAqcHJvcG9z
ZWRfY21kbGluZSwKKwkJIGZhcnB0ciBleHRyYV9jbWRsaW5lX2ZhcnB0ciwK
KwkJIGNvbnN0IGNoYXIgKmNtZGxpbmVfbmFtZSwgY29uc3QgY2hhciAqY21k
bGluZV9leHRyYXBhcmFtKQoreworCWNoYXIgKmNtZHB0ciA9IGNvbW1hbmRf
bGluZTsKKworCS8qIGluc2VydCBhdCBiZWdpbm5pbmcgdGhlIG5hbWUgb2Yg
dGhlIHVuY29tcHJlc3NlZCBHWklQIGZpbGU6ICovCisJaWYgKGNtZGxpbmVf
bmFtZSAmJiAqY21kbGluZV9uYW1lKSB7CisJCWRvCisJCQkqY21kcHRyKysg
PSAqY21kbGluZV9uYW1lKys7CisJCXdoaWxlICgqY21kbGluZV9uYW1lKTsK
KwkJKmNtZHB0cisrID0gJyAnOworCX0KKworCS8qIGluc2VydCB0aGVuOiBj
b25zb2xlPXR0eVM/LDk2MDAsbiw3IG9yIHZpZGVvPXZlc2EsCisJCWtleWJv
YXJkPT8/LCBOdW1Mb2NrPW9uL29mZiwgbW91c2U9L2Rldi9wc2F1eCwKKwkJ
Q09MUz0sIExJTkVTPSBwcm9wb3NlZCBieSBHdWppbiAqLworCWlmIChwcm9w
b3NlZF9jbWRsaW5lICYmICpwcm9wb3NlZF9jbWRsaW5lKSB7CisJCWRvCisJ
CQkqY21kcHRyKysgPSAqcHJvcG9zZWRfY21kbGluZSsrOworCQl3aGlsZSAo
KnByb3Bvc2VkX2NtZGxpbmUpOworCQkqY21kcHRyKysgPSAnICc7CisJfQor
CisJLyogQWRkIG5lYXJieSBlbmQgdGhlIEd1amluIGd1amluX3BhcmFtLmV4
dHJhX2NtZGxpbmUgZmllbGQ6ICovCisJLyogV2UgYXNzdW1lIHRoZXJlIGd1
amluX3BhcmFtLmV4dHJhX2NtZGxpbmUgaXMgY29ycmVjdGx5IHplcm8gdGVy
bWluYXRlZCAqLworCS8qIE5vdGU6IHdlIHdpbGwgaGF2ZSAicm9vdD0iIHBh
cmFtZXRlciBmcm9tIEd1amluIHNldHVwIHNjcmVlbiBmaXJzdCwKKwkgICBz
byB0aGF0IGlmIHRoZSBvbmUgaW4gdGhlIEdaSVAgY29tbWVudCBpZiBlcnJv
bmVvdXMsIHdlIGNhbiBqdXN0CisJICAgb3ZlcndyaXRlIGl0IHdpdGggdGhl
IEd1amluIHNldHVwIChUT0NIRUNLOiB3aGVuIHR3byAicm9vdD0iIGFyZQor
CSAgIGdpdmVuIG9uIHRoZSBjb21tYW5kIGxpbmUsIG9ubHkgdGhlIGZpcnN0
IG9uZSBpcyB0YWtlbikgKi8KKwlpZiAoZXh0cmFfY21kbGluZV9mYXJwdHIg
IT0gMCAmJiBwZWVrYihleHRyYV9jbWRsaW5lX2ZhcnB0cikgIT0gMCkgewor
CQkqY21kcHRyKysgPSAnICc7IC8qIHR3byBzcGFjZXMgYXMgc2VwYXJhdG9y
ICovCisJCWZvciAoOzspIHsKKwkJCSpjbWRwdHIgPSBwZWVrYihleHRyYV9j
bWRsaW5lX2ZhcnB0cisrKTsKKwkJCWlmICgqY21kcHRyIDwgJyAnKSB7IC8q
IHN0b3AgYXQgXDAsIFxuLCBcciBvciBcdCAqLworCQkJCSpjbWRwdHIgPSAn
XDAnOworCQkJCWJyZWFrOworCQkJfQorCQkJY21kcHRyKys7CisJCX0KKwl9
CisKKwkvKiBhZGQgYXQgZW5kIHRoZSBwYXJhbXMgaW4gdGhlIGNvbW1lbnQg
cGFydCBvZiB0aGUgR1pJUCBmaWxlOiAqLworCS8qIFRoaXMgbWF5IG9yIG1h
eSBub3Qgc3RvcCBhdCB0aGUgZmlyc3QgbmV3bGluZSAqLworCWlmIChjbWRs
aW5lX2V4dHJhcGFyYW0gJiYgKmNtZGxpbmVfZXh0cmFwYXJhbSkgeworCQkq
Y21kcHRyKysgPSAnICc7CisJCWRvCisJCQkqY21kcHRyKysgPSAqY21kbGlu
ZV9leHRyYXBhcmFtKys7CisJCXdoaWxlICgqY21kbGluZV9leHRyYXBhcmFt
ICE9IDAgJiYgKmNtZGxpbmVfZXh0cmFwYXJhbSAhPSAnXG4nKTsKKwl9CisJ
KmNtZHB0ciA9ICdcMCc7Cit9CisKK3N0cnVjdCBkZXNjX3N0cjsKK3N0cnVj
dCBncGxfY29tcGxpYW50X3N0cjsKKworQ09ERSBzdGF0aWMgaW5saW5lIHZv
aWQKK3ZtbGludXpfRElTS1MgKHVuaW9uIGRyaXZlX2luZm8gKmRyaXZlMSwg
dW5pb24gZHJpdmVfaW5mbyAqZHJpdmUyKQoreworCXVuc2lnbmVkIG5ic2Vj
dDsKKwl1bnNpZ25lZCBjaGFyIHN0YXR1cywgZGlzayA9IDB4ODA7CisJdW5p
b24gZHJpdmVfaW5mbyAqZHJpdmUgPSBkcml2ZTE7CisJZmFycHRyIHZlY3Rv
cmFkciA9IChmYXJwdHIpKDB4NDEgKiA0KTsKKworCXdoaWxlIChkaXNrIDw9
IDB4ODEpIHsKKwkJaWYgKF9CSU9TRElTS19nZXR0eXBlIChkaXNrLCAmbmJz
ZWN0LCAmc3RhdHVzKSA9PSAwKQorCQkJZ2V0X2RyaXZlX2luZm8gKHZlY3Rv
cmFkciwgZHJpdmUpOworCQlkaXNrKys7CisJCXZlY3RvcmFkciA9IChmYXJw
dHIpKDB4NDYgKiA0KTsKKwkJZHJpdmUgPSBkcml2ZTI7CisJfQorfQorCisv
KioKKyAqKiBUSEUgZnVuY3Rpb246CisgKiovCitzdHJ1Y3QgTE9BREVSX3N0
ciB7CisJdW5zaWduZWQgc2hvcnQgc2l6ZW9mX2xvYWRlcl9zdHIsIHNpemVv
Zl9maWxlbG9hZF9zdHI7CisJc3RydWN0IGZpbGVsb2FkX3N0ciB7CisJCS8q
IGlucHV0OiAqLworCQl1bnNpZ25lZCBsb2FkX2FkZHJlc3MsIG1heF9zaXpl
OworCQkvKiBvbmx5IGZvciBYTVMgdXNlOiAqLworCQl1bnNpZ25lZCBzaG9y
dCBoYW5kbGUsIEtCYWxsb2NlZDsKKwkJLyogRm9yIHJlZmVyZW5jZTogKi8K
KwkJdW5zaWduZWQgQk9PVFdBWV9kZXNjX2luZGV4OworCQkvKiBvdXRwdXQ6
ICovCisJCXVuc2lnbmVkIGNvbXByZXNzZWRfc2l6ZSwgdW5jb21wcmVzc2Vk
X3NpemU7CisJfSBmaWxlbG9hZFszXSwgKmN1cmZpbGVsb2FkOwkvKiBrZXJu
ZWwgYW5kIGluaXRyZCAqLworCWludCBpbml0cmRfaW5kZXg7CisJdW5zaWdu
ZWQgc2hvcnQgbWlub3JfbWFqb3Jfcm9vdDsKKwl1bnNpZ25lZCBzaG9ydCBs
aWNlbnNlX2NvbXBsaWFudDsKKwl1bnNpZ25lZCB2bWxpbnV6X2J5dGVfdHJl
YXRlZDsgLyogaGVhZGVyICsga2VybmVsIEdaSVAgKi8KKwl1bnNpZ25lZCBi
YXNlX3JlYWxfZmN0OyAvKiBsaW5lYXIgYWRkcmVzcyBpbnNpZGUgdW5jb21w
cmVzc2VkIGtlcm5lbCAqLworCXVuc2lnbmVkIGhhbmRsZV9yZWFsX2ZjdDsK
Kwl1bnNpZ25lZCBhY2NlcHRfdW5jb21wcmVzc2VkX2luaXRyZF9maWxlc2l6
ZTsKKwl1bnNpZ25lZCByZXNlcnZlZFs2XTsKKwkvKiBJbml0aWFsaXNlZCBm
cm9tIHRoZSAiY29tbWVudCIgbGluZSBvZiB0aGUgR1pJUCBmaWxlICovCisJ
dW5pb24geworCQl1bnNpZ25lZCBhcnJheVszMl07CisJCXN0cnVjdCB7CisJ
CQl1bnNpZ25lZCBOT05HUExfcHJvZHVjdElEOworCQkJdW5zaWduZWQgTk9O
R1BMX3Byb2R1Y3ROQjsKKwkJCXVuc2lnbmVkIG1pbl9ndWppbl92ZXJzaW9u
OwkvKiAweDEwMCBmb3IgMS4wICovCisJCQl1bnNpZ25lZCBsYXRlX3JlbG9j
YXRpb25fYWRkcmVzczsKKwkJCXVuc2lnbmVkIHJ1bmFkcjsKKwkJCXVuc2ln
bmVkIHBhcmFtYWRyOwkvKiB1c3VhbGx5IDB4MDAwODAwMDAgKi8KKwkJCXVu
c2lnbmVkIHJlYWxmY3Rfc2l6ZTsJLyogaW4gYnl0ZXMgKi8KKwkJCXVuc2ln
bmVkIG1pbnJhbTsJLyogaW4ga2lsb2J5dGVzICovCisJCQl1bnNpZ25lZCBv
cHRpb247CisJCQl1bnNpZ25lZCBtYXNrY3B1OworCQkJdW5zaWduZWQgbWFz
a0RmbGFnczsgLyogcmVxdWVzdCB0aG9zZSBiaXRzIHNldCwKKwkJCQkJY3B1
aWQgMHgwMDAwMDAwMSBpbiBlZHggKHVzdWFsKSAqLworCQkJdW5zaWduZWQg
bWFza0NmbGFnczsgLyogcmVxdWVzdCB0aG9zZSBiaXRzIHNldCwKKwkJCQkJ
Y3B1aWQgMHgwMDAwMDAwMSBpbiBlY3ggKG5ldykgKi8KKwkJCXVuc2lnbmVk
IG1hc2tCZmxhZ3M7IC8qIHVudXNlZCBvbiBQQ3MgKi8KKwkJCXVuc2lnbmVk
IG1hc2tBZmxhZ3M7IC8qIHJlcXVlc3QgdGhvc2UgYml0cyBzZXQsCisJCQkJ
CWNwdWlkIDB4ODAwMDAwMDEgKi8KKwkJCXVuc2lnbmVkIG1hc2t2ZXNhOyAv
KiBpZiBiaXQgKDgtMSkgc2V0LAorCQkJCQkJVkVTQSA4QlBQIHN1cHBvcnRl
ZCAqLworCQkJdW5zaWduZWQgbWFza3Jlc29sdXRpb247IC8qIGJpdCBzZXQg
PT4gZXhjbHVkZQorCQkJCQkJdGhvc2UgbW9kZXMgKi8KKwkJfSBlbGVtOwor
CX0gY29tbWVudDsKKwkvKiByZWxhdGVkIHRvIExpbnV4IHZlcnNpb246ICov
CisJY2hhciBjbWRsaW5lX2V4dHJhcGFyYW1bNTEyXTsKKwljaGFyIGNtZGxp
bmVfbmFtZVsxMjhdOworfTsKKworQ09ERSBfX2F0dHJpYnV0ZV9fICgoY2Rl
Y2wsIHJlZ3Bhcm0oMCkpKSB1bnNpZ25lZAorbGludXhfc2V0X3BhcmFtcyAo
dW5zaWduZWQgbG9jYWxfcmV0dXJuX2FkZHJlc3MsCisJCSAgdW5zaWduZWQg
dG90YWxtZW0sCisJCSAgc3RydWN0IGxvYWRlcl90IGJvb3Rsb2FkZXJfdHlw
ZSwKKwkJICBzdHJ1Y3QgbGludXhfcGFyYW0gKkxueFBhcmFtLAorCQkgIGNv
bnN0IHN0cnVjdCBMT0FERVJfc3RyICpsb2FkZXIsCisJCSAgY29uc3Qgc3Ry
dWN0IGdwbF9jb21wbGlhbnRfc3RyICp0b2dwbCwKKwkJICBjb25zdCBzdHJ1
Y3QgZGVzY19zdHIgKnN5c3RlbV9kZXNjLAorCQkgIGludCBwcm9wb3NlZF9y
b3csCisJCSAgY2hhciAqKnN0cmluZ3B0ciwKKwkJICB1bnNpZ25lZCBjaGFy
ICpwcm9wb3NlZF9jbWRsaW5lKQoreworCXVuc2lnbmVkIGNoYXIgKnB0cjsK
Kwl1bnNpZ25lZCBuYl9zbGFzaF9pbl9rZXJuZWxuYW1lID0gMDsKKwl0ZXN0
X2xpbnV4X3BhcmFtX3N0cnVjdCgpOworCisJdm1saW51el9WSURFTyAoJkxu
eFBhcmFtLT5zY3JlZW5faW5mbywgJkxueFBhcmFtLT5pbl9vdXQudmlkX21v
ZGUsCisJCSAgICAgIHByb3Bvc2VkX3Jvdyk7CisKKwkvKiBKdXN0IG5lZWRl
ZCBmb3Igb2xkIGtlcm5lbHMsIGJlZm9yZSAyLjIueDogKi8KKwlMbnhQYXJh
bS0+c2NyZWVuX2luZm8uRVhUX01FTV9LID0gdm1saW51el9FWFRfTUVNX0so
KTsKKworCS8qIG9sZCBDb21tYW5kIExpbmUgbWFnaWMgZm9yIDIuMi0ga2Vy
bmVsczogKi8KKwlMbnhQYXJhbS0+c2NyZWVuX2luZm8uQ0xfTUFHSUMgPSAw
eEEzM0Y7CisJTG54UGFyYW0tPnNjcmVlbl9pbmZvLkNMX09GRlNFVCA9IG9m
ZnNldG9mKHN0cnVjdCBsaW51eF9wYXJhbSwKKwkJCQkJCSAgIGNvbW1hbmRf
bGluZSk7CisJLyogTmV3IENvbW1hbmQgTGluZSBtYWdpYyBmb3IgMi40KyBr
ZXJuZWxzOiAqLworCUxueFBhcmFtLT5pbl9vdXQuY21kX2xpbmVfcHRyID0g
bG9hZGVyLT5jb21tZW50LmVsZW0ucGFyYW1hZHIKKwkgICAgKyBvZmZzZXRv
ZiAoc3RydWN0IGxpbnV4X3BhcmFtLCBjb21tYW5kX2xpbmUpOworCisvKiAg
TG54UGFyYW0tPmluX291dC5oZWFkZXJfc2lnbmF0dXJlLmxvbmd3b3JkID0g
eyB7ICdIJywgJ2QnLCAncicsICdTJyB9IH07ICovCisJTG54UGFyYW0tPmlu
X291dC5oZWFkZXJfdmVyc2lvbl9udW1iZXIgPSAweDAyMDI7CisJTG54UGFy
YW0tPmluX291dC5yYW1kaXNrX2ltYWdlID0gbG9hZGVyLT5maWxlbG9hZFsx
XS5sb2FkX2FkZHJlc3M7CisJTG54UGFyYW0tPmluX291dC5yYW1kaXNrX3Np
emUgPSBsb2FkZXItPmZpbGVsb2FkWzFdLnVuY29tcHJlc3NlZF9zaXplOwor
CUxueFBhcmFtLT5pbl9vdXQudHlwZV9vZl9sb2FkZXIgPSBib290bG9hZGVy
X3R5cGU7CisKKwlMbnhQYXJhbS0+QUxUX01FTV9LID0gdG90YWxtZW07CisK
Kwl2bWxpbnV6X0FQTSAoJkxueFBhcmFtLT5hcG1fYmlvc19pbmZvKTsKKwor
CV9YODZTcGVlZFN0ZXBTbWkgKCZMbnhQYXJhbS0+WDg2U3BlZWRTdGVwU21p
KTsKKwl2bWxpbnV6X0RJU0tTICgmTG54UGFyYW0tPmRyaXZlMSwgJkxueFBh
cmFtLT5kcml2ZTIpOworCXZtbGludXpfQ09ORklHICgmTG54UGFyYW0tPnN5
c19kZXNjX3RhYmxlKTsKKwkvKiBkbyB2bWxpbnV6X0VESUQoKSBiZWZvcmUg
dm1saW51el9FODIwKCkgc28gdGhhdCBpZiB0aGUgbGF0ZXIKKwkgZnVuY3Rp
b24gZGVzY3JpYmVzIG1vcmUgdGhhbiAxOCAoYW5kIGxlc3MgdGhhbiAzMikg
YmxvY2tzIG9mIG1lbW9yeSwKKwkgdGhlIG1vcmUgaW1wb3J0YW50IGluZm9y
bWF0aW9uIGVyYXNlcyB0aGUgbGVzcyBpbXBvcnRhbnQgb25lLgorCSBTaW5j
ZSAyLjYuMTIgdGhlcmUgaXNuJ3QgYW55IG92ZXJ3cml0ZSBwcm9ibGVtLiov
CisJdm1saW51el9FRElEICgmTG54UGFyYW0tPmVkaWRfZGF0YSk7CisJTG54
UGFyYW0tPm5iX0U4MjBfZW50cmllcyA9IHZtbGludXpfRTgyMCAoTG54UGFy
YW0tPmU4MjBtYXAsCisJCXNpemVvZihMbnhQYXJhbS0+ZTgyMG1hcCkpOwor
CisJLyogTm93IHRoZSBjb21tYW5kIGxpbmUgc3R1ZmY6ICovCisJdm1saW51
el9DTURMSU5FIChMbnhQYXJhbS0+Y29tbWFuZF9saW5lLCBwcm9wb3NlZF9j
bWRsaW5lLAorCQkJKihmYXJwdHIgKilzdHJpbmdwdHIsCisJCQlsb2FkZXIt
PmNtZGxpbmVfbmFtZSwgbG9hZGVyLT5jbWRsaW5lX2V4dHJhcGFyYW0pOwor
CisJZm9yIChwdHIgPSBMbnhQYXJhbS0+Y29tbWFuZF9saW5lOyAqcHRyICE9
ICdcMCc7IHB0cisrKSB7CisJCS8qIERvIG5vdCB0cnkgdG8gYmUgaW50ZWxs
aWdlbnQgYW5kIGRvIGEgMzIgYml0cyBjb21wYXJlLAorCQkgICBpdCB3aWxs
IGdlbmVyYXRlIGNvbnN0YW50IGluIC5yb2RhdGEuc3RyMS4xIG9yIC5yb2Rh
dGEKKwkJICAgd2l0aCBhIHZlcnNpb24gb2YgR0NDIG9yIGFub3RoZXIuICov
CisJCWlmIChwdHJbMF0gPT0gJ2UnICYmIHB0clsxXSA9PSAnZCcgJiYgcHRy
WzJdID09ICdkJworCQkJCSAgJiYgcHRyWzNdID09ICc9JykKKwkJCWJyZWFr
OworCX0KKwkvKiBJIGRvIG5vdCBrbm93IGFib3V0IGVkZD1za2lwbWJyLCBp
ZiB0aGVyZSBpcyBhIHJlYWQgZXJyb3IKKwkJR3VqaW4gd2lsbCBub3QgZXZl
biBib290IHVwIHRvIHRoZXJlLi4uICovCisJaWYgKCpwdHIgPT0gJ1wwJyB8
fCBwdHJbNF0gIT0gJ28nIHx8IHB0cls1XSAhPSAnZicgfHwgcHRyWzZdICE9
ICdmJykgeworCQlMbnhQYXJhbS0+bmJfTUJSU0lHX2VudHJpZXMgPSB2bWxp
bnV6X01CUlNJRyAoTG54UGFyYW0tPk1CUlNJRywKKwkJCXNpemVvZihMbnhQ
YXJhbS0+TUJSU0lHKS9zaXplb2YoTG54UGFyYW0tPk1CUlNJR1swXSkpOwor
CQlMbnhQYXJhbS0+bmJfRUREX2VudHJpZXMgPSB2bWxpbnV6X0VERCAoTG54
UGFyYW0tPmVkZCwKKwkJCXNpemVvZihMbnhQYXJhbS0+ZWRkKS9zaXplb2Yo
TG54UGFyYW0tPmVkZFswXSkpOworCX0KKworCWZvciAocHRyID0gTG54UGFy
YW0tPmNvbW1hbmRfbGluZTsgKnB0ciAhPSAnXDAnOyBwdHIrKykgeworI2Rl
ZmluZSBlbmRwYXJhbShjKSAoKGMpID09ICcgJyB8fCAoYykgPT0gJ1xuJyB8
fCAoYykgPT0gJ1x0JyB8fCAoYykgPT0gJ1wwJykKKwkJaWYgKHB0clswXSA9
PSAncicgJiYgKHB0clsxXSA9PSAndycgfHwgcHRyWzFdID09ICdvJykKKwkJ
CQkgICYmIGVuZHBhcmFtKHB0clsyXSkpIHsKKwkJCUxueFBhcmFtLT5pbl9v
dXQucm9vdF9mbGFncy5yZWFkX29ubHkKKwkJCQkJPSAocHRyWzFdID09ICd3
Jyk/IDAgOiAxOworCQkJYnJlYWs7CisJCX0gZWxzZSB7CisJCQl3aGlsZSAo
IWVuZHBhcmFtKCpwdHIpKQorCQkJCXB0cisrOworCQl9CisJfQorCisJaWYg
KGxvYWRlci0+Y21kbGluZV9uYW1lKQorCQlmb3IgKHB0ciA9ICh1bnNpZ25l
ZCBjaGFyICopbG9hZGVyLT5jbWRsaW5lX25hbWU7CisJCSAgICAgKnB0ciAh
PSAnXDAnOworCQkgICAgIHB0cisrKQorCQkJaWYgKCpwdHIgPT0gJy8nKQor
CQkJCW5iX3NsYXNoX2luX2tlcm5lbG5hbWUrKzsKKworCXRlc3RfdmdhcHJp
bnQoKTsKKworCSpzdHJpbmdwdHIgPSAwOyAvKiBHdWppbiB3aWxsIG5vdCBw
cmludCBhbnl0aGluZyBieSBkZWZhdWx0ICovCisvLwkqc3RyaW5ncHRyID0g
TG54UGFyYW0tPmNvbW1hbmRfbGluZTsKKworCXJldHVybiAwOworfQpkaWZm
IC11cHJOIC1YIGxpbnV4LTIuNi4xNS1tbTEvRG9jdW1lbnRhdGlvbi9kb250
ZGlmZiBsaW51eC0yLjYuMTUtbW0xLTEvYXJjaC9pMzg2L2tlcm5lbC9zZXR1
cC5jIGxpbnV4LTIuNi4xNS1tbTEtMi9hcmNoL2kzODYva2VybmVsL3NldHVw
LmMKLS0tIGxpbnV4LTIuNi4xNS1tbTEtMS9hcmNoL2kzODYva2VybmVsL3Nl
dHVwLmMJMjAwNi0wMS0wNSAyMDozMDoyMS4wMDAwMDAwMDAgKzAwMDAKKysr
IGxpbnV4LTIuNi4xNS1tbTEtMi9hcmNoL2kzODYva2VybmVsL3NldHVwLmMJ
MjAwNi0wMS0wNSAyMDozMTo1OS4wMDAwMDAwMDAgKzAwMDAKQEAgLTcxNCw2
ICs3MTQsMTggQEAgc3RhdGljIHZvaWQgX19pbml0IHBhcnNlX2NtZGxpbmVf
ZWFybHkgKAogCS8qIFNhdmUgdW5wYXJzZWQgY29tbWFuZCBsaW5lIGNvcHkg
Zm9yIC9wcm9jL2NtZGxpbmUgKi8KIAlzYXZlZF9jb21tYW5kX2xpbmVbQ09N
TUFORF9MSU5FX1NJWkUtMV0gPSAnXDAnOwogCisJLyoKKwkgKiBJZiB0aGUg
Y29tbWFuZCBsaW5lIGJlZ2luIHdpdGggJy8nLCBpdCBpcyB0aGUgZmlsZW5h
bWUgb2YgdGhlCisJICoga2VybmVsIGZpbGUgLSBsaWtlIGEgc2hlbGwgY29t
bWFuZCBsaW5lLiBUaGF0IGNhbiBiZSB1c2VkIHRvCisJICogZGVkdWNlIHdo
ZXJlIHJvb3Qgd2FzIGxvY2F0ZWQgd2hlbiB0aGUga2VybmVsIHdhcyBjb21w
aWxlZCwKKwkgKiBpbnNpZGUgYSBkaXJlY3Rvcnkgb2Ygcm9vdCBuYW1lZCAv
Ym9vdCwgaW5zaWRlIGEgc21hbGwgcGFydGl0aW9uCisJICogbW91bnRlZCBv
biBhIGRpcmVjdG9yeSBvZiByb290IG5hbWVkIC9ib290IG9yIGluIHRoZSBy
b290CisJICogZGlyZWN0b3J5IGl0c2VsZi4KKwkgKi8KKwlpZiAoKmZyb20g
PT0gJy8nKQorCQl3aGlsZSAoKmZyb20gIT0gJyAnICYmICpmcm9tICE9ICdc
dCcgJiYgKmZyb20gIT0gJ1xuJyAmJiAqZnJvbSAhPSAnXDAnKQorCQkJZnJv
bSsrOworCiAJZm9yICg7OykgewogCQlpZiAoYyAhPSAnICcpCiAJCQlnb3Rv
IG5leHRfY2hhcjsKZGlmZiAtdXByTiAtWCBsaW51eC0yLjYuMTUtbW0xL0Rv
Y3VtZW50YXRpb24vZG9udGRpZmYgbGludXgtMi42LjE1LW1tMS0xL2FyY2gv
aTM4Ni9rZXJuZWwvdm1saW51eC5sZHMuUyBsaW51eC0yLjYuMTUtbW0xLTIv
YXJjaC9pMzg2L2tlcm5lbC92bWxpbnV4Lmxkcy5TCi0tLSBsaW51eC0yLjYu
MTUtbW0xLTEvYXJjaC9pMzg2L2tlcm5lbC92bWxpbnV4Lmxkcy5TCTIwMDYt
MDEtMDMgMDM6MjE6MTAuMDAwMDAwMDAwICswMDAwCisrKyBsaW51eC0yLjYu
MTUtbW0xLTIvYXJjaC9pMzg2L2tlcm5lbC92bWxpbnV4Lmxkcy5TCTIwMDYt
MDEtMDUgMjA6MzE6NTkuMDAwMDAwMDAwICswMDAwCkBAIC0xMSw5ICsxMSwz
OSBAQAogT1VUUFVUX0ZPUk1BVCgiZWxmMzItaTM4NiIsICJlbGYzMi1pMzg2
IiwgImVsZjMyLWkzODYiKQogT1VUUFVUX0FSQ0goaTM4NikKIEVOVFJZKHBo
eXNfc3RhcnR1cF8zMikKK0VYVEVSTihfX0VSUk9SKSAgIC8qIEZvcmNlIGEg
bGluayBlcnJvciBpZiBmdW5jdGlvbiBfX0VSUk9SKCkgaXMgZXZlciBjYWxs
ZWQgKi8KK05PQ1JPU1NSRUZTKC5yZWFsbW9kZSAudGV4dCkKK05PQ1JPU1NS
RUZTKC5yZWFsbW9kZSAuZGF0YSkKK05PQ1JPU1NSRUZTKC5yZWFsbW9kZSAu
cm9kYXRhKQogamlmZmllcyA9IGppZmZpZXNfNjQ7CiBTRUNUSU9OUwogewor
ICAvKiByZWFsbW9kZSBCSU9TIChpbml0aWFsaXNhdGlvbiBvbmx5KSBib290
IGNvZGUvZGF0YSBhcmVhLgorICAgKiBIZXJlLCBzZWdtZW50IC5jb2RlMTYg
aXMgcmVsb2NhdGFibGUgYnV0IC5kYXRhMTYgaXMgbm90LgorICAgKiBUbyBz
ZWUgdGhlIGFzc2VtYmxlciBvZiBjb21waWxlZCBmaWxlIHJlYWxtb2RlLmM6
CisgICAqICAgb2JqZHVtcCAtRCAtbSBpODA4NiBhcmNoL2kzODYva2VybmVs
L3JlYWxtb2RlLm8KKyAgICogICBvYmpkdW1wIC1kIC0tc2VjdGlvbj0ucmVh
bG1vZGUgLW0gaTgwODYgdm1saW51eAorICAgKi8KKyAgLnJlYWxtb2RlIDAg
OiBBVCAoX2VuZCAtIExPQURfT0ZGU0VUKSB7CisJKiguaW5pdC50ZXh0MTYp
CisJLiA9IEFMSUdOKDE2KTsKKwlfc2RhdGExNiA9IC47CisJKigucm9kYXRh
MTYqIC5kYXRhMTYgLmJzczE2KQorCS4gPSBBTElHTigxNik7CisJX2VkYXRh
MTYgPSAuOyAvKiBtYXhpbXVtIDB4MTAwMCBpLmUuIDQgS2IgbGltaXQgKi8K
KwkqKC50ZXh0MTYpCisJLiA9IEFMSUdOKDE2KTsKKwlfZW5kMTYgPSAuOwor
CS8qIFRoaXMgbWF5IGJlIHVzZWQgb25lIGRheSAtIGtlZXAgYSAxNiBieXRl
cyBibG9jayBhdCBlbmQgb2YgZmlsZTogKi8KKwlMT05HKDApCisJTE9ORyhT
SVpFT0YgKC5yZWFsbW9kZSkpCisJTE9ORyhBRERSICgucmVhbG1vZGUpKQor
CUJZVEUoMHg0MikgLyogJ0InICovCisJQllURSgweDQ5KSAvKiAnSScgKi8K
KwlCWVRFKDB4NEYpIC8qICdPJyAqLworCUJZVEUoMHg1MykgLyogJ1MnICov
CisJfSA9IDB4OTA5MAorCiAgIC4gPSBfX0tFUk5FTF9TVEFSVDsKICAgcGh5
c19zdGFydHVwXzMyID0gc3RhcnR1cF8zMiAtIExPQURfT0ZGU0VUOwogICAv
KiByZWFkLW9ubHkgKi8KZGlmZiAtdXByTiAtWCBsaW51eC0yLjYuMTUtbW0x
L0RvY3VtZW50YXRpb24vZG9udGRpZmYgbGludXgtMi42LjE1LW1tMS0xL2lu
Y2x1ZGUvYXNtLWkzODYvcmVhbG1vZGUuaCBsaW51eC0yLjYuMTUtbW0xLTIv
aW5jbHVkZS9hc20taTM4Ni9yZWFsbW9kZS5oCi0tLSBsaW51eC0yLjYuMTUt
bW0xLTEvaW5jbHVkZS9hc20taTM4Ni9yZWFsbW9kZS5oCTE5NzAtMDEtMDEg
MDE6MDA6MDAuMDAwMDAwMDAwICswMTAwCisrKyBsaW51eC0yLjYuMTUtbW0x
LTIvaW5jbHVkZS9hc20taTM4Ni9yZWFsbW9kZS5oCTIwMDYtMDEtMDUgMjA6
MzE6NTkuMDAwMDAwMDAwICswMDAwCkBAIC0wLDAgKzEsNTIxIEBACisvKgor
ICogIFRoaXMgZmlsZSAicmVhbG1vZGUuaCIgaXMgbGljZW5zZWQgd2l0aCB0
aGUgc2FtZSBsaWNlbnNlIGFzIHRoZSBMaW51eAorICoga2VybmVsLCBhbmQg
YW55d2F5IHRoZSBtYXBwaW5nIG9mIHRoZSBkYXRhIHN0cnVjdHVyZSBwcm9k
dWNlZCBpcyBvd25lZAorICogYnkgTGludXgga2VybmVsIGNvcHlyaWdodCBv
d25lcihzKSAtIGZvciBhIGxvbmcgdGltZS4KKyAqICBNb3JlIGluZm9ybWF0
aW9uIGluIHRoZSAicmVhbG1vZGUuYyIgZmlsZS4KKyAqCisgKiAgRmlyc3Qg
dmVyc2lvbiBoYXMgYmVlbiB3cml0dGVuIGJ5IEV0aWVubmUgTG9ycmFpbiBp
biBEZWNlbWJlciAyMDA0LgorICogVGhpcyBwYXRjaCBjYW5ub3QgcmVhbGx5
IGJlIGFwcGxpZWQgdG8gTGludXgtMi4xMSBhbmQgYmVmb3JlIHdpdGhvdXQK
KyAqIGxvb3NpbmcgdGhlIEVERCBhbmQgRURJRCBpbmZvbWF0aW9uIHdoaWNo
IG1vdmVkIGluIExpbnV4LTIuNi4xMgorICovCisKKy8qIDE2IGJpdHMgc2Vn
bWVudCBpbiBNU0IsIDE2IGJpdHMgb2Zmc2V0IGluIExTQjogKi8KK3R5cGVk
ZWYgdW5zaWduZWQgZmFycHRyOworCisjZGVmaW5lIG9mZnNldG9mKHR5cGUs
IGZpZWxkKQkoKHVuc2lnbmVkKSgmKCgodHlwZSAqKTApLT5maWVsZCkpKQor
CisvKgorICogVGhpcyBzaGFsbCBhbHdheXMgYmUgb3B0aW1pc2VkIGF3YXkg
YmVjYXVzZSB0aGUgdGVzdCBoYXMgdG8gYmUgZmFsc2UsCisgKiBpdCBzaGFs
bCBwcm9kdWNlIGFuIGVycm9yIGluIHRoZSBidWlsZCBwcm9jZXNzLgorICog
Q29ycmVzcG9uZGluZyBsaW5lIHRvIHRoZSBsaW5rZXIgZmlsZSAndm1saW51
eC5sZHMnOiBFWFRFUk4oX19FUlJPUikKKyAqLwordm9pZCBfX0VSUk9SKHZv
aWQpOworCisvKioKKyAqKiBNYXBwaW5nIG9mIHRoZSB0b3RhbCBzdHJ1Y3R1
cmUgZXhjaGFuZ2VkIGluIGJldHdlZW4gdGhlIEJJT1MKKyAqKiBib290IGNv
ZGUgKGluIHJlYWwgbW9kZSkgYW5kIHRoZSBMaW51eCBrZXJuZWwgKGluIHBy
b3RlY3RlZCBtb2RlKToKKyAqKgorICoqIFNvbWUgb2YgdGhvc2Ugc3RydWN0
dXJlcyBoYXZlIHRvIGJlIHB1dCBiYWNrIGluIHRoZWlyIGNvcnJlc3BvbmRp
bmcKKyAqKiBmaWxlIC0gdGhleSBhcmUgaGVyZSB1bnRpbCB0aGUgYmlnIGNs
ZWFuaW5nIHByb2Nlc3MgYmVnaW4uLi4KKyAqKi8KK3N0cnVjdCBzY3JlZW5f
aW5mbyB7CS8qIHN0b2xlbl5XY2tlY2tvdXQgZnJvbSBsaW51eC9pbmNsdWRl
L2xpbnV4L3R0eS5oICovCisJdW5zaWduZWQgY2hhciBvcmlnX3g7CisJdW5z
aWduZWQgY2hhciBvcmlnX3k7CisJdW5zaWduZWQgc2hvcnQgRVhUX01FTV9L
OwkvKiBnZW5lcmFsIGluZm8gKi8KKwl1bnNpZ25lZCBjaGFyIHVuZGVmaW5l
ZDsKKwl1bnNpZ25lZCBjaGFyIG9yaWdfdmlkZW9fcGFnZTsKKwl1bnNpZ25l
ZCBjaGFyIG9yaWdfdmlkZW9fbW9kZTsKKwl1bnNpZ25lZCBjaGFyIG9yaWdf
dmlkZW9fY29sczsKKwl1bnNpZ25lZCBzaG9ydCB1bnVzZWQyOworCXVuc2ln
bmVkIHNob3J0IG9yaWdfdmlkZW9fZWdhX2J4OworCXVuc2lnbmVkIHNob3J0
IHVudXNlZDM7CisJdW5zaWduZWQgY2hhciBvcmlnX3ZpZGVvX2xpbmVzOwor
CXVuc2lnbmVkIGNoYXIgb3JpZ192aWRlb19pc1ZHQTsKKwl1bnNpZ25lZCBz
aG9ydCBvcmlnX2ZvbnRfaGVpZ2h0OworCS8qIFZFU0EgZ3JhcGhpYyBtb2Rl
IC0tIGxpbmVhciBmcmFtZSBidWZmZXIgKi8KKwl1bnNpZ25lZCBzaG9ydCBs
ZmJfd2lkdGg7CisJdW5zaWduZWQgc2hvcnQgbGZiX2hlaWdodDsKKwl1bnNp
Z25lZCBzaG9ydCBsZmJfZGVwdGg7CisJdW5zaWduZWQgbGZiX2Jhc2U7CisJ
dW5zaWduZWQgbGZiX3NpemU7CisJdW5zaWduZWQgc2hvcnQgQ0xfTUFHSUM7
CS8qIDB4QTMzRiwgZ2VuZXJhbCBpbmZvICovCisJdW5zaWduZWQgc2hvcnQg
Q0xfT0ZGU0VUOwkvKiBnZW5lcmFsIGluZm8gKi8KKwl1bnNpZ25lZCBzaG9y
dCBsZmJfbGluZWxlbmd0aDsKKwlzdHJ1Y3QgdmVzYV9jb2xvcl9sYXlvdXRf
c3RyIHsKKwkJc3RydWN0IHsKKwkJCXVuc2lnbmVkIGNoYXIgTWFza1NpemU7
CisJCQl1bnNpZ25lZCBjaGFyIEZpZWxkUG9zaXRpb247CisJCX0gIF9fYXR0
cmlidXRlX18gKChwYWNrZWQpKSBSZWQsIEdyZWVuLCBCbHVlLCBSc3ZkOwor
CX0gX19hdHRyaWJ1dGVfXyAoKHBhY2tlZCkpIGxheW91dDsKKwl1bnNpZ25l
ZCBzaG9ydCB2ZXNhcG1fc2VnOworCXVuc2lnbmVkIHNob3J0IHZlc2FwbV9v
ZmY7CisJdW5zaWduZWQgc2hvcnQgbGZiX3BhZ2VzOworCXN0cnVjdCB2ZXNh
X21vZGVfYXR0cmlidXRlX3N0ciB7CisJCS8qIFZFU0E6ICovCisJCXVuc2ln
bmVkIHNob3J0IG1vZGVfc3VwcG9ydGVkCQk6IDE7CS8qIGUuZy4gZW5vdWdo
dCBSQU0gZm9yIGl0ICovCisJCXVuc2lnbmVkIHNob3J0IG9wdGlvbmFsX2lu
Zm9fYXZhaWxhYmxlCTogMTsKKwkJdW5zaWduZWQgc2hvcnQgQklPU19vdXRw
dXRfc3VwcG9ydGVkCTogMTsKKwkJdW5zaWduZWQgc2hvcnQgY29sb3JfbW9k
ZQkJOiAxOwkvKiBlbHNlIG1vbm9jaHJvbWUgKi8KKwkJdW5zaWduZWQgc2hv
cnQgZ3JhcGhpY19tb2RlCQk6IDE7CS8qIGVsc2UgdGV4dCBtb2RlICovCisJ
CS8qIFZCRSAyLjA6ICovCisJCXVuc2lnbmVkIHNob3J0IG1vZGVfbm90X1ZH
QV9jb21wYXRpYmxlCTogMTsKKwkJdW5zaWduZWQgc2hvcnQgbm9fVkdBX2Nv
bXBhdGlibGVfd2luZG93CTogMTsKKwkJdW5zaWduZWQgc2hvcnQgbGluZWFy
X2ZyYW1lYnVmZmVyX3N1cHBvcnRlZAk6IDE7CisJCXVuc2lnbmVkIHNob3J0
IHJlc2VydmVkCQkJOiA4OworCX0gX19hdHRyaWJ1dGVfXyAoKHBhY2tlZCkp
IHZlc2FfYXR0cmliOworCS8qIDB4MzYgLS0gMHgzZiByZXNlcnZlZCBmb3Ig
ZnV0dXJlIGV4cGFuc2lvbiAqLworCXVuc2lnbmVkIGNoYXIgcmVzZXJ2ZWRb
MTBdOworfSBfX2F0dHJpYnV0ZV9fICgocGFja2VkKSk7CisKK3N0cnVjdCBh
cG1fYmlvc19pbmZvIHsKKwl1bnNpZ25lZCBzaG9ydCB2ZXJzaW9uOworCXVu
c2lnbmVkIHNob3J0IGNzZWc7CisJdW5zaWduZWQgb2Zmc2V0OworCXVuc2ln
bmVkIHNob3J0IGNzZWdfMTY7CisJdW5zaWduZWQgc2hvcnQgZHNlZzsKKwl1
bnNpZ25lZCBzaG9ydCBmbGFnczsKKwl1bnNpZ25lZCBzaG9ydCBjc2VnX2xl
bjsKKwl1bnNpZ25lZCBzaG9ydCB1bnVzZWQ7CS8qIGNzZWdfMTZfbGVuICov
CisJdW5zaWduZWQgc2hvcnQgZHNlZ19sZW47Cit9IF9fYXR0cmlidXRlX18g
KChwYWNrZWQpKTsKKworLyogU2VlIHByb2JlX2Ntb3NfZm9yX2RyaXZlcygp
IGluIGxpbnV4L2RyaXZlcnMvaWRlL2lkZS1nZW9tZXRyeS5jICovCisvKiBy
YXJlbHkgdXNlZCwgYWxzbyBjaGVjayBmb3IgQ01PUyBhZGRyZXNzIDB4MTIg
KGludCAweDQxLCAweDQ2KSAqLwordW5pb24gZHJpdmVfaW5mbyB7CisJc3Ry
dWN0IEZEUFRfc3RyIHsKKwkJdW5zaWduZWQgc2hvcnQgcGh5X2N5bDsKKwkJ
dW5zaWduZWQgY2hhciBwaHlfaGVhZDsKKwkJdW5zaWduZWQgc2hvcnQgc3Rh
cnRfcmVkdWNlZF93cml0ZV9jdXJyZW50X2N5bDsJLyogUEMgWFQgb25seSAq
LworCQl1bnNpZ25lZCBzaG9ydCBzdGFydF93cml0ZV9wcmVjb21wX2N5bDsK
KwkJdW5zaWduZWQgY2hhciBtYXhfRUNDX2J1cnN0X2xlbmd0aDsJCS8qIFBD
IFhUIG9ubHkgKi8KKwkJdW5pb24gZHJpdmVfY3RsX2J5dGVfdSB7CisJCQlz
dHJ1Y3QgeworCQkJCXVuc2lnbmVkIGNoYXIgZHJpdmVfc3RlcF9zcGVlZDoz
OworCQkJCXVuc2lnbmVkIGNoYXIgdW51c2VkOjM7CisJCQkJdW5zaWduZWQg
Y2hhciBkaXNhYmxlX2VjY19yZXRyeToxOworCQkJCXVuc2lnbmVkIGNoYXIg
ZGlzYWJsZV9hY2Nlc3NfcmV0cnk6MTsKKwkJCX0gX19hdHRyaWJ1dGVfXyAo
KHBhY2tlZCkpIHh0OworCQkJc3RydWN0IHsKKwkJCQl1bnNpZ25lZCBjaGFy
IHVudXNlZDoxOworCQkJCXVuc2lnbmVkIGNoYXIgZGlzYWJsZV9pcnE6MTsJ
LyogMCAqLworCQkJCXVuc2lnbmVkIGNoYXIgbm9fcmVzZXQ6MTsJLyogMCAq
LworCQkJCXVuc2lnbmVkIGNoYXIgbW9yZV90aGFuXzhfaGVhZHM6MTsKKwkJ
CQl1bnNpZ25lZCBjaGFyIGFsd2F5c18wOjE7CisJCQkJdW5zaWduZWQgY2hh
ciBtYW51Zl9kZWZlY3RfbWFwX29uX21heGN5bDoxOwkvKiBBVCArICovCisJ
CQkJdW5zaWduZWQgY2hhciBkaXNhYmxlX2VjY19yZXRyeToxOworCQkJCXVu
c2lnbmVkIGNoYXIgZGlzYWJsZV9hY2Nlc3NfcmV0cnk6MTsKKwkJCX0gX19h
dHRyaWJ1dGVfXyAoKHBhY2tlZCkpIGF0OworCQkJdW5zaWduZWQgY2hhciBh
bGw7CisJCX0gZHJpdmVfY3RsX2J5dGU7CisJCXVuc2lnbmVkIGNoYXIgc3Rh
bmRhcmRfdGltZW91dDsJCS8qIFBDIFhUIG9ubHkgKi8KKwkJdW5zaWduZWQg
Y2hhciBmb3JtYXRpbmdfdGltZW91dDsJLyogUEMgWFQgb25seSAqLworCQl1
bnNpZ25lZCBjaGFyIGNoZWNrX2RyaXZlX3RpbWVvdXQ7CS8qIFBDIFhUIG9u
bHkgKi8KKwkJdW5zaWduZWQgc2hvcnQgbGFuZGluZ196b25lX2N5bGluZGVy
OwkvKiBQQyBBVCsgKi8KKwkJdW5zaWduZWQgY2hhciBwaHlfc2VjdDsJCQkv
KiBQQyBBVCsgKi8KKwkJdW5zaWduZWQgY2hhciByZXNlcnZlZDsKKwl9IF9f
YXR0cmlidXRlX18gKChwYWNrZWQpKSBmZHB0OworCS8qIEZvciB0cmFuc2xh
dGluZyBCSU9TZXM6ICovCisJc3RydWN0IEVEUFRfc3RyIHsKKwkJdW5zaWdu
ZWQgc2hvcnQgbG9nX2N5bDsJCQkvKiBtYXggMTAyNCAqLworCQl1bnNpZ25l
ZCBjaGFyIGxvZ19oZWFkOwkJCS8qIG1heCAyNTYgKi8KKwkJdW5zaWduZWQg
Y2hhciBzaWduYXR1cmVfMHhBMDsKKwkJdW5zaWduZWQgY2hhciBwaHlfc2Vj
dDsKKwkJdW5zaWduZWQgc2hvcnQgc3RhcnRfd3JpdGVfcHJlY29tcF9jeWw7
CS8qIG9ic29sZXRlICovCisJCXVuc2lnbmVkIGNoYXIgcmVzZXJ2ZWQ7CisJ
CXVuaW9uIGRyaXZlX2N0bF9ieXRlX3UgZHJpdmVfY3RsX2J5dGU7CisJCXVu
c2lnbmVkIHNob3J0IHBoeV9jeWw7CQkJLyogbWF4IDY1NTM2ICovCisJCXVu
c2lnbmVkIGNoYXIgcGh5X2hlYWQ7CQkJLyogbWF4IDE2ICovCisJCXVuc2ln
bmVkIHNob3J0IGxhbmRpbmdfem9uZV9jeWxpbmRlcjsJLyogb2Jzb2xldGUg
Ki8KKwkJdW5zaWduZWQgY2hhciBsb2dfc2VjdDsJCQkvKiBtYXggNjMgKi8K
KwkJdW5zaWduZWQgY2hhciBjaGVja3N1bTsKKwl9IF9fYXR0cmlidXRlX18g
KChwYWNrZWQpKSBlZHB0OworfSBfX2F0dHJpYnV0ZV9fICgocGFja2VkKSk7
CisKK3N0cnVjdCBzeXNfZGVzY190YWJsZV9pbmZvIHsKKwl1bnNpZ25lZCBz
aG9ydCBsZW5ndGg7CisJdW5zaWduZWQgY2hhciB0YWJsZVsxNF07Cit9IF9f
YXR0cmlidXRlX18gKChwYWNrZWQpKTsKKworc3RydWN0IGluX291dF9pbmZv
IHsKKwl1bnNpZ25lZCBjaGFyIHNldHVwX3NlY3RzOwkJLyogZGVmYXVsdCA0
ICovCisJc3RydWN0IHsKKwkJdW5zaWduZWQgc2hvcnQgcmVhZF9vbmx5OjE7
CisJCXVuc2lnbmVkIHNob3J0IHVudXNlZDoxNTsKKwl9IF9fYXR0cmlidXRl
X18gKChwYWNrZWQpKSByb290X2ZsYWdzOworCXVuc2lnbmVkIHNob3J0IGtl
cm5lbF9jb21wcmVzc2VkX3NpemU7CS8qIDE2IGJ5dGVzIHVuaXQsIHJvdW5k
ZWQgdXAgKi8KKwl1bnNpZ25lZCBzaG9ydCBzd2FwX2RldjsJCS8qIDAgKi8K
KwlzdHJ1Y3QgeworCQl1bnNpZ25lZCBzaG9ydCBzaXplOjExOworCQl1bnNp
Z25lZCBzaG9ydCB1bnVzZWQ6MzsKKwkJdW5zaWduZWQgc2hvcnQgbG9hZDox
OwkJLyogc2VwYXJhdGUgZGlzayAqLworCQl1bnNpZ25lZCBzaG9ydCBwcm9t
cHQ6MTsKKwl9IF9fYXR0cmlidXRlX18gKChwYWNrZWQpKSByYW1kaXNrOwkv
KiBSQU1ESVNLLCBkZWZhdWx0IDAgKi8KKwl1bnNpZ25lZCBzaG9ydCB2aWRf
bW9kZTsJLyogU3RvcmUgbW9kZSBmb3IgdXNlIGluIGFjcGlfd2FrZXVwLlMg
Ki8KKwl1bmlvbiB7CisJCXN0cnVjdCB7CisJCQl1bnNpZ25lZCBjaGFyIG1p
bm9yX3Jvb3Q7CS8qIFJPT1RfREVWICovCisJCQl1bnNpZ25lZCBjaGFyIG1h
am9yX3Jvb3Q7CS8qIFJPT1RfREVWICovCisJCX0gX19hdHRyaWJ1dGVfXyAo
KHBhY2tlZCkpIGZpZWxkczsKKwkJdW5zaWduZWQgc2hvcnQgbWlub3JfbWFq
b3I7CisJfSBfX2F0dHJpYnV0ZV9fICgocGFja2VkKSkgcm9vdDsKKwl1bnNp
Z25lZCBjaGFyIEFVWF9ERVZJQ0VfSU5GTzsJCS8qIGlnbm9yZWQgKi8KKwl1
bnNpZ25lZCBjaGFyIGptcF90cmFtcG9saW5lWzNdOworCXVuaW9uIHsKKwkJ
dW5zaWduZWQgY2hhciBieXRlc1s0XTsJCS8qICJIZHJTIiAqLworCQl1bnNp
Z25lZCBsb25nd29yZDsKKwl9IF9fYXR0cmlidXRlX18gKChwYWNrZWQpKSBo
ZWFkZXJfc2lnbmF0dXJlOworCXVuc2lnbmVkIHNob3J0IGhlYWRlcl92ZXJz
aW9uX251bWJlcjsJLyogMHgwMjAyICovCisJdW5zaWduZWQgc2hvcnQgcmVh
bG1vZGVfc3d0Y2hbMl07CS8qIGhvb2sgdG8gcGx1ZyBpbiBhIEEyMC1vcGVu
IGZ1bmMgKi8KKwl1bnNpZ25lZCBzaG9ydCBzdGFydF9zeXNfc2VnOwkJLyog
U1lTU0VHICovCisJdW5zaWduZWQgc2hvcnQga2VybmVsX3ZlcnNpb247CQkv
KiBjaGFyIHBvaW50ZXIgKi8KKwlzdHJ1Y3QgbG9hZGVyX3QgeworCQllbnVt
IHsgTElMTyA9IDAsIExvYWRsaW4sIGJvb3RzZWN0LAorCQkJU1lTTElOVVgs
IEVUSEVSQk9PVCwgRUxJTE8sIFVOS05PV04sCisJCQlHUlVCLCBVQk9PVCwg
R1VKSU4KKwkJfSB0eXBlOjQ7CisJCXVuc2lnbmVkIGNoYXIgdmVyc2lvbjo0
OworCX0gX19hdHRyaWJ1dGVfXyAoKHBhY2tlZCkpIHR5cGVfb2ZfbG9hZGVy
OworCXN0cnVjdCB7CisJCXVuc2lnbmVkIGNoYXIgTE9BREVEX0hJR0g6MTsK
KwkJdW5zaWduZWQgY2hhciB1bnVzZWQ6NjsKKwkJdW5zaWduZWQgY2hhciBD
QU5fVVNFX0hFQVA6MTsJLyogaGVhcF9lbmRfcHRyIGlzIHNldCAqLworCX0g
X19hdHRyaWJ1dGVfXyAoKHBhY2tlZCkpIGxvYWRmbGFnczsKKwl1bnNpZ25l
ZCBzaG9ydCBzZXR1cF9tb3ZlX3NpemU7CQkvKiAweDgwMDAgKi8KKwl1bnNp
Z25lZCBjb2RlMzJfc3RhcnQ7CisJdW5zaWduZWQgcmFtZGlza19pbWFnZTsK
Kwl1bnNpZ25lZCByYW1kaXNrX3NpemU7CQkJLyogaW4gYnl0ZXMgKi8KKwl1
bnNpZ25lZCBzaG9ydCBib290c2VjdF9rbHVkZ2VbMl07CisJdW5zaWduZWQg
c2hvcnQgaGVhcF9lbmRfcHRyOwkvKiBtb2RlbGlzdCsxMDI0LCB2ZXJzaW9u
ID49IDB4MDIwMSAqLworCXVuc2lnbmVkIHNob3J0IHBhZDE7CisJdW5zaWdu
ZWQgY21kX2xpbmVfcHRyOwkJLyogZGVmYXVsdCAweDkwODAwLCB2ZXJzaW9u
ID49IDB4MDIwMiAqLworfSBfX2F0dHJpYnV0ZV9fICgocGFja2VkKSk7CisK
K3N0cnVjdCBlODIwbWFwX2luZm8geworCWxvbmcgbG9uZyBhZGRyOwkJLyog
c3RhcnQgb2YgbWVtb3J5IHNlZ21lbnQgKi8KKwlsb25nIGxvbmcgc2l6ZTsJ
CS8qIHNpemUgb2YgbWVtb3J5IHNlZ21lbnQgKi8KKwlsb25nIHR5cGU7CQkv
KiB0eXBlIG9mIG1lbW9yeSBzZWdtZW50ICovCit9IF9fYXR0cmlidXRlX18g
KChwYWNrZWQpKTsKKworc3RydWN0IGVkZF9kZXZpY2VfcGFyYW1zIHsKKwl1
bnNpZ25lZCBzaG9ydCBsZW5ndGg7CisJdW5zaWduZWQgc2hvcnQgaW5mb19m
bGFnczsKKwl1bnNpZ25lZCBudW1fZGVmYXVsdF9jeWxpbmRlcnM7CisJdW5z
aWduZWQgbnVtX2RlZmF1bHRfaGVhZHM7CisJdW5zaWduZWQgc2VjdG9yc19w
ZXJfdHJhY2s7CisJdW5zaWduZWQgbG9uZyBsb25nIG51bWJlcl9vZl9zZWN0
b3JzOworCXVuc2lnbmVkIHNob3J0IGJ5dGVzX3Blcl9zZWN0b3I7CisJdW5z
aWduZWQgZHB0ZV9wdHI7CS8qIDB4RkZGRkZGRkYgZm9yIG91ciBwdXJwb3Nl
cyAqLworCXVuc2lnbmVkIHNob3J0IGtleTsJLyogPSAweEJFREQgKi8KKwl1
bnNpZ25lZCBjaGFyIGRldmljZV9wYXRoX2luZm9fbGVuZ3RoOwkvKiA9IDQ0
ICovCisJdW5zaWduZWQgY2hhciByZXNlcnZlZDI7CisJdW5zaWduZWQgc2hv
cnQgcmVzZXJ2ZWQzOworCXVuc2lnbmVkIGNoYXIgaG9zdF9idXNfdHlwZVs0
XTsKKwl1bnNpZ25lZCBjaGFyIGludGVyZmFjZV90eXBlWzhdOworCXVuaW9u
IHsKKwkJc3RydWN0IHsKKwkJCXVuc2lnbmVkIHNob3J0IGJhc2VfYWRkcmVz
czsKKwkJCXVuc2lnbmVkIHNob3J0IHJlc2VydmVkMTsKKwkJCXVuc2lnbmVk
IHJlc2VydmVkMjsKKwkJfSBfX2F0dHJpYnV0ZV9fICgocGFja2VkKSkgaXNh
OworCQlzdHJ1Y3QgeworCQkJdW5zaWduZWQgY2hhciBidXM7CisJCQl1bnNp
Z25lZCBjaGFyIHNsb3Q7CisJCQl1bnNpZ25lZCBjaGFyIGZ1bmN0aW9uOwor
CQkJdW5zaWduZWQgY2hhciBjaGFubmVsOworCQkJdW5zaWduZWQgcmVzZXJ2
ZWQ7CisJCX0gX19hdHRyaWJ1dGVfXyAoKHBhY2tlZCkpIHBjaTsKKwkJLyog
cGNpeCBpcyBzYW1lIGFzIHBjaSAqLworCQlzdHJ1Y3QgeworCQkJdW5zaWdu
ZWQgbG9uZyBsb25nIHJlc2VydmVkOworCQl9IF9fYXR0cmlidXRlX18gKChw
YWNrZWQpKSBpYm5kOworCQlzdHJ1Y3QgeworCQkJdW5zaWduZWQgbG9uZyBs
b25nIHJlc2VydmVkOworCQl9IF9fYXR0cmlidXRlX18gKChwYWNrZWQpKSB4
cHJzOworCQlzdHJ1Y3QgeworCQkJdW5zaWduZWQgbG9uZyBsb25nIHJlc2Vy
dmVkOworCQl9IF9fYXR0cmlidXRlX18gKChwYWNrZWQpKSBodHB0OworCQlz
dHJ1Y3QgeworCQkJdW5zaWduZWQgbG9uZyBsb25nIHJlc2VydmVkOworCQl9
IF9fYXR0cmlidXRlX18gKChwYWNrZWQpKSB1bmtub3duOworCX0gaW50ZXJm
YWNlX3BhdGg7CisJdW5pb24geworCQlzdHJ1Y3QgeworCQkJdW5zaWduZWQg
Y2hhciBkZXZpY2U7CisJCQl1bnNpZ25lZCBjaGFyIHJlc2VydmVkMTsKKwkJ
CXVuc2lnbmVkIHNob3J0IHJlc2VydmVkMjsKKwkJCXVuc2lnbmVkIHJlc2Vy
dmVkMzsKKwkJCXVuc2lnbmVkIGxvbmcgbG9uZyByZXNlcnZlZDQ7CisJCX0g
X19hdHRyaWJ1dGVfXyAoKHBhY2tlZCkpIGF0YTsKKwkJc3RydWN0IHsKKwkJ
CXVuc2lnbmVkIGNoYXIgZGV2aWNlOworCQkJdW5zaWduZWQgY2hhciBsdW47
CisJCQl1bnNpZ25lZCBjaGFyIHJlc2VydmVkMTsKKwkJCXVuc2lnbmVkIGNo
YXIgcmVzZXJ2ZWQyOworCQkJdW5zaWduZWQgcmVzZXJ2ZWQzOworCQkJdW5z
aWduZWQgbG9uZyBsb25nIHJlc2VydmVkNDsKKwkJfSBfX2F0dHJpYnV0ZV9f
ICgocGFja2VkKSkgYXRhcGk7CisJCXN0cnVjdCB7CisJCQl1bnNpZ25lZCBz
aG9ydCBpZDsKKwkJCXVuc2lnbmVkIGxvbmcgbG9uZyBsdW47CisJCQl1bnNp
Z25lZCBzaG9ydCByZXNlcnZlZDE7CisJCQl1bnNpZ25lZCByZXNlcnZlZDI7
CisJCX0gX19hdHRyaWJ1dGVfXyAoKHBhY2tlZCkpIHNjc2k7CisJCXN0cnVj
dCB7CisJCQl1bnNpZ25lZCBsb25nIGxvbmcgc2VyaWFsX251bWJlcjsKKwkJ
CXVuc2lnbmVkIGxvbmcgbG9uZyByZXNlcnZlZDsKKwkJfSBfX2F0dHJpYnV0
ZV9fICgocGFja2VkKSkgdXNiOworCQlzdHJ1Y3QgeworCQkJdW5zaWduZWQg
bG9uZyBsb25nIGV1aTsKKwkJCXVuc2lnbmVkIGxvbmcgbG9uZyByZXNlcnZl
ZDsKKwkJfSBfX2F0dHJpYnV0ZV9fICgocGFja2VkKSkgaTEzOTQ7CisJCXN0
cnVjdCB7CisJCQl1bnNpZ25lZCBsb25nIGxvbmcgd3dpZDsKKwkJCXVuc2ln
bmVkIGxvbmcgbG9uZyBsdW47CisJCX0gX19hdHRyaWJ1dGVfXyAoKHBhY2tl
ZCkpIGZpYnJlOworCQlzdHJ1Y3QgeworCQkJdW5zaWduZWQgbG9uZyBsb25n
IGlkZW50aXR5X3RhZzsKKwkJCXVuc2lnbmVkIGxvbmcgbG9uZyByZXNlcnZl
ZDsKKwkJfSBfX2F0dHJpYnV0ZV9fICgocGFja2VkKSkgaTJvOworCQlzdHJ1
Y3QgeworCQkJdW5zaWduZWQgYXJyYXlfbnVtYmVyOworCQkJdW5zaWduZWQg
cmVzZXJ2ZWQxOworCQkJdW5zaWduZWQgbG9uZyBsb25nIHJlc2VydmVkMjsK
KwkJfSBfX2F0dHJpYnV0ZSgocGFja2VkKSkgcmFpZDsKKwkJc3RydWN0IHsK
KwkJCXVuc2lnbmVkIGNoYXIgZGV2aWNlOworCQkJdW5zaWduZWQgY2hhciBy
ZXNlcnZlZDE7CisJCQl1bnNpZ25lZCBzaG9ydCByZXNlcnZlZDI7CisJCQl1
bnNpZ25lZCByZXNlcnZlZDM7CisJCQl1bnNpZ25lZCBsb25nIGxvbmcgcmVz
ZXJ2ZWQ0OworCQl9IF9fYXR0cmlidXRlX18gKChwYWNrZWQpKSBzYXRhOwor
CQlzdHJ1Y3QgeworCQkJdW5zaWduZWQgbG9uZyBsb25nIHJlc2VydmVkMTsK
KwkJCXVuc2lnbmVkIGxvbmcgbG9uZyByZXNlcnZlZDI7CisJCX0gX19hdHRy
aWJ1dGVfXyAoKHBhY2tlZCkpIHVua25vd247CisJfSBkZXZpY2VfcGF0aDsK
Kwl1bnNpZ25lZCBjaGFyIHJlc2VydmVkNDsKKwl1bnNpZ25lZCBjaGFyIGNo
ZWNrc3VtOworfSBfX2F0dHJpYnV0ZV9fICgocGFja2VkKSk7CisKK3N0cnVj
dCBlZGRfaW5mbyB7CisJdW5zaWduZWQgY2hhciBkZXZpY2U7CisJdW5zaWdu
ZWQgY2hhciB2ZXJzaW9uOworCXVuc2lnbmVkIHNob3J0IGludGVyZmFjZV9z
dXBwb3J0OworCXVuc2lnbmVkIHNob3J0IG1heF9jeWw7CisJdW5zaWduZWQg
Y2hhciBtYXhfaGVhZDsKKwl1bnNpZ25lZCBjaGFyIG1heF9zZWN0OworCXN0
cnVjdCBlZGRfZGV2aWNlX3BhcmFtcyBwYXJhbXM7Cit9IF9fYXR0cmlidXRl
X18gKChwYWNrZWQpKTsKKwordHlwZWRlZiBzdHJ1Y3QgeworCXVuc2lnbmVk
IGNoYXIgcGFkZGluZ1s4XTsKKwlzdHJ1Y3QgeworCQl1bnNpZ25lZCBzaG9y
dCBwYWRkaW5nOjE7CS8qIG1hcHBpbmcgcmlnaHQgPyAqLworCQl1bnNpZ25l
ZCBzaG9ydCBmaXJzdF9sZXR0ZXI6NTsKKwkJdW5zaWduZWQgc2hvcnQgc2Vj
b25kX2xldHRlcjo1OworCQl1bnNpZ25lZCBzaG9ydCB0aGlyZF9sZXR0ZXI6
NTsKKwl9IF9fYXR0cmlidXRlX18gKChwYWNrZWQpKSBtYW51ZmFjdHVyZXJf
aWQ7CisJdW5zaWduZWQgc2hvcnQgbW9uaXRvcl9tb2RlbDsKKwl1bnNpZ25l
ZCBzZXJpYWxfbnVtYmVyOworCXVuc2lnbmVkIGNoYXIgbWFudWZhY3R1cmVf
d2VlazsKKwl1bnNpZ25lZCBjaGFyIG1hbnVmYWN0dXJlX3llYXI7CQkvKiBi
YXNlOiAxOTkwICovCisJdW5zaWduZWQgY2hhciB2ZXJzaW9uOworCXVuc2ln
bmVkIGNoYXIgcmV2aXNpb247CisJdW5zaWduZWQgY2hhciB2aWRlb19pbnB1
dF90eXBlOwkJLyogYml0ZmllbGQgKi8KKwl1bnNpZ25lZCBjaGFyIG1heF9o
b3Jpem9udGFsX3NpemVfY207CisJdW5zaWduZWQgY2hhciBtYXhfdmVydGlj
YWxfc2l6ZV9jbTsKKwl1bnNpZ25lZCBjaGFyIGdhbW1hX2ZhY3RvcjsJLyog
Z2FtbWEgPSAxLjAgKyBnYW1tYV9mYWN0b3IvMTAwICovCisJc3RydWN0IHsK
KwkJdW5zaWduZWQgY2hhciB1bnVzZWQ6MzsKKwkJdW5zaWduZWQgY2hhciBS
Qkdjb2xvcjoxOworCQl1bnNpZ25lZCBjaGFyIHVudXNlZDI6MTsKKwkJdW5z
aWduZWQgY2hhciBhY3RpdmVfb2ZmX3N1cHBvcnRlZDoxOworCQl1bnNpZ25l
ZCBjaGFyIHN1c3BlbmRfc3VwcG9ydGVkOjE7CisJCXVuc2lnbmVkIGNoYXIg
c3RhbmRieV9zdXBwb3J0ZWQ6MTsKKwl9IF9fYXR0cmlidXRlX18gKChwYWNr
ZWQpKSBEUE1TOworCXVuc2lnbmVkIGNoYXIgY2hyb21hX2dyZWVuX2FuZF9y
ZWQ7CisJdW5zaWduZWQgY2hhciBjaHJvbWFfd2hpdGVfYW5kX2JsdWU7CisJ
dW5zaWduZWQgY2hhciBjaHJvbWFfcmVkX1k7CisJdW5zaWduZWQgY2hhciBj
aHJvbWFfcmVkX1g7CisJdW5zaWduZWQgY2hhciBjaHJvbWFfZ3JlZW5fWTsK
Kwl1bnNpZ25lZCBjaGFyIGNocm9tYV9ncmVlbl9YOworCXVuc2lnbmVkIGNo
YXIgY2hyb21hX2JsdWVfWTsKKwl1bnNpZ25lZCBjaGFyIGNocm9tYV9ibHVl
X1g7CisJdW5zaWduZWQgY2hhciBjaHJvbWFfd2hpdGVfWTsKKwl1bnNpZ25l
ZCBjaGFyIGNocm9tYV93aGl0ZV9YOworCXN0cnVjdCB7CisJCXVuc2lnbmVk
IHNob3J0IF83MjBfNDAwXzcwSHo6MTsKKwkJdW5zaWduZWQgc2hvcnQgXzcy
MF80MDBfODhIejoxOworCQl1bnNpZ25lZCBzaG9ydCBfNjQwXzQ4MF82MEh6
OjE7CisJCXVuc2lnbmVkIHNob3J0IF82NDBfNDgwXzY3SHo6MTsKKwkJdW5z
aWduZWQgc2hvcnQgXzY0MF80ODBfNzJIejoxOworCQl1bnNpZ25lZCBzaG9y
dCBfNjQwXzQ4MF83NUh6OjE7CisJCXVuc2lnbmVkIHNob3J0IF84MDBfNjAw
XzU2SHo6MTsKKwkJdW5zaWduZWQgc2hvcnQgXzgwMF82MDBfNjBIejoxOwor
CisJCXVuc2lnbmVkIHNob3J0IF84MDBfNjAwXzcySHo6MTsKKwkJdW5zaWdu
ZWQgc2hvcnQgXzgwMF82MDBfNzVIejoxOworCQl1bnNpZ25lZCBzaG9ydCBf
ODMyXzYyNF83NUh6OjE7CisJCXVuc2lnbmVkIHNob3J0IF8xMDI0Xzc2OF9p
ODdIejoxOworCQl1bnNpZ25lZCBzaG9ydCBfMTAyNF83NjhfNjBIejoxOwor
CQl1bnNpZ25lZCBzaG9ydCBfMTAyNF83NjhfNzBIejoxOworCQl1bnNpZ25l
ZCBzaG9ydCBfMTAyNF83NjhfNzVIejoxOworCQl1bnNpZ25lZCBzaG9ydCBf
MTI4MF8xMDI0Xzc1SHo6MTsKKwl9IF9fYXR0cmlidXRlX18gKChwYWNrZWQp
KSBlc3RhYmxpc2hlZF90aW1taW5nOworCXVuc2lnbmVkIGNoYXIgbWFudWZh
Y3R1cmVyX3RpbW1pbmc7CisJc3RydWN0IHsKKwkJdW5zaWduZWQgc2hvcnQg
cmVzb2x1dGlvbjo4OyAgLyogWCByZXNvbHV0aW9uID0gKGZpZWxkKzMxKSo4
ICovCisJCXVuc2lnbmVkIHNob3J0IHZlcnRpY2FsX3JlZnJlc2hfZnJlcTo2
OwkvKiBhZGQgNjBIeiAqLworCQl1bnNpZ25lZCBzaG9ydCBhc3BlY3RfcmF0
aW86MjsJCS8qIDAxOiAwLjc1ICovCisJfSBfX2F0dHJpYnV0ZV9fICgocGFj
a2VkKSkgc3RhbmRhcmRfdGltbWluZ1s4XTsKKwl1bmlvbiB7CisJCXN0cnVj
dCB7CisJCQl1bnNpZ25lZCBzaG9ydCB3b3JkbWFya2VyXzA7CisJCQl1bnNp
Z25lZCBjaGFyIGJ5dGVtYXJrZXJfMDsKKwkJCWVudW0geyBzZXJpYWxfbnVt
YmVyID0gMHhGRiwKKwkJCQl2ZW5kb3JfbmFtZSA9IDB4RkUsCisJCQkJdmVy
dGljYWxfaG9yaXpvbnRhbF9mcmVxdWVuY3lfcmFuZ2UgPSAweEZELAorCQkJ
CW1vZGVsX25hbWUgPSAweEZDCisvKiBSQiBJbnRlcnJ1cHQgTGlzdCBzYXkg
dGhhdCBidXQgSSByZWFkIHNvbWV0aGluZyBlbHNlLi4uCSovCisvKiAgICAg
ICAgICAgICAgfSBzdHJfdHlwZSA6IDg7CQkJCQkqLworLyogICAgICAgICAg
Y2hhciAgICAgICAgICAgICAgICBzdHJpbmdbMTRdOwkJKi8KKwkJCX0gc3Ry
X3R5cGU6MTY7CisJCQljaGFyIHN0cmluZ1sxM107CisJCX0gX19hdHRyaWJ1
dGVfXyAoKHBhY2tlZCkpIHN0cmluZ3M7CisJCXN0cnVjdCB7CisJCQl1bnNp
Z25lZCBjaGFyIGhvcml6b250YWxfZnJlcV9LaHo7CS8qICE9IDAgKi8KKwkJ
CXVuc2lnbmVkIGNoYXIgdmVydGljYWxfZnJlcV9IejsJCS8qICE9IDAgKi8K
KwkJCXVuc2lnbmVkIGNoYXIgaG9yaXpvbnRhbF9hY3RpdmVfdGltZV9waXg7
IC8qICE9IDAgKi8KKwkJCXVuc2lnbmVkIGNoYXIgaG9yaXpvbnRhbF9ibGFu
a2luZ190aW1lX3BpeDsKKwkJCXVuc2lnbmVkIGNoYXIgaG9yaXpvbnRhbF9h
Y3RpdmUyX3RpbWU7CisJCQl1bnNpZ25lZCBjaGFyIHZlcnRpY2FsX2FjdGl2
ZV90aW1lX2xpbmU7CisJCQl1bnNpZ25lZCBjaGFyIHZlcnRpY2FsX2JsYW5r
aW5nX3RpbWVfbGluZTsKKwkJCXVuc2lnbmVkIGNoYXIgdmVydGljYWxfYWN0
aXZlX3RpbWUyOworCQkJdW5zaWduZWQgY2hhciBob3Jpem9udGFsX3N5bmNf
b2Zmc2V0OworCQkJdW5zaWduZWQgY2hhciBob3Jpem9udGFsX3N5bmNfcHVs
c2V3aWR0aF9waXg7CisJCQl1bnNpZ25lZCBjaGFyIHZlcnRpY2FsX3N5bmNf
cHVsc2V3aWR0aDsKKwkJCXVuc2lnbmVkIGNoYXIgaG9yaXpvbnRhbF92ZXJ0
aWNhbF9zeW5jX29mZnNldDI7CisJCQl1bnNpZ25lZCBjaGFyIGhvcml6b250
YWxfaW1hZ2Vfc2l6ZV9tbTsKKwkJCXVuc2lnbmVkIGNoYXIgdmVydGljYWxf
aW1hZ2Vfc2l6ZV9tbTsKKwkJCXVuc2lnbmVkIGNoYXIgaG9yaXpvbnRhbF9p
bWFnZV9zaXplXzI7CisJCQl1bnNpZ25lZCBjaGFyIGhvcml6b250YWxfYm9y
ZGVyX3BpeDsKKwkJCXVuc2lnbmVkIGNoYXIgdmVydGljYWxfYm9yZGVyX3Bp
eDsKKwkJCXN0cnVjdCB7CisJCQkJdW5zaWduZWQgY2hhciB1bnVzZWQ6MTsK
KwkJCQl1bnNpZ25lZCBjaGFyIGhvcml6b250YWxfc3luY19wb2w6MTsKKwkJ
CQl1bnNpZ25lZCBjaGFyIHZlcnRpY2FsX3N5bmNfcG9sOjE7CisJCQkJdW5z
aWduZWQgY2hhciBzeW5jX3R5cGU6MjsKKwkJCQllbnVtIHsgbm9fc291bmQs
IHN0ZXJlb19yaWdodCwKKwkJCQkJc3RlcmVvX2xlZnQsIHVuZGVmaW5lZAor
CQkJCX0gc291bmQ6MjsKKwkJCQl1bnNpZ25lZCBjaGFyIGludGVybGFjZWQ6
MTsKKwkJCX0gX19hdHRyaWJ1dGVfXyAoKHBhY2tlZCkpIGRpc3BsYXlfdDsK
KwkJfSBfX2F0dHJpYnV0ZV9fICgocGFja2VkKSkgdGltbWluZ3M7CisJfSBf
X2F0dHJpYnV0ZV9fICgocGFja2VkKSkgZGV0YWlsZWRfdGltbWluZ1s0XTsK
Kwl1bnNpZ25lZCBjaGFyIHVudXNlZDsKKwl1bnNpZ25lZCBjaGFyIGNoZWNr
c3VtOworfSBfX2F0dHJpYnV0ZV9fICgocGFja2VkKSkgVkJFX0VESURfdDsK
Kworc3RydWN0IFg4NlNwZWVkU3RlcFNtaV9zIHsKKwl1bnNpZ25lZCBkYXRh
MSwgZGF0YTIsIGRhdGEzLCBkYXRhNDsKK307CisKK3N0cnVjdCBFRklfcyB7
IC8qIHN0aWxsIG5vdCBpbml0aWFsaXNlZCBpbiBHdWppbi0xLjIhICovCisJ
dW5zaWduZWQgc3lzdGVtX3RhYmxlX3BvaW50ZXI7CisJdW5zaWduZWQgbWVt
b3J5X2Rlc2NyaXB0b3Jfc2l6ZTsKKwl1bnNpZ25lZCBtZW1vcnlfZGVzY3Jp
cHRvcl92ZXJzaW9uOworCXVuc2lnbmVkIG1lbW9yeV9kZXNjcmlwdG9yX21h
cF9wb2ludGVyOworCXVuc2lnbmVkIG1lbW9yeV9kZXNjcmlwdG9yX21hcF9z
aXplOworfTsKKworLyoKKyAqIFRoZSBjb21wbGV0ZSB2ZXJzaW9uIC0gYW5k
IGl0cyBvZmZzZXQgdGVzdGVyOgorICovCitzdHJ1Y3QgbGludXhfcGFyYW0g
eworCXN0cnVjdCBzY3JlZW5faW5mbyBzY3JlZW5faW5mbzsKKwlzdHJ1Y3Qg
YXBtX2Jpb3NfaW5mbyBhcG1fYmlvc19pbmZvOworCXVuc2lnbmVkIGNoYXIg
ZnJlZTFbMTJdOworCXN0cnVjdCBYODZTcGVlZFN0ZXBTbWlfcyBYODZTcGVl
ZFN0ZXBTbWk7CisJdW5zaWduZWQgY2hhciBmcmVlMlsxNl07CisJdW5pb24g
ZHJpdmVfaW5mbyBkcml2ZTEsIGRyaXZlMjsKKwlzdHJ1Y3Qgc3lzX2Rlc2Nf
dGFibGVfaW5mbyBzeXNfZGVzY190YWJsZTsKKwl1bnNpZ25lZCBjaGFyIGZy
ZWUzWzE0NF07CisJVkJFX0VESURfdCBlZGlkX2RhdGE7CisJdW5zaWduZWQg
dW51c2VkOworCXN0cnVjdCBFRklfcyBFRkk7CisJdW5zaWduZWQgY2hhciBm
cmVlNFs4XTsKKwl1bnNpZ25lZCBBTFRfTUVNX0s7CisJdW5zaWduZWQgY2hh
ciBmcmVlNVs0XTsKKwl1bnNpZ25lZCBjaGFyIG5iX0U4MjBfZW50cmllczsK
Kwl1bnNpZ25lZCBjaGFyIG5iX0VERF9lbnRyaWVzOworCXVuc2lnbmVkIGNo
YXIgbmJfTUJSU0lHX2VudHJpZXM7CisJdW5zaWduZWQgY2hhciBmcmVlNls2
XTsKKwkvKiA1MTIgYnl0ZXMgYm9vdHNlY3RvciBsaW1pdCAqLworCS8qICJp
bl9vdXQiIGlzIG1vc3RseSBpbml0J2VkIGluIHZtbGludXogZmlsZTogKi8K
KwlzdHJ1Y3QgaW5fb3V0X2luZm8gaW5fb3V0OworCXVuc2lnbmVkIGNoYXIg
ZnJlZTdbMTAwXTsKKwl1bnNpZ25lZCBNQlJTSUdbMTZdOworCXN0cnVjdCBl
ODIwbWFwX2luZm8gZTgyMG1hcFs2NF07CS8qIDIwIGJ5dGVzIGVhY2ggKi8K
Kwl1bnNpZ25lZCBjaGFyIGZyZWU4WzQ4XTsKKwl1bnNpZ25lZCBjaGFyIGNv
bW1hbmRfbGluZVsxMDI0XTsKKwl1bnNpZ25lZCBjaGFyIGZyZWU5WzI1Nl07
CisJc3RydWN0IGVkZF9pbmZvIGVkZFs2XTsKKwl1bnNpZ25lZCBjaGFyIGZy
ZWUxMFsyNzZdOworfSBfX2F0dHJpYnV0ZV9fICgocGFja2VkKSk7CisKK2V4
dGVybiBpbmxpbmUgdm9pZCB0ZXN0X2xpbnV4X3BhcmFtX3N0cnVjdCh2b2lk
KQoreworCWlmIChvZmZzZXRvZihzdHJ1Y3QgbGludXhfcGFyYW0sIHNjcmVl
bl9pbmZvLkVYVF9NRU1fSykgIT0gMHgwMikKKwkJIF9fRVJST1IoKTsKKwlp
ZiAob2Zmc2V0b2Yoc3RydWN0IGxpbnV4X3BhcmFtLCBhcG1fYmlvc19pbmZv
KSAhPSAweDQwKQorCQkgX19FUlJPUigpOworCWlmIChvZmZzZXRvZihzdHJ1
Y3QgbGludXhfcGFyYW0sIFg4NlNwZWVkU3RlcFNtaSkgIT0gOTYpCisJCSBf
X0VSUk9SKCk7CisJaWYgKG9mZnNldG9mKHN0cnVjdCBsaW51eF9wYXJhbSwg
ZHJpdmUxKSAhPSAweDgwKQorCQkgX19FUlJPUigpOworCWlmIChvZmZzZXRv
ZihzdHJ1Y3QgbGludXhfcGFyYW0sIGRyaXZlMikgIT0gMHg4MCArIDE2KQor
CQkgX19FUlJPUigpOworCWlmIChvZmZzZXRvZihzdHJ1Y3QgbGludXhfcGFy
YW0sIHN5c19kZXNjX3RhYmxlKSAhPSAweEEwKQorCQkgX19FUlJPUigpOwor
CWlmIChvZmZzZXRvZihzdHJ1Y3QgbGludXhfcGFyYW0sIGVkaWRfZGF0YSkg
IT0gMHgxNDApCisJCV9fRVJST1IoKTsKKwlpZiAob2Zmc2V0b2Yoc3RydWN0
IGxpbnV4X3BhcmFtLCBBTFRfTUVNX0spICE9IDB4MUUwKQorCQkgX19FUlJP
UigpOworCWlmIChvZmZzZXRvZihzdHJ1Y3QgbGludXhfcGFyYW0sIG5iX0U4
MjBfZW50cmllcykgIT0gMHgxRTgpCisJCSBfX0VSUk9SKCk7CisJaWYgKG9m
ZnNldG9mKHN0cnVjdCBsaW51eF9wYXJhbSwgbmJfRUREX2VudHJpZXMpICE9
IDB4MUU5KQorCQkgX19FUlJPUigpOworCWlmIChvZmZzZXRvZihzdHJ1Y3Qg
bGludXhfcGFyYW0sIGluX291dC5zZXR1cF9zZWN0cykgIT0gMHgxRjEpCisJ
CSBfX0VSUk9SKCk7CisJaWYgKG9mZnNldG9mKHN0cnVjdCBsaW51eF9wYXJh
bSwgaW5fb3V0LnJvb3RfZmxhZ3MpICE9IDB4MUYyKQorCQkgX19FUlJPUigp
OworCWlmIChvZmZzZXRvZihzdHJ1Y3QgbGludXhfcGFyYW0sIGluX291dC5r
ZXJuZWxfY29tcHJlc3NlZF9zaXplKSAhPSAweDFGNCkKKwkJIF9fRVJST1Io
KTsKKwlpZiAob2Zmc2V0b2Yoc3RydWN0IGxpbnV4X3BhcmFtLCBpbl9vdXQu
c3dhcF9kZXYpICE9IDB4MUY2KQorCQkgX19FUlJPUigpOworCWlmIChvZmZz
ZXRvZihzdHJ1Y3QgbGludXhfcGFyYW0sIGluX291dC5oZWFkZXJfdmVyc2lv
bl9udW1iZXIpICE9IDB4MjA2KQorCQkgX19FUlJPUigpOworCWlmIChvZmZz
ZXRvZihzdHJ1Y3QgbGludXhfcGFyYW0sIGluX291dC5jb2RlMzJfc3RhcnQp
ICE9IDB4MjE0KQorCQkgX19FUlJPUigpOworCWlmIChvZmZzZXRvZihzdHJ1
Y3QgbGludXhfcGFyYW0sIGluX291dC5oZWFwX2VuZF9wdHIpICE9IDB4MjI0
KQorCQkgX19FUlJPUigpOworCWlmIChvZmZzZXRvZihzdHJ1Y3QgbGludXhf
cGFyYW0sIE1CUlNJRykgIT0gMHgyOTApCisJCSBfX0VSUk9SKCk7CisJaWYg
KG9mZnNldG9mKHN0cnVjdCBsaW51eF9wYXJhbSwgZTgyMG1hcCkgIT0gMHgy
RDApCisJCSBfX0VSUk9SKCk7CisJaWYgKG9mZnNldG9mKHN0cnVjdCBsaW51
eF9wYXJhbSwgY29tbWFuZF9saW5lKSAhPSAweDgwMCkKKwkJIF9fRVJST1Io
KTsKKwlpZiAob2Zmc2V0b2Yoc3RydWN0IGxpbnV4X3BhcmFtLCBlZGQpICE9
IDB4ZDAwKQorCQkgX19FUlJPUigpOworfQorCmRpZmYgLXVwck4gLVggbGlu
dXgtMi42LjE1LW1tMS9Eb2N1bWVudGF0aW9uL2RvbnRkaWZmIGxpbnV4LTIu
Ni4xNS1tbTEtMS9NYWtlZmlsZSBsaW51eC0yLjYuMTUtbW0xLTIvTWFrZWZp
bGUKLS0tIGxpbnV4LTIuNi4xNS1tbTEtMS9NYWtlZmlsZQkyMDA2LTAxLTA1
IDIwOjMxOjMwLjAwMDAwMDAwMCArMDAwMAorKysgbGludXgtMi42LjE1LW1t
MS0yL01ha2VmaWxlCTIwMDYtMDEtMDUgMjA6MzE6NTkuMDAwMDAwMDAwICsw
MDAwCkBAIC0zMjUsNiArMzI1LDcgQEAgU1RSSVAJCT0gJChDUk9TU19DT01Q
SUxFKXN0cmlwCiBPQkpDT1BZCQk9ICQoQ1JPU1NfQ09NUElMRSlvYmpjb3B5
CiBPQkpEVU1QCQk9ICQoQ1JPU1NfQ09NUElMRSlvYmpkdW1wCiBBV0sJCT0g
YXdrCitHWklQCQk9IGd6aXAKIEdFTktTWU1TCT0gc2NyaXB0cy9nZW5rc3lt
cy9nZW5rc3ltcwogREVQTU9ECQk9IC9zYmluL2RlcG1vZAogS0FMTFNZTVMJ
PSBzY3JpcHRzL2thbGxzeW1zCkBAIC0zMzgsNyArMzM5LDIzIEBAIEFGTEFH
U19NT0RVTEUgICA9ICQoTU9ERkxBR1MpCiBMREZMQUdTX01PRFVMRSAgPSAt
cgogQ0ZMQUdTX0tFUk5FTAk9CiBBRkxBR1NfS0VSTkVMCT0KLQorT0JKQ09Q
WUZMQUdTICAgOj0gLU8gYmluYXJ5IC1SIC5ub3RlIC1SIC5jb21tZW50IC1T
CitHWklQRkxBR1MJPQorCisjIFBhbWFyZXRlcnMgdG8gYWRkIHRvIHRoZSBH
WklQIGNvbW1lbnQgb2YgdGhlICUua2d6IHRhcmdldDoKK0xJTlVYX1BBUkFN
ID0gcm8KK2lmZGVmIFJPT1QKKyMgUk9PVCBpcyBwcmVzZW50IG9uIGNvbW1h
bmQgbGluZSBvciBpbiBlbnZpcm9ubWVudCAodW51c3VhbCBjYXNlKSwKKyMg
ZG8gbm90IGF1dG9kZXRlY3QgaXQgYXQgYm9vdCB0aW1lOgoraWZlcSAoJChS
T09UKSxhdXRvKQorIyBDb21tYW5kIGxpbmUgaXMgbGlrZSAibWFrZSAvYm9v
dC9saW51eC0yLjYuMTAua2d6IFJPT1Q9YXV0byIsCisjIGdldCB2YWx1ZSBm
cm9tIC9wcm9jL2NtZGxpbmUgKHdoaWNoIGNhbiBiZSBtb3JlIHRoYW4gb25l
IGxpbmUpOgorTElOVVhfUk9PVCA9IGBzZWQgJy9yb290PS9zLy4qXChyb290
PVtfLy5hLXowLTlBLVpdKlwpLiovXDEvJyAvcHJvYy9jbWRsaW5lYAorZWxz
ZQorIyBDb21tYW5kIGxpbmUgaXMgbGlrZSAibWFrZSAvYm9vdC9saW51eC0y
LjYuMTAua2d6IFJPT1Q9L2Rldi9zZGE2IgorTElOVVhfUk9PVCA9ICJyb290
PSQoUk9PVCkiCitlbmRpZgorZW5kaWYKIAogIyBVc2UgTElOVVhJTkNMVURF
IHdoZW4geW91IG11c3QgcmVmZXJlbmNlIHRoZSBpbmNsdWRlLyBkaXJlY3Rv
cnkuCiAjIE5lZWRlZCB0byBiZSBjb21wYXRpYmxlIHdpdGggdGhlIE89IG9w
dGlvbgpAQCAtNzY0LDExICs3ODEsNTQgQEAgZGVidWdfa2FsbHN5bXM6IC50
bXBfbWFwJChsYXN0X2thbGxzeW1zKQogCiBlbmRpZiAjIGlmZGVmIENPTkZJ
R19LQUxMU1lNUwogCi0jIHZtbGludXggaW1hZ2UgLSBpbmNsdWRpbmcgdXBk
YXRlZCBrZXJuZWwgc3ltYm9scworIyB2bWxpbnV4IEVMRiBpbWFnZSAtIGlu
Y2x1ZGluZyB1cGRhdGVkIGtlcm5lbCBzeW1ib2xzCiB2bWxpbnV4OiAkKHZt
bGludXgtbGRzKSAkKHZtbGludXgtaW5pdCkgJCh2bWxpbnV4LW1haW4pICQo
a2FsbHN5bXMubykgRk9SQ0UKIAkkKGNhbGwgaWZfY2hhbmdlZF9ydWxlLHZt
bGludXhfXykKIAkkKFEpcm0gLWYgLm9sZF92ZXJzaW9uCiAKKyMgdm1saW51
eCBiaW5hcnkgaW1hZ2UKK3F1aWV0X2NtZF9vYmpjb3B5ID0gT0JKQ09QWSAk
QAorICAgICAgY21kX29iamNvcHkgPSAkKE9CSkNPUFkpICQoT0JKQ09QWUZM
QUdTKSAkPCAkQAordm1saW51eC5iaW46IHZtbGludXggRk9SQ0UKKwkkKGNh
bGwgaWZfY2hhbmdlZCxvYmpjb3B5KQorCisjIGNvbXByZXNzZWQgdm1saW51
eCBiaW5hcnkgaW1hZ2UKK3F1aWV0X2NtZF9nemlwID0gR1pJUCAgICAkQAor
ICAgICAgY21kX2d6aXAgPSAkKEdaSVApICQoR1pJUEZMQUdTKSAkPCAtYyA+
ICRACit2bWxpbnV4LmJpbi5nejogdm1saW51eC5iaW4gRk9SQ0UKKwkkKGNh
bGwgaWZfY2hhbmdlZCxnemlwKQorCisjIElmIHlvdSBoYXZlIGEgbW9kaWZp
ZWQgR1BMIGtlcm5lbCBidXQgYXJlIG5vdCByZWRpc3RyaWJ1dGluZworIyBh
bnl0aGluZywgdXNlIHRoZSB0d28gbGluZXMgYXMgZ3pjb3B5IHBhcmFtZXRl
cjoKKyMgICAgIC1jICJUaGlzIHNvZnR3YXJlIGlzIG5vdCB1c2VkIG91dHNp
ZGUgdGhlIGNvcHlyaWdodCBvd25lciBjb21wYW55LiIgXAorIyAgICAgLWFs
ICJDb3B5cmlnaHQgb3duZXI6ICIgIjxvZmZpY2lhbCBuYW1lIG9mIG93bmVy
IG9mIHRoZSBwYXRjaD4iCisjIEd1amluIGFsc28gYWNjZXB0IG9uZSBvciBt
b3JlICJDb3B5cmlnaHQgb3duZXI6ICIgbGluZSBmb3IgR1BMIGZpbGVzLAor
IyB0YWtlIGNhcmUgb2YgdGhlIHNwYWNlIGFmdGVyIHRoZSBzZW1pY29sb24u
CisjICAgIEZvciBpbnN0YW5jZTogLWFsPSJDb3B5cmlnaHQgb3duZXI6IExp
bnVzIFRvcnZhbGRzIiBcCisjICBLZWVwIHRoZSBsaWNlbnNlIGZpcnN0LCB0
aGVuIENvcHlyaWdodC9zb3VyY2UgbG9jYXRpb24gbGluZShzKSwKKyMgdGhl
IGZvbGxvd2luZyBsaW5lIGlzIGNvcGllZCB0byB0aGUgTGludXggcGFyYW1l
dGVyIGxpbmUgYnkgdGhlIChwcm92aWRlZCkKKyMgbGludXhfc2V0X3BhcmFt
cyBmdW5jdGlvbiwgc28gdGhlIChwcm92aWRlZCkgZnVuY3Rpb24gbWF5IG9y
IG1heSBub3QgYWxzbworIyBpbmNsdWRlIGxhc3QgbGluZSAoaS5lLiBHdWpp
biBwYXJhbWV0ZXJzKSBhcyBrZXJuZWwgcGFyYW1ldGVycy4KKyMgIE5vdGUg
dGhhdCB0aGUgY29tbWFuZCBsaW5lIGdpdmVuIHRvIExJTlVYIHNoYWxsIG5v
dCBiZSBlbXB0eSwKKyMga2VlcCBhdCBsZWFzdCBvbmUgc3BhY2UgaW4gdGhl
ICItYWw9IiBvZiAkKExJTlVYX1JPT1QpLgorIyBVU0FHRSBnemNvcHkgIi1h
cz0iIGNoZWNrL2FkZCBhIHNwYWNlLCAiLWFsPSIgY2hlY2svYWRkIGEgbmV3
bGluZQorIyBpbiBiZXR3ZWVuIHRoZSBjdXJyZW50IGFuZCB0aGUgYXBwZW5k
ZWQgY29tbWVudC4KK3F1aWV0X2NtZF9wYXJhbXMgPSBQQVJBTVMgICRACisg
ICAgICBjbWRfcGFyYW1zID0gIHNjcmlwdHMvZ3pjb3B5IC1mICQ8ICRAIC1u
PSRAIFwKKyAgICAtYz0iVGhpcyBzb2Z0d2FyZSBpcyBkaXN0cmlidXRlZCB1
bmRlciB0aGUgR1BMIGxpY2Vuc2UuIiBcCisgICAgLWFsPSJJdHMgc291cmNl
IGNvZGUgaXMgYXQ6IGh0dHA6Ly93d3cua2VybmVsLm9yZyIgXAorICAgIC1h
bD0iJChMSU5VWF9ST09UKSAiIC1hcz0iJChMSU5VWF9QQVJBTSkiIFwKKyAg
ICAtYWw9ImBzY3JpcHRzL2d6cGFyYW1gIiBcCisgICAgLWFzPSJyZWFsZmN0
X3NpemU9YHNpemUgLUF4IHZtbGludXggfCAkKEFXSykgJy8ucmVhbG1vZGUv
e3ByaW50ZiBcJCQyfSdgIiBcCisgICAgICAmJiBlY2hvICIiIFwKKyAgICAg
ICYmIGVjaG8gIiAgYHNjcmlwdHMvZ3pjb3B5IC1uMCAkQGAgaGFzIGJlZW4g
cmVidWlsdCB3aXRoIHBhcmFtZXRlcnM6IiBcCisgICAgICAmJiBlY2hvICJg
c2NyaXB0cy9nemNvcHkgLWMwICRAYCIKKworIyBHdWppbiBuYXRpdmUgYm9v
dGFibGUgZmlsZToganVzdCB0eXBlICJtYWtlIC9ib290L2xpbnV4LTIuNi4x
My5rZ3oiCisjIHRvIGdldCBldmVyeXRoaW5nIChidXQgbW9kdWxlcyAmIGlu
aXRyZCAmIGluaXRyYW1mcykgZG9uZS4KKyUua2d6IDogdm1saW51eC5iaW4u
Z3ogc2NyaXB0cy9nenBhcmFtIHNjcmlwdHMvZ3pjb3B5IEZPUkNFCisJJChj
YWxsIGNtZCxwYXJhbXMpCisKICMgVXRpbGl0eSB0byBkaXNwbGF5IHRoZSBr
ZXJuZWwgY29tcGlsZSB0aW1lIHBhcmFtZXRlcnMKIHF1aWV0X2NtZF9nenBh
cmFtID0gSE9TVENDICAkQAogICAgICAgY21kX2d6cGFyYW0gPSAkKEhPU1RD
QykgJChIT1NUQ0ZMQUdTKSAtV2wsIi11IF9fRVJST1IiIC1vICRAICQ8CkBA
IC05OTQsNyArMTA1NCw3IEBAIGVuZGlmICMgQ09ORklHX01PRFVMRVMKICMg
RGlyZWN0b3JpZXMgJiBmaWxlcyByZW1vdmVkIHdpdGggJ21ha2UgY2xlYW4n
CiBDTEVBTl9ESVJTICArPSAkKE1PRFZFUkRJUikKIENMRUFOX0ZJTEVTICs9
CXZtbGludXggU3lzdGVtLm1hcCBcCi0gICAgICAgICAgICAgICAgc2NyaXB0
cy9nenBhcmFtIHNjcmlwdHMvZ3pjb3B5IFwKKyAgICAgICAgICAgICAgICB2
bWxpbnV4LmJpbiB2bWxpbnV4LmJpbi5neiBzY3JpcHRzL2d6cGFyYW0gc2Ny
aXB0cy9nemNvcHkgXAogICAgICAgICAgICAgICAgIC50bXBfa2FsbHN5bXMq
IC50bXBfdmVyc2lvbiAudG1wX3ZtbGludXgqIC50bXBfU3lzdGVtLm1hcAog
CiAjIERpcmVjdG9yaWVzICYgZmlsZXMgcmVtb3ZlZCB3aXRoICdtYWtlIG1y
cHJvcGVyJwpAQCAtMTA3OCw2ICsxMTM4LDggQEAgaGVscDoKIAlAZWNobyAg
J090aGVyIGdlbmVyaWMgdGFyZ2V0czonCiAJQGVjaG8gICcgIGFsbAkJICAt
IEJ1aWxkIGFsbCB0YXJnZXRzIG1hcmtlZCB3aXRoIFsqXScKIAlAZWNobyAg
Jyogdm1saW51eAkgIC0gQnVpbGQgdGhlIGJhcmUga2VybmVsJworCUBlY2hv
ICAnICAvYm9vdC9saW51eC5rZ3ogUk9PVD0vZGV2L2hkYTEgICAtIHJlcGxh
Y2UgImhkYTEiIHdpdGggeW91ciByb290IGZpbGVzeXN0ZW0nCisJQGVjaG8g
ICcgIC9ib290L2xpbnV4LmtneiBST09UPWF1dG8gICAgICAgIC0gcm9vdCBm
aWxlc3lzdGVtIGZyb20gY3VycmVudCAvcHJvYy9jbWRsaW5lJwogCUBlY2hv
ICAnKiBtb2R1bGVzCSAgLSBCdWlsZCBhbGwgbW9kdWxlcycKIAlAZWNobyAg
JyAgbW9kdWxlc19pbnN0YWxsIC0gSW5zdGFsbCBhbGwgbW9kdWxlcyB0byBJ
TlNUQUxMX01PRF9QQVRIIChkZWZhdWx0OiAvKScKIAlAZWNobyAgJyAgZGly
LyAgICAgICAgICAgIC0gQnVpbGQgYWxsIGZpbGVzIGluIGRpciBhbmQgYmVs
b3cnCg==

--0-657460192-1136502430=:32400--
