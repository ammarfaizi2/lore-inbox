Return-Path: <linux-kernel-owner+willy=40w.ods.org-S262185AbVD1RdO@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S262185AbVD1RdO (ORCPT <rfc822;willy@w.ods.org>);
	Thu, 28 Apr 2005 13:33:14 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S262186AbVD1RdO
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Thu, 28 Apr 2005 13:33:14 -0400
Received: from fire.osdl.org ([65.172.181.4]:42677 "EHLO smtp.osdl.org")
	by vger.kernel.org with ESMTP id S262185AbVD1Rcy (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Thu, 28 Apr 2005 13:32:54 -0400
Date: Thu, 28 Apr 2005 10:32:45 -0700
From: "Randy.Dunlap" <rddunlap@osdl.org>
To: "Rafael J. Wysocki" <rjw@sisk.pl>
Cc: akpm@osdl.org, ak@suse.de, linux-kernel@vger.kernel.org
Subject: Re: [BUG] 2.6.12-rc3: unkillable java process in TASK_RUNNING on
 AMD64
Message-Id: <20050428103245.21023e00.rddunlap@osdl.org>
In-Reply-To: <200504271412.51565.rjw@sisk.pl>
References: <200504271152.15423.rjw@sisk.pl>
	<200504271305.10882.rjw@sisk.pl>
	<20050427045546.7c769a4f.akpm@osdl.org>
	<200504271412.51565.rjw@sisk.pl>
Organization: OSDL
X-Mailer: Sylpheed version 1.0.0 (GTK+ 1.2.10; x86_64-unknown-linux-gnu)
Mime-Version: 1.0
Content-Type: multipart/mixed;
 boundary="Multipart=_Thu__28_Apr_2005_10_32_45_-0700_TfP_+ZQ65jznrvG9"
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org

This is a multi-part message in MIME format.

--Multipart=_Thu__28_Apr_2005_10_32_45_-0700_TfP_+ZQ65jznrvG9
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

On Wed, 27 Apr 2005 14:12:51 +0200
"Rafael J. Wysocki" <rjw@sisk.pl> wrote:

> 
> > It'd be interesting to know the interrupt rate and context switch rate
> > which this is going on.
> 
> OK, but could you please tell me how to get these numbers?


Use something like the attached perl script... (a little overkill
for this).

---
~Randy

--Multipart=_Thu__28_Apr_2005_10_32_45_-0700_TfP_+ZQ65jznrvG9
Content-Type: application/octet-stream;
 name="sysalive.pl"
Content-Disposition: attachment;
 filename="sysalive.pl"
Content-Transfer-Encoding: base64

IyEgL3Vzci9iaW4vcGVybCAtdwojIHN5c2FsaXZlLnBsIDIwMDUuMDMuMTIKIyBSYW5keSBEdW5s
YXAgPHJkZHVubGFwQG9zZGwub3JnPgojCiMgQ2hhbmdlbG9nOgojIEFkZCBwYWdlX2lvL3NlY29u
ZCwgc3dhcF9pby9zZWNvbmQsIGludHMvc2Vjb25kLAojIGFuZCBjb250ZXh0X3N3aXRjaGVzL3Nl
Y29uZDsKIyBBbHNvIG1ha2UgJGludGVydmFsIGFuZCAkbG9vcGNvdW50IGJlIGludCh2YWx1ZSk7
CiMgT21pdCBwYWdlIGFuZCBzd2FwIGRhdGEgaW4gMi42Lng7CiMgQWRkIHNvbWUgL3Byb2Mvdm1z
dGF0IHBpZWNlczsKIwojIFByaW50cyBzb21lIHNlbGVjdGVkIHN5c3RlbSBzdGF0cyBmb3IgYSBx
dWljayBpbmRpY2F0aW9uIG9mCiMgICBzeXN0ZW0gbGl2ZWxpbmVzczsKIyBCZSBzbWFsbCBhbmQg
dGFrZSBsZXNzIENQVSB0aW1lICh1bmxpa2UgdG9wIG9yIHZtc3RhdCk7CiMgSGFuZyBhcm91bmQg
c28gdGhhdCBhbm90aGVyIGZvcmsoKSBpcyBub3QgcmVxdWlyZWQ7CiMKIyBwb3NzaWJpbGl0aWVz
OgojIC0gY21kbGluZSArIHZlcnNpb24gKDEgdGltZSBvbmx5KSAvLwojIC0gdGltZTsJCQkvLwoj
IC0gY3B1aW5mbyBzdW1tYXJ5OgkJVEJECiMgLSBpbnRlcnJ1cHRzIHN1bW1hcnk6CQlUQkQKIyAt
IGxvYWRhdmcgcGllY2VzOgkJLy8KIyAJbG9hZFtsYXN0IDEgbWluXSwgbG9hZFtsYXN0IDUgbWlu
XSwgbG9hZFtsYXN0IDE1IG1pbl0sCiMgCW5yX3Byb2NzX2luX3JlYWR5cSwgbnJfcHJvY3NfdG90
YWwsIGxhc3RfcGlkX3VzZWQKIyAtIG1lbWluZm8gc3VtbWFyeToJCVRCRAojIC0gc3RhdCBwaWVj
ZXM6CQkvLwojIAlwYWdlOiBpbiwgb3V0IHwgc3dhcDogaW4sIG91dCB8IGludHI6IHRvdGFsX2lu
dHMgKGlnbm9yZSByZXN0KQojIAljdHh0OiBjbnR4dF9zdyB8IHByb2Nlc3NlczogdG90YWxfZm9y
a3MKIyAtIHZtc3RhdCBwaWVjZXM6CQlUQkQKCm15ICRwcmV2cGFnZWlvID0gMDsKbXkgJHByZXZz
d2FwaW8gPSAwOwpteSAkcHJldmludHMgPSAwOwpteSAkcHJldmN0eHN3ID0gMDsKCnN1YiB1c2Fn
ZQp7CglwcmludCAidXNhZ2U6ICBzeXNhbGl2ZS5wbCBbZGVsYXlfaW5fc2Vjb25kcyBbbG9vcF9j
b3VudF1dXG4iOwoJcHJpbnQgIiAgZGVmYXVsdHM6IGRlbGF5ID0gMSBhbmQgY291bnQgPSBmb3Jl
dmVyXG4iOwp9ICMgZW5kIHVzYWdlCgpzdWIgZG9fbG9hZGF2Zwp7CglzZWVrIChMT0FEQVZHLCAw
LCAwKSBvciBkaWUgJCE7CglteSAkbG9hZGF2ZzsKCXJlYWQgKExPQURBVkcsICRsb2FkYXZnLCAy
NTUpOwoJcHJpbnQgImxvYWRbMSwgNSwgMTVdLCByZHlxL3R0bF9wcm9jcywgbGFzdF9waWQ6ICAk
bG9hZGF2ZyI7CSMgJGxvYWRhdmcgdy8gXG4KfSAjIGVuZCBkb19sb2FkYXZnCgpzdWIgZG9fc3Rh
dAp7CglteSAkc2tpcF9wYWdlX3N3YXAgPSAwOwoKCXNlZWsgKFNUQVQsIDAsIDApOwkjIHRvIEJP
RgoJd2hpbGUgKCRzdGF0ID0gPFNUQVQ+KQkJIyBTVEFUIGhhcyBtdWx0aXBsZSBsaW5lcwoJewoJ
CWNob21wICRzdGF0OwoJCSMjI3ByaW50ICJyYXcgc3RhdDogWyRzdGF0XVxuIjsKCQkjIHNwbGl0
IGludG8gd29yZHMKCQlAd29yZHMgPSBzcGxpdCAvICsvLCAkc3RhdDsKCQkjIyNwcmludCAicmF3
IHdvcmRzOiBbQHdvcmRzXVxuIjsKCQkkdGFnID0gJHdvcmRzWzBdOwoJCWlmICgkdGFnIGVxICJp
bnRyIikKCQl7CgkJCSRkYXRhID0gJHdvcmRzWzFdOwkjIHVzZSBvbmx5IGZpcnN0ICJpbnRyIiB2
YWx1ZQoJCX0KCQllbHNlCgkJewoJCQkkZGF0YSA9IGpvaW4gKCQiLCBAd29yZHNbMS4uJCN3b3Jk
c10pOwoJCX0KCQkjIyNwcmludCAicmF3IHRhZyBbJHRhZ10sIGRhdGEgWyRkYXRhXVxuIjsKCQkk
c3RhdHN7JHRhZ30gPSAkZGF0YTsKCQlpZiAoJHRhZyBlcSAicGFnZSIpCgkJewoJCQkkdGhpc3Bh
Z2VpbyA9ICR3b3Jkc1sxXSArICR3b3Jkc1syXTsKCQl9CgkJaWYgKCR0YWcgZXEgInN3YXAiKQoJ
CXsKCQkJJHRoaXNzd2FwaW8gPSAkd29yZHNbMV0gKyAkd29yZHNbMl07CgkJfQoJfQoJaWYgKGRl
ZmluZWQoJHN0YXRzeydwYWdlJ30pKQoJewoJCXByaW50ICJwYWdlIEkvTzogJHN0YXRzeydwYWdl
J30gfCBzd2FwIEkvTzogJHN0YXRzeydzd2FwJ30gfCBpbnRyX3N1bTogJHN0YXRzeydpbnRyJ31c
biI7CgkJcHJpbnQgImN0eHRfc3c6ICRzdGF0c3snY3R4dCd9IHwgZm9ya3M6ICRzdGF0c3sncHJv
Y2Vzc2VzJ31cbiI7Cgl9CgllbHNlIHsKCQlwcmludCAiaW50cl9zdW06ICRzdGF0c3snaW50cid9
IHwgY3R4dF9zdzogJHN0YXRzeydjdHh0J30gfCBmb3JrczogJHN0YXRzeydwcm9jZXNzZXMnfVxu
IjsKCQkkc2tpcF9wYWdlX3N3YXAgPSAxOwoJfQoKCWlmIChkZWZpbmVkKCRzdGF0c3snYm91bmNl
X2lvJ30pKQoJewoJCWlmIChkZWZpbmVkKCRzdGF0c3snYm91bmNlX3J3J30pKQoJCXsKCQkJcHJp
bnQgImJvdW5jZSBJL086ICRzdGF0c3snYm91bmNlX2lvJ30gfCBib3VuY2UgUi9XOiAkc3RhdHN7
J2JvdW5jZV9ydyd9IHwgYm91bmNlLXN3YXAgSS9POiAkc3RhdHN7J2JvdW5jZV9zd2FwX2lvJ31c
biI7CgkJfQoJCWVsc2UKCQl7CgkJCXByaW50ICJib3VuY2UgSS9POiAkc3RhdHN7J2JvdW5jZV9p
byd9IHwgYm91bmNlLXN3YXAgSS9POiAkc3RhdHN7J2JvdW5jZV9zd2FwX2lvJ31cbiI7CgkJfQoJ
fQoKCWlmICghICRza2lwX3BhZ2Vfc3dhcCkKCXsKCQkkcHJ0cGdpbyA9ICgkdGhpc3BhZ2VpbyAt
ICRwcmV2cGFnZWlvKSAvICRpbnRlcnZhbDsKCQkkcHJ0c3dpbyA9ICgkdGhpc3N3YXBpbyAtICRw
cmV2c3dhcGlvKSAvICRpbnRlcnZhbDsKCX0KCSRwcnRpbnRzID0gKCRzdGF0c3snaW50cid9IC0g
JHByZXZpbnRzKSAvICRpbnRlcnZhbDsKCSRwcnRjdHh0ID0gKCRzdGF0c3snY3R4dCd9IC0gJHBy
ZXZjdHhzdykgLyAkaW50ZXJ2YWw7CglpZiAoISAkc2tpcF9wYWdlX3N3YXApCgl7CgkJcHJpbnQg
InBnaW8vc2VjOiAkcHJ0cGdpbyB8IHN3aW8vc2VjOiAkcHJ0c3dpbyB8IGludHMvc2VjOiAkcHJ0
aW50cyB8IGN0c3cvc2VjOiAkcHJ0Y3R4dFxuIjsKCX0KCWVsc2UgewoJCXByaW50ICJpbnRzL3Nl
YzogJHBydGludHMgfCBjdHN3L3NlYzogJHBydGN0eHRcbiI7Cgl9CgkkcHJldnBhZ2VpbyA9ICR0
aGlzcGFnZWlvOwoJJHByZXZzd2FwaW8gPSAkdGhpc3N3YXBpbzsKCSRwcmV2aW50cyA9ICRzdGF0
c3snaW50cid9OwoJJHByZXZjdHhzdyA9ICRzdGF0c3snY3R4dCd9Owp9ICMgZW5kIGRvX3N0YXQK
CnN1YiBkb19tZW1pbmZvCnsKCXNlZWsgKE1FTUlORk8sIDAsIDApOwkjIHRvIEJPRgoJIyMjJGhl
YWRlciA9IDxNRU1JTkZPPjsJCSMgZmlyc3QgbGluZSBpcyBoZWFkZXI6CgkjIyNjaG9tcCAkaGVh
ZGVyOwoKCXdoaWxlICgkbWVtaW5mbyA9IDxNRU1JTkZPPikJIyBNRU1JTkZPIGhhcyBtdWx0aXBs
ZSBsaW5lcwoJewoJCWNob21wICRtZW1pbmZvOwoJCSMjI3ByaW50ICJyYXcgbWVtaW5mbyBbJG1l
bWluZm9dXG4iOwoJCSMgc3BsaXQgaW50byB3b3JkcwoJCUB3b3JkcyA9IHNwbGl0IC8gKy8sICRt
ZW1pbmZvOwoJCSMjI3ByaW50ICJyYXcgd29yZHM6IFtAd29yZHNdXG4iOwoJCSR0YWcgPSAkd29y
ZHNbMF07CgkJaWYgKCR0YWcgZXEgIiIpCgkJewoJCQlzaGlmdCBAd29yZHM7CgkJCSR0YWcgPSAk
d29yZHNbMF07CgkJfQoJCSRkYXRhID0gam9pbiAoJCIsIEB3b3Jkc1sxLi4kI3dvcmRzXSk7CgkJ
IyMjcHJpbnQgInJhdyB0YWcgWyR0YWddLCBkYXRhIFskZGF0YV1cbiI7CgkJJHN0YXRzeyR0YWd9
ID0gJGRhdGE7Cgl9CgkjIyNwcmludCAiJGhlYWRlclxuIjsKCSMjI3ByaW50ICJNZW06ICRzdGF0
c3snTWVtOid9XG4iOwoJIyMjcHJpbnQgIlN3YXA6ICRzdGF0c3snU3dhcDonfSAgfCAgTWVtRnJl
ZTogJHN0YXRzeydNZW1GcmVlOid9XG4iOwoJcHJpbnQgIk1lbVRvdGFsL0ZyZWU6ICRzdGF0c3sn
TWVtVG90YWw6J30vJHN0YXRzeydNZW1GcmVlOid9IHwgIjsKCXByaW50ICJTd2FwVG90YWwvRnJl
ZTogJHN0YXRzeydTd2FwVG90YWw6J30vJHN0YXRzeydTd2FwRnJlZTonfVxuIjsKfSAjIGVuZCBk
b19tZW1pbmZvCgpzdWIgZG9fdm1zdGF0CnsKfSAjIGVuZCBkb192bXN0YXQKCiMjIyMjIyMjIyMj
IyMjIyMjIyMjIyMgbWFpbiAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgokaW50ZXJ2YWwgPSAxOwkJ
CSMgc2Vjb25kcyB0byBzbGVlcCBiZXR3ZWVuIHVwZGF0ZXMKaWYgKHNjYWxhciAoQEFSR1YpID4g
MCkKewoJJGludGVydmFsID0gaW50IChzaGlmdCAoQEFSR1YpKTsKCXByaW50ICJ1cGRhdGUgaW50
ZXJ2YWwgY2hhbmdlZCBmcm9tIDEgc2Vjb25kIHRvICRpbnRlcnZhbFxuIjsKCWlmICgkaW50ZXJ2
YWwgPD0gMCkKCXsKCQlwcmludCAiaW52YWxpZCBpbnRlcnZhbDogJGludGVydmFsXG4iOwoJCXVz
YWdlKCk7CgkJZXhpdCAyOwoJfQp9CgokbG9vcGNvdW50ID0gMDsJCQkjIG51bWJlciBvZiBsb29w
cyB0byBzdGF5IGFsaXZlCmlmIChzY2FsYXIgKEBBUkdWKSA+IDApCnsKCSRsb29wY291bnQgPSBp
bnQgKHNoaWZ0IChAQVJHVikpOwoJcHJpbnQgInVwZGF0ZSBsb29wY291bnQgY2hhbmdlZCBmcm9t
IDAgdG8gJGxvb3Bjb3VudFxuIjsKCWlmICgkbG9vcGNvdW50IDw9IDApCgl7CgkJcHJpbnQgImlu
dmFsaWQgbG9vcGNvdW50OiAkbG9vcGNvdW50XG4iOwoJCXVzYWdlKCk7CgkJZXhpdCAyOwoJfQp9
CgojIGdldCAvcHJvYy9jbWRsaW5lIGFuZCAvcHJvYy92ZXJzaW9uIG9uZSB0aW1lIG9ubHkKb3Bl
biAoUFJPQ0ZJTEUsICI8L3Byb2MvY21kbGluZSIpIG9yIGRpZSAiY2Fubm90IG9wZW4gL3Byb2Mv
Y21kbGluZVxuIjsKJGNtZGxpbmUgPSA8UFJPQ0ZJTEU+OwpjaG9tcCAkY21kbGluZTsKY2xvc2Ug
UFJPQ0ZJTEU7CgpvcGVuIChQUk9DRklMRSwgIjwvcHJvYy92ZXJzaW9uIikgb3IgZGllICJjYW5u
b3Qgb3BlbiAvcHJvYy92ZXJzaW9uXG4iOwokdmVyc2lvbiA9IDxQUk9DRklMRT47CmNob21wICR2
ZXJzaW9uOwpjbG9zZSBQUk9DRklMRTsKIApvcGVuIChMT0FEQVZHLCAiPC9wcm9jL2xvYWRhdmci
KSBvciBkaWUgImNhbm5vdCBvcGVuIC9wcm9jL2xvYWRhdmdcbiI7Cm9wZW4gKFNUQVQsICI8L3By
b2Mvc3RhdCIpICAgICAgIG9yIGRpZSAiY2Fubm90IG9wZW4gL3Byb2Mvc3RhdFxuIjsKb3BlbiAo
TUVNSU5GTywgIjwvcHJvYy9tZW1pbmZvIikgb3IgZGllICJjYW5ub3Qgb3BlbiAvcHJvYy9tZW1p
bmZvXG4iOwogCiR0bSA9IGxvY2FsdGltZTsKcHJpbnQgInRpbWU6ICR0bVxuIjsKcHJpbnQgImNt
ZGxpbmU6ICRjbWRsaW5lXG4iOwpwcmludCAidmVyc2lvbjogJHZlcnNpb25cbiI7CnByaW50ICI9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuIjsKCiMg
ZG8gdW50aWwga2lsbGVkIG9yIGxvb3Bjb3VudCB0aW1lczoKTE9PUEVSOgp3aGlsZSAoMSkKewoJ
JHRtID0gbG9jYWx0aW1lOwoJcHJpbnQgInRpbWU6ICAkdG1cbiI7CgoJZG9fbG9hZGF2ZygpOwkJ
CSMgL3Byb2MvbG9hZGF2ZyBmaWxlCglkb19zdGF0KCk7CQkJIyAvcHJvYy9zdGF0IGZpbGUKCWRv
X3Ztc3RhdCgpOwkJCSMgL3Byb2Mvdm1zdGF0IGZpbGUKCWRvX21lbWluZm8oKTsJCQkjIC9wcm9j
L21lbWluZm8gZmlsZQoKCXByaW50ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PVxuIjsKCXNsZWVwICgkaW50ZXJ2YWwpOwoKCWlmICgkbG9vcGNvdW50
KQkJCSMgaXMgYmVpbmcgdXNlZAoJewoJCSRsb29wY291bnQtLTsKCQlsYXN0IExPT1BFUiBpZiAk
bG9vcGNvdW50ID09IDA7Cgl9Cn0gIyBlbmQgZm9yZXZlci9MT09QRVIKCgpjbG9zZSAoTE9BREFW
Ryk7CmNsb3NlIChTVEFUKTsKY2xvc2UgKE1FTUlORk8pOwoKZXhpdCAwOwojIGVuZCBzeXNhbGl2
ZS5wbAo=

--Multipart=_Thu__28_Apr_2005_10_32_45_-0700_TfP_+ZQ65jznrvG9--
