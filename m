Return-Path: <linux-kernel-owner+willy=40w.ods.org@vger.kernel.org>
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S263101AbTLXBpc (ORCPT <rfc822;willy@w.ods.org>);
	Tue, 23 Dec 2003 20:45:32 -0500
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S262913AbTLXBpb
	(ORCPT <rfc822;linux-kernel-outgoing>);
	Tue, 23 Dec 2003 20:45:31 -0500
Received: from zero.voxel.net ([209.123.232.253]:47260 "EHLO zero.voxel.net")
	by vger.kernel.org with ESMTP id S263462AbTLXBnu (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Tue, 23 Dec 2003 20:43:50 -0500
Subject: [PATCH 4/7] more CardServices() removals (drivers/net/wireless)
From: Andres Salomon <dilinger@voxel.net>
To: Andrew Morton <akpm@osdl.org>
Cc: linux-kernel@vger.kernel.org, linux-pcmcia@lists.infradead.org
Content-Type: multipart/signed; micalg=pgp-sha1; protocol="application/pgp-signature"; boundary="=-6BWOe9nQzR6wIHlzihOO"
Message-Id: <1072226926.5300.20.camel@spiral.internal>
Mime-Version: 1.0
X-Mailer: Ximian Evolution 1.4.5 
Date: Tue, 23 Dec 2003 20:43:43 -0500
Sender: linux-kernel-owner@vger.kernel.org
X-Mailing-List: linux-kernel@vger.kernel.org


--=-6BWOe9nQzR6wIHlzihOO
Content-Type: multipart/mixed; boundary="=-0234RNVA5V9CbluZPSGH"


--=-0234RNVA5V9CbluZPSGH
Content-Type: text/plain
Content-Transfer-Encoding: quoted-printable

Part 4 of 7.

--=-0234RNVA5V9CbluZPSGH
Content-Disposition: attachment; filename=104-cs_remove.patch
Content-Type: text/x-patch; name=104-cs_remove.patch; charset=us-ascii
Content-Transfer-Encoding: base64

UmV2aXNpb246IGxpbnV4LS1tYWlubGluZS0tMi42LS1wYXRjaC0zMw0KQXJjaGl2ZTogZGlsaW5n
ZXJAdm94ZWwubmV0LS0yMDAzLXNwaXJhbA0KQ3JlYXRvcjogQW5kcmVzIFNhbG9tb24gPGRpbGlu
Z2VyQHZveGVsLm5ldD4NCkRhdGU6IFR1ZSBEZWMgMjMgMTg6NTY6MzEgRVNUIDIwMDMNClN0YW5k
YXJkLWRhdGU6IDIwMDMtMTItMjMgMjM6NTY6MzEgR01UDQpNb2RpZmllZC1maWxlczogZHJpdmVy
cy9uZXQvd2lyZWxlc3Mvb3Jpbm9jb19jcy5jDQpOZXctcGF0Y2hlczogZGlsaW5nZXJAdm94ZWwu
bmV0LS0yMDAzLXNwaXJhbC9saW51eC0tbWFpbmxpbmUtLTIuNi0tcGF0Y2gtMzMNClN1bW1hcnk6
IENhcmRTZXJ2aWNlcygpIHJlbW92YWwsIGFjdCAyLCBwdC4gNC4NCktleXdvcmRzOiANCg0KUmVt
b3ZlIGNhbGxzIHRvIENhcmRTZXJ2aWNlcygpLCBhY3QgMiwgcGFydCA0OyBvcmlub2NvX2NzLmMu
DQoNCiogYWRkZWQgZmlsZXMNCg0KICAgIHthcmNofS9saW51eC9saW51eC0tbWFpbmxpbmUvbGlu
dXgtLW1haW5saW5lLS0yLjYvZGlsaW5nZXJAdm94ZWwubmV0LS0yMDAzLXNwaXJhbC9wYXRjaC1s
b2cvcGF0Y2gtMzMNCg0KKiBtb2RpZmllZCBmaWxlcw0KDQotLS0gb3JpZy9kcml2ZXJzL25ldC93
aXJlbGVzcy9vcmlub2NvX2NzLmMNCisrKyBtb2QvZHJpdmVycy9uZXQvd2lyZWxlc3Mvb3Jpbm9j
b19jcy5jDQpAQCAtMTMxLDcgKzEzMSw3IEBADQogCS8qIFdlIG5lZWQgYXRvbWljIG9wcyBoZXJl
LCBiZWNhdXNlIHdlJ3JlIG5vdCBob2xkaW5nIHRoZSBsb2NrICovDQogCXNldF9iaXQoMCwgJmNh
cmQtPmhhcmRfcmVzZXRfaW5fcHJvZ3Jlc3MpOw0KIA0KLQllcnIgPSBDYXJkU2VydmljZXMoUmVz
ZXRDYXJkLCBsaW5rLT5oYW5kbGUsIE5VTEwpOw0KKwllcnIgPSBwY21jaWFfcmVzZXRfY2FyZChs
aW5rLT5oYW5kbGUsIE5VTEwpOw0KIAlpZiAoZXJyKQ0KIAkJcmV0dXJuIGVycjsNCiANCkBAIC0x
NTAsNyArMTUwLDcgQEANCiBvcmlub2NvX2NzX2Vycm9yKGNsaWVudF9oYW5kbGVfdCBoYW5kbGUs
IGludCBmdW5jLCBpbnQgcmV0KQ0KIHsNCiAJZXJyb3JfaW5mb190IGVyciA9IHsgZnVuYywgcmV0
IH07DQotCUNhcmRTZXJ2aWNlcyhSZXBvcnRFcnJvciwgaGFuZGxlLCAmZXJyKTsNCisJcGNtY2lh
X3JlcG9ydF9lcnJvcihoYW5kbGUsICZlcnIpOw0KIH0NCiANCiAvKg0KQEAgLTIxNCw3ICsyMTQs
NyBAQA0KIAljbGllbnRfcmVnLlZlcnNpb24gPSAweDAyMTA7IC8qIEZJWE1FOiB3aGF0IGRvZXMg
dGhpcyBtZWFuPyAqLw0KIAljbGllbnRfcmVnLmV2ZW50X2NhbGxiYWNrX2FyZ3MuY2xpZW50X2Rh
dGEgPSBsaW5rOw0KIA0KLQlyZXQgPSBDYXJkU2VydmljZXMoUmVnaXN0ZXJDbGllbnQsICZsaW5r
LT5oYW5kbGUsICZjbGllbnRfcmVnKTsNCisJcmV0ID0gcGNtY2lhX3JlZ2lzdGVyX2NsaWVudCgm
bGluay0+aGFuZGxlLCAmY2xpZW50X3JlZyk7DQogCWlmIChyZXQgIT0gQ1NfU1VDQ0VTUykgew0K
IAkJb3Jpbm9jb19jc19lcnJvcihsaW5rLT5oYW5kbGUsIFJlZ2lzdGVyQ2xpZW50LCByZXQpOw0K
IAkJb3Jpbm9jb19jc19kZXRhY2gobGluayk7DQpAQCAtMjUwLDcgKzI1MCw3IEBADQogDQogCS8q
IEJyZWFrIHRoZSBsaW5rIHdpdGggQ2FyZCBTZXJ2aWNlcyAqLw0KIAlpZiAobGluay0+aGFuZGxl
KQ0KLQkJQ2FyZFNlcnZpY2VzKERlcmVnaXN0ZXJDbGllbnQsIGxpbmstPmhhbmRsZSk7DQorCQlw
Y21jaWFfZGVyZWdpc3Rlcl9jbGllbnQobGluay0+aGFuZGxlKTsNCiANCiAJLyogVW5saW5rIGRl
dmljZSBzdHJ1Y3R1cmUsIGFuZCBmcmVlIGl0ICovDQogCSpsaW5rcCA9IGxpbmstPm5leHQ7DQpA
QCAtMjY5LDExICsyNjksOCBAQA0KICAqIGRldmljZSBhdmFpbGFibGUgdG8gdGhlIHN5c3RlbS4N
CiAgKi8NCiANCi0jZGVmaW5lIENTX0NIRUNLKGZuLCBhcmdzLi4uKSBcDQotCXdoaWxlICgobGFz
dF9yZXQ9Q2FyZFNlcnZpY2VzKGxhc3RfZm49KGZuKSxhcmdzKSkhPTApIGdvdG8gY3NfZmFpbGVk
DQotDQotI2RlZmluZSBDRkdfQ0hFQ0soZm4sIGFyZ3MuLi4pIFwNCi0JaWYgKENhcmRTZXJ2aWNl
cyhmbiwgYXJncykgIT0gMCkgZ290byBuZXh0X2VudHJ5DQorI2RlZmluZSBDU19DSEVDSyhmbiwg
cmV0KSBcDQorZG8geyBsYXN0X2ZuID0gKGZuKTsgaWYgKChsYXN0X3JldCA9IChyZXQpKSAhPSAw
KSBnb3RvIGNzX2ZhaWxlZDsgfSB3aGlsZSAoMCkNCiANCiBzdGF0aWMgdm9pZA0KIG9yaW5vY29f
Y3NfY29uZmlnKGRldl9saW5rX3QgKmxpbmspDQpAQCAtMjkwLDcgKzI4Nyw3IEBADQogCXR1cGxl
X3QgdHVwbGU7DQogCWNpc3BhcnNlX3QgcGFyc2U7DQogDQotCUNTX0NIRUNLKFZhbGlkYXRlQ0lT
LCBoYW5kbGUsICZpbmZvKTsNCisJQ1NfQ0hFQ0soVmFsaWRhdGVDSVMsIHBjbWNpYV92YWxpZGF0
ZV9jaXMoaGFuZGxlLCAmaW5mbykpOw0KIA0KIAkvKg0KIAkgKiBUaGlzIHJlYWRzIHRoZSBjYXJk
J3MgQ09ORklHIHR1cGxlIHRvIGZpbmQgaXRzDQpAQCAtMzAxLDkgKzI5OCw5IEBADQogCXR1cGxl
LlR1cGxlRGF0YSA9IGJ1ZjsNCiAJdHVwbGUuVHVwbGVEYXRhTWF4ID0gc2l6ZW9mKGJ1Zik7DQog
CXR1cGxlLlR1cGxlT2Zmc2V0ID0gMDsNCi0JQ1NfQ0hFQ0soR2V0Rmlyc3RUdXBsZSwgaGFuZGxl
LCAmdHVwbGUpOw0KLQlDU19DSEVDSyhHZXRUdXBsZURhdGEsIGhhbmRsZSwgJnR1cGxlKTsNCi0J
Q1NfQ0hFQ0soUGFyc2VUdXBsZSwgaGFuZGxlLCAmdHVwbGUsICZwYXJzZSk7DQorCUNTX0NIRUNL
KEdldEZpcnN0VHVwbGUsIHBjbWNpYV9nZXRfZmlyc3RfdHVwbGUoaGFuZGxlLCAmdHVwbGUpKTsN
CisJQ1NfQ0hFQ0soR2V0VHVwbGVEYXRhLCBwY21jaWFfZ2V0X3R1cGxlX2RhdGEoaGFuZGxlLCAm
dHVwbGUpKTsNCisJQ1NfQ0hFQ0soUGFyc2VUdXBsZSwgcGNtY2lhX3BhcnNlX3R1cGxlKGhhbmRs
ZSwgJnR1cGxlLCAmcGFyc2UpKTsNCiAJbGluay0+Y29uZi5Db25maWdCYXNlID0gcGFyc2UuY29u
ZmlnLmJhc2U7DQogCWxpbmstPmNvbmYuUHJlc2VudCA9IHBhcnNlLmNvbmZpZy5ybWFza1swXTsN
CiANCkBAIC0zMTEsNyArMzA4LDcgQEANCiAJbGluay0+c3RhdGUgfD0gREVWX0NPTkZJRzsNCiAN
CiAJLyogTG9vayB1cCB0aGUgY3VycmVudCBWY2MgKi8NCi0JQ1NfQ0hFQ0soR2V0Q29uZmlndXJh
dGlvbkluZm8sIGhhbmRsZSwgJmNvbmYpOw0KKwlDU19DSEVDSyhHZXRDb25maWd1cmF0aW9uSW5m
bywgcGNtY2lhX2dldF9jb25maWd1cmF0aW9uX2luZm8oaGFuZGxlLCAmY29uZikpOw0KIAlsaW5r
LT5jb25mLlZjYyA9IGNvbmYuVmNjOw0KIA0KIAkvKg0KQEAgLTMyOSwxMyArMzI2LDE0IEBADQog
CSAqIGltcGxlbWVudGF0aW9uLWRlZmluZWQgZGV0YWlscy4NCiAJICovDQogCXR1cGxlLkRlc2ly
ZWRUdXBsZSA9IENJU1RQTF9DRlRBQkxFX0VOVFJZOw0KLQlDU19DSEVDSyhHZXRGaXJzdFR1cGxl
LCBoYW5kbGUsICZ0dXBsZSk7DQorCUNTX0NIRUNLKEdldEZpcnN0VHVwbGUsIHBjbWNpYV9nZXRf
Zmlyc3RfdHVwbGUoaGFuZGxlLCAmdHVwbGUpKTsNCiAJd2hpbGUgKDEpIHsNCiAJCWNpc3RwbF9j
ZnRhYmxlX2VudHJ5X3QgKmNmZyA9ICYocGFyc2UuY2Z0YWJsZV9lbnRyeSk7DQogCQljaXN0cGxf
Y2Z0YWJsZV9lbnRyeV90IGRmbHQgPSB7IC5pbmRleCA9IDAgfTsNCiANCi0JCUNGR19DSEVDSyhH
ZXRUdXBsZURhdGEsIGhhbmRsZSwgJnR1cGxlKTsNCi0JCUNGR19DSEVDSyhQYXJzZVR1cGxlLCBo
YW5kbGUsICZ0dXBsZSwgJnBhcnNlKTsNCisJCWlmIChwY21jaWFfZ2V0X3R1cGxlX2RhdGEoaGFu
ZGxlLCAmdHVwbGUpICE9IDAgfHwNCisJCQkJcGNtY2lhX3BhcnNlX3R1cGxlKGhhbmRsZSwgJnR1
cGxlLCAmcGFyc2UpICE9IDApDQorCQkJZ290byBuZXh0X2VudHJ5Ow0KIA0KIAkJaWYgKGNmZy0+
ZmxhZ3MgJiBDSVNUUExfQ0ZUQUJMRV9ERUZBVUxUKQ0KIAkJCWRmbHQgPSAqY2ZnOw0KQEAgLTQw
MCw3ICszOTgsOCBAQA0KIAkJCX0NCiANCiAJCQkvKiBUaGlzIHJlc2VydmVzIElPIHNwYWNlIGJ1
dCBkb2Vzbid0IGFjdHVhbGx5IGVuYWJsZSBpdCAqLw0KLQkJCUNGR19DSEVDSyhSZXF1ZXN0SU8s
IGxpbmstPmhhbmRsZSwgJmxpbmstPmlvKTsNCisJCQlpZiAocGNtY2lhX3JlcXVlc3RfaW8obGlu
ay0+aGFuZGxlLCAmbGluay0+aW8pICE9IDApDQorCQkJCWdvdG8gbmV4dF9lbnRyeTsNCiAJCX0N
CiANCiANCkBAIC00MTAsOCArNDA5LDggQEANCiAJCQ0KIAluZXh0X2VudHJ5Og0KIAkJaWYgKGxp
bmstPmlvLk51bVBvcnRzMSkNCi0JCQlDYXJkU2VydmljZXMoUmVsZWFzZUlPLCBsaW5rLT5oYW5k
bGUsICZsaW5rLT5pbyk7DQotCQlsYXN0X3JldCA9IENhcmRTZXJ2aWNlcyhHZXROZXh0VHVwbGUs
IGhhbmRsZSwgJnR1cGxlKTsNCisJCQlwY21jaWFfcmVsZWFzZV9pbyhsaW5rLT5oYW5kbGUsICZs
aW5rLT5pbyk7DQorCQlsYXN0X3JldCA9IHBjbWNpYV9nZXRfbmV4dF90dXBsZShoYW5kbGUsICZ0
dXBsZSk7DQogCQlpZiAobGFzdF9yZXQgID09IENTX05PX01PUkVfSVRFTVMpIHsNCiAJCQlwcmlu
dGsoS0VSTl9FUlIgIkdldE5leHRUdXBsZSgpLiAgTm8gbWF0Y2hpbmcgQ0lTIGNvbmZpZ3VyYXRp
b24sICINCiAJCQkgICAgICAgIm1heWJlIHlvdSBuZWVkIHRoZSBpZ25vcmVfY2lzX3ZjYz0xIHBh
cmFtZXRlci5cbiIpOw0KQEAgLTQzOCw3ICs0MzcsNyBAQA0KICAgCQlsaW5rLT5pcnEuSGFuZGxl
ciA9IG9yaW5vY29faW50ZXJydXB0OyANCiAgIAkJbGluay0+aXJxLkluc3RhbmNlID0gZGV2OyAN
CiAJCQ0KLQkJQ1NfQ0hFQ0soUmVxdWVzdElSUSwgbGluay0+aGFuZGxlLCAmbGluay0+aXJxKTsN
CisJCUNTX0NIRUNLKFJlcXVlc3RJUlEsIHBjbWNpYV9yZXF1ZXN0X2lycShsaW5rLT5oYW5kbGUs
ICZsaW5rLT5pcnEpKTsNCiAJfQ0KIA0KIAkvKiBXZSBpbml0aWFsaXplIHRoZSBoZXJtZXMgc3Ry
dWN0dXJlIGJlZm9yZSBjb21wbGV0aW5nIFBDTUNJQQ0KQEAgLTQ1Miw3ICs0NTEsNyBAQA0KIAkg
KiB0aGUgSS9PIHdpbmRvd3MgYW5kIHRoZSBpbnRlcnJ1cHQgbWFwcGluZywgYW5kIHB1dHRpbmcg
dGhlDQogCSAqIGNhcmQgYW5kIGhvc3QgaW50ZXJmYWNlIGludG8gIk1lbW9yeSBhbmQgSU8iIG1v
ZGUuDQogCSAqLw0KLQlDU19DSEVDSyhSZXF1ZXN0Q29uZmlndXJhdGlvbiwgbGluay0+aGFuZGxl
LCAmbGluay0+Y29uZik7DQorCUNTX0NIRUNLKFJlcXVlc3RDb25maWd1cmF0aW9uLCBwY21jaWFf
cmVxdWVzdF9jb25maWd1cmF0aW9uKGxpbmstPmhhbmRsZSwgJmxpbmstPmNvbmYpKTsNCiANCiAJ
LyogT2ssIHdlIGhhdmUgdGhlIGNvbmZpZ3VyYXRpb24sIHByZXBhcmUgdG8gcmVnaXN0ZXIgdGhl
IG5ldGRldiAqLw0KIAlkZXYtPmJhc2VfYWRkciA9IGxpbmstPmlvLkJhc2VQb3J0MTsNCkBAIC01
MjEsMTEgKzUyMCwxMSBAQA0KIAlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZwcml2LT5sb2NrLCBm
bGFncyk7DQogDQogCS8qIERvbid0IGJvdGhlciBjaGVja2luZyB0byBzZWUgaWYgdGhlc2Ugc3Vj
Y2VlZCBvciBub3QgKi8NCi0JQ2FyZFNlcnZpY2VzKFJlbGVhc2VDb25maWd1cmF0aW9uLCBsaW5r
LT5oYW5kbGUpOw0KKwlwY21jaWFfcmVsZWFzZV9jb25maWd1cmF0aW9uKGxpbmstPmhhbmRsZSk7
DQogCWlmIChsaW5rLT5pby5OdW1Qb3J0czEpDQotCQlDYXJkU2VydmljZXMoUmVsZWFzZUlPLCBs
aW5rLT5oYW5kbGUsICZsaW5rLT5pbyk7DQorCQlwY21jaWFfcmVsZWFzZV9pbyhsaW5rLT5oYW5k
bGUsICZsaW5rLT5pbyk7DQogCWlmIChsaW5rLT5pcnEuQXNzaWduZWRJUlEpDQotCQlDYXJkU2Vy
dmljZXMoUmVsZWFzZUlSUSwgbGluay0+aGFuZGxlLCAmbGluay0+aXJxKTsNCisJCXBjbWNpYV9y
ZWxlYXNlX2lycShsaW5rLT5oYW5kbGUsICZsaW5rLT5pcnEpOw0KIAlsaW5rLT5zdGF0ZSAmPSB+
REVWX0NPTkZJRzsNCiB9CQkJCS8qIG9yaW5vY29fY3NfcmVsZWFzZSAqLw0KIA0KQEAgLTU4Nyw3
ICs1ODYsNyBAQA0KIAkJCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZwcml2LT5sb2NrLCBmbGFn
cyk7DQogCQkJfQ0KIA0KLQkJCUNhcmRTZXJ2aWNlcyhSZWxlYXNlQ29uZmlndXJhdGlvbiwgbGlu
ay0+aGFuZGxlKTsNCisJCQlwY21jaWFfcmVsZWFzZV9jb25maWd1cmF0aW9uKGxpbmstPmhhbmRs
ZSk7DQogCQl9DQogCQlicmVhazsNCiANCkBAIC01OTgsOCArNTk3LDcgQEANCiAJCWlmIChsaW5r
LT5zdGF0ZSAmIERFVl9DT05GSUcpIHsNCiAJCQkvKiBGSVhNRTogc2hvdWxkIHdlIGRvdWJsZSBj
aGVjayB0aGF0IHRoaXMgaXMNCiAJCQkgKiB0aGUgc2FtZSBjYXJkIGFzIHdlIGhhZCBiZWZvcmUg
Ki8NCi0JCQlDYXJkU2VydmljZXMoUmVxdWVzdENvbmZpZ3VyYXRpb24sIGxpbmstPmhhbmRsZSwN
Ci0JCQkJICAgICAmbGluay0+Y29uZik7DQorCQkJcGNtY2lhX3JlcXVlc3RfY29uZmlndXJhdGlv
bihsaW5rLT5oYW5kbGUsICZsaW5rLT5jb25mKTsNCiANCiAJCQlpZiAoISB0ZXN0X2JpdCgwLCAm
Y2FyZC0+aGFyZF9yZXNldF9pbl9wcm9ncmVzcykpIHsNCiAJCQkJZXJyID0gb3Jpbm9jb19yZWlu
aXRfZmlybXdhcmUoZGV2KTsNCg0KDQoNCg==

--=-0234RNVA5V9CbluZPSGH--

--=-6BWOe9nQzR6wIHlzihOO
Content-Type: application/pgp-signature; name=signature.asc
Content-Description: This is a digitally signed message part

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)

iD8DBQA/6OJu78o9R9NraMQRAmlqAKCzRG+8VW2XQk30nh6vnTsWbDBO7QCgs5c2
r6NAVLGlyoCW0r1E/c3lWxc=
=dsCz
-----END PGP SIGNATURE-----

--=-6BWOe9nQzR6wIHlzihOO--

